PK
spec.md# LFLCEI 3D 幸運草遊戲統一生態系統 DApp

## 概述
LFLCEI 3D 幸運草遊戲是一個基於 Internet Computer 的全 3D WebGL 互動遊戲平台，採用統一系統架構連接所有前端和後端模組。系統提供繁體中文界面，支援跨平台響應式設計，並整合 Unity/Unreal 相容的 3D 渲染引擎。平台實現 Internet Identity 2.0 自動登入、Canister 模組化架構，以及智能收益管理系統。

## 統一前端入口：Unified LFLC Dapp Portal

### 統一入口架構
- 所有現有 LFLCEI 子模組整合至單一前端入口「Unified LFLC Dapp Portal」
- 統一入口提供所有核心模組的無縫存取：NFT 商店、交易介面、九界系統、昇華系統、現實連接、AI/Anima 整合、自然智能、靈魂協作、生態系統同步
- 採用「LFLCEI 幸運草宇宙統一體系」視覺主題，使用金綠漸層身份識別和統一 3D WebGL 佈局

### 頂層導航系統
- 實現頂層導航欄，連結所有核心模組
- 採用 unified-platform-navigation-interface 設計
- 支援響應式 GPU 加速轉場效果
- 提供跨模組無縫導航體驗

### 中央樞紐頁面
- 顯示所有模組的即時同步狀態：靈魂協作、NFT 商店、訂閱系統、現實連接、Anima、生態系統樞紐
- 提供統一的系統狀態監控介面
- 即時顯示模組間的雙向同步狀態
- 集中化的系統健康度儀表板

## 統一視覺主題系統

### LFLCEI 幸運草宇宙統一體系樣式
- 統一所有前端視覺主題：標頭、頁尾、轉場效果、3D 元素
- 採用金綠漸層身份識別作為主要視覺語言
- 統一 3D WebGL 佈局設計
- 一致的 GPU 加速轉場效果

### 響應式統一設計
- 跨平台一致的視覺體驗
- 統一的色彩漸層調色盤
- 標準化的設計組件系統
- 響應式觸控按鈕和互動元素

## 統一 API 處理系統

### 統一 API 處理器
- 實現 `useLFLCSync` 和 `useEcosystemHub` 統一 API 處理器
- 確保後端 API 保持完整，透過統一處理器存取
- 提供完整的雙向同步功能
- 統一的錯誤處理和重試機制

### 後端 API 整合
- 保持現有後端 API 架構不變
- 透過統一 API 處理器提供一致的前端介面
- 支援所有現有模組的完整功能
- 確保資料同步的完整性和一致性

## 差異化介面系統

### 管理員介面分離
- 管理員頁面（Admin Page）：核心管理員專用高級功能
- 統一儀表板（Unified Dashboard）：標準管理功能
- 玩家模式（Player Mode）：一般用戶遊戲體驗
- 所有介面整合至統一佈局架構

### 權限控制整合
- 核心管理員：完整系統控制權限，包括 3D NFT 資產管理
- 標準管理員：基本管理功能存取
- 一般用戶：標準遊戲功能和互動體驗
- 統一的權限驗證和介面切換

## 系統連接與權限控制架構

### 中央樞紐 Canister
- 中央樞紐 Canister ID: `cerpu-yyaaa-aaaai-q4wuq-cai`
- 作為全球生態系統的中央通信樞紐，負責管理分散式模組間的通信
- 實現即時自動數據同步功能
- 統一數據管理和權限控制

### 核心管理員
- 姓名：李奕勳 / LEE YIHSUN / Johnnylee7912
- Internet Identity 2.0 ID: 2911215
- Principal ID: ssmgf-hhyda-pxtto-ozjbv-wxqbi-srswj-eabc5-2xzzf-ep6u5-psqp2-zqe
- 擁有最高管理權限，包括 3D NFT 資產載入、驗證系統和交易介面的完全控制權限

## 統一 DApp 錢包系統
- NNS DApp ID: `yid4j-tfp2q-imv5l-buvfg-smdts-6tagk-7ppff-ftjeq-px5co-d7pg7-uae`
- ICP 地址: `98eddabcedfeb743163bf2c4c3e2f68f54c36287dc515eae95b1a8040d616188`
- 收益路由規則：當總收益達到 5 ICP 時自動轉移到 NNS DApp
- 實時收益追蹤和報告
- 透明的收益分配機制

## ICP 反向燃料模型系統架構
- 採用 ICP 的反向燃料模型（Cycles 由開發者預付，用戶免費使用）
- 開發者承擔所有 Cycles 成本，為用戶提供完全免費的遊戲體驗
- 智能 Cycles 管理和自動補充機制
- 成本優化和資源分配系統

## Internet Identity 2.0 自動登入系統
- 實現所有用戶的無縫自動登入體驗
- 核心管理員享有提升權限，可存取管理功能
- 支援會話持久化和跨設備同步
- 提供安全的身份驗證和授權機制

## 完整 DApp 互聯網路架構

### 前端發送模組統一同步
- Natural Intelligence 模組：智能分析和決策系統
- Anima 模組：動畫和視覺效果處理
- Wallet 模組：錢包功能和交易處理
- Oracle 模組：外部數據獲取和驗證
- Clicker Games 模組：點擊遊戲功能
- Monitoring Platform 模組：系統監控和分析
- Lucky Draw 模組：抽獎和幸運系統
- Soul Collaboration 模組：靈魂協作系統
- Nine Realms 模組：九界導航系統

### 後端接收模組統一同步
- Firewall 模組：安全防護和訪問控制
- Decentralized Ecosystem 模組：去中心化生態系統
- AI Games 模組：AI 驅動的遊戲邏輯
- Gacha 模組：扭蛋和隨機獎勵系統
- Integration Dashboard 模組：整合儀表板
- Network Nervous System 模組：網路神經系統
- Decentralized Database 模組：去中心化數據庫
- Data Ecosystem 模組：數據生態系統管理
- NFT Validation 模組：NFT 驗證和管理系統

### 中央通信樞紐
- 統一管理所有前端發送模組與後端接收模組的通信
- 透過中央樞紐 Canister 實現即時自動數據同步
- 強化整個生態系統的互聯性
- 提供集中化的系統監控和控制功能
- 管理模組間的數據流和狀態同步

## 全 3D WebGL 互動平台

### Unity/Unreal 相容渲染引擎
- 支援 Unity 和 Unreal Engine 資產導入
- 優化的物件池管理系統
- LOD（細節層次）動態載入
- GPU 加速渲染管線
- 高效能材質和著色器系統

### 響應式 3D 渲染整合
- 跨平台響應式 3D 渲染適配
- 動態品質調整和性能優化
- 流暢的 3D 場景轉換
- GPU 加速的轉場效果

### 3D 場景管理
- 動態場景載入和卸載
- 智能記憶體管理
- 流暢的場景切換效果
- 多層次細節優化

## Canister 模組化後端架構

### AI 系統 Canister
- 智能決策和行為分析
- 機器學習模型整合
- 自然語言處理功能

### 物理引擎 Canister
- 3D 物理模擬
- 碰撞檢測和響應
- 粒子系統管理

### NFT 管理 Canister
- 3D NFT 鑄造和交易
- 元數據管理和驗證
- 所有權驗證和轉移
- 核心管理員權限控制

### 玩家數據 Canister
- 用戶資料存儲
- 遊戲進度追蹤
- 成就和獎勵系統

### 能量同步 Canister
- 生態系統能量管理
- 跨模組能量同步
- 實時能量追蹤

## ICP 子網互操作性
- 支援跨子網通信
- 低延遲多人遊戲功能
- 分散式數據處理
- 高可用性架構

## 自動任務調度系統
- 使用 ICP Timers 實現定時任務
- NPC 事件自動觸發
- 隨機遊戲現象生成
- 系統維護和更新調度

## 3D 初始化優化流程
- Internet Identity 2.0 快速驗證
- Wasm 引擎增強
- 並行資源載入
- 智能預載入機制
- 流暢的載入動畫

## 跨平台響應式設計
- 桌面端：完整 3D 功能體驗
- 平板端：觸控優化界面
- 手機端：簡化 3D 操作
- 統一的用戶體驗

## 後端數據存儲
- 用戶數據：用戶資料、遊戲記錄、偏好設定、Internet Identity 2.0 資訊
- 權限管理數據：核心管理員權限記錄、介面存取控制、安全管理結構
- 模組通信數據：統一系統架構的通信記錄、即時同步數據、中央樞紐日誌
- 3D 場景數據：場景配置、物件狀態、渲染設定
- NFT 資產數據：3D NFT 元數據、驗證記錄、交易歷史
- 收益管理數據：開發者收益記錄、自動轉移日誌、NNS DApp 交易記錄
- 任務調度數據：定時任務配置、執行記錄、NPC 事件日誌
- 系統性能數據：3D 渲染性能指標、Canister 運行狀態、網路延遲統計
- Cycles 管理數據：反向燃料模型使用記錄、成本追蹤、資源分配日誌
- 統一入口數據：模組同步狀態、導航歷史、用戶偏好設定

## 業務邏輯
- 統一入口邏輯：Unified LFLC Dapp Portal 管理、模組整合協調、頂層導航控制邏輯
- 統一視覺主題邏輯：LFLCEI 幸運草宇宙統一體系樣式管理、金綠漸層身份識別、3D WebGL 佈局協調邏輯
- 統一 API 處理邏輯：useLFLCSync 和 useEcosystemHub 處理器、雙向同步管理、錯誤處理和重試邏輯
- 差異化介面邏輯：管理員頁面、統一儀表板、玩家模式的權限控制和介面切換邏輯
- 中央樞紐頁面邏輯：即時同步狀態顯示、系統健康度監控、模組狀態管理邏輯
- 統一系統架構邏輯：中央樞紐 Canister 通信管理、分散式模組協調、即時自動數據同步邏輯
- 完整 DApp 互聯邏輯：前端發送模組與後端接收模組的統一同步、跨模組通信協調、生態系統互聯邏輯
- Internet Identity 2.0 自動登入邏輯：所有用戶自動登入、核心管理員提升權限、會話管理邏輯
- 統一 DApp 錢包邏輯：收益累積、5 ICP 自動轉移規則、NNS DApp 整合邏輯
- ICP 反向燃料模型邏輯：Cycles 預付管理、用戶免費體驗、成本優化邏輯
- 3D WebGL 渲染邏輯：Unity/Unreal 相容性、物件池管理、LOD 動態載入、GPU 加速轉場邏輯
- NFT 資產管理邏輯：3D NFT 載入、驗證系統、交易介面、核心管理員完全控制權限邏輯
- Canister 模組化邏輯：AI 系統、物理引擎、NFT 管理、玩家數據、能量同步的協調邏輯
- ICP 子網互操作邏輯：跨子網通信、低延遲多人遊戲、分散式處理邏輯
- 自動任務調度邏輯：ICP Timers 管理、NPC 事件觸發、隨機現象生成邏輯
- 3D 初始化優化邏輯：登入流程、Wasm 引擎增強、資源載入優化邏輯
PK
backend/PK
backend/lib.moimport Nat8 "mo:core/Nat8";

module {
  public func nat8ToChar(n : Nat8) : Char {
    let n32 = n.toNat32();
    Char.fromNat32(n32);
  };
};
PK
backend/main.moimport OutCall "http-outcalls/outcall";
import Stripe "stripe/stripe";
import AccessControl "authorization/access-control";
import Map "mo:core/Map";
import Set "mo:core/Set";
import Int "mo:core/Int";
import Float "mo:core/Float";
import Time "mo:core/Time";
import Iter "mo:core/Iter";
import Runtime "mo:core/Runtime";
import Principal "mo:core/Principal";

actor {
  module T {
    public type RewardType = {
      #common;
      #rare;
      #epic;
      #legendary;
    };

    public type Realm = {
      id : Nat;
      name : Text;
      description : Text;
      theming : Text;
      energyType : Text;
      ambientSound : Text;
      backgroundAnimation : Text;
      entryRequirements : [Text];
      realmType : RealmType;
      realmPoints : Nat;
      reputationPoints : Nat;
      challengeScores : Nat;
    };

    public type RealmType = {
      #fairy;
      #cultivation;
      #martial;
      #buddhist;
      #heavenly;
      #demonic;
      #underworld;
      #divine;
    };

    public type Reward = {
      name : Text;
      rewardPoints : Nat;
      rewardType : RewardType;
      probability : Float;
    };

    public type RewardHistory = {
      id : Nat;
      reward : Reward;
      timestamp : Time.Time;
    };

    public type DayRecord = {
      day : Nat;
      rewardPoints : Nat;
      adMultiplier : Bool;
      timestamp : Time.Time;
    };

    public type DayCycle = [DayRecord];

    public type UserProfile = {
      name : Text;
      points : Nat;
      cycleCompletedCount : Nat;
      dayCycle : DayCycle;
      rewardHistory : [RewardHistory];
      ascensionLevel : Nat;
      ascensionProgress : Float;
      energyBalance : Nat;
      realms : [Realm];
    };

    public type FortuneMessage = {
      id : Nat;
      message : Text;
      probability : Float;
    };

    public type UserFortuneRecord = {
      userId : Principal;
      fortuneMessage : FortuneMessage;
      timestamp : Time.Time;
    };

    public type ExternalLink = {
      id : Nat;
      title : Text;
      url : Text;
      iconUrl : Text;
      adminOnly : Bool;
    };

    public type SynchronizationStatus = {
      lastSyncTimestamp : Time.Time;
      lastSyncStatus : Text;
    };

    public type SoulCollaborationSyncLog = {
      syncTime : Time.Time;
      syncStatus : Text;
      errorCode : ?Text;
      errorMessage : ?Text;
    };

    public type AscensionLevel = {
      level : Nat;
      requiredEnergy : Nat;
      rewards : [Reward];
      visualEffects : [Text];
    };

    public type AscensionRitual = {
      id : Nat;
      participants : [Principal];
      initiator : Principal;
      ritualType : Text;
      startTime : Time.Time;
      endTime : ?Time.Time;
      status : AscensionRitualStatus;
      energyContributed : Nat;
    };

    public type AscensionRitualStatus = {
      #pending;
      #active;
      #completed;
      #failed;
    };

    public type EnergyState = {
      userId : Principal;
      currentEnergy : Nat;
      maxEnergy : Nat;
      lastUpdate : Time.Time;
      energyFlowRate : Float;
    };

    public type AscensionAchievement = {
      id : Nat;
      name : Text;
      description : Text;
      achievedAt : Time.Time;
      rewardPoints : Nat;
    };

    public type SoulCollaboration = {
      lastSyncTime : Time.Time;
      lastSyncStatus : Text;
      syncLogs : [SoulCollaborationSyncLog];
    };

    public type UserSyncInterval = {
      interval : Int;
      lastUpdated : Time.Time;
    };

    public type UnifiedSyncResponse = {
      soulCollaboration : SoulCollaboration;
      subscriptionActive : Bool;
      synchronizationStatus : ?SynchronizationStatus;
      lastSyncTime : Time.Time;
    };

    public type RealmAnalysis = {
      totalPoints : Nat;
      totalReputation : Nat;
      totalChallenges : Nat;
      fairyCount : Nat;
      cultivationCount : Nat;
      martialCount : Nat;
      buddhistCount : Nat;
      heavenlyCount : Nat;
      demonicCount : Nat;
      underworldCount : Nat;
      divineCount : Nat;
      energyValue : Float;
    };

    public type OracleIntegration = {
      connectionStatus : Bool;
      lastChecked : Time.Time;
      url : Text;
      errorLog : [Text];
    };

    public type RateLimitRecord = {
      lastAccess : Time.Time;
      accessCount : Nat;
    };

    public type HourlySubscriptionStatus = {
      active : Bool;
      lastBilledTime : ?Time.Time;
      hoursBilled : Int;
      totalICPPaid : Nat;
    };

    public type HourlyBillingRecord = {
      timestamp : Time.Time;
      hoursBilled : Int;
      amountICP : Nat;
      success : Bool;
      errorMessage : ?Text;
    };

    public type NFTAsset = {
      id : Nat;
      name : Text;
      owner : Principal;
      metadata : Text;
      validationStatus : Bool;
      createdAt : Time.Time;
    };

    public type TransactionRecord = {
      id : Nat;
      from : Principal;
      to : Principal;
      amount : Nat;
      timestamp : Time.Time;
      transactionType : Text;
    };
  };

  // Core Administrator Principal ID (李奕勳 / LEE YIHSUN / Johnnylee7912)
  let CORE_ADMIN_PRINCIPAL = Principal.fromText("ssmgf-hhyda-pxtto-ozjbv-wxqbi-srswj-eabc5-2xzzf-ep6u5-psqp2-zqe");
  
  // Designated Backend Canister ID
  let DESIGNATED_CANISTER_ID = Principal.fromText("cerpu-yyaaa-aaaai-q4wuq-cai");
  
  // NNS DApp ICP Address for developer wallet
  let NNS_DAPP_ICP_ADDRESS = "98eddabcedfeb743163bf2c4c3e2f68f54c36287dc515eae95b1a8040d616188";
  let AUTO_TRANSFER_THRESHOLD_ICP = 500000000; // 5 ICP in e8s
  
  let developerICPAddress = "38614da9d6625a2c38eebb8870e842c2fecb21bdf3688bada26a01d24042e7d5";
  let subscriptionPriceICP = 100000000;
  let hourlyRateICP = 10000000;
  let allowedCountries = ["CN", "HK", "TW"];
  let rewards : [T.Reward] = [
    { name = "1000 點"; rewardPoints = 1000; rewardType = #common; probability = 0.6 },
    { name = "2000 點"; rewardPoints = 2000; rewardType = #rare; probability = 0.25 },
    { name = "5000 點"; rewardPoints = 5000; rewardType = #epic; probability = 0.14 },
    { name = "金鑽幸運草"; rewardPoints = 10000; rewardType = #legendary; probability = 0.01 },
  ];

  let dayCycles : [T.DayCycle] = [
    [
      { day = 1; rewardPoints = 3; adMultiplier = false; timestamp = 0 },
      { day = 2; rewardPoints = 5; adMultiplier = false; timestamp = 0 },
      { day = 3; rewardPoints = 7; adMultiplier = false; timestamp = 0 },
      { day = 4; rewardPoints = 9; adMultiplier = false; timestamp = 0 },
      { day = 5; rewardPoints = 10; adMultiplier = false; timestamp = 0 },
      { day = 6; rewardPoints = 15; adMultiplier = false; timestamp = 0 },
      { day = 7; rewardPoints = 20; adMultiplier = false; timestamp = 0 },
    ],
  ];

  let successfulPayments = Set.empty<Principal>();
  let failedPayments = Set.empty<Principal>();
  let userSubscriptions = Map.empty<Principal, Time.Time>();
  let userHourlySubscriptions = Map.empty<Principal, T.HourlySubscriptionStatus>();
  let hourlyBillingRecords = Map.empty<Principal, [T.HourlyBillingRecord]>();

  let STAR_REALMS : [T.Realm] = [
    {
      id = 0;
      name = "仙島";
      description = "仙境主題，飄逸靈氣，仙鶴飛舞，雲霧繚繞的3D環境";
      theming = "fairy";
      energyType = "仙靈氣";
      ambientSound = "/assets/sounds/fairy.mp3";
      backgroundAnimation = "/assets/animations/fairy.json";
      entryRequirements = [];
      realmType = #fairy;
      realmPoints = 0;
      reputationPoints = 0;
      challengeScores = 0;
    },
    {
      id = 1;
      name = "修真聖地";
      description = "修煉主題，靈力修煉，丹藥煉製系統";
      theming = "cultivation";
      energyType = "修煉靈力";
      ambientSound = "/assets/sounds/cultivation.mp3";
      backgroundAnimation = "/assets/animations/cultivation.json";
      entryRequirements = ["初生"];
      realmType = #cultivation;
      realmPoints = 0;
      reputationPoints = 0;
      challengeScores = 0;
    },
    {
      id = 2;
      name = "武道聖地";
      description = "武術主題，武功修煉，內力提升系統";
      theming = "martial";
      energyType = "武道能量";
      ambientSound = "/assets/sounds/martial.mp3";
      backgroundAnimation = "/assets/animations/martial.json";
      entryRequirements = ["初生"];
      realmType = #martial;
      realmPoints = 0;
      reputationPoints = 0;
      challengeScores = 0;
    },
    {
      id = 3;
      name = "佛國";
      description = "佛教主題，禪修靜心，蓮花綻放的寧靜空間";
      theming = "buddhist";
      energyType = "佛法能量";
      ambientSound = "/assets/sounds/buddhist.mp3";
      backgroundAnimation = "/assets/animations/buddhist.json";
      entryRequirements = ["初生"];
      realmType = #buddhist;
      realmPoints = 0;
      reputationPoints = 0;
      challengeScores = 0;
    },
    {
      id = 4;
      name = "天堂";
      description = "神聖主題，聖光環繞，天使翅膀元素";
      theming = "heavenly";
      energyType = "聖潔能量";
      ambientSound = "/assets/sounds/heavenly.mp3";
      backgroundAnimation = "/assets/animations/heavenly.json";
      entryRequirements = ["初生"];
      realmType = #heavenly;
      realmPoints = 0;
      reputationPoints = 0;
      challengeScores = 0;
    },
    {
      id = 5;
      name = "地獄";
      description = "暗黑主題，烈火燃燒，紅色火焰粒子效果";
      theming = "demonic";
      energyType = "黑暗能量";
      ambientSound = "/assets/sounds/demonic.mp3";
      backgroundAnimation = "/assets/animations/demonic.json";
      entryRequirements = ["初生"];
      realmType = #demonic;
      realmPoints = 0;
      reputationPoints = 0;
      challengeScores = 0;
    },
    {
      id = 6;
      name = "地府";
      description = "陰間主題，幽冥氣息，青綠色靈魂光芒";
      theming = "underworld";
      energyType = "陰間能量";
      ambientSound = "/assets/sounds/underworld.mp3";
      backgroundAnimation = "/assets/animations/underworld.json";
      entryRequirements = ["初生"];
      realmType = #underworld;
      realmPoints = 0;
      reputationPoints = 0;
      challengeScores = 0;
    },
    {
      id = 7;
      name = "神殿";
      description = "神話主題，古典建築，金色神聖粒子";
      theming = "divine";
      energyType = "神力能量";
      ambientSound = "/assets/sounds/divine.mp3";
      backgroundAnimation = "/assets/animations/divine.json";
      entryRequirements = ["初生"];
      realmType = #divine;
      realmPoints = 0;
      reputationPoints = 0;
      challengeScores = 0;
    },
  ];

  let accessControlState = AccessControl.initState();
  let userProfiles = Map.empty<Principal, T.UserProfile>();
  let userSyncIntervals = Map.empty<Principal, T.UserSyncInterval>();
  let profileInitialized = Set.empty<Principal>();
  var lastRewardTimestamp : Time.Time = 0;
  var rewardIdCounter = 0;

  var fortuneMessages : [T.FortuneMessage] = [
    { id = 0; message = "今日大吉，萬事如意！"; probability = 0.5 },
    { id = 1; message = "努力不懈，必有收穫"; probability = 0.3 },
    { id = 2; message = "保持善良，幸運常在"; probability = 0.15 },
    { id = 3; message = "勇敢面對挑戰"; probability = 0.04 },
    { id = 4; message = "耐心等候，佳音自來"; probability = 0.01 },
  ];

  let usedFortunesCurrentDay = Map.empty<Principal, T.UserFortuneRecord>();
  let rateLimits = Map.empty<Principal, T.RateLimitRecord>();

  // NFT Asset Management (Core Admin Only)
  let nftAssets = Map.empty<Nat, T.NFTAsset>();
  var nftIdCounter : Nat = 0;
  
  // Transaction Records (Core Admin Only)
  let transactionRecords = Map.empty<Nat, T.TransactionRecord>();
  var transactionIdCounter : Nat = 0;
  
  // Developer Wallet Balance Tracking
  var developerWalletBalance : Nat = 0;

  func initializeUserRealms() : [T.Realm] {
    STAR_REALMS;
  };

  let externalLinks : [T.ExternalLink] = [
    {
      id = 0;
      title = "LFLC Integration Platform Dashboard";
      url = "https://integration-platform.caffeine.xyz/";
      iconUrl = "/assets/icons/dashboard.png";
      adminOnly = false;
    },
    {
      id = 1;
      title = "LFLC Clicker Games";
      url = "https://clicker-games.caffeine.xyz/";
      iconUrl = "/assets/icons/games.png";
      adminOnly = false;
    },
    {
      id = 2;
      title = "LFLC Wallet";
      url = "https://lflc-wallet-mm9.caffeine.xyz/";
      iconUrl = "/assets/icons/wallet.png";
      adminOnly = false;
    },
    {
      id = 3;
      title = "LFLC Advisory Portal";
      url = "https://advisory-teal-yiq-draft.caffeine.xyz/";
      iconUrl = "/assets/icons/advisory.png";
      adminOnly = false;
    },
    {
      id = 4;
      title = "LFLC Database";
      url = "https://database.caffeine.xyz/";
      iconUrl = "/assets/icons/database.png";
      adminOnly = true;
    },
    {
      id = 5;
      title = "LFLC Firewall Management";
      url = "https://firewall.caffeine.xyz/";
      iconUrl = "/assets/icons/firewall.png";
      adminOnly = true;
    },
    {
      id = 6;
      title = "LFLC AI Control Room";
      url = "https://ai-control.caffeine.xyz/";
      iconUrl = "/assets/icons/ai.png";
      adminOnly = true;
    },
    {
      id = 7;
      title = "LFLC Network Nervous System（中樞神經元）";
      url = "https://lflc-network-nervous-system-dqx.caffeine.xyz/";
      iconUrl = "/assets/icons/network_nervous_system.png";
      adminOnly = true;
    },
    {
      id = 8;
      title = "LFLCEI 仿生幸運籤";
      url = "https://lflc-natural-intelligence-spd.caffeine.xyz/";
      iconUrl = "/assets/icons/clover.png";
      adminOnly = false;
    },
    {
      id = 9;
      title = "Oracle 平台";
      url = "https://lflc-oracle-4bu.caffeine.xyz";
      iconUrl = "/assets/icons/oracle-button-transparent.png";
      adminOnly = false;
    },
  ];

  var ascensionLevels : [T.AscensionLevel] = [
    { level = 1; requiredEnergy = 1000; rewards = []; visualEffects = ["能量螺旋"] },
    { level = 2; requiredEnergy = 2500; rewards = []; visualEffects = ["光之門戶"] },
    { level = 3; requiredEnergy = 5000; rewards = []; visualEffects = ["靈魂共鳴波"] },
    { level = 4; requiredEnergy = 10000; rewards = []; visualEffects = ["能量爆發"] },
    { level = 5; requiredEnergy = 20000; rewards = []; visualEffects = ["力量漩渦"] },
  ];

  let ascensionRituals = Map.empty<Nat, T.AscensionRitual>();
  var ritualIdCounter : Nat = 0;
  let energyStates = Map.empty<Principal, T.EnergyState>();
  let ascensionAchievements = Map.empty<Principal, [T.AscensionAchievement]>();
  var achievementIdCounter : Nat = 0;
  let stripeSessionOwners = Map.empty<Text, Principal>();

  // Authorization Helper Functions
  func isCoreAdmin(caller : Principal) : Bool {
    caller == CORE_ADMIN_PRINCIPAL
  };

  func requireCoreAdmin(caller : Principal) {
    if (not isCoreAdmin(caller)) {
      Runtime.trap("Unauthorized: Core administrator access required (李奕勳 only)");
    };
  };

  func requireAdminOrCoreAdmin(caller : Principal) {
    if (not (AccessControl.hasPermission(accessControlState, caller, #admin) or isCoreAdmin(caller))) {
      Runtime.trap("Unauthorized: Administrator or core administrator access required");
    };
  };

  func requireUser(caller : Principal) {
    if (not (AccessControl.hasPermission(accessControlState, caller, #user))) {
      Runtime.trap("Unauthorized: Only users can perform this action");
    };
  };

  func checkRateLimit(caller : Principal, maxRequests : Nat, windowNanos : Int) : Bool {
    let now = Time.now();
    switch (rateLimits.get(caller)) {
      case (?record) {
        if (now - record.lastAccess < windowNanos) {
          if (record.accessCount >= maxRequests) {
            return false;
          };
          rateLimits.add(caller, {
            lastAccess = record.lastAccess;
            accessCount = record.accessCount + 1;
          });
        } else {
          rateLimits.add(caller, {
            lastAccess = now;
            accessCount = 1;
          });
        };
      };
      case (null) {
        rateLimits.add(caller, {
          lastAccess = now;
          accessCount = 1;
        });
      };
    };
    true;
  };

  public shared ({ caller }) func initializeAccessControl() : async () {
    AccessControl.initialize(accessControlState, caller);
    
    // Automatically assign core admin role to the designated principal
    if (caller == CORE_ADMIN_PRINCIPAL) {
      AccessControl.assignRole(accessControlState, caller, CORE_ADMIN_PRINCIPAL, #admin);
    };
  };

  public query ({ caller }) func getCallerUserRole() : async AccessControl.UserRole {
    AccessControl.getUserRole(accessControlState, caller);
  };

  public shared ({ caller }) func assignCallerUserRole(user : Principal, role : AccessControl.UserRole) : async () {
    AccessControl.assignRole(accessControlState, caller, user, role);
  };

  public shared ({ caller }) func addAdminUser(newAdmin : Principal) : async () {
    requireAdminOrCoreAdmin(caller);
    AccessControl.assignRole(accessControlState, caller, newAdmin, #admin);
  };

  public query ({ caller }) func isCallerAdmin() : async Bool {
    AccessControl.isAdmin(accessControlState, caller) or isCoreAdmin(caller);
  };

  public query ({ caller }) func isCallerCoreAdmin() : async Bool {
    isCoreAdmin(caller);
  };

  // 3D NFT Asset Management Functions (Core Admin Only)
  public shared ({ caller }) func loadNFTAsset(name : Text, metadata : Text) : async Nat {
    requireCoreAdmin(caller);
    
    if (not checkRateLimit(caller, 50, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many NFT operations");
    };
    
    if (name.size() == 0 or name.size() > 200) {
      Runtime.trap("Invalid NFT name length");
    };
    
    if (metadata.size() > 10000) {
      Runtime.trap("NFT metadata too large");
    };
    
    let nftId = nftIdCounter;
    nftIdCounter += 1;
    
    let nftAsset : T.NFTAsset = {
      id = nftId;
      name;
      owner = caller;
      metadata;
      validationStatus = false;
      createdAt = Time.now();
    };
    
    nftAssets.add(nftId, nftAsset);
    nftId;
  };

  public shared ({ caller }) func validateNFTAsset(nftId : Nat) : async () {
    requireCoreAdmin(caller);
    
    if (not checkRateLimit(caller, 100, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many validation operations");
    };
    
    switch (nftAssets.get(nftId)) {
      case (?asset) {
        let validatedAsset = {
          asset with
          validationStatus = true;
        };
        nftAssets.add(nftId, validatedAsset);
      };
      case (null) {
        Runtime.trap("NFT asset not found");
      };
    };
  };

  public query ({ caller }) func getNFTAsset(nftId : Nat) : async ?T.NFTAsset {
    requireUser(caller);
    nftAssets.get(nftId);
  };

  public query ({ caller }) func getAllNFTAssets() : async [(Nat, T.NFTAsset)] {
    requireCoreAdmin(caller);
    nftAssets.toArray();
  };

  public shared ({ caller }) func transferNFTAsset(nftId : Nat, newOwner : Principal) : async () {
    requireCoreAdmin(caller);
    
    if (not checkRateLimit(caller, 50, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many transfer operations");
    };
    
    switch (nftAssets.get(nftId)) {
      case (?asset) {
        let transferredAsset = {
          asset with
          owner = newOwner;
        };
        nftAssets.add(nftId, transferredAsset);
        
        // Record transaction
        let txId = transactionIdCounter;
        transactionIdCounter += 1;
        
        let txRecord : T.TransactionRecord = {
          id = txId;
          from = asset.owner;
          to = newOwner;
          amount = 0;
          timestamp = Time.now();
          transactionType = "NFT_TRANSFER";
        };
        
        transactionRecords.add(txId, txRecord);
      };
      case (null) {
        Runtime.trap("NFT asset not found");
      };
    };
  };

  // Transaction Interface Management (Core Admin Only)
  public shared ({ caller }) func recordTransaction(from : Principal, to : Principal, amount : Nat, txType : Text) : async Nat {
    requireCoreAdmin(caller);
    
    if (not checkRateLimit(caller, 100, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many transaction records");
    };
    
    if (amount > 1000000000000) {
      Runtime.trap("Transaction amount exceeds reasonable limit");
    };
    
    if (txType.size() > 100) {
      Runtime.trap("Transaction type description too long");
    };
    
    let txId = transactionIdCounter;
    transactionIdCounter += 1;
    
    let txRecord : T.TransactionRecord = {
      id = txId;
      from;
      to;
      amount;
      timestamp = Time.now();
      transactionType = txType;
    };
    
    transactionRecords.add(txId, txRecord);
    
    // Update developer wallet balance if applicable
    if (to == CORE_ADMIN_PRINCIPAL) {
      developerWalletBalance += amount;
      
      // Check if auto-transfer threshold reached
      if (developerWalletBalance >= AUTO_TRANSFER_THRESHOLD_ICP) {
        // In production, this would trigger actual ICP transfer to NNS DApp
        // For now, we just log it
        developerWalletBalance := 0;
      };
    };
    
    txId;
  };

  public query ({ caller }) func getTransaction(txId : Nat) : async ?T.TransactionRecord {
    requireCoreAdmin(caller);
    transactionRecords.get(txId);
  };

  public query ({ caller }) func getAllTransactions() : async [(Nat, T.TransactionRecord)] {
    requireCoreAdmin(caller);
    transactionRecords.toArray();
  };

  public query ({ caller }) func getDeveloperWalletBalance() : async Nat {
    requireCoreAdmin(caller);
    developerWalletBalance;
  };

  public query ({ caller }) func getNNSDAppAddress() : async Text {
    requireCoreAdmin(caller);
    NNS_DAPP_ICP_ADDRESS;
  };

  // Player Interface Functions (Standard Users)
  public query ({ caller }) func getAllStarRealms() : async [T.Realm] {
    requireUser(caller);
    STAR_REALMS;
  };

  public query ({ caller }) func getRealmById(realmId : Nat) : async ?T.Realm {
    requireUser(caller);

    if (realmId >= STAR_REALMS.size()) {
      return null;
    };

    STAR_REALMS.values().find(func(realm) { realm.id == realmId });
  };

  public query ({ caller }) func getUserRealms(user : Principal) : async [T.Realm] {
    requireUser(caller);

    if (caller != user and not (AccessControl.hasPermission(accessControlState, caller, #admin) or isCoreAdmin(caller))) {
      Runtime.trap("Unauthorized: Can only view your own realms");
    };

    switch (userProfiles.get(user)) {
      case (?profile) { profile.realms };
      case (null) { [] };
    };
  };

  public shared ({ caller }) func updateUserRealmStats(realmId : Nat, points : Nat, reputation : Nat, challenges : Nat) : async () {
    requireUser(caller);

    if (not profileInitialized.contains(caller)) {
      Runtime.trap("Profile must be initialized first");
    };

    if (not checkRateLimit(caller, 100, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many requests");
    };

    if (realmId >= STAR_REALMS.size()) {
      Runtime.trap("Invalid realm ID");
    };

    if (points > 1000000 or reputation > 1000000 or challenges > 1000000) {
      Runtime.trap("Stat values exceed reasonable limits");
    };

    switch (userProfiles.get(caller)) {
      case (?profile) {
        let realmExists = profile.realms.values().find(func(r) { r.id == realmId });
        switch (realmExists) {
          case (null) {
            Runtime.trap("Realm not found in user profile");
          };
          case (?existingRealm) {
            if (existingRealm.id != realmId) {
              Runtime.trap("Realm ID mismatch - unauthorized modification attempt");
            };

            if (points < existingRealm.realmPoints) {
              Runtime.trap("Cannot decrease realm points - invalid state transition");
            };

            if (reputation < existingRealm.reputationPoints) {
              Runtime.trap("Cannot decrease reputation points - invalid state transition");
            };

            if (challenges < existingRealm.challengeScores) {
              Runtime.trap("Cannot decrease challenge scores - invalid state transition");
            };

            let pointsIncrease = points - existingRealm.realmPoints;
            let reputationIncrease = reputation - existingRealm.reputationPoints;
            let challengesIncrease = challenges - existingRealm.challengeScores;

            if (pointsIncrease > 10000 or reputationIncrease > 10000 or challengesIncrease > 10000) {
              Runtime.trap("Stat increase too large - possible manipulation detected");
            };

            let updatedRealms = profile.realms.map(
              func(realm) {
                if (realm.id == realmId) {
                  {
                    realm with
                    realmPoints = points;
                    reputationPoints = reputation;
                    challengeScores = challenges;
                  };
                } else {
                  realm;
                };
              }
            );
            userProfiles.add(caller, { profile with realms = updatedRealms });
          };
        };
      };
      case (null) {
        Runtime.trap("Profile not found - initialize profile first");
      };
    };
  };

  public shared ({ caller }) func completeProfileInitialization(profile : T.UserProfile) : async () {
    requireUser(caller);

    if (profileInitialized.contains(caller)) {
      Runtime.trap("Profile already initialized");
    };

    if (profile.name == "" or profile.name.size() > 100) {
      Runtime.trap("Profile name must be between 1 and 100 characters");
    };

    let nameChars = profile.name.chars();
    for (char in nameChars) {
      let charCode = char.toNat32();
      if (charCode < 32 or (charCode > 126 and charCode < 160)) {
        Runtime.trap("Profile name contains invalid characters");
      };
    };

    let validatedProfile : T.UserProfile = {
      name = profile.name;
      points = 0;
      cycleCompletedCount = 0;
      dayCycle = dayCycles[0];
      rewardHistory = [];
      ascensionLevel = 0;
      ascensionProgress = 0.0;
      energyBalance = 0;
      realms = initializeUserRealms();
    };

    userProfiles.add(caller, validatedProfile);
    userSyncIntervals.add(caller, { interval = 60 * 60 * 1000000000; lastUpdated = Time.now() });
    profileInitialized.add(caller);
  };

  public shared ({ caller }) func saveCallerUserProfile(profile : T.UserProfile) : async () {
    requireUser(caller);

    if (not profileInitialized.contains(caller)) {
      Runtime.trap("Profile must be initialized first");
    };

    if (profile.name == "" or profile.name.size() > 100) {
      Runtime.trap("Invalid profile name");
    };

    if (profile.points > 100000000) {
      Runtime.trap("Points value exceeds reasonable limit");
    };

    if (profile.ascensionLevel > ascensionLevels.size()) {
      Runtime.trap("Invalid ascension level");
    };

    if (profile.energyBalance > 10000000) {
      Runtime.trap("Energy balance exceeds reasonable limit");
    };

    if (profile.realms.size() != STAR_REALMS.size()) {
      Runtime.trap("Invalid realms configuration");
    };

    for (realm in profile.realms.values()) {
      if (realm.realmPoints > 1000000 or realm.reputationPoints > 1000000 or realm.challengeScores > 1000000) {
        Runtime.trap("Realm stat values exceed reasonable limits");
      };
    };

    switch (userProfiles.get(caller)) {
      case (?existingProfile) {
        if (profile.points < existingProfile.points) {
          Runtime.trap("Cannot decrease total points - invalid state transition");
        };

        if (profile.cycleCompletedCount < existingProfile.cycleCompletedCount) {
          Runtime.trap("Cannot decrease cycle count - invalid state transition");
        };

        if (profile.ascensionLevel < existingProfile.ascensionLevel) {
          Runtime.trap("Cannot decrease ascension level - invalid state transition");
        };

        if (profile.energyBalance < existingProfile.energyBalance and (existingProfile.energyBalance - profile.energyBalance) > 100000) {
          Runtime.trap("Energy balance decrease too large - possible manipulation");
        };
      };
      case (null) {
        Runtime.trap("Profile not found - cannot save without initialization");
      };
    };

    userProfiles.add(caller, profile);
  };

  public query ({ caller }) func getCallerUserProfile() : async ?T.UserProfile {
    requireUser(caller);
    userProfiles.get(caller);
  };

  public query ({ caller }) func getUserProfile(user : Principal) : async ?T.UserProfile {
    requireUser(caller);

    if (caller != user and not (AccessControl.hasPermission(accessControlState, caller, #admin) or isCoreAdmin(caller))) {
      Runtime.trap("Unauthorized: Can only view your own profile");
    };
    userProfiles.get(user);
  };

  public shared ({ caller }) func drawDailyFortune() : async T.FortuneMessage {
    requireUser(caller);

    if (not profileInitialized.contains(caller)) {
      Runtime.trap("Profile must be initialized first");
    };

    if (not checkRateLimit(caller, 10, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many fortune draws");
    };

    switch (usedFortunesCurrentDay.get(caller)) {
      case (?record) {
        if (Time.now() - record.timestamp <= 24 * 60 * 60 * 1000000000) {
          return record.fortuneMessage;
        };
      };
      case (null) {};
    };

    let currentTime = Time.now();
    let randomNum = (Int.abs(currentTime) % 10000) % 100;

    let selectedFortune = switch (fortuneMessages.find(
      func(fm) {
        let threshold = (fm.probability * 100.0).toInt();
        threshold >= randomNum;
      }
    )) {
      case (?fm) { fm };
      case (null) { fortuneMessages[0] };
    };

    let fortuneRecord : T.UserFortuneRecord = {
      userId = caller;
      fortuneMessage = selectedFortune;
      timestamp = currentTime;
    };

    usedFortunesCurrentDay.add(caller, fortuneRecord);

    selectedFortune;
  };

  public shared ({ caller }) func resetDailyFortunes() : async () {
    requireAdminOrCoreAdmin(caller);

    if (not checkRateLimit(caller, 10, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many admin operations");
    };

    let remainingRecords = usedFortunesCurrentDay.filter(
      func(_, record) {
        Time.now() - record.timestamp <= 24 * 60 * 60 * 1000000000
      }
    );
    usedFortunesCurrentDay.clear();
    remainingRecords.forEach(
      func(userId, record) {
        usedFortunesCurrentDay.add(userId, record);
      }
    );
  };

  public query ({ caller }) func hasUserDrawnFortune() : async Bool {
    requireUser(caller);

    switch (usedFortunesCurrentDay.get(caller)) {
      case (?record) {
        Time.now() - record.timestamp <= 24 * 60 * 60 * 1000000000;
      };
      case (null) { false };
    };
  };

  public query ({ caller }) func getUserFortuneRecord() : async ?T.UserFortuneRecord {
    requireUser(caller);
    usedFortunesCurrentDay.get(caller);
  };

  public query ({ caller }) func getExternalLinks() : async [T.ExternalLink] {
    requireUser(caller);

    if (AccessControl.hasPermission(accessControlState, caller, #admin) or isCoreAdmin(caller)) {
      externalLinks;
    } else {
      externalLinks.filter(
        func(link) { not link.adminOnly }
      );
    };
  };

  public query ({ caller }) func getExternalLink(id : Nat) : async ?T.ExternalLink {
    requireUser(caller);

    let link = externalLinks.values().find(func(link) { link.id == id });
    switch (link) {
      case (?l) {
        if (l.adminOnly and not (AccessControl.hasPermission(accessControlState, caller, #admin) or isCoreAdmin(caller))) {
          null;
        } else {
          ?l;
        };
      };
      case (null) { null };
    };
  };

  type AdvisoryPortalStatus = {
    lastAccessed : Time.Time;
    accessCount : Nat;
  };

  let advisoryPortalStatus = Map.empty<Principal, AdvisoryPortalStatus>();

  var soulCollaboration : T.SoulCollaboration = {
    lastSyncTime = 0 : Time.Time;
    lastSyncStatus = "尚未同步";
    syncLogs = [
      { syncTime = 0; syncStatus = "初始化"; errorCode = null; errorMessage = null }
    ];
  };
  let synchronizationStatus = Map.empty<Principal, T.SynchronizationStatus>();

  public query ({ caller }) func getSoulCollaborationSyncStatus() : async T.SoulCollaboration {
    requireUser(caller);
    soulCollaboration;
  };

  public shared ({ caller }) func updateSoulCollaborationSync(status : Text, errorCode : ?Text, errorMessage : ?Text) : async () {
    requireUser(caller);

    if (not profileInitialized.contains(caller)) {
      Runtime.trap("Profile must be initialized first");
    };

    if (not checkRateLimit(caller, 60, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many sync updates");
    };

    if (status.size() > 200) {
      Runtime.trap("Status message too long");
    };

    switch (errorCode) {
      case (?code) {
        if (code.size() > 50) {
          Runtime.trap("Error code too long");
        };
      };
      case (null) {};
    };

    switch (errorMessage) {
      case (?msg) {
        if (msg.size() > 500) {
          Runtime.trap("Error message too long");
        };
      };
      case (null) {};
    };

    let currentTime = Time.now();
    let newLog : T.SoulCollaborationSyncLog = {
      syncTime = currentTime;
      syncStatus = status;
      errorCode;
      errorMessage;
    };

    let updatedLogs = soulCollaboration.syncLogs.concat([newLog]);
    soulCollaboration := {
      lastSyncTime = currentTime;
      lastSyncStatus = status;
      syncLogs = updatedLogs;
    };

    synchronizationStatus.add(caller, {
      lastSyncTimestamp = currentTime;
      lastSyncStatus = status;
    });
  };

  public query ({ caller }) func getUserSynchronizationStatus() : async ?T.SynchronizationStatus {
    requireUser(caller);
    synchronizationStatus.get(caller);
  };

  public query ({ caller }) func getAscensionLevels() : async [T.AscensionLevel] {
    requireUser(caller);
    ascensionLevels;
  };

  public query ({ caller }) func getCallerEnergyState() : async ?T.EnergyState {
    requireUser(caller);
    energyStates.get(caller);
  };

  public shared ({ caller }) func updateCallerEnergyState(currentEnergy : Nat, maxEnergy : Nat, energyFlowRate : Float) : async () {
    requireUser(caller);

    if (not profileInitialized.contains(caller)) {
      Runtime.trap("Profile must be initialized first");
    };

    if (not checkRateLimit(caller, 100, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many energy updates");
    };

    if (currentEnergy > maxEnergy) {
      Runtime.trap("Current energy cannot exceed max energy");
    };

    if (maxEnergy > 1000000) {
      Runtime.trap("Max energy exceeds reasonable limit");
    };

    if (energyFlowRate < 0.0 or energyFlowRate > 1000.0) {
      Runtime.trap("Energy flow rate out of valid range");
    };

    switch (energyStates.get(caller)) {
      case (?existingState) {
        let timeDiff = Time.now() - existingState.lastUpdate;
        if (timeDiff < 1_000_000_000) {
          Runtime.trap("Energy updates too frequent - minimum 1 second interval required");
        };

        if (currentEnergy > existingState.currentEnergy) {
          let energyIncrease = currentEnergy - existingState.currentEnergy;
          let maxAllowedIncrease = (energyFlowRate * (timeDiff.toFloat() / 1_000_000_000.0)).toInt().toNat();
          if (energyIncrease > maxAllowedIncrease + 100) {
            Runtime.trap("Energy increase exceeds flow rate - possible manipulation");
          };
        };
      };
      case (null) {};
    };

    let energyState : T.EnergyState = {
      userId = caller;
      currentEnergy;
      maxEnergy;
      lastUpdate = Time.now();
      energyFlowRate;
    };

    energyStates.add(caller, energyState);
  };

  var stripeConfiguration : ?Stripe.StripeConfiguration = null;

  public query ({ caller }) func isStripeConfigured() : async Bool {
    requireUser(caller);
    stripeConfiguration != null;
  };

  public shared ({ caller }) func setStripeConfiguration(config : Stripe.StripeConfiguration) : async () {
    requireAdminOrCoreAdmin(caller);

    if (not checkRateLimit(caller, 5, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many configuration changes");
    };

    stripeConfiguration := ?config;
  };

  func getStripeConfiguration() : Stripe.StripeConfiguration {
    switch (stripeConfiguration) {
      case (null) { Runtime.trap("Stripe needs to be first configured") };
      case (?value) { value };
    };
  };

  public query ({ caller }) func transform(input : OutCall.TransformationInput) : async OutCall.TransformationOutput {
    // Transform function can be called by anyone including the IC system
    OutCall.transform(input);
  };

  public shared ({ caller }) func getStripeSessionStatus(sessionId : Text) : async Stripe.StripeSessionStatus {
    requireUser(caller);

    if (sessionId.size() > 200) {
      Runtime.trap("Invalid session ID");
    };

    switch (stripeSessionOwners.get(sessionId)) {
      case (?owner) {
        if (owner != caller and not (AccessControl.hasPermission(accessControlState, caller, #admin) or isCoreAdmin(caller))) {
          Runtime.trap("Unauthorized: Can only check your own session status");
        };
      };
      case (null) {
        Runtime.trap("Session not found or unauthorized");
      };
    };

    if (not checkRateLimit(caller, 20, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many session status checks");
    };

    await Stripe.getSessionStatus(getStripeConfiguration(), sessionId, transform);
  };

  public shared ({ caller }) func createCheckoutSession(items : [Stripe.ShoppingItem], successUrl : Text, cancelUrl : Text) : async Text {
    requireUser(caller);

    if (not profileInitialized.contains(caller)) {
      Runtime.trap("Profile must be initialized first");
    };

    if (not checkRateLimit(caller, 10, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many checkout session requests");
    };

    if (items.size() == 0 or items.size() > 100) {
      Runtime.trap("Invalid number of items");
    };

    if (successUrl.size() > 2000 or cancelUrl.size() > 2000) {
      Runtime.trap("URL too long");
    };

    let sessionId = await Stripe.createCheckoutSession(getStripeConfiguration(), caller, items, successUrl, cancelUrl, transform);

    stripeSessionOwners.add(sessionId, caller);

    sessionId;
  };

  let realmValues = Map.fromArray<Nat, Float>([
    (0, 10.0),
    (1, 15.0),
    (2, 12.0),
    (3, 14.0),
    (4, 18.0),
    (5, 8.0),
    (6, 6.0),
    (7, 20.0),
  ]);

  public shared ({ caller }) func unifiedSyncFunction() : async T.UnifiedSyncResponse {
    requireUser(caller);

    if (not profileInitialized.contains(caller)) {
      Runtime.trap("Profile must be initialized first");
    };

    if (not checkRateLimit(caller, 120, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many sync requests");
    };

    let now = Time.now();
    let subscriptionActive = switch (userSubscriptions.get(caller)) {
      case (?lastPayment) { lastPayment + subscriptionPeriod > now };
      case (null) { false };
    };

    {
      soulCollaboration;
      subscriptionActive;
      synchronizationStatus = synchronizationStatus.get(caller);
      lastSyncTime = now;
    };
  };

  public query ({ caller }) func getRealmAnalysis() : async ?T.RealmAnalysis {
    requireUser(caller);

    if (not profileInitialized.contains(caller)) {
      return null;
    };

    switch (userProfiles.get(caller)) {
      case (?profile) {
        let userRealms = profile.realms;
        let totalPoints = userRealms.values().foldLeft(0, func(acc, realm) { acc + realm.realmPoints });
        let totalReputation = userRealms.values().foldLeft(0, func(acc, realm) { acc + realm.realmPoints });
        let totalChallenges = userRealms.values().foldLeft(0, func(acc, realm) { acc + realm.challengeScores });

        let fairyCount = userRealms.values().filter(func(realm) { realm.realmType == #fairy }).size();
        let cultivationCount = userRealms.values().filter(func(realm) { realm.realmType == #cultivation }).size();
        let martialCount = userRealms.values().filter(func(realm) { realm.realmType == #martial }).size();
        let buddhistCount = userRealms.values().filter(func(realm) { realm.realmType == #buddhist }).size();
        let heavenlyCount = userRealms.values().filter(func(realm) { realm.realmType == #heavenly }).size();
        let demonicCount = userRealms.values().filter(func(realm) { realm.realmType == #demonic }).size();
        let underworldCount = userRealms.values().filter(func(realm) { realm.realmType == #underworld }).size();
        let divineCount = userRealms.values().filter(func(realm) { realm.realmType == #divine }).size();

        let energyValue = totalPoints.toFloat() * 1.5 + totalReputation.toFloat() * 2.0 + totalChallenges.toFloat() * 1.8;

        ?{
          totalPoints;
          totalReputation;
          totalChallenges;
          fairyCount;
          cultivationCount;
          martialCount;
          buddhistCount;
          heavenlyCount;
          demonicCount;
          underworldCount;
          divineCount;
          energyValue;
        };
      };
      case (null) { null };
    };
  };

  public query ({ caller }) func getRealmAnalysisPublic() : async ?T.RealmAnalysis {
    // Public data - no authorization required, but still check for valid user
    requireUser(caller);

    let totalPoints = STAR_REALMS.values().foldLeft(0, func(acc, realm) { acc + realm.realmPoints });
    let totalReputation = STAR_REALMS.values().foldLeft(0, func(acc, realm) { acc + realm.realmPoints });
    let totalChallenges = STAR_REALMS.values().foldLeft(0, func(acc, realm) { acc + realm.challengeScores });

    let fairyCount = STAR_REALMS.values().filter(func(realm) { realm.realmType == #fairy }).size();
    let cultivationCount = STAR_REALMS.values().filter(func(realm) { realm.realmType == #cultivation }).size();
    let martialCount = STAR_REALMS.values().filter(func(realm) { realm.realmType == #martial }).size();
    let buddhistCount = STAR_REALMS.values().filter(func(realm) { realm.realmType == #buddhist }).size();
    let heavenlyCount = STAR_REALMS.values().filter(func(realm) { realm.realmType == #heavenly }).size();
    let demonicCount = STAR_REALMS.values().filter(func(realm) { realm.realmType == #demonic }).size();
    let underworldCount = STAR_REALMS.values().filter(func(realm) { realm.realmType == #underworld }).size();
    let divineCount = STAR_REALMS.values().filter(func(realm) { realm.realmType == #divine }).size();

    let energyValue = totalPoints.toFloat() * 1.5 + totalReputation.toFloat() * 2.0 + totalChallenges.toFloat() * 1.8;

    ?{
      totalPoints;
      totalReputation;
      totalChallenges;
      fairyCount;
      cultivationCount;
      martialCount;
      buddhistCount;
      heavenlyCount;
      demonicCount;
      underworldCount;
      divineCount;
      energyValue;
    };
  };

  public shared ({ caller }) func analyzeEnergyStates() : async { totalUsers : Nat; totalEnergy : Float; averageEnergy : Float } {
    requireAdminOrCoreAdmin(caller);

    if (not checkRateLimit(caller, 20, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many admin operations");
    };

    let userCount = energyStates.size();
    if (userCount == 0) {
      return {
        totalUsers = 0;
        totalEnergy = 0.0;
        averageEnergy = 0.0;
      };
    };

    var totalEnergy : Float = 0.0;
    energyStates.forEach(
      func(_, energyState) {
        totalEnergy += energyState.currentEnergy.toFloat();
      }
    );

    {
      totalUsers = userCount;
      totalEnergy;
      averageEnergy = totalEnergy / userCount.toFloat();
    };
  };

  public shared ({ caller }) func setUserSyncInterval(interval : Int) : async () {
    requireUser(caller);

    if (not profileInitialized.contains(caller)) {
      Runtime.trap("Profile must be initialized first");
    };

    if (interval < 60000000000 or interval > 86400000000000) {
      Runtime.trap("Invalid interval: must be between 1 minute and 24 hours");
    };

    if (not checkRateLimit(caller, 30, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many interval updates");
    };

    let currentTime = Time.now();
    userSyncIntervals.add(caller, {
      interval;
      lastUpdated = currentTime;
    });
  };

  public query ({ caller }) func getUserSyncInterval() : async Int {
    requireUser(caller);

    switch (userSyncIntervals.get(caller)) {
      case (?interval) {
        interval.interval;
      };
      case (null) { 3600000000000 };
    };
  };

  let subscriptionPeriod = 30 * 24 * 60 * 60 * 1000000000;

  public query ({ caller }) func isCallerSubscribed() : async Bool {
    requireUser(caller);

    let now = Time.now();
    switch (userSubscriptions.get(caller)) {
      case (?lastPayment) {
        if (lastPayment + subscriptionPeriod > now) { return true };
      };
      case (null) {};
    };
    false;
  };

  public query ({ caller }) func getUserSubscriptionStatus(user : Principal) : async Bool {
    requireUser(caller);

    if (caller != user and not (AccessControl.hasPermission(accessControlState, caller, #admin) or isCoreAdmin(caller))) {
      Runtime.trap("Unauthorized: Can only check your own subscription status");
    };

    let now = Time.now();
    switch (userSubscriptions.get(user)) {
      case (?lastPayment) {
        if (lastPayment + subscriptionPeriod > now) { return true };
      };
      case (null) {};
    };
    false;
  };

  public shared ({ caller }) func verifyAndActivateSubscription(sessionId : Text) : async Bool {
    requireUser(caller);

    if (not profileInitialized.contains(caller)) {
      Runtime.trap("Profile must be initialized first");
    };

    if (sessionId.size() > 200) {
      Runtime.trap("Invalid session ID");
    };

    switch (stripeSessionOwners.get(sessionId)) {
      case (?owner) {
        if (owner != caller) {
          Runtime.trap("Unauthorized: Can only activate your own subscription");
        };
      };
      case (null) {
        Runtime.trap("Session not found or unauthorized");
      };
    };

    if (not checkRateLimit(caller, 10, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many verification requests");
    };

    let sessionStatus = await Stripe.getSessionStatus(getStripeConfiguration(), sessionId, transform);

    switch (sessionStatus) {
      case (#completed(_response)) {
        userSubscriptions.add(caller, Time.now());
        successfulPayments.add(caller);
        stripeSessionOwners.remove(sessionId);
        true;
      };
      case (#failed(_error)) {
        failedPayments.add(caller);
        false;
      };
    };

  };

  public shared ({ caller }) func clearExpiredSubscriptions() : async () {
    requireAdminOrCoreAdmin(caller);

    if (not checkRateLimit(caller, 10, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many admin operations");
    };

    let now = Time.now();
    let expired = userSubscriptions.filter(
      func(_principal, lastPayment) { lastPayment + subscriptionPeriod < now }
    );
    expired.forEach(
      func(principal, _lastPayment) {
        userSubscriptions.remove(principal);
      }
    );
  };

  public query ({ caller }) func getSubscriptionExpiryTime() : async ?Time.Time {
    requireUser(caller);

    switch (userSubscriptions.get(caller)) {
      case (?lastPayment) {
        ?(lastPayment + subscriptionPeriod);
      };
      case (null) { null };
    };
  };

  public query ({ caller }) func getActiveSubscribersCount() : async Nat {
    requireAdminOrCoreAdmin(caller);

    let now = Time.now();
    let activeSubscribers = userSubscriptions.filter(
      func(_principal, lastPayment) { lastPayment + subscriptionPeriod > now }
    );
    activeSubscribers.size();
  };

  var oracleIntegration : T.OracleIntegration = {
    connectionStatus = false;
    lastChecked = Time.now();
    url = "https://lflc-oracle-4bu.caffeine.xyz";
    errorLog = [];
  };

  public query ({ caller }) func getOracleIntegrationStatus() : async T.OracleIntegration {
    requireAdminOrCoreAdmin(caller);
    oracleIntegration;
  };

  public shared ({ caller }) func recordOracleAccess(success : Bool, errorMessage : ?Text) : async () {
    requireAdminOrCoreAdmin(caller);

    if (not checkRateLimit(caller, 30, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many Oracle access records");
    };

    let currentTime = Time.now();
    oracleIntegration := {
      oracleIntegration with
      connectionStatus = success;
      lastChecked = currentTime;
      errorLog = switch (errorMessage) {
        case (null) { oracleIntegration.errorLog };
        case (?msg) {
          if (msg.size() > 1000) {
            Runtime.trap("Error message too long");
          };
          oracleIntegration.errorLog.concat(["[" # currentTime.toText() # "] " # msg]);
        };
      };
    };
  };

  public query ({ caller }) func getOracleConnectionStatus() : async Bool {
    requireUser(caller);
    oracleIntegration.connectionStatus;
  };

  public shared ({ caller }) func activateHourlySubscription() : async () {
    requireUser(caller);

    if (not profileInitialized.contains(caller)) {
      Runtime.trap("Profile must be initialized first");
    };

    if (not checkRateLimit(caller, 10, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many activation requests");
    };

    switch (userHourlySubscriptions.get(caller)) {
      case (?status) {
        if (status.active) {
          Runtime.trap("Hourly subscription already active");
        };
      };
      case (null) {};
    };

    let newStatus : T.HourlySubscriptionStatus = {
      active = true;
      lastBilledTime = ?Time.now();
      hoursBilled = 0;
      totalICPPaid = 0;
    };

    userHourlySubscriptions.add(caller, newStatus);
  };

  public shared ({ caller }) func deactivateHourlySubscription() : async () {
    requireUser(caller);

    if (not profileInitialized.contains(caller)) {
      Runtime.trap("Profile must be initialized first");
    };

    if (not checkRateLimit(caller, 10, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many deactivation requests");
    };

    switch (userHourlySubscriptions.get(caller)) {
      case (?status) {
        if (not status.active) {
          Runtime.trap("Hourly subscription already inactive");
        };

        let updatedStatus : T.HourlySubscriptionStatus = {
          active = false;
          lastBilledTime = status.lastBilledTime;
          hoursBilled = status.hoursBilled;
          totalICPPaid = status.totalICPPaid;
        };

        userHourlySubscriptions.add(caller, updatedStatus);
      };
      case (null) {
        Runtime.trap("Hourly subscription not found");
      };
    };
  };

  public query ({ caller }) func getHourlySubscriptionStatus() : async ?T.HourlySubscriptionStatus {
    requireUser(caller);
    userHourlySubscriptions.get(caller);
  };

  public query ({ caller }) func getHourlyBillingHistory() : async [T.HourlyBillingRecord] {
    requireUser(caller);

    switch (hourlyBillingRecords.get(caller)) {
      case (?records) { records };
      case (null) { [] };
    };
  };

  public shared ({ caller }) func adminProcessHourlyBilling(user : Principal) : async () {
    requireAdminOrCoreAdmin(caller);

    if (not checkRateLimit(caller, 100, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many billing operations");
    };

    switch (userHourlySubscriptions.get(user)) {
      case (?status) {
        if (not status.active) {
          Runtime.trap("Hourly subscription is not active for this user");
        };

        let currentTime = Time.now();
        let hoursPassed = switch (status.lastBilledTime) {
          case (?lastTime) {
            let nanosPassed = currentTime - lastTime;
            let hoursPassedInt = nanosPassed / 3_600_000_000_000;
            hoursPassedInt;
          };
          case (null) { 0 };
        };

        if (hoursPassed <= 0) {
          Runtime.trap("No hours passed since last billing");
        };

        let amountToBill = hoursPassed.toNat() * hourlyRateICP;

        let updatedStatus : T.HourlySubscriptionStatus = {
          active = true;
          lastBilledTime = ?currentTime;
          hoursBilled = status.hoursBilled + hoursPassed;
          totalICPPaid = status.totalICPPaid + amountToBill;
        };

        userHourlySubscriptions.add(user, updatedStatus);

        let billingRecord : T.HourlyBillingRecord = {
          timestamp = currentTime;
          hoursBilled = hoursPassed;
          amountICP = amountToBill;
          success = true;
          errorMessage = null;
        };

        let existingRecords = switch (hourlyBillingRecords.get(user)) {
          case (?records) { records };
          case (null) { [] };
        };

        hourlyBillingRecords.add(user, existingRecords.concat([billingRecord]));
      };
      case (null) {
        Runtime.trap("Hourly subscription not found for this user");
      };
    };
  };

  public shared ({ caller }) func adminGetAllHourlySubscriptions() : async [(Principal, T.HourlySubscriptionStatus)] {
    requireAdminOrCoreAdmin(caller);

    if (not checkRateLimit(caller, 20, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many admin queries");
    };

    userHourlySubscriptions.toArray();
  };

  public shared ({ caller }) func adminGetUserHourlyBillingHistory(user : Principal) : async [T.HourlyBillingRecord] {
    requireAdminOrCoreAdmin(caller);

    if (not checkRateLimit(caller, 50, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many admin queries");
    };

    switch (hourlyBillingRecords.get(user)) {
      case (?records) { records };
      case (null) { [] };
    };
  };

  public shared ({ caller }) func adminDeactivateUserHourlySubscription(user : Principal) : async () {
    requireAdminOrCoreAdmin(caller);

    if (not checkRateLimit(caller, 30, 60_000_000_000)) {
      Runtime.trap("Rate limit exceeded: Too many admin operations");
    };

    switch (userHourlySubscriptions.get(user)) {
      case (?status) {
        let updatedStatus : T.HourlySubscriptionStatus = {
          active = false;
          lastBilledTime = status.lastBilledTime;
          hoursBilled = status.hoursBilled;
          totalICPPaid = status.totalICPPaid;
        };

        userHourlySubscriptions.add(user, updatedStatus);
      };
      case (null) {
        Runtime.trap("Hourly subscription not found for this user");
      };
    };
  };

  public query ({ caller }) func adminGetHourlySubscriptionStats() : async {
    totalActiveSubscriptions : Nat;
    totalHoursBilled : Int;
    totalICPCollected : Nat;
  } {
    requireAdminOrCoreAdmin(caller);

    var activeCount : Nat = 0;
    var totalHours : Int = 0;
    var totalICP : Nat = 0;

    userHourlySubscriptions.forEach(
      func(_user, status) {
        if (status.active) {
          activeCount += 1;
        };
        totalHours += status.hoursBilled;
        totalICP += status.totalICPPaid;
      }
    );

    {
      totalActiveSubscriptions = activeCount;
      totalHoursBilled = totalHours;
      totalICPCollected = totalICP;
    };
  };
};
PK
backend/authorization/PK
backend/authorization/access-control.moimport Map "mo:core/Map";
import Principal "mo:core/Principal";
import Runtime "mo:core/Runtime";

module {
  public type UserRole = {
    #admin;
    #user;
    #guest;
  };

  public type AccessControlState = {
    var adminAssigned : Bool;
    userRoles : Map.Map<Principal, UserRole>;
  };

  public func initState() : AccessControlState {
    {
      var adminAssigned = false;
      userRoles = Map.empty<Principal, UserRole>();
    };
  };

  // First principal that calls this function becomes admin, all other principals become users.
  public func initialize(state : AccessControlState, caller : Principal) {
    if (not caller.isAnonymous()) {
      switch (state.userRoles.get(caller)) {
        case (?_) {};
        case (null) {
          if (not state.adminAssigned) {
            state.userRoles.add(caller, #admin);
            state.adminAssigned := true;
          } else {
            state.userRoles.add(caller, #user);
          };
        };
      };
    };
  };

  public func getUserRole(state : AccessControlState, caller : Principal) : UserRole {
    if (caller.isAnonymous()) {
      #guest;
    } else {
      switch (state.userRoles.get(caller)) {
        case (?role) { role };
        case (null) {
          Runtime.trap("User is not registered");
        };
      };
    };
  };

  public func assignRole(state : AccessControlState, caller : Principal, user : Principal, role : UserRole) {
    if (not (isAdmin(state, caller))) {
      Runtime.trap("Unauthorized: Only admins can assign user roles");
    };
    state.userRoles.add(user, role);
  };

  public func hasPermission(state : AccessControlState, caller : Principal, requiredRole : UserRole) : Bool {
    let role = getUserRole(state, caller);
    switch (role) {
      case (#admin) { true };
      case (role) {
        switch (requiredRole) {
          case (#admin) { false };
          case (#user) { role == #user };
          case (#guest) { true };
        };
      };
    };
  };

  public func isAdmin(state : AccessControlState, caller : Principal) : Bool {
    getUserRole(state, caller) == #admin;
  };
};
PK
backend/stripe/PK
backend/stripe/stripe.moimport Nat "mo:core/Nat";
import Text "mo:core/Text";
import Principal "mo:core/Principal";
import Runtime "mo:core/Runtime";
import Error "mo:core/Error";
import List "mo:core/List";
import OutCall "../http-outcalls/outcall";

module {
  public type StripeConfiguration = {
    secretKey : Text;
    allowedCountries : [Text];
  };

  public type ShoppingItem = {
    currency : Text;
    productName : Text;
    productDescription : Text;
    priceInCents : Nat;
    quantity : Nat;
  };

  public func createCheckoutSession(configuration : StripeConfiguration, caller : Principal, items : [ShoppingItem], successUrl : Text, cancelUrl : Text, transform : OutCall.Transform) : async Text {
    let requestBody = buildCheckoutSessionBody(items, configuration.allowedCountries, successUrl, cancelUrl, ?caller.toText());
    try {
      await callStripe(configuration, "v1/checkout/sessions", #post, ?requestBody, transform);
    } catch (error) {
      Runtime.trap("Failed to create checkout session: " # error.message());
    };
  };

  public type StripeSessionStatus = {
    #failed : { error : Text };
    #completed : { response : Text; userPrincipal : ?Text };
  };

  public func getSessionStatus(configuration : StripeConfiguration, sessionId : Text, transform : OutCall.Transform) : async StripeSessionStatus {
    try {
      let reply = await callStripe(configuration, "v1/checkout/sessions/" # sessionId, #get, null, transform);
      if (reply.contains(#text "\"error\"")) {
        #failed({ error = "Stripe API error" });
      } else {
        let extractedPrincipal = extractClientReferenceId(reply);
        #completed({ response = reply; userPrincipal = extractedPrincipal });
      };
    } catch (error) {
      #failed({ error = error.message() });
    };
  };

  func callStripe(configuration : StripeConfiguration, endpoint : Text, method : { #get; #post }, body : ?Text, transform : OutCall.Transform) : async Text {
    var headers = [
      {
        name = "authorization";
        value = "Bearer " # configuration.secretKey;
      },
      {
        name = "content-type";
        value = if (method == #get) { "application/json" } else { "application/x-www-form-urlencoded" };
      }
    ];
    let url = "https://api.stripe.com/" # endpoint;
    switch (method) {
      case (#get) {
        switch (body) {
          case (?_) { Runtime.trap("HTTP GET does not support a HTTP body") };
          case (null) {};
        };
        await OutCall.httpGetRequest(url, headers, transform);
      };
      case (#post) {
        let postBody = switch (body) {
          case (?rawBody) { rawBody };
          case (null) { Runtime.trap("HTTP POST requires a HTTP body") };
        };
        await OutCall.httpPostRequest(url, headers, postBody, transform);
      };
    };
  };

  func urlEncode(text : Text) : Text {
    text.replace(#char ' ', "%20").replace(#char '&', "%26").replace(#char '=', "%3D");
  };

  func buildCheckoutSessionBody(items : [ShoppingItem], allowedCountries : [Text], successUrl : Text, cancelUrl : Text, clientReferenceId : ?Text) : Text {
    let params = List.empty<Text>();
    var index = 0;
    for (item in items.vals()) {
      let indexText = index.toText();
      params.add("line_items[" # indexText # "][price_data][currency]=" # urlEncode(item.currency));
      params.add("line_items[" # indexText # "][price_data][product_data][name]=" # urlEncode(item.productName));
      params.add("line_items[" # indexText # "][price_data][product_data][description]=" # urlEncode(item.productDescription));
      params.add("line_items[" # indexText # "][price_data][unit_amount]=" # item.priceInCents.toText());
      params.add("line_items[" # indexText # "][quantity]=" # item.quantity.toText());
      index += 1;
    };
    params.add("mode=payment");
    params.add("success_url=" # urlEncode(successUrl));
    params.add("cancel_url=" # urlEncode(cancelUrl));
    for (country in allowedCountries.vals()) {
      params.add("shipping_address_collection[allowed_countries][0]=" # urlEncode(country));
    };
    switch (clientReferenceId) {
      case (?id) { params.add("client_reference_id=" # urlEncode(id)) };
      case (null) {};
    };
    params.values().join("&");
  };

  func extractClientReferenceId(jsonText : Text) : ?Text {
    let patterns = ["\"client_reference_id\":\"", "\"client_reference_id\": \""];
    for (pattern in patterns.values()) {
      if (jsonText.contains(#text pattern)) {
        let parts = jsonText.split(#text pattern);
        switch (parts.next()) {
          case (null) {};
          case (?_) {
            switch (parts.next()) {
              case (?afterPattern) {
                switch (afterPattern.split(#text "\"").next()) {
                  case (?value) {
                    if (value.size() > 0) {
                      return ?value;
                    };
                  };
                  case (_) {};
                };
              };
              case (null) {};
            };
          };
        };
      };
    };
    null;
  };
};
PK
build-template/PK
build-template/package.json{
  "name": "@caffeine/template-app",
  "type": "module",
  "engines": {
    "node": ">=16.0.0",
    "pnpm": ">=7.0.0",
    "npm": "please use pnpm"
  },
  "scripts": {
    "build": "pnpm -r --if-present run build",
    "prebuild": "pnpm -r --if-present run prebuild",
    "pretest": "pnpm -r --if-present run prebuild",
    "start": "pnpm -r --if-present run start",
    "test": "pnpm -r --if-present run test"
  },
  "devDependencies": {
    "sharp": "^0.34.4"
  }
}
PK
build-template/pnpm-lock.yamllockfileVersion: '9.0'

settings:
    autoInstallPeers: true
    excludeLinksFromLockfile: false

importers:
    .:
        devDependencies:
            sharp:
                specifier: ^0.34.4
                version: 0.34.4

    src/frontend:
        dependencies:
            '@dfinity/agent':
                specifier: ~3.3.0
                version: 3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/hashes@1.8.0)
            '@dfinity/auth-client':
                specifier: ~3.3.0
                version: 3.3.1(@dfinity/agent@3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/hashes@1.8.0))(@dfinity/identity@3.3.1(@dfinity/agent@3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/hashes@1.8.0))(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/curves@1.9.7)(@noble/hashes@1.8.0))(@dfinity/principal@3.3.1)
            '@dfinity/candid':
                specifier: ~3.3.0
                version: 3.3.1(@dfinity/principal@3.3.1)
            '@dfinity/identity':
                specifier: ~3.3.0
                version: 3.3.1(@dfinity/agent@3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/hashes@1.8.0))(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/curves@1.9.7)(@noble/hashes@1.8.0)
            '@dfinity/principal':
                specifier: ~3.3.0
                version: 3.3.1
            '@icp-sdk/core':
                specifier: ~4.1.0
                version: 4.1.1(@dfinity/agent@3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/hashes@1.8.0))(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/identity-secp256k1@3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/curves@1.9.7)(@noble/hashes@1.8.0))(@dfinity/identity@3.3.1(@dfinity/agent@3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/hashes@1.8.0))(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/curves@1.9.7)(@noble/hashes@1.8.0))(@dfinity/principal@3.3.1)
            '@radix-ui/react-accordion':
                specifier: ^1.1.2
                version: 1.2.12(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-alert-dialog':
                specifier: ^1.1.2
                version: 1.1.15(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-aspect-ratio':
                specifier: ^1.1.0
                version: 1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-avatar':
                specifier: ^1.1.0
                version: 1.1.10(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-checkbox':
                specifier: ^1.1.1
                version: 1.3.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-collapsible':
                specifier: ^1.1.0
                version: 1.1.12(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-context-menu':
                specifier: ^2.2.15
                version: 2.2.16(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-dialog':
                specifier: ^1.1.1
                version: 1.1.15(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-dropdown-menu':
                specifier: ^2.1.1
                version: 2.1.16(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-hover-card':
                specifier: ^1.1.2
                version: 1.1.15(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-label':
                specifier: ^2.1.0
                version: 2.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-menubar':
                specifier: ^1.1.1
                version: 1.1.16(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-navigation-menu':
                specifier: ^1.2.0
                version: 1.2.14(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-popover':
                specifier: ^1.1.1
                version: 1.1.15(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-progress':
                specifier: ^1.1.0
                version: 1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-radio-group':
                specifier: ^1.2.0
                version: 1.3.8(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-scroll-area':
                specifier: ^1.2.0
                version: 1.2.10(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-select':
                specifier: ^2.1.2
                version: 2.2.6(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-separator':
                specifier: ^1.1.0
                version: 1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-slider':
                specifier: ^1.2.0
                version: 1.3.6(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-slot':
                specifier: ^1.1.0
                version: 1.2.3(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-switch':
                specifier: ^1.1.1
                version: 1.2.6(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-tabs':
                specifier: ^1.1.0
                version: 1.1.13(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-toggle':
                specifier: ^1.1.0
                version: 1.1.10(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-toggle-group':
                specifier: ^1.1.0
                version: 1.1.11(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-tooltip':
                specifier: ^1.1.2
                version: 1.2.8(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@react-three/cannon':
                specifier: ~6.6.0
                version: 6.6.0(@react-three/fiber@9.1.4(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)(three@0.176.0))(react@19.1.1)(three@0.176.0)(typescript@5.9.3)
            '@react-three/drei':
                specifier: ~10.0.8
                version: 10.0.8(@react-three/fiber@9.1.4(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)(three@0.176.0))(@types/react@19.1.17)(@types/three@0.176.0)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)(three@0.176.0)
            '@react-three/fiber':
                specifier: ~9.1.2
                version: 9.1.4(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)(three@0.176.0)
            '@tanstack/react-query':
                specifier: ^5.24.0
                version: 5.90.5(react@19.1.1)
            '@tanstack/react-router':
                specifier: ~1.131.8
                version: 1.131.50(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            class-variance-authority:
                specifier: ^0.7.0
                version: 0.7.1
            clsx:
                specifier: ^2.1.1
                version: 2.1.1
            cmdk:
                specifier: ^1.0.0
                version: 1.1.1(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            date-fns:
                specifier: ^3.6.0
                version: 3.6.0
            embla-carousel-react:
                specifier: ^8.2.1
                version: 8.6.0(react@19.1.1)
            input-otp:
                specifier: ^1.4.1
                version: 1.4.2(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            lucide-react:
                specifier: 0.511.0
                version: 0.511.0(react@19.1.1)
            next-themes:
                specifier: ~0.4.6
                version: 0.4.6(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            react:
                specifier: ~19.1.0
                version: 19.1.1
            react-day-picker:
                specifier: ^9.5.0
                version: 9.11.1(react@19.1.1)
            react-dom:
                specifier: ~19.1.0
                version: 19.1.1(react@19.1.1)
            react-hook-form:
                specifier: ^7.53.0
                version: 7.65.0(react@19.1.1)
            react-icons:
                specifier: ^5.4.0
                version: 5.5.0(react@19.1.1)
            react-quill-new:
                specifier: 3.4.6
                version: 3.4.6(quill-delta@5.1.0)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            react-resizable-panels:
                specifier: ^2.1.7
                version: 2.1.9(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            react-use:
                specifier: ~17.6.0
                version: 17.6.0(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            recharts:
                specifier: ^2.15.1
                version: 2.15.4(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            sonner:
                specifier: ^1.7.4
                version: 1.7.4(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            tailwind-merge:
                specifier: ^2.5.2
                version: 2.6.0
            three:
                specifier: ^0.176.0
                version: 0.176.0
            vaul:
                specifier: ^1.1.2
                version: 1.1.2(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            zustand:
                specifier: ~5.0.5
                version: 5.0.8(@types/react@19.1.17)(react@19.1.1)(use-sync-external-store@1.6.0(react@19.1.1))
        devDependencies:
            '@eslint/js':
                specifier: ~9.27.0
                version: 9.27.0
            '@react-three/eslint-plugin':
                specifier: ~0.1.2
                version: 0.1.2
            '@tailwindcss/container-queries':
                specifier: ^0.1.1
                version: 0.1.1(tailwindcss@3.4.18)
            '@tailwindcss/typography':
                specifier: 0.5.10
                version: 0.5.10(tailwindcss@3.4.18)
            '@tanstack/eslint-plugin-router':
                specifier: ~1.115.0
                version: 1.115.0(eslint@9.27.0(jiti@1.21.7))(typescript@5.9.3)
            '@types/node':
                specifier: ^20.9.0
                version: 20.19.24
            '@types/react':
                specifier: ~19.1.0
                version: 19.1.17
            '@types/react-dom':
                specifier: ~19.1.0
                version: 19.1.11(@types/react@19.1.17)
            '@types/three':
                specifier: 0.176.0
                version: 0.176.0
            '@typescript-eslint/eslint-plugin':
                specifier: ^8.32.1
                version: 8.46.2(@typescript-eslint/parser@8.46.2(eslint@9.27.0(jiti@1.21.7))(typescript@5.9.3))(eslint@9.27.0(jiti@1.21.7))(typescript@5.9.3)
            '@typescript-eslint/parser':
                specifier: ^8.32.1
                version: 8.46.2(eslint@9.27.0(jiti@1.21.7))(typescript@5.9.3)
            '@typescript-eslint/utils':
                specifier: ^8.32.1
                version: 8.46.2(eslint@9.27.0(jiti@1.21.7))(typescript@5.9.3)
            '@vitejs/plugin-react':
                specifier: ^4.3.1
                version: 4.7.0(vite@5.4.21(@types/node@20.19.24))
            autoprefixer:
                specifier: ^10.4.20
                version: 10.4.21(postcss@8.5.6)
            dotenv:
                specifier: ^16.5.0
                version: 16.6.1
            dotenv-cli:
                specifier: ^8.0.0
                version: 8.0.0
            eslint:
                specifier: ~9.27.0
                version: 9.27.0(jiti@1.21.7)
            eslint-plugin-react:
                specifier: ~7.37.5
                version: 7.37.5(eslint@9.27.0(jiti@1.21.7))
            eslint-plugin-react-hooks:
                specifier: ~5.2.0
                version: 5.2.0(eslint@9.27.0(jiti@1.21.7))
            eslint-plugin-tailwindcss:
                specifier: ~3.18.2
                version: 3.18.2(tailwindcss@3.4.18)
            globals:
                specifier: ~16.2.0
                version: 16.2.0
            postcss:
                specifier: ^8.4.41
                version: 8.5.6
            tailwindcss:
                specifier: ^3.4.17
                version: 3.4.18
            tailwindcss-animate:
                specifier: ^1.0.7
                version: 1.0.7(tailwindcss@3.4.18)
            typescript:
                specifier: ^5.8.3
                version: 5.9.3
            vite:
                specifier: ^5.4.1
                version: 5.4.21(@types/node@20.19.24)
            vite-plugin-environment:
                specifier: ^1.1.3
                version: 1.1.3(vite@5.4.21(@types/node@20.19.24))

packages:
    '@alloc/quick-lru@5.2.0':
        resolution:
            {
                integrity: sha512-UrcABB+4bUrFABwbluTIBErXwvbsU/V7TZWfmbgJfbkwiBuziS9gxdODUyuiecfdGQ85jglMW6juS3+z5TsKLw==
            }
        engines: { node: '>=10' }

    '@babel/code-frame@7.27.1':
        resolution:
            {
                integrity: sha512-cjQ7ZlQ0Mv3b47hABuTevyTuYN4i+loJKGeV9flcCgIK37cCXRh+L1bd3iBHlynerhQ7BhCkn2BPbQUL+rGqFg==
            }
        engines: { node: '>=6.9.0' }

    '@babel/compat-data@7.28.5':
        resolution:
            {
                integrity: sha512-6uFXyCayocRbqhZOB+6XcuZbkMNimwfVGFji8CTZnCzOHVGvDqzvitu1re2AU5LROliz7eQPhB8CpAMvnx9EjA==
            }
        engines: { node: '>=6.9.0' }

    '@babel/core@7.28.5':
        resolution:
            {
                integrity: sha512-e7jT4DxYvIDLk1ZHmU/m/mB19rex9sv0c2ftBtjSBv+kVM/902eh0fINUzD7UwLLNR+jU585GxUJ8/EBfAM5fw==
            }
        engines: { node: '>=6.9.0' }

    '@babel/generator@7.28.5':
        resolution:
            {
                integrity: sha512-3EwLFhZ38J4VyIP6WNtt2kUdW9dokXA9Cr4IVIFHuCpZ3H8/YFOl5JjZHisrn1fATPBmKKqXzDFvh9fUwHz6CQ==
            }
        engines: { node: '>=6.9.0' }

    '@babel/helper-compilation-targets@7.27.2':
        resolution:
            {
                integrity: sha512-2+1thGUUWWjLTYTHZWK1n8Yga0ijBz1XAhUXcKy81rd5g6yh7hGqMp45v7cadSbEHc9G3OTv45SyneRN3ps4DQ==
            }
        engines: { node: '>=6.9.0' }

    '@babel/helper-globals@7.28.0':
        resolution:
            {
                integrity: sha512-+W6cISkXFa1jXsDEdYA8HeevQT/FULhxzR99pxphltZcVaugps53THCeiWA8SguxxpSp3gKPiuYfSWopkLQ4hw==
            }
        engines: { node: '>=6.9.0' }

    '@babel/helper-module-imports@7.27.1':
        resolution:
            {
                integrity: sha512-0gSFWUPNXNopqtIPQvlD5WgXYI5GY2kP2cCvoT8kczjbfcfuIljTbcWrulD1CIPIX2gt1wghbDy08yE1p+/r3w==
            }
        engines: { node: '>=6.9.0' }

    '@babel/helper-module-transforms@7.28.3':
        resolution:
            {
                integrity: sha512-gytXUbs8k2sXS9PnQptz5o0QnpLL51SwASIORY6XaBKF88nsOT0Zw9szLqlSGQDP/4TljBAD5y98p2U1fqkdsw==
            }
        engines: { node: '>=6.9.0' }
        peerDependencies:
            '@babel/core': ^7.0.0

    '@babel/helper-plugin-utils@7.27.1':
        resolution:
            {
                integrity: sha512-1gn1Up5YXka3YYAHGKpbideQ5Yjf1tDa9qYcgysz+cNCXukyLl6DjPXhD3VRwSb8c0J9tA4b2+rHEZtc6R0tlw==
            }
        engines: { node: '>=6.9.0' }

    '@babel/helper-string-parser@7.27.1':
        resolution:
            {
                integrity: sha512-qMlSxKbpRlAridDExk92nSobyDdpPijUq2DW6oDnUqd0iOGxmQjyqhMIihI9+zv4LPyZdRje2cavWPbCbWm3eA==
            }
        engines: { node: '>=6.9.0' }

    '@babel/helper-validator-identifier@7.28.5':
        resolution:
            {
                integrity: sha512-qSs4ifwzKJSV39ucNjsvc6WVHs6b7S03sOh2OcHF9UHfVPqWWALUsNUVzhSBiItjRZoLHx7nIarVjqKVusUZ1Q==
            }
        engines: { node: '>=6.9.0' }

    '@babel/helper-validator-option@7.27.1':
        resolution:
            {
                integrity: sha512-YvjJow9FxbhFFKDSuFnVCe2WxXk1zWc22fFePVNEaWJEu8IrZVlda6N0uHwzZrUM1il7NC9Mlp4MaJYbYd9JSg==
            }
        engines: { node: '>=6.9.0' }

    '@babel/helpers@7.28.4':
        resolution:
            {
                integrity: sha512-HFN59MmQXGHVyYadKLVumYsA9dBFun/ldYxipEjzA4196jpLZd8UjEEBLkbEkvfYreDqJhZxYAWFPtrfhNpj4w==
            }
        engines: { node: '>=6.9.0' }

    '@babel/parser@7.28.5':
        resolution:
            {
                integrity: sha512-KKBU1VGYR7ORr3At5HAtUQ+TV3SzRCXmA/8OdDZiLDBIZxVyzXuztPjfLd3BV1PRAQGCMWWSHYhL0F8d5uHBDQ==
            }
        engines: { node: '>=6.0.0' }
        hasBin: true

    '@babel/plugin-transform-react-jsx-self@7.27.1':
        resolution:
            {
                integrity: sha512-6UzkCs+ejGdZ5mFFC/OCUrv028ab2fp1znZmCZjAOBKiBK2jXD1O+BPSfX8X2qjJ75fZBMSnQn3Rq2mrBJK2mw==
            }
        engines: { node: '>=6.9.0' }
        peerDependencies:
            '@babel/core': ^7.0.0-0

    '@babel/plugin-transform-react-jsx-source@7.27.1':
        resolution:
            {
                integrity: sha512-zbwoTsBruTeKB9hSq73ha66iFeJHuaFkUbwvqElnygoNbj/jHRsSeokowZFN3CZ64IvEqcmmkVe89OPXc7ldAw==
            }
        engines: { node: '>=6.9.0' }
        peerDependencies:
            '@babel/core': ^7.0.0-0

    '@babel/runtime@7.28.4':
        resolution:
            {
                integrity: sha512-Q/N6JNWvIvPnLDvjlE1OUBLPQHH6l3CltCEsHIujp45zQUSSh8K+gHnaEX45yAT1nyngnINhvWtzN+Nb9D8RAQ==
            }
        engines: { node: '>=6.9.0' }

    '@babel/template@7.27.2':
        resolution:
            {
                integrity: sha512-LPDZ85aEJyYSd18/DkjNh4/y1ntkE5KwUHWTiqgRxruuZL2F1yuHligVHLvcHY2vMHXttKFpJn6LwfI7cw7ODw==
            }
        engines: { node: '>=6.9.0' }

    '@babel/traverse@7.28.5':
        resolution:
            {
                integrity: sha512-TCCj4t55U90khlYkVV/0TfkJkAkUg3jZFA3Neb7unZT8CPok7iiRfaX0F+WnqWqt7OxhOn0uBKXCw4lbL8W0aQ==
            }
        engines: { node: '>=6.9.0' }

    '@babel/types@7.28.5':
        resolution:
            {
                integrity: sha512-qQ5m48eI/MFLQ5PxQj4PFaprjyCTLI37ElWMmNs0K8Lk3dVeOdNpB3ks8jc7yM5CDmVC73eMVk/trk3fgmrUpA==
            }
        engines: { node: '>=6.9.0' }

    '@date-fns/tz@1.4.1':
        resolution:
            {
                integrity: sha512-P5LUNhtbj6YfI3iJjw5EL9eUAG6OitD0W3fWQcpQjDRc/QIsL0tRNuO1PcDvPccWL1fSTXXdE1ds+l95DV/OFA==
            }

    '@dfinity/agent@3.3.1':
        resolution:
            {
                integrity: sha512-U1zWIiCgJmxNet2NpKN+2UgOcO/OFC+FqGEpIsvu964eH7FeEMagmSZ5xTIsXSL9sN0mR7gY5Fuz+bv5XSBJQg==
            }
        peerDependencies:
            '@dfinity/candid': 3.3.1
            '@dfinity/principal': 3.3.1
            '@noble/hashes': ^1.8.0

    '@dfinity/auth-client@3.3.1':
        resolution:
            {
                integrity: sha512-Cxf8dlWzxG9mgRzEesuf4cRVCAMrIhlRKw54bc1CNceSobkhpo9Hbz4bSqD02zddKD+G69KAQR3z5r43wKi8CA==
            }
        peerDependencies:
            '@dfinity/agent': 3.3.1
            '@dfinity/identity': 3.3.1
            '@dfinity/principal': 3.3.1

    '@dfinity/candid@3.3.1':
        resolution:
            {
                integrity: sha512-BOvhZhQarrpA5ErwLwXW/M28nSx3e0ZlV0iyJ+MvH6SkFcZqATVBPA0rVn57uDtMFboT8TzlA3RoW+YBzHxLJQ==
            }
        peerDependencies:
            '@dfinity/principal': 3.3.1

    '@dfinity/cbor@0.2.2':
        resolution:
            {
                integrity: sha512-GPJpH73kDEKbUBdUjY80lz7cq9l0vm1h/7ppejPV6O0ZTqCLrYspssYvqjRmK4aNnJ/SKXsP0rg9LYX7zpegaA==
            }

    '@dfinity/identity-secp256k1@3.3.1':
        resolution:
            {
                integrity: sha512-rGgcCm9wLQkxuluPdfPcl1P/KrwehLmjVIXc1lEPE01C0H2YK4bofxYrxCnHQQl8a8Ioc1dkpOl7TBUtXTkKHw==
            }
        peerDependencies:
            '@dfinity/candid': 3.3.1
            '@noble/curves': ^1.9.2
            '@noble/hashes': ^1.8.0

    '@dfinity/identity@3.3.1':
        resolution:
            {
                integrity: sha512-c+Grr7Mc7RephqBzRpdtySDg1to9pitb0wakXSk8902yg3BVc5vAsmbA3S1WwriY8+AMB06Dy2IZl/9Hot/Yhw==
            }
        peerDependencies:
            '@dfinity/agent': 3.3.1
            '@dfinity/candid': 3.3.1
            '@dfinity/principal': 3.3.1
            '@noble/curves': ^1.9.2
            '@noble/hashes': ^1.8.0

    '@dfinity/principal@3.3.1':
        resolution:
            {
                integrity: sha512-UWloNRbDHSwVV/gec0CrtWm/cHODPgu+jgwn5iERheVwYCEp+yGXVIssUkJeN6wFxraqqCFcoBUvg7vtWM+GBg==
            }

    '@dimforge/rapier3d-compat@0.12.0':
        resolution:
            {
                integrity: sha512-uekIGetywIgopfD97oDL5PfeezkFpNhwlzlaEYNOA0N6ghdsOvh/HYjSMek5Q2O1PYvRSDFcqFVJl4r4ZBwOow==
            }

    '@emnapi/runtime@1.6.0':
        resolution:
            {
                integrity: sha512-obtUmAHTMjll499P+D9A3axeJFlhdjOWdKUNs/U6QIGT7V5RjcUW1xToAzjvmgTSQhDbYn/NwfTRoJcQ2rNBxA==
            }

    '@esbuild/aix-ppc64@0.21.5':
        resolution:
            {
                integrity: sha512-1SDgH6ZSPTlggy1yI6+Dbkiz8xzpHJEVAlF/AM1tHPLsf5STom9rwtjE4hKAF20FfXXNTFqEYXyJNWh1GiZedQ==
            }
        engines: { node: '>=12' }
        cpu: [ppc64]
        os: [aix]

    '@esbuild/android-arm64@0.21.5':
        resolution:
            {
                integrity: sha512-c0uX9VAUBQ7dTDCjq+wdyGLowMdtR/GoC2U5IYk/7D1H1JYC0qseD7+11iMP2mRLN9RcCMRcjC4YMclCzGwS/A==
            }
        engines: { node: '>=12' }
        cpu: [arm64]
        os: [android]

    '@esbuild/android-arm@0.21.5':
        resolution:
            {
                integrity: sha512-vCPvzSjpPHEi1siZdlvAlsPxXl7WbOVUBBAowWug4rJHb68Ox8KualB+1ocNvT5fjv6wpkX6o/iEpbDrf68zcg==
            }
        engines: { node: '>=12' }
        cpu: [arm]
        os: [android]

    '@esbuild/android-x64@0.21.5':
        resolution:
            {
                integrity: sha512-D7aPRUUNHRBwHxzxRvp856rjUHRFW1SdQATKXH2hqA0kAZb1hKmi02OpYRacl0TxIGz/ZmXWlbZgjwWYaCakTA==
            }
        engines: { node: '>=12' }
        cpu: [x64]
        os: [android]

    '@esbuild/darwin-arm64@0.21.5':
        resolution:
            {
                integrity: sha512-DwqXqZyuk5AiWWf3UfLiRDJ5EDd49zg6O9wclZ7kUMv2WRFr4HKjXp/5t8JZ11QbQfUS6/cRCKGwYhtNAY88kQ==
            }
        engines: { node: '>=12' }
        cpu: [arm64]
        os: [darwin]

    '@esbuild/darwin-x64@0.21.5':
        resolution:
            {
                integrity: sha512-se/JjF8NlmKVG4kNIuyWMV/22ZaerB+qaSi5MdrXtd6R08kvs2qCN4C09miupktDitvh8jRFflwGFBQcxZRjbw==
            }
        engines: { node: '>=12' }
        cpu: [x64]
        os: [darwin]

    '@esbuild/freebsd-arm64@0.21.5':
        resolution:
            {
                integrity: sha512-5JcRxxRDUJLX8JXp/wcBCy3pENnCgBR9bN6JsY4OmhfUtIHe3ZW0mawA7+RDAcMLrMIZaf03NlQiX9DGyB8h4g==
            }
        engines: { node: '>=12' }
        cpu: [arm64]
        os: [freebsd]

    '@esbuild/freebsd-x64@0.21.5':
        resolution:
            {
                integrity: sha512-J95kNBj1zkbMXtHVH29bBriQygMXqoVQOQYA+ISs0/2l3T9/kj42ow2mpqerRBxDJnmkUDCaQT/dfNXWX/ZZCQ==
            }
        engines: { node: '>=12' }
        cpu: [x64]
        os: [freebsd]

    '@esbuild/linux-arm64@0.21.5':
        resolution:
            {
                integrity: sha512-ibKvmyYzKsBeX8d8I7MH/TMfWDXBF3db4qM6sy+7re0YXya+K1cem3on9XgdT2EQGMu4hQyZhan7TeQ8XkGp4Q==
            }
        engines: { node: '>=12' }
        cpu: [arm64]
        os: [linux]

    '@esbuild/linux-arm@0.21.5':
        resolution:
            {
                integrity: sha512-bPb5AHZtbeNGjCKVZ9UGqGwo8EUu4cLq68E95A53KlxAPRmUyYv2D6F0uUI65XisGOL1hBP5mTronbgo+0bFcA==
            }
        engines: { node: '>=12' }
        cpu: [arm]
        os: [linux]

    '@esbuild/linux-ia32@0.21.5':
        resolution:
            {
                integrity: sha512-YvjXDqLRqPDl2dvRODYmmhz4rPeVKYvppfGYKSNGdyZkA01046pLWyRKKI3ax8fbJoK5QbxblURkwK/MWY18Tg==
            }
        engines: { node: '>=12' }
        cpu: [ia32]
        os: [linux]

    '@esbuild/linux-loong64@0.21.5':
        resolution:
            {
                integrity: sha512-uHf1BmMG8qEvzdrzAqg2SIG/02+4/DHB6a9Kbya0XDvwDEKCoC8ZRWI5JJvNdUjtciBGFQ5PuBlpEOXQj+JQSg==
            }
        engines: { node: '>=12' }
        cpu: [loong64]
        os: [linux]

    '@esbuild/linux-mips64el@0.21.5':
        resolution:
            {
                integrity: sha512-IajOmO+KJK23bj52dFSNCMsz1QP1DqM6cwLUv3W1QwyxkyIWecfafnI555fvSGqEKwjMXVLokcV5ygHW5b3Jbg==
            }
        engines: { node: '>=12' }
        cpu: [mips64el]
        os: [linux]

    '@esbuild/linux-ppc64@0.21.5':
        resolution:
            {
                integrity: sha512-1hHV/Z4OEfMwpLO8rp7CvlhBDnjsC3CttJXIhBi+5Aj5r+MBvy4egg7wCbe//hSsT+RvDAG7s81tAvpL2XAE4w==
            }
        engines: { node: '>=12' }
        cpu: [ppc64]
        os: [linux]

    '@esbuild/linux-riscv64@0.21.5':
        resolution:
            {
                integrity: sha512-2HdXDMd9GMgTGrPWnJzP2ALSokE/0O5HhTUvWIbD3YdjME8JwvSCnNGBnTThKGEB91OZhzrJ4qIIxk/SBmyDDA==
            }
        engines: { node: '>=12' }
        cpu: [riscv64]
        os: [linux]

    '@esbuild/linux-s390x@0.21.5':
        resolution:
            {
                integrity: sha512-zus5sxzqBJD3eXxwvjN1yQkRepANgxE9lgOW2qLnmr8ikMTphkjgXu1HR01K4FJg8h1kEEDAqDcZQtbrRnB41A==
            }
        engines: { node: '>=12' }
        cpu: [s390x]
        os: [linux]

    '@esbuild/linux-x64@0.21.5':
        resolution:
            {
                integrity: sha512-1rYdTpyv03iycF1+BhzrzQJCdOuAOtaqHTWJZCWvijKD2N5Xu0TtVC8/+1faWqcP9iBCWOmjmhoH94dH82BxPQ==
            }
        engines: { node: '>=12' }
        cpu: [x64]
        os: [linux]

    '@esbuild/netbsd-x64@0.21.5':
        resolution:
            {
                integrity: sha512-Woi2MXzXjMULccIwMnLciyZH4nCIMpWQAs049KEeMvOcNADVxo0UBIQPfSmxB3CWKedngg7sWZdLvLczpe0tLg==
            }
        engines: { node: '>=12' }
        cpu: [x64]
        os: [netbsd]

    '@esbuild/openbsd-x64@0.21.5':
        resolution:
            {
                integrity: sha512-HLNNw99xsvx12lFBUwoT8EVCsSvRNDVxNpjZ7bPn947b8gJPzeHWyNVhFsaerc0n3TsbOINvRP2byTZ5LKezow==
            }
        engines: { node: '>=12' }
        cpu: [x64]
        os: [openbsd]

    '@esbuild/sunos-x64@0.21.5':
        resolution:
            {
                integrity: sha512-6+gjmFpfy0BHU5Tpptkuh8+uw3mnrvgs+dSPQXQOv3ekbordwnzTVEb4qnIvQcYXq6gzkyTnoZ9dZG+D4garKg==
            }
        engines: { node: '>=12' }
        cpu: [x64]
        os: [sunos]

    '@esbuild/win32-arm64@0.21.5':
        resolution:
            {
                integrity: sha512-Z0gOTd75VvXqyq7nsl93zwahcTROgqvuAcYDUr+vOv8uHhNSKROyU961kgtCD1e95IqPKSQKH7tBTslnS3tA8A==
            }
        engines: { node: '>=12' }
        cpu: [arm64]
        os: [win32]

    '@esbuild/win32-ia32@0.21.5':
        resolution:
            {
                integrity: sha512-SWXFF1CL2RVNMaVs+BBClwtfZSvDgtL//G/smwAc5oVK/UPu2Gu9tIaRgFmYFFKrmg3SyAjSrElf0TiJ1v8fYA==
            }
        engines: { node: '>=12' }
        cpu: [ia32]
        os: [win32]

    '@esbuild/win32-x64@0.21.5':
        resolution:
            {
                integrity: sha512-tQd/1efJuzPC6rCFwEvLtci/xNFcTZknmXs98FYDfGE4wP9ClFV98nyKrzJKVPMhdDnjzLhdUyMX4PsQAPjwIw==
            }
        engines: { node: '>=12' }
        cpu: [x64]
        os: [win32]

    '@eslint-community/eslint-utils@4.9.0':
        resolution:
            {
                integrity: sha512-ayVFHdtZ+hsq1t2Dy24wCmGXGe4q9Gu3smhLYALJrr473ZH27MsnSL+LKUlimp4BWJqMDMLmPpx/Q9R3OAlL4g==
            }
        engines: { node: ^12.22.0 || ^14.17.0 || >=16.0.0 }
        peerDependencies:
            eslint: ^6.0.0 || ^7.0.0 || >=8.0.0

    '@eslint-community/regexpp@4.12.2':
        resolution:
            {
                integrity: sha512-EriSTlt5OC9/7SXkRSCAhfSxxoSUgBm33OH+IkwbdpgoqsSsUg7y3uh+IICI/Qg4BBWr3U2i39RpmycbxMq4ew==
            }
        engines: { node: ^12.0.0 || ^14.0.0 || >=16.0.0 }

    '@eslint/config-array@0.20.1':
        resolution:
            {
                integrity: sha512-OL0RJzC/CBzli0DrrR31qzj6d6i6Mm3HByuhflhl4LOBiWxN+3i6/t/ZQQNii4tjksXi8r2CRW1wMpWA2ULUEw==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }

    '@eslint/config-helpers@0.2.3':
        resolution:
            {
                integrity: sha512-u180qk2Um1le4yf0ruXH3PYFeEZeYC3p/4wCTKrr2U1CmGdzGi3KtY0nuPDH48UJxlKCC5RDzbcbh4X0XlqgHg==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }

    '@eslint/core@0.14.0':
        resolution:
            {
                integrity: sha512-qIbV0/JZr7iSDjqAc60IqbLdsj9GDt16xQtWD+B78d/HAlvysGdZZ6rpJHGAc2T0FQx1X6thsSPdnoiGKdNtdg==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }

    '@eslint/core@0.15.2':
        resolution:
            {
                integrity: sha512-78Md3/Rrxh83gCxoUc0EiciuOHsIITzLy53m3d9UyiW8y9Dj2D29FeETqyKA+BRK76tnTp6RXWb3pCay8Oyomg==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }

    '@eslint/eslintrc@2.1.4':
        resolution:
            {
                integrity: sha512-269Z39MS6wVJtsoUl10L60WdkhJVdPG24Q4eZTH3nnF6lpvSShEK3wQjDX9JRWAUPvPh7COouPpU9IrqaZFvtQ==
            }
        engines: { node: ^12.22.0 || ^14.17.0 || >=16.0.0 }

    '@eslint/eslintrc@3.3.1':
        resolution:
            {
                integrity: sha512-gtF186CXhIl1p4pJNGZw8Yc6RlshoePRvE0X91oPGb3vZ8pM3qOS9W9NGPat9LziaBV7XrJWGylNQXkGcnM3IQ==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }

    '@eslint/js@8.57.1':
        resolution:
            {
                integrity: sha512-d9zaMRSTIKDLhctzH12MtXvJKSSUhaHcjV+2Z+GK+EEY7XKpP5yR4x+N3TAcHTcu963nIr+TMcCb4DBCYX1z6Q==
            }
        engines: { node: ^12.22.0 || ^14.17.0 || >=16.0.0 }

    '@eslint/js@9.27.0':
        resolution:
            {
                integrity: sha512-G5JD9Tu5HJEu4z2Uo4aHY2sLV64B7CDMXxFzqzjl3NKd6RVzSXNoE80jk7Y0lJkTTkjiIhBAqmlYwjuBY3tvpA==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }

    '@eslint/object-schema@2.1.7':
        resolution:
            {
                integrity: sha512-VtAOaymWVfZcmZbp6E2mympDIHvyjXs/12LqWYjVw6qjrfF+VK+fyG33kChz3nnK+SU5/NeHOqrTEHS8sXO3OA==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }

    '@eslint/plugin-kit@0.3.5':
        resolution:
            {
                integrity: sha512-Z5kJ+wU3oA7MMIqVR9tyZRtjYPr4OC004Q4Rw7pgOKUOKkJfZ3O24nz3WYfGRpMDNmcOi3TwQOmgm7B7Tpii0w==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }

    '@floating-ui/core@1.7.3':
        resolution:
            {
                integrity: sha512-sGnvb5dmrJaKEZ+LDIpguvdX3bDlEllmv4/ClQ9awcmCZrlx5jQyyMWFM5kBI+EyNOCDDiKk8il0zeuX3Zlg/w==
            }

    '@floating-ui/dom@1.7.4':
        resolution:
            {
                integrity: sha512-OOchDgh4F2CchOX94cRVqhvy7b3AFb+/rQXyswmzmGakRfkMgoWVjfnLWkRirfLEfuD4ysVW16eXzwt3jHIzKA==
            }

    '@floating-ui/react-dom@2.1.6':
        resolution:
            {
                integrity: sha512-4JX6rEatQEvlmgU80wZyq9RT96HZJa88q8hp0pBd+LrczeDI4o6uA2M+uvxngVHo4Ihr8uibXxH6+70zhAFrVw==
            }
        peerDependencies:
            react: '>=16.8.0'
            react-dom: '>=16.8.0'

    '@floating-ui/utils@0.2.10':
        resolution:
            {
                integrity: sha512-aGTxbpbg8/b5JfU1HXSrbH3wXZuLPJcNEcZQFMxLs3oSzgtVu6nFPkbbGGUvBcUjKV2YyB9Wxxabo+HEH9tcRQ==
            }

    '@humanfs/core@0.19.1':
        resolution:
            {
                integrity: sha512-5DyQ4+1JEUzejeK1JGICcideyfUbGixgS9jNgex5nqkW+cY7WZhxBigmieN5Qnw9ZosSNVC9KQKyb+GUaGyKUA==
            }
        engines: { node: '>=18.18.0' }

    '@humanfs/node@0.16.7':
        resolution:
            {
                integrity: sha512-/zUx+yOsIrG4Y43Eh2peDeKCxlRt/gET6aHfaKpuq267qXdYDFViVHfMaLyygZOnl0kGWxFIgsBy8QFuTLUXEQ==
            }
        engines: { node: '>=18.18.0' }

    '@humanwhocodes/config-array@0.13.0':
        resolution:
            {
                integrity: sha512-DZLEEqFWQFiyK6h5YIeynKx7JlvCYWL0cImfSRXZ9l4Sg2efkFGTuFf6vzXjK1cq6IYkU+Eg/JizXw+TD2vRNw==
            }
        engines: { node: '>=10.10.0' }
        deprecated: Use @eslint/config-array instead

    '@humanwhocodes/module-importer@1.0.1':
        resolution:
            {
                integrity: sha512-bxveV4V8v5Yb4ncFTT3rPSgZBOpCkjfK0y4oVVVJwIuDVBRMDXrPyXRL988i5ap9m9bnyEEjWfm5WkBmtffLfA==
            }
        engines: { node: '>=12.22' }

    '@humanwhocodes/object-schema@2.0.3':
        resolution:
            {
                integrity: sha512-93zYdMES/c1D69yZiKDBj0V24vqNzB/koF26KPaagAfd3P/4gUlh3Dys5ogAK+Exi9QyzlD8x/08Zt7wIKcDcA==
            }
        deprecated: Use @eslint/object-schema instead

    '@humanwhocodes/retry@0.4.3':
        resolution:
            {
                integrity: sha512-bV0Tgo9K4hfPCek+aMAn81RppFKv2ySDQeMoSZuvTASywNTnVJCArCZE2FWqpvIatKu7VMRLWlR1EazvVhDyhQ==
            }
        engines: { node: '>=18.18' }

    '@icp-sdk/core@4.1.1':
        resolution:
            {
                integrity: sha512-IYWsRauSvmr3M3T85FPaRM9lhuIumavhmJVG69tiYYqQmayAt0X0veKSevO+vm9nzmymriYCOwXqi57NqYhufA==
            }
        peerDependencies:
            '@dfinity/agent': 3.3.1
            '@dfinity/candid': 3.3.1
            '@dfinity/identity': 3.3.1
            '@dfinity/identity-secp256k1': 3.3.1
            '@dfinity/principal': 3.3.1

    '@img/colour@1.0.0':
        resolution:
            {
                integrity: sha512-A5P/LfWGFSl6nsckYtjw9da+19jB8hkJ6ACTGcDfEJ0aE+l2n2El7dsVM7UVHZQ9s2lmYMWlrS21YLy2IR1LUw==
            }
        engines: { node: '>=18' }

    '@img/sharp-darwin-arm64@0.34.4':
        resolution:
            {
                integrity: sha512-sitdlPzDVyvmINUdJle3TNHl+AG9QcwiAMsXmccqsCOMZNIdW2/7S26w0LyU8euiLVzFBL3dXPwVCq/ODnf2vA==
            }
        engines: { node: ^18.17.0 || ^20.3.0 || >=21.0.0 }
        cpu: [arm64]
        os: [darwin]

    '@img/sharp-darwin-x64@0.34.4':
        resolution:
            {
                integrity: sha512-rZheupWIoa3+SOdF/IcUe1ah4ZDpKBGWcsPX6MT0lYniH9micvIU7HQkYTfrx5Xi8u+YqwLtxC/3vl8TQN6rMg==
            }
        engines: { node: ^18.17.0 || ^20.3.0 || >=21.0.0 }
        cpu: [x64]
        os: [darwin]

    '@img/sharp-libvips-darwin-arm64@1.2.3':
        resolution:
            {
                integrity: sha512-QzWAKo7kpHxbuHqUC28DZ9pIKpSi2ts2OJnoIGI26+HMgq92ZZ4vk8iJd4XsxN+tYfNJxzH6W62X5eTcsBymHw==
            }
        cpu: [arm64]
        os: [darwin]

    '@img/sharp-libvips-darwin-x64@1.2.3':
        resolution:
            {
                integrity: sha512-Ju+g2xn1E2AKO6YBhxjj+ACcsPQRHT0bhpglxcEf+3uyPY+/gL8veniKoo96335ZaPo03bdDXMv0t+BBFAbmRA==
            }
        cpu: [x64]
        os: [darwin]

    '@img/sharp-libvips-linux-arm64@1.2.3':
        resolution:
            {
                integrity: sha512-I4RxkXU90cpufazhGPyVujYwfIm9Nk1QDEmiIsaPwdnm013F7RIceaCc87kAH+oUB1ezqEvC6ga4m7MSlqsJvQ==
            }
        cpu: [arm64]
        os: [linux]

    '@img/sharp-libvips-linux-arm@1.2.3':
        resolution:
            {
                integrity: sha512-x1uE93lyP6wEwGvgAIV0gP6zmaL/a0tGzJs/BIDDG0zeBhMnuUPm7ptxGhUbcGs4okDJrk4nxgrmxpib9g6HpA==
            }
        cpu: [arm]
        os: [linux]

    '@img/sharp-libvips-linux-ppc64@1.2.3':
        resolution:
            {
                integrity: sha512-Y2T7IsQvJLMCBM+pmPbM3bKT/yYJvVtLJGfCs4Sp95SjvnFIjynbjzsa7dY1fRJX45FTSfDksbTp6AGWudiyCg==
            }
        cpu: [ppc64]
        os: [linux]

    '@img/sharp-libvips-linux-s390x@1.2.3':
        resolution:
            {
                integrity: sha512-RgWrs/gVU7f+K7P+KeHFaBAJlNkD1nIZuVXdQv6S+fNA6syCcoboNjsV2Pou7zNlVdNQoQUpQTk8SWDHUA3y/w==
            }
        cpu: [s390x]
        os: [linux]

    '@img/sharp-libvips-linux-x64@1.2.3':
        resolution:
            {
                integrity: sha512-3JU7LmR85K6bBiRzSUc/Ff9JBVIFVvq6bomKE0e63UXGeRw2HPVEjoJke1Yx+iU4rL7/7kUjES4dZ/81Qjhyxg==
            }
        cpu: [x64]
        os: [linux]

    '@img/sharp-libvips-linuxmusl-arm64@1.2.3':
        resolution:
            {
                integrity: sha512-F9q83RZ8yaCwENw1GieztSfj5msz7GGykG/BA+MOUefvER69K/ubgFHNeSyUu64amHIYKGDs4sRCMzXVj8sEyw==
            }
        cpu: [arm64]
        os: [linux]

    '@img/sharp-libvips-linuxmusl-x64@1.2.3':
        resolution:
            {
                integrity: sha512-U5PUY5jbc45ANM6tSJpsgqmBF/VsL6LnxJmIf11kB7J5DctHgqm0SkuXzVWtIY90GnJxKnC/JT251TDnk1fu/g==
            }
        cpu: [x64]
        os: [linux]

    '@img/sharp-linux-arm64@0.34.4':
        resolution:
            {
                integrity: sha512-YXU1F/mN/Wu786tl72CyJjP/Ngl8mGHN1hST4BGl+hiW5jhCnV2uRVTNOcaYPs73NeT/H8Upm3y9582JVuZHrQ==
            }
        engines: { node: ^18.17.0 || ^20.3.0 || >=21.0.0 }
        cpu: [arm64]
        os: [linux]

    '@img/sharp-linux-arm@0.34.4':
        resolution:
            {
                integrity: sha512-Xyam4mlqM0KkTHYVSuc6wXRmM7LGN0P12li03jAnZ3EJWZqj83+hi8Y9UxZUbxsgsK1qOEwg7O0Bc0LjqQVtxA==
            }
        engines: { node: ^18.17.0 || ^20.3.0 || >=21.0.0 }
        cpu: [arm]
        os: [linux]

    '@img/sharp-linux-ppc64@0.34.4':
        resolution:
            {
                integrity: sha512-F4PDtF4Cy8L8hXA2p3TO6s4aDt93v+LKmpcYFLAVdkkD3hSxZzee0rh6/+94FpAynsuMpLX5h+LRsSG3rIciUQ==
            }
        engines: { node: ^18.17.0 || ^20.3.0 || >=21.0.0 }
        cpu: [ppc64]
        os: [linux]

    '@img/sharp-linux-s390x@0.34.4':
        resolution:
            {
                integrity: sha512-qVrZKE9Bsnzy+myf7lFKvng6bQzhNUAYcVORq2P7bDlvmF6u2sCmK2KyEQEBdYk+u3T01pVsPrkj943T1aJAsw==
            }
        engines: { node: ^18.17.0 || ^20.3.0 || >=21.0.0 }
        cpu: [s390x]
        os: [linux]

    '@img/sharp-linux-x64@0.34.4':
        resolution:
            {
                integrity: sha512-ZfGtcp2xS51iG79c6Vhw9CWqQC8l2Ot8dygxoDoIQPTat/Ov3qAa8qpxSrtAEAJW+UjTXc4yxCjNfxm4h6Xm2A==
            }
        engines: { node: ^18.17.0 || ^20.3.0 || >=21.0.0 }
        cpu: [x64]
        os: [linux]

    '@img/sharp-linuxmusl-arm64@0.34.4':
        resolution:
            {
                integrity: sha512-8hDVvW9eu4yHWnjaOOR8kHVrew1iIX+MUgwxSuH2XyYeNRtLUe4VNioSqbNkB7ZYQJj9rUTT4PyRscyk2PXFKA==
            }
        engines: { node: ^18.17.0 || ^20.3.0 || >=21.0.0 }
        cpu: [arm64]
        os: [linux]

    '@img/sharp-linuxmusl-x64@0.34.4':
        resolution:
            {
                integrity: sha512-lU0aA5L8QTlfKjpDCEFOZsTYGn3AEiO6db8W5aQDxj0nQkVrZWmN3ZP9sYKWJdtq3PWPhUNlqehWyXpYDcI9Sg==
            }
        engines: { node: ^18.17.0 || ^20.3.0 || >=21.0.0 }
        cpu: [x64]
        os: [linux]

    '@img/sharp-wasm32@0.34.4':
        resolution:
            {
                integrity: sha512-33QL6ZO/qpRyG7woB/HUALz28WnTMI2W1jgX3Nu2bypqLIKx/QKMILLJzJjI+SIbvXdG9fUnmrxR7vbi1sTBeA==
            }
        engines: { node: ^18.17.0 || ^20.3.0 || >=21.0.0 }
        cpu: [wasm32]

    '@img/sharp-win32-arm64@0.34.4':
        resolution:
            {
                integrity: sha512-2Q250do/5WXTwxW3zjsEuMSv5sUU4Tq9VThWKlU2EYLm4MB7ZeMwF+SFJutldYODXF6jzc6YEOC+VfX0SZQPqA==
            }
        engines: { node: ^18.17.0 || ^20.3.0 || >=21.0.0 }
        cpu: [arm64]
        os: [win32]

    '@img/sharp-win32-ia32@0.34.4':
        resolution:
            {
                integrity: sha512-3ZeLue5V82dT92CNL6rsal6I2weKw1cYu+rGKm8fOCCtJTR2gYeUfY3FqUnIJsMUPIH68oS5jmZ0NiJ508YpEw==
            }
        engines: { node: ^18.17.0 || ^20.3.0 || >=21.0.0 }
        cpu: [ia32]
        os: [win32]

    '@img/sharp-win32-x64@0.34.4':
        resolution:
            {
                integrity: sha512-xIyj4wpYs8J18sVN3mSQjwrw7fKUqRw+Z5rnHNCy5fYTxigBz81u5mOMPmFumwjcn8+ld1ppptMBCLic1nz6ig==
            }
        engines: { node: ^18.17.0 || ^20.3.0 || >=21.0.0 }
        cpu: [x64]
        os: [win32]

    '@isaacs/cliui@8.0.2':
        resolution:
            {
                integrity: sha512-O8jcjabXaleOG9DQ0+ARXWZBTfnP4WNAqzuiJK7ll44AmxGKv/J2M4TPjxjY3znBCfvBXFzucm1twdyFybFqEA==
            }
        engines: { node: '>=12' }

    '@jridgewell/gen-mapping@0.3.13':
        resolution:
            {
                integrity: sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA==
            }

    '@jridgewell/remapping@2.3.5':
        resolution:
            {
                integrity: sha512-LI9u/+laYG4Ds1TDKSJW2YPrIlcVYOwi2fUC6xB43lueCjgxV4lffOCZCtYFiH6TNOX+tQKXx97T4IKHbhyHEQ==
            }

    '@jridgewell/resolve-uri@3.1.2':
        resolution:
            {
                integrity: sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==
            }
        engines: { node: '>=6.0.0' }

    '@jridgewell/sourcemap-codec@1.5.5':
        resolution:
            {
                integrity: sha512-cYQ9310grqxueWbl+WuIUIaiUaDcj7WOq5fVhEljNVgRfOUhY9fy2zTvfoqWsnebh8Sl70VScFbICvJnLKB0Og==
            }

    '@jridgewell/trace-mapping@0.3.31':
        resolution:
            {
                integrity: sha512-zzNR+SdQSDJzc8joaeP8QQoCQr8NuYx2dIIytl1QeBEZHJ9uW6hebsrYgbz8hJwUQao3TWCMtmfV8Nu1twOLAw==
            }

    '@mediapipe/tasks-vision@0.10.17':
        resolution:
            {
                integrity: sha512-CZWV/q6TTe8ta61cZXjfnnHsfWIdFhms03M9T7Cnd5y2mdpylJM0rF1qRq+wsQVRMLz1OYPVEBU9ph2Bx8cxrg==
            }

    '@monogrid/gainmap-js@3.1.0':
        resolution:
            {
                integrity: sha512-Obb0/gEd/HReTlg8ttaYk+0m62gQJmCblMOjHSMHRrBP2zdfKMHLCRbh/6ex9fSUJMKdjjIEiohwkbGD3wj2Nw==
            }
        peerDependencies:
            three: '>= 0.159.0'

    '@noble/curves@1.9.7':
        resolution:
            {
                integrity: sha512-gbKGcRUYIjA3/zCCNaWDciTMFI0dCkvou3TL8Zmy5Nc7sJ47a0jtOeZoTaMxkuqRo9cRhjOdZJXegxYE5FN/xw==
            }
        engines: { node: ^14.21.3 || >=16 }

    '@noble/hashes@1.8.0':
        resolution:
            {
                integrity: sha512-jCs9ldd7NwzpgXDIf6P3+NrHh9/sD6CQdxHyjQI+h/6rDNo88ypBxxz45UDuZHz9r3tNz7N/VInSVoVdtXEI4A==
            }
        engines: { node: ^14.21.3 || >=16 }

    '@nodelib/fs.scandir@2.1.5':
        resolution:
            {
                integrity: sha512-vq24Bq3ym5HEQm2NKCr3yXDwjc7vTsEThRDnkp2DK9p1uqLR+DHurm/NOTo0KG7HYHU7eppKZj3MyqYuMBf62g==
            }
        engines: { node: '>= 8' }

    '@nodelib/fs.stat@2.0.5':
        resolution:
            {
                integrity: sha512-RkhPPp2zrqDAQA/2jNhnztcPAlv64XdhIp7a7454A5ovI7Bukxgt7MX7udwAu3zg1DcpPU0rz3VV1SeaqvY4+A==
            }
        engines: { node: '>= 8' }

    '@nodelib/fs.walk@1.2.8':
        resolution:
            {
                integrity: sha512-oGB+UxlgWcgQkgwo8GcEGwemoTFt3FIO9ababBmaGwXIoBKZ+GTy0pP185beGg7Llih/NSHSV2XAs1lnznocSg==
            }
        engines: { node: '>= 8' }

    '@pkgjs/parseargs@0.11.0':
        resolution:
            {
                integrity: sha512-+1VkjdD0QBLPodGrJUeqarH8VAIvQODIbwh9XpP5Syisf7YoQgsJKPNFoqqLQlu+VQ/tVSshMR6loPMn8U+dPg==
            }
        engines: { node: '>=14' }

    '@pmndrs/cannon-worker-api@2.4.0':
        resolution:
            {
                integrity: sha512-oJA1Bboc+WObksRaGDKJG0Wna9Q75xi1MdXVAZ9qXzBOyPsadmAnrmiKOEF0R8v/4zsuJElvscNZmyo3msbZjA==
            }
        peerDependencies:
            three: '>=0.139'

    '@radix-ui/number@1.1.1':
        resolution:
            {
                integrity: sha512-MkKCwxlXTgz6CFoJx3pCwn07GKp36+aZyu/u2Ln2VrA5DcdyCZkASEDBTd8x5whTQQL5CiYf4prXKLcgQdv29g==
            }

    '@radix-ui/primitive@1.1.3':
        resolution:
            {
                integrity: sha512-JTF99U/6XIjCBo0wqkU5sK10glYe27MRRsfwoiq5zzOEZLHU3A3KCMa5X/azekYRCJ0HlwI0crAXS/5dEHTzDg==
            }

    '@radix-ui/react-accordion@1.2.12':
        resolution:
            {
                integrity: sha512-T4nygeh9YE9dLRPhAHSeOZi7HBXo+0kYIPJXayZfvWOWA0+n3dESrZbjfDPUABkUNym6Hd+f2IR113To8D2GPA==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-alert-dialog@1.1.15':
        resolution:
            {
                integrity: sha512-oTVLkEw5GpdRe29BqJ0LSDFWI3qu0vR1M0mUkOQWDIUnY/QIkLpgDMWuKxP94c2NAC2LGcgVhG1ImF3jkZ5wXw==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-arrow@1.1.7':
        resolution:
            {
                integrity: sha512-F+M1tLhO+mlQaOWspE8Wstg+z6PwxwRd8oQ8IXceWz92kfAmalTRf0EjrouQeo7QssEPfCn05B4Ihs1K9WQ/7w==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-aspect-ratio@1.1.7':
        resolution:
            {
                integrity: sha512-Yq6lvO9HQyPwev1onK1daHCHqXVLzPhSVjmsNjCa2Zcxy2f7uJD2itDtxknv6FzAKCwD1qQkeVDmX/cev13n/g==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-avatar@1.1.10':
        resolution:
            {
                integrity: sha512-V8piFfWapM5OmNCXTzVQY+E1rDa53zY+MQ4Y7356v4fFz6vqCyUtIz2rUD44ZEdwg78/jKmMJHj07+C/Z/rcog==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-checkbox@1.3.3':
        resolution:
            {
                integrity: sha512-wBbpv+NQftHDdG86Qc0pIyXk5IR3tM8Vd0nWLKDcX8nNn4nXFOFwsKuqw2okA/1D/mpaAkmuyndrPJTYDNZtFw==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-collapsible@1.1.12':
        resolution:
            {
                integrity: sha512-Uu+mSh4agx2ib1uIGPP4/CKNULyajb3p92LsVXmH2EHVMTfZWpll88XJ0j4W0z3f8NK1eYl1+Mf/szHPmcHzyA==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-collection@1.1.7':
        resolution:
            {
                integrity: sha512-Fh9rGN0MoI4ZFUNyfFVNU4y9LUz93u9/0K+yLgA2bwRojxM8JU1DyvvMBabnZPBgMWREAJvU2jjVzq+LrFUglw==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-compose-refs@1.1.2':
        resolution:
            {
                integrity: sha512-z4eqJvfiNnFMHIIvXP3CY57y2WJs5g2v3X0zm9mEJkrkNv4rDxu+sg9Jh8EkXyeqBkB7SOcboo9dMVqhyrACIg==
            }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true

    '@radix-ui/react-context-menu@2.2.16':
        resolution:
            {
                integrity: sha512-O8morBEW+HsVG28gYDZPTrT9UUovQUlJue5YO836tiTJhuIWBm/zQHc7j388sHWtdH/xUZurK9olD2+pcqx5ww==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-context@1.1.2':
        resolution:
            {
                integrity: sha512-jCi/QKUM2r1Ju5a3J64TH2A5SpKAgh0LpknyqdQ4m6DCV0xJ2HG1xARRwNGPQfi1SLdLWZ1OJz6F4OMBBNiGJA==
            }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true

    '@radix-ui/react-dialog@1.1.15':
        resolution:
            {
                integrity: sha512-TCglVRtzlffRNxRMEyR36DGBLJpeusFcgMVD9PZEzAKnUs1lKCgX5u9BmC2Yg+LL9MgZDugFFs1Vl+Jp4t/PGw==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-direction@1.1.1':
        resolution:
            {
                integrity: sha512-1UEWRX6jnOA2y4H5WczZ44gOOjTEmlqv1uNW4GAJEO5+bauCBhv8snY65Iw5/VOS/ghKN9gr2KjnLKxrsvoMVw==
            }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true

    '@radix-ui/react-dismissable-layer@1.1.11':
        resolution:
            {
                integrity: sha512-Nqcp+t5cTB8BinFkZgXiMJniQH0PsUt2k51FUhbdfeKvc4ACcG2uQniY/8+h1Yv6Kza4Q7lD7PQV0z0oicE0Mg==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-dropdown-menu@2.1.16':
        resolution:
            {
                integrity: sha512-1PLGQEynI/3OX/ftV54COn+3Sud/Mn8vALg2rWnBLnRaGtJDduNW/22XjlGgPdpcIbiQxjKtb7BkcjP00nqfJw==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-focus-guards@1.1.3':
        resolution:
            {
                integrity: sha512-0rFg/Rj2Q62NCm62jZw0QX7a3sz6QCQU0LpZdNrJX8byRGaGVTqbrW9jAoIAHyMQqsNpeZ81YgSizOt5WXq0Pw==
            }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true

    '@radix-ui/react-focus-scope@1.1.7':
        resolution:
            {
                integrity: sha512-t2ODlkXBQyn7jkl6TNaw/MtVEVvIGelJDCG41Okq/KwUsJBwQ4XVZsHAVUkK4mBv3ewiAS3PGuUWuY2BoK4ZUw==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-hover-card@1.1.15':
        resolution:
            {
                integrity: sha512-qgTkjNT1CfKMoP0rcasmlH2r1DAiYicWsDsufxl940sT2wHNEWWv6FMWIQXWhVdmC1d/HYfbhQx60KYyAtKxjg==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-id@1.1.1':
        resolution:
            {
                integrity: sha512-kGkGegYIdQsOb4XjsfM97rXsiHaBwco+hFI66oO4s9LU+PLAC5oJ7khdOVFxkhsmlbpUqDAvXw11CluXP+jkHg==
            }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true

    '@radix-ui/react-label@2.1.7':
        resolution:
            {
                integrity: sha512-YT1GqPSL8kJn20djelMX7/cTRp/Y9w5IZHvfxQTVHrOqa2yMl7i/UfMqKRU5V7mEyKTrUVgJXhNQPVCG8PBLoQ==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-menu@2.1.16':
        resolution:
            {
                integrity: sha512-72F2T+PLlphrqLcAotYPp0uJMr5SjP5SL01wfEspJbru5Zs5vQaSHb4VB3ZMJPimgHHCHG7gMOeOB9H3Hdmtxg==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-menubar@1.1.16':
        resolution:
            {
                integrity: sha512-EB1FktTz5xRRi2Er974AUQZWg2yVBb1yjip38/lgwtCVRd3a+maUoGHN/xs9Yv8SY8QwbSEb+YrxGadVWbEutA==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-navigation-menu@1.2.14':
        resolution:
            {
                integrity: sha512-YB9mTFQvCOAQMHU+C/jVl96WmuWeltyUEpRJJky51huhds5W2FQr1J8D/16sQlf0ozxkPK8uF3niQMdUwZPv5w==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-popover@1.1.15':
        resolution:
            {
                integrity: sha512-kr0X2+6Yy/vJzLYJUPCZEc8SfQcf+1COFoAqauJm74umQhta9M7lNJHP7QQS3vkvcGLQUbWpMzwrXYwrYztHKA==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-popper@1.2.8':
        resolution:
            {
                integrity: sha512-0NJQ4LFFUuWkE7Oxf0htBKS6zLkkjBH+hM1uk7Ng705ReR8m/uelduy1DBo0PyBXPKVnBA6YBlU94MBGXrSBCw==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-portal@1.1.9':
        resolution:
            {
                integrity: sha512-bpIxvq03if6UNwXZ+HTK71JLh4APvnXntDc6XOX8UVq4XQOVl7lwok0AvIl+b8zgCw3fSaVTZMpAPPagXbKmHQ==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-presence@1.1.5':
        resolution:
            {
                integrity: sha512-/jfEwNDdQVBCNvjkGit4h6pMOzq8bHkopq458dPt2lMjx+eBQUohZNG9A7DtO/O5ukSbxuaNGXMjHicgwy6rQQ==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-primitive@2.1.3':
        resolution:
            {
                integrity: sha512-m9gTwRkhy2lvCPe6QJp4d3G1TYEUHn/FzJUtq9MjH46an1wJU+GdoGC5VLof8RX8Ft/DlpshApkhswDLZzHIcQ==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-progress@1.1.7':
        resolution:
            {
                integrity: sha512-vPdg/tF6YC/ynuBIJlk1mm7Le0VgW6ub6J2UWnTQ7/D23KXcPI1qy+0vBkgKgd38RCMJavBXpB83HPNFMTb0Fg==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-radio-group@1.3.8':
        resolution:
            {
                integrity: sha512-VBKYIYImA5zsxACdisNQ3BjCBfmbGH3kQlnFVqlWU4tXwjy7cGX8ta80BcrO+WJXIn5iBylEH3K6ZTlee//lgQ==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-roving-focus@1.1.11':
        resolution:
            {
                integrity: sha512-7A6S9jSgm/S+7MdtNDSb+IU859vQqJ/QAtcYQcfFC6W8RS4IxIZDldLR0xqCFZ6DCyrQLjLPsxtTNch5jVA4lA==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-scroll-area@1.2.10':
        resolution:
            {
                integrity: sha512-tAXIa1g3sM5CGpVT0uIbUx/U3Gs5N8T52IICuCtObaos1S8fzsrPXG5WObkQN3S6NVl6wKgPhAIiBGbWnvc97A==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-select@2.2.6':
        resolution:
            {
                integrity: sha512-I30RydO+bnn2PQztvo25tswPH+wFBjehVGtmagkU78yMdwTwVf12wnAOF+AeP8S2N8xD+5UPbGhkUfPyvT+mwQ==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-separator@1.1.7':
        resolution:
            {
                integrity: sha512-0HEb8R9E8A+jZjvmFCy/J4xhbXy3TV+9XSnGJ3KvTtjlIUy/YQ/p6UYZvi7YbeoeXdyU9+Y3scizK6hkY37baA==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-slider@1.3.6':
        resolution:
            {
                integrity: sha512-JPYb1GuM1bxfjMRlNLE+BcmBC8onfCi60Blk7OBqi2MLTFdS+8401U4uFjnwkOr49BLmXxLC6JHkvAsx5OJvHw==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-slot@1.2.3':
        resolution:
            {
                integrity: sha512-aeNmHnBxbi2St0au6VBVC7JXFlhLlOnvIIlePNniyUNAClzmtAUEY8/pBiK3iHjufOlwA+c20/8jngo7xcrg8A==
            }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true

    '@radix-ui/react-switch@1.2.6':
        resolution:
            {
                integrity: sha512-bByzr1+ep1zk4VubeEVViV592vu2lHE2BZY5OnzehZqOOgogN80+mNtCqPkhn2gklJqOpxWgPoYTSnhBCqpOXQ==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-tabs@1.1.13':
        resolution:
            {
                integrity: sha512-7xdcatg7/U+7+Udyoj2zodtI9H/IIopqo+YOIcZOq1nJwXWBZ9p8xiu5llXlekDbZkca79a/fozEYQXIA4sW6A==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-toggle-group@1.1.11':
        resolution:
            {
                integrity: sha512-5umnS0T8JQzQT6HbPyO7Hh9dgd82NmS36DQr+X/YJ9ctFNCiiQd6IJAYYZ33LUwm8M+taCz5t2ui29fHZc4Y6Q==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-toggle@1.1.10':
        resolution:
            {
                integrity: sha512-lS1odchhFTeZv3xwHH31YPObmJn8gOg7Lq12inrr0+BH/l3Tsq32VfjqH1oh80ARM3mlkfMic15n0kg4sD1poQ==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-tooltip@1.2.8':
        resolution:
            {
                integrity: sha512-tY7sVt1yL9ozIxvmbtN5qtmH2krXcBCfjEiCgKGLqunJHvgvZG2Pcl2oQ3kbcZARb1BGEHdkLzcYGO8ynVlieg==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/react-use-callback-ref@1.1.1':
        resolution:
            {
                integrity: sha512-FkBMwD+qbGQeMu1cOHnuGB6x4yzPjho8ap5WtbEJ26umhgqVXbhekKUQO+hZEL1vU92a3wHwdp0HAcqAUF5iDg==
            }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true

    '@radix-ui/react-use-controllable-state@1.2.2':
        resolution:
            {
                integrity: sha512-BjasUjixPFdS+NKkypcyyN5Pmg83Olst0+c6vGov0diwTEo6mgdqVR6hxcEgFuh4QrAs7Rc+9KuGJ9TVCj0Zzg==
            }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true

    '@radix-ui/react-use-effect-event@0.0.2':
        resolution:
            {
                integrity: sha512-Qp8WbZOBe+blgpuUT+lw2xheLP8q0oatc9UpmiemEICxGvFLYmHm9QowVZGHtJlGbS6A6yJ3iViad/2cVjnOiA==
            }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true

    '@radix-ui/react-use-escape-keydown@1.1.1':
        resolution:
            {
                integrity: sha512-Il0+boE7w/XebUHyBjroE+DbByORGR9KKmITzbR7MyQ4akpORYP/ZmbhAr0DG7RmmBqoOnZdy2QlvajJ2QA59g==
            }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true

    '@radix-ui/react-use-is-hydrated@0.1.0':
        resolution:
            {
                integrity: sha512-U+UORVEq+cTnRIaostJv9AGdV3G6Y+zbVd+12e18jQ5A3c0xL03IhnHuiU4UV69wolOQp5GfR58NW/EgdQhwOA==
            }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true

    '@radix-ui/react-use-layout-effect@1.1.1':
        resolution:
            {
                integrity: sha512-RbJRS4UWQFkzHTTwVymMTUv8EqYhOp8dOOviLj2ugtTiXRaRQS7GLGxZTLL1jWhMeoSCf5zmcZkqTl9IiYfXcQ==
            }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true

    '@radix-ui/react-use-previous@1.1.1':
        resolution:
            {
                integrity: sha512-2dHfToCj/pzca2Ck724OZ5L0EVrr3eHRNsG/b3xQJLA2hZpVCS99bLAX+hm1IHXDEnzU6by5z/5MIY794/a8NQ==
            }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true

    '@radix-ui/react-use-rect@1.1.1':
        resolution:
            {
                integrity: sha512-QTYuDesS0VtuHNNvMh+CjlKJ4LJickCMUAqjlE3+j8w+RlRpwyX3apEQKGFzbZGdo7XNG1tXa+bQqIE7HIXT2w==
            }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true

    '@radix-ui/react-use-size@1.1.1':
        resolution:
            {
                integrity: sha512-ewrXRDTAqAXlkl6t/fkXWNAhFX9I+CkKlw6zjEwk86RSPKwZr3xpBRso655aqYafwtnbpHLj6toFzmd6xdVptQ==
            }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true

    '@radix-ui/react-visually-hidden@1.2.3':
        resolution:
            {
                integrity: sha512-pzJq12tEaaIhqjbzpCuv/OypJY/BPavOofm+dbab+MHLajy277+1lLm6JFcGgF5eskJ6mquGirhXY2GD/8u8Ug==
            }
        peerDependencies:
            '@types/react': '*'
            '@types/react-dom': '*'
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true
            '@types/react-dom':
                optional: true

    '@radix-ui/rect@1.1.1':
        resolution:
            {
                integrity: sha512-HPwpGIzkl28mWyZqG52jiqDJ12waP11Pa1lGoiyUkIEuMLBP0oeK/C89esbXrxsky5we7dfd8U58nm0SgAWpVw==
            }

    '@react-three/cannon@6.6.0':
        resolution:
            {
                integrity: sha512-lP9rJoVHQi0w+dYF8FJAm2xr5eLfNEckb04j72kjqndUkuOPr26N4rSBhQbHl5b5N3tEnhQaIMungAvHkcY8/A==
            }
        peerDependencies:
            '@react-three/fiber': '>=8'
            react: '>=18'
            three: '>=0.139'

    '@react-three/drei@10.0.8':
        resolution:
            {
                integrity: sha512-ZE9LgtzMWutpfwrUYFM//kdInzkzWT/3keHdqNQ2s/+IBEuNHPII4QJTS6e8Ko2uYdL/mPeCRFcmEKFUNFrhBQ==
            }
        peerDependencies:
            '@react-three/fiber': ^9.0.0
            react: ^19
            react-dom: ^19
            three: '>=0.159'
        peerDependenciesMeta:
            react-dom:
                optional: true

    '@react-three/eslint-plugin@0.1.2':
        resolution:
            {
                integrity: sha512-jenNIhvt+/1fb3NDr3M5vwF06U9euX6kI2SuAFltVKdQP2nzUPY+zdati2Rd67ewAKn0jfljQWT7DWIe6siChg==
            }

    '@react-three/fiber@9.1.4':
        resolution:
            {
                integrity: sha512-Ugzs6n6YNORSa4hRZH1CKTd5DLTzwOvYjze+EZWS8iVDyeNQETnLzuke+MMEuXTqM8eAV/gyWgd27t/GR41oGA==
            }
        peerDependencies:
            expo: '>=43.0'
            expo-asset: '>=8.4'
            expo-file-system: '>=11.0'
            expo-gl: '>=11.0'
            react: ^19.0.0
            react-dom: ^19.0.0
            react-native: '>=0.78'
            three: '>=0.156'
        peerDependenciesMeta:
            expo:
                optional: true
            expo-asset:
                optional: true
            expo-file-system:
                optional: true
            expo-gl:
                optional: true
            react-dom:
                optional: true
            react-native:
                optional: true

    '@rolldown/pluginutils@1.0.0-beta.27':
        resolution:
            {
                integrity: sha512-+d0F4MKMCbeVUJwG96uQ4SgAznZNSq93I3V+9NHA4OpvqG8mRCpGdKmK8l/dl02h2CCDHwW2FqilnTyDcAnqjA==
            }

    '@rollup/rollup-android-arm-eabi@4.52.5':
        resolution:
            {
                integrity: sha512-8c1vW4ocv3UOMp9K+gToY5zL2XiiVw3k7f1ksf4yO1FlDFQ1C2u72iACFnSOceJFsWskc2WZNqeRhFRPzv+wtQ==
            }
        cpu: [arm]
        os: [android]

    '@rollup/rollup-android-arm64@4.52.5':
        resolution:
            {
                integrity: sha512-mQGfsIEFcu21mvqkEKKu2dYmtuSZOBMmAl5CFlPGLY94Vlcm+zWApK7F/eocsNzp8tKmbeBP8yXyAbx0XHsFNA==
            }
        cpu: [arm64]
        os: [android]

    '@rollup/rollup-darwin-arm64@4.52.5':
        resolution:
            {
                integrity: sha512-takF3CR71mCAGA+v794QUZ0b6ZSrgJkArC+gUiG6LB6TQty9T0Mqh3m2ImRBOxS2IeYBo4lKWIieSvnEk2OQWA==
            }
        cpu: [arm64]
        os: [darwin]

    '@rollup/rollup-darwin-x64@4.52.5':
        resolution:
            {
                integrity: sha512-W901Pla8Ya95WpxDn//VF9K9u2JbocwV/v75TE0YIHNTbhqUTv9w4VuQ9MaWlNOkkEfFwkdNhXgcLqPSmHy0fA==
            }
        cpu: [x64]
        os: [darwin]

    '@rollup/rollup-freebsd-arm64@4.52.5':
        resolution:
            {
                integrity: sha512-QofO7i7JycsYOWxe0GFqhLmF6l1TqBswJMvICnRUjqCx8b47MTo46W8AoeQwiokAx3zVryVnxtBMcGcnX12LvA==
            }
        cpu: [arm64]
        os: [freebsd]

    '@rollup/rollup-freebsd-x64@4.52.5':
        resolution:
            {
                integrity: sha512-jr21b/99ew8ujZubPo9skbrItHEIE50WdV86cdSoRkKtmWa+DDr6fu2c/xyRT0F/WazZpam6kk7IHBerSL7LDQ==
            }
        cpu: [x64]
        os: [freebsd]

    '@rollup/rollup-linux-arm-gnueabihf@4.52.5':
        resolution:
            {
                integrity: sha512-PsNAbcyv9CcecAUagQefwX8fQn9LQ4nZkpDboBOttmyffnInRy8R8dSg6hxxl2Re5QhHBf6FYIDhIj5v982ATQ==
            }
        cpu: [arm]
        os: [linux]

    '@rollup/rollup-linux-arm-musleabihf@4.52.5':
        resolution:
            {
                integrity: sha512-Fw4tysRutyQc/wwkmcyoqFtJhh0u31K+Q6jYjeicsGJJ7bbEq8LwPWV/w0cnzOqR2m694/Af6hpFayLJZkG2VQ==
            }
        cpu: [arm]
        os: [linux]

    '@rollup/rollup-linux-arm64-gnu@4.52.5':
        resolution:
            {
                integrity: sha512-a+3wVnAYdQClOTlyapKmyI6BLPAFYs0JM8HRpgYZQO02rMR09ZcV9LbQB+NL6sljzG38869YqThrRnfPMCDtZg==
            }
        cpu: [arm64]
        os: [linux]

    '@rollup/rollup-linux-arm64-musl@4.52.5':
        resolution:
            {
                integrity: sha512-AvttBOMwO9Pcuuf7m9PkC1PUIKsfaAJ4AYhy944qeTJgQOqJYJ9oVl2nYgY7Rk0mkbsuOpCAYSs6wLYB2Xiw0Q==
            }
        cpu: [arm64]
        os: [linux]

    '@rollup/rollup-linux-loong64-gnu@4.52.5':
        resolution:
            {
                integrity: sha512-DkDk8pmXQV2wVrF6oq5tONK6UHLz/XcEVow4JTTerdeV1uqPeHxwcg7aFsfnSm9L+OO8WJsWotKM2JJPMWrQtA==
            }
        cpu: [loong64]
        os: [linux]

    '@rollup/rollup-linux-ppc64-gnu@4.52.5':
        resolution:
            {
                integrity: sha512-W/b9ZN/U9+hPQVvlGwjzi+Wy4xdoH2I8EjaCkMvzpI7wJUs8sWJ03Rq96jRnHkSrcHTpQe8h5Tg3ZzUPGauvAw==
            }
        cpu: [ppc64]
        os: [linux]

    '@rollup/rollup-linux-riscv64-gnu@4.52.5':
        resolution:
            {
                integrity: sha512-sjQLr9BW7R/ZiXnQiWPkErNfLMkkWIoCz7YMn27HldKsADEKa5WYdobaa1hmN6slu9oWQbB6/jFpJ+P2IkVrmw==
            }
        cpu: [riscv64]
        os: [linux]

    '@rollup/rollup-linux-riscv64-musl@4.52.5':
        resolution:
            {
                integrity: sha512-hq3jU/kGyjXWTvAh2awn8oHroCbrPm8JqM7RUpKjalIRWWXE01CQOf/tUNWNHjmbMHg/hmNCwc/Pz3k1T/j/Lg==
            }
        cpu: [riscv64]
        os: [linux]

    '@rollup/rollup-linux-s390x-gnu@4.52.5':
        resolution:
            {
                integrity: sha512-gn8kHOrku8D4NGHMK1Y7NA7INQTRdVOntt1OCYypZPRt6skGbddska44K8iocdpxHTMMNui5oH4elPH4QOLrFQ==
            }
        cpu: [s390x]
        os: [linux]

    '@rollup/rollup-linux-x64-gnu@4.52.5':
        resolution:
            {
                integrity: sha512-hXGLYpdhiNElzN770+H2nlx+jRog8TyynpTVzdlc6bndktjKWyZyiCsuDAlpd+j+W+WNqfcyAWz9HxxIGfZm1Q==
            }
        cpu: [x64]
        os: [linux]

    '@rollup/rollup-linux-x64-musl@4.52.5':
        resolution:
            {
                integrity: sha512-arCGIcuNKjBoKAXD+y7XomR9gY6Mw7HnFBv5Rw7wQRvwYLR7gBAgV7Mb2QTyjXfTveBNFAtPt46/36vV9STLNg==
            }
        cpu: [x64]
        os: [linux]

    '@rollup/rollup-openharmony-arm64@4.52.5':
        resolution:
            {
                integrity: sha512-QoFqB6+/9Rly/RiPjaomPLmR/13cgkIGfA40LHly9zcH1S0bN2HVFYk3a1eAyHQyjs3ZJYlXvIGtcCs5tko9Cw==
            }
        cpu: [arm64]
        os: [openharmony]

    '@rollup/rollup-win32-arm64-msvc@4.52.5':
        resolution:
            {
                integrity: sha512-w0cDWVR6MlTstla1cIfOGyl8+qb93FlAVutcor14Gf5Md5ap5ySfQ7R9S/NjNaMLSFdUnKGEasmVnu3lCMqB7w==
            }
        cpu: [arm64]
        os: [win32]

    '@rollup/rollup-win32-ia32-msvc@4.52.5':
        resolution:
            {
                integrity: sha512-Aufdpzp7DpOTULJCuvzqcItSGDH73pF3ko/f+ckJhxQyHtp67rHw3HMNxoIdDMUITJESNE6a8uh4Lo4SLouOUg==
            }
        cpu: [ia32]
        os: [win32]

    '@rollup/rollup-win32-x64-gnu@4.52.5':
        resolution:
            {
                integrity: sha512-UGBUGPFp1vkj6p8wCRraqNhqwX/4kNQPS57BCFc8wYh0g94iVIW33wJtQAx3G7vrjjNtRaxiMUylM0ktp/TRSQ==
            }
        cpu: [x64]
        os: [win32]

    '@rollup/rollup-win32-x64-msvc@4.52.5':
        resolution:
            {
                integrity: sha512-TAcgQh2sSkykPRWLrdyy2AiceMckNf5loITqXxFI5VuQjS5tSuw3WlwdN8qv8vzjLAUTvYaH/mVjSFpbkFbpTg==
            }
        cpu: [x64]
        os: [win32]

    '@scure/base@1.2.6':
        resolution:
            {
                integrity: sha512-g/nm5FgUa//MCj1gV09zTJTaM6KBAHqLN907YVQqf7zC49+DcO4B1so4ZX07Ef10Twr6nuqYEH9GEggFXA4Fmg==
            }

    '@scure/bip32@1.7.0':
        resolution:
            {
                integrity: sha512-E4FFX/N3f4B80AKWp5dP6ow+flD1LQZo/w8UnLGYZO674jS6YnYeepycOOksv+vLPSpgN35wgKgy+ybfTb2SMw==
            }

    '@scure/bip39@1.6.0':
        resolution:
            {
                integrity: sha512-+lF0BbLiJNwVlev4eKelw1WWLaiKXw7sSl8T6FvBlWkdX+94aGJ4o8XjUdlyhTCjd8c+B3KT3JfS8P0bLRNU6A==
            }

    '@tailwindcss/container-queries@0.1.1':
        resolution:
            {
                integrity: sha512-p18dswChx6WnTSaJCSGx6lTmrGzNNvm2FtXmiO6AuA1V4U5REyoqwmT6kgAsIMdjo07QdAfYXHJ4hnMtfHzWgA==
            }
        peerDependencies:
            tailwindcss: '>=3.2.0'

    '@tailwindcss/typography@0.5.10':
        resolution:
            {
                integrity: sha512-Pe8BuPJQJd3FfRnm6H0ulKIGoMEQS+Vq01R6M5aCrFB/ccR/shT+0kXLjouGC1gFLm9hopTFN+DMP0pfwRWzPw==
            }
        peerDependencies:
            tailwindcss: '>=3.0.0 || insiders'

    '@tanstack/eslint-plugin-router@1.115.0':
        resolution:
            {
                integrity: sha512-vwKP9NjzAQ2nU3qADDoTSTxD1vNduLcK0312AWkXkicCWUZQZJtmRuZXPk9cEfuzDD2BAJCIUmlaF1K0vq4oRw==
            }
        peerDependencies:
            eslint: ^8.57.0 || ^9.0.0

    '@tanstack/history@1.131.2':
        resolution:
            {
                integrity: sha512-cs1WKawpXIe+vSTeiZUuSBy8JFjEuDgdMKZFRLKwQysKo8y2q6Q1HvS74Yw+m5IhOW1nTZooa6rlgdfXcgFAaw==
            }
        engines: { node: '>=12' }

    '@tanstack/query-core@5.90.5':
        resolution:
            {
                integrity: sha512-wLamYp7FaDq6ZnNehypKI5fNvxHPfTYylE0m/ZpuuzJfJqhR5Pxg9gvGBHZx4n7J+V5Rg5mZxHHTlv25Zt5u+w==
            }

    '@tanstack/react-query@5.90.5':
        resolution:
            {
                integrity: sha512-pN+8UWpxZkEJ/Rnnj2v2Sxpx1WFlaa9L6a4UO89p6tTQbeo+m0MS8oYDjbggrR8QcTyjKoYWKS3xJQGr3ExT8Q==
            }
        peerDependencies:
            react: ^18 || ^19

    '@tanstack/react-router@1.131.50':
        resolution:
            {
                integrity: sha512-WNW9x/v9VeSCaeK6Wq0z0420rV5aRwRaC7klysxiAcegFhfyZp8lhIwwPZQ7hYcCWinCxKKFG/4ihA1I2jKcbQ==
            }
        engines: { node: '>=12' }
        peerDependencies:
            react: '>=18.0.0 || >=19.0.0'
            react-dom: '>=18.0.0 || >=19.0.0'

    '@tanstack/react-store@0.7.7':
        resolution:
            {
                integrity: sha512-qqT0ufegFRDGSof9D/VqaZgjNgp4tRPHZIJq2+QIHkMUtHjaJ0lYrrXjeIUJvjnTbgPfSD1XgOMEt0lmANn6Zg==
            }
        peerDependencies:
            react: ^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0
            react-dom: ^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0

    '@tanstack/router-core@1.131.50':
        resolution:
            {
                integrity: sha512-eojd4JZ5ziUhGEmXZ4CaVX5mQdiTMiz56Sp8ZQ6r7deb55Q+5G4JQDkeuXpI7HMAvzr+4qlsFeLaDRXXjXyOqQ==
            }
        engines: { node: '>=12' }

    '@tanstack/store@0.7.7':
        resolution:
            {
                integrity: sha512-xa6pTan1bcaqYDS9BDpSiS63qa6EoDkPN9RsRaxHuDdVDNntzq3xNwR5YKTU/V3SkSyC9T4YVOPh2zRQN0nhIQ==
            }

    '@tweenjs/tween.js@23.1.3':
        resolution:
            {
                integrity: sha512-vJmvvwFxYuGnF2axRtPYocag6Clbb5YS7kLL+SO/TeVFzHqDIWrNKYtcsPMibjDx9O+bu+psAy9NKfWklassUA==
            }

    '@types/babel__core@7.20.5':
        resolution:
            {
                integrity: sha512-qoQprZvz5wQFJwMDqeseRXWv3rqMvhgpbXFfVyWhbx9X47POIA6i/+dXefEmZKoAgOaTdaIgNSMqMIU61yRyzA==
            }

    '@types/babel__generator@7.27.0':
        resolution:
            {
                integrity: sha512-ufFd2Xi92OAVPYsy+P4n7/U7e68fex0+Ee8gSG9KX7eo084CWiQ4sdxktvdl0bOPupXtVJPY19zk6EwWqUQ8lg==
            }

    '@types/babel__template@7.4.4':
        resolution:
            {
                integrity: sha512-h/NUaSyG5EyxBIp8YRxo4RMe2/qQgvyowRwVMzhYhBCONbW8PUsg4lkFMrhgZhUe5z3L3MiLDuvyJ/CaPa2A8A==
            }

    '@types/babel__traverse@7.28.0':
        resolution:
            {
                integrity: sha512-8PvcXf70gTDZBgt9ptxJ8elBeBjcLOAcOtoO/mPJjtji1+CdGbHgm77om1GrsPxsiE+uXIpNSK64UYaIwQXd4Q==
            }

    '@types/d3-array@3.2.2':
        resolution:
            {
                integrity: sha512-hOLWVbm7uRza0BYXpIIW5pxfrKe0W+D5lrFiAEYR+pb6w3N2SwSMaJbXdUfSEv+dT4MfHBLtn5js0LAWaO6otw==
            }

    '@types/d3-color@3.1.3':
        resolution:
            {
                integrity: sha512-iO90scth9WAbmgv7ogoq57O9YpKmFBbmoEoCHDB2xMBY0+/KVrqAaCDyCE16dUspeOvIxFFRI+0sEtqDqy2b4A==
            }

    '@types/d3-ease@3.0.2':
        resolution:
            {
                integrity: sha512-NcV1JjO5oDzoK26oMzbILE6HW7uVXOHLQvHshBUW4UMdZGfiY6v5BeQwh9a9tCzv+CeefZQHJt5SRgK154RtiA==
            }

    '@types/d3-interpolate@3.0.4':
        resolution:
            {
                integrity: sha512-mgLPETlrpVV1YRJIglr4Ez47g7Yxjl1lj7YKsiMCb27VJH9W8NVM6Bb9d8kkpG/uAQS5AmbA48q2IAolKKo1MA==
            }

    '@types/d3-path@3.1.1':
        resolution:
            {
                integrity: sha512-VMZBYyQvbGmWyWVea0EHs/BwLgxc+MKi1zLDCONksozI4YJMcTt8ZEuIR4Sb1MMTE8MMW49v0IwI5+b7RmfWlg==
            }

    '@types/d3-scale@4.0.9':
        resolution:
            {
                integrity: sha512-dLmtwB8zkAeO/juAMfnV+sItKjlsw2lKdZVVy6LRr0cBmegxSABiLEpGVmSJJ8O08i4+sGR6qQtb6WtuwJdvVw==
            }

    '@types/d3-shape@3.1.7':
        resolution:
            {
                integrity: sha512-VLvUQ33C+3J+8p+Daf+nYSOsjB4GXp19/S/aGo60m9h1v6XaxjiT82lKVWJCfzhtuZ3yD7i/TPeC/fuKLLOSmg==
            }

    '@types/d3-time@3.0.4':
        resolution:
            {
                integrity: sha512-yuzZug1nkAAaBlBBikKZTgzCeA+k1uy4ZFwWANOfKw5z5LRhV0gNA7gNkKm7HoK+HRN0wX3EkxGk0fpbWhmB7g==
            }

    '@types/d3-timer@3.0.2':
        resolution:
            {
                integrity: sha512-Ps3T8E8dZDam6fUyNiMkekK3XUsaUEik+idO9/YjPtfj2qruF8tFBXS7XhtE4iIXBLxhmLjP3SXpLhVf21I9Lw==
            }

    '@types/draco3d@1.4.10':
        resolution:
            {
                integrity: sha512-AX22jp8Y7wwaBgAixaSvkoG4M/+PlAcm3Qs4OW8yT9DM4xUpWKeFhLueTAyZF39pviAdcDdeJoACapiAceqNcw==
            }

    '@types/estree@1.0.8':
        resolution:
            {
                integrity: sha512-dWHzHa2WqEXI/O1E9OjrocMTKJl2mSrEolh1Iomrv6U+JuNwaHXsXx9bLu5gG7BUWFIN0skIQJQ/L1rIex4X6w==
            }

    '@types/js-cookie@2.2.7':
        resolution:
            {
                integrity: sha512-aLkWa0C0vO5b4Sr798E26QgOkss68Un0bLjs7u9qxzPT5CG+8DuNTffWES58YzJs3hrVAOs1wonycqEBqNJubA==
            }

    '@types/json-schema@7.0.15':
        resolution:
            {
                integrity: sha512-5+fP8P8MFNC+AyZCDxrB2pkZFPGzqQWUzpSeuuVLvm8VMcorNYavBqoFcxK8bQz4Qsbn4oUEEem4wDLfcysGHA==
            }

    '@types/node@20.19.24':
        resolution:
            {
                integrity: sha512-FE5u0ezmi6y9OZEzlJfg37mqqf6ZDSF2V/NLjUyGrR9uTZ7Sb9F7bLNZ03S4XVUNRWGA7Ck4c1kK+YnuWjl+DA==
            }

    '@types/offscreencanvas@2019.7.3':
        resolution:
            {
                integrity: sha512-ieXiYmgSRXUDeOntE1InxjWyvEelZGP63M+cGuquuRLuIKKT1osnkXjxev9B7d1nXSug5vpunx+gNlbVxMlC9A==
            }

    '@types/react-dom@19.1.11':
        resolution:
            {
                integrity: sha512-3BKc/yGdNTYQVVw4idqHtSOcFsgGuBbMveKCOgF8wQ5QtrYOc3jDIlzg3jef04zcXFIHLelyGlj0T+BJ8+KN+w==
            }
        peerDependencies:
            '@types/react': ^19.0.0

    '@types/react-reconciler@0.28.9':
        resolution:
            {
                integrity: sha512-HHM3nxyUZ3zAylX8ZEyrDNd2XZOnQ0D5XfunJF5FLQnZbHHYq4UWvW1QfelQNXv1ICNkwYhfxjwfnqivYB6bFg==
            }
        peerDependencies:
            '@types/react': '*'

    '@types/react@19.1.17':
        resolution:
            {
                integrity: sha512-Qec1E3mhALmaspIrhWt9jkQMNdw6bReVu64mjvhbhq2NFPftLPVr+l1SZgmw/66WwBNpDh7ao5AT6gF5v41PFA==
            }

    '@types/stats.js@0.17.4':
        resolution:
            {
                integrity: sha512-jIBvWWShCvlBqBNIZt0KAshWpvSjhkwkEu4ZUcASoAvhmrgAUI2t1dXrjSL4xXVLB4FznPrIsX3nKXFl/Dt4vA==
            }

    '@types/three@0.176.0':
        resolution:
            {
                integrity: sha512-FwfPXxCqOtP7EdYMagCFePNKoG1AGBDUEVKtluv2BTVRpSt7b+X27xNsirPCTCqY1pGYsPUzaM3jgWP7dXSxlw==
            }

    '@types/webxr@0.5.24':
        resolution:
            {
                integrity: sha512-h8fgEd/DpoS9CBrjEQXR+dIDraopAEfu4wYVNY2tEPwk60stPWhvZMf4Foo5FakuQ7HFZoa8WceaWFervK2Ovg==
            }

    '@typescript-eslint/eslint-plugin@8.46.2':
        resolution:
            {
                integrity: sha512-ZGBMToy857/NIPaaCucIUQgqueOiq7HeAKkhlvqVV4lm089zUFW6ikRySx2v+cAhKeUCPuWVHeimyk6Dw1iY3w==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }
        peerDependencies:
            '@typescript-eslint/parser': ^8.46.2
            eslint: ^8.57.0 || ^9.0.0
            typescript: '>=4.8.4 <6.0.0'

    '@typescript-eslint/parser@8.46.2':
        resolution:
            {
                integrity: sha512-BnOroVl1SgrPLywqxyqdJ4l3S2MsKVLDVxZvjI1Eoe8ev2r3kGDo+PcMihNmDE+6/KjkTubSJnmqGZZjQSBq/g==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }
        peerDependencies:
            eslint: ^8.57.0 || ^9.0.0
            typescript: '>=4.8.4 <6.0.0'

    '@typescript-eslint/project-service@8.46.2':
        resolution:
            {
                integrity: sha512-PULOLZ9iqwI7hXcmL4fVfIsBi6AN9YxRc0frbvmg8f+4hQAjQ5GYNKK0DIArNo+rOKmR/iBYwkpBmnIwin4wBg==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }
        peerDependencies:
            typescript: '>=4.8.4 <6.0.0'

    '@typescript-eslint/scope-manager@8.46.2':
        resolution:
            {
                integrity: sha512-LF4b/NmGvdWEHD2H4MsHD8ny6JpiVNDzrSZr3CsckEgCbAGZbYM4Cqxvi9L+WqDMT+51Ozy7lt2M+d0JLEuBqA==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }

    '@typescript-eslint/tsconfig-utils@8.46.2':
        resolution:
            {
                integrity: sha512-a7QH6fw4S57+F5y2FIxxSDyi5M4UfGF+Jl1bCGd7+L4KsaUY80GsiF/t0UoRFDHAguKlBaACWJRmdrc6Xfkkag==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }
        peerDependencies:
            typescript: '>=4.8.4 <6.0.0'

    '@typescript-eslint/type-utils@8.46.2':
        resolution:
            {
                integrity: sha512-HbPM4LbaAAt/DjxXaG9yiS9brOOz6fabal4uvUmaUYe6l3K1phQDMQKBRUrr06BQkxkvIZVVHttqiybM9nJsLA==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }
        peerDependencies:
            eslint: ^8.57.0 || ^9.0.0
            typescript: '>=4.8.4 <6.0.0'

    '@typescript-eslint/types@8.46.2':
        resolution:
            {
                integrity: sha512-lNCWCbq7rpg7qDsQrd3D6NyWYu+gkTENkG5IKYhUIcxSb59SQC/hEQ+MrG4sTgBVghTonNWq42bA/d4yYumldQ==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }

    '@typescript-eslint/typescript-estree@8.46.2':
        resolution:
            {
                integrity: sha512-f7rW7LJ2b7Uh2EiQ+7sza6RDZnajbNbemn54Ob6fRwQbgcIn+GWfyuHDHRYgRoZu1P4AayVScrRW+YfbTvPQoQ==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }
        peerDependencies:
            typescript: '>=4.8.4 <6.0.0'

    '@typescript-eslint/utils@8.46.2':
        resolution:
            {
                integrity: sha512-sExxzucx0Tud5tE0XqR0lT0psBQvEpnpiul9XbGUB1QwpWJJAps1O/Z7hJxLGiZLBKMCutjTzDgmd1muEhBnVg==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }
        peerDependencies:
            eslint: ^8.57.0 || ^9.0.0
            typescript: '>=4.8.4 <6.0.0'

    '@typescript-eslint/visitor-keys@8.46.2':
        resolution:
            {
                integrity: sha512-tUFMXI4gxzzMXt4xpGJEsBsTox0XbNQ1y94EwlD/CuZwFcQP79xfQqMhau9HsRc/J0cAPA/HZt1dZPtGn9V/7w==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }

    '@ungap/structured-clone@1.3.0':
        resolution:
            {
                integrity: sha512-WmoN8qaIAo7WTYWbAZuG8PYEhn5fkz7dZrqTBZ7dtt//lL2Gwms1IcnQ5yHqjDfX8Ft5j4YzDM23f87zBfDe9g==
            }

    '@use-gesture/core@10.3.1':
        resolution:
            {
                integrity: sha512-WcINiDt8WjqBdUXye25anHiNxPc0VOrlT8F6LLkU6cycrOGUDyY/yyFmsg3k8i5OLvv25llc0QC45GhR/C8llw==
            }

    '@use-gesture/react@10.3.1':
        resolution:
            {
                integrity: sha512-Yy19y6O2GJq8f7CHf7L0nxL8bf4PZCPaVOCgJrusOeFHY1LvHgYXnmnXg6N5iwAnbgbZCDjo60SiM6IPJi9C5g==
            }
        peerDependencies:
            react: '>= 16.8.0'

    '@vitejs/plugin-react@4.7.0':
        resolution:
            {
                integrity: sha512-gUu9hwfWvvEDBBmgtAowQCojwZmJ5mcLn3aufeCsitijs3+f2NsrPtlAWIR6OPiqljl96GVCUbLe0HyqIpVaoA==
            }
        engines: { node: ^14.18.0 || >=16.0.0 }
        peerDependencies:
            vite: ^4.2.0 || ^5.0.0 || ^6.0.0 || ^7.0.0

    '@webgpu/types@0.1.66':
        resolution:
            {
                integrity: sha512-YA2hLrwLpDsRueNDXIMqN9NTzD6bCDkuXbOSe0heS+f8YE8usA6Gbv1prj81pzVHrbaAma7zObnIC+I6/sXJgA==
            }

    '@xobotyi/scrollbar-width@1.9.5':
        resolution:
            {
                integrity: sha512-N8tkAACJx2ww8vFMneJmaAgmjAG1tnVBZJRLRcx061tmsLRZHSEZSLuGWnwPtunsSLvSqXQ2wfp7Mgqg1I+2dQ==
            }

    acorn-jsx@5.3.2:
        resolution:
            {
                integrity: sha512-rq9s+JNhf0IChjtDXxllJ7g41oZk5SlXtp0LHwyA5cejwn7vKmKp4pPri6YEePv2PU65sAsegbXtIinmDFDXgQ==
            }
        peerDependencies:
            acorn: ^6.0.0 || ^7.0.0 || ^8.0.0

    acorn@8.15.0:
        resolution:
            {
                integrity: sha512-NZyJarBfL7nWwIq+FDL6Zp/yHEhePMNnnJ0y3qfieCrmNvYct8uvtiV41UvlSe6apAfk0fY1FbWx+NwfmpvtTg==
            }
        engines: { node: '>=0.4.0' }
        hasBin: true

    ajv@6.12.6:
        resolution:
            {
                integrity: sha512-j3fVLgvTo527anyYyJOGTYJbG+vnnQYvE0m5mmkc1TK+nxAppkCLMIL0aZ4dblVCNoGShhm+kzE4ZUykBoMg4g==
            }

    ansi-regex@5.0.1:
        resolution:
            {
                integrity: sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==
            }
        engines: { node: '>=8' }

    ansi-regex@6.2.2:
        resolution:
            {
                integrity: sha512-Bq3SmSpyFHaWjPk8If9yc6svM8c56dB5BAtW4Qbw5jHTwwXXcTLoRMkpDJp6VL0XzlWaCHTXrkFURMYmD0sLqg==
            }
        engines: { node: '>=12' }

    ansi-styles@4.3.0:
        resolution:
            {
                integrity: sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg==
            }
        engines: { node: '>=8' }

    ansi-styles@6.2.3:
        resolution:
            {
                integrity: sha512-4Dj6M28JB+oAH8kFkTLUo+a2jwOFkuqb3yucU0CANcRRUbxS0cP0nZYCGjcc3BNXwRIsUVmDGgzawme7zvJHvg==
            }
        engines: { node: '>=12' }

    any-promise@1.3.0:
        resolution:
            {
                integrity: sha512-7UvmKalWRt1wgjL1RrGxoSJW/0QZFIegpeGvZG9kjp8vrRu55XTHbwnqq2GpXm9uLbcuhxm3IqX9OB4MZR1b2A==
            }

    anymatch@3.1.3:
        resolution:
            {
                integrity: sha512-KMReFUr0B4t+D+OBkjR3KYqvocp2XaSzO55UcB6mgQMd3KbcE+mWTyvVV7D/zsdEbNnV6acZUutkiHQXvTr1Rw==
            }
        engines: { node: '>= 8' }

    arg@5.0.2:
        resolution:
            {
                integrity: sha512-PYjyFOLKQ9y57JvQ6QLo8dAgNqswh8M1RMJYdQduT6xbWSgK36P/Z/v+p888pM69jMMfS8Xd8F6I1kQ/I9HUGg==
            }

    argparse@2.0.1:
        resolution:
            {
                integrity: sha512-8+9WqebbFzpX9OR+Wa6O29asIogeRMzcGtAINdpMHHyAg10f05aSFVBbcEqGf/PXw1EjAZ+q2/bEBg3DvurK3Q==
            }

    aria-hidden@1.2.6:
        resolution:
            {
                integrity: sha512-ik3ZgC9dY/lYVVM++OISsaYDeg1tb0VtP5uL3ouh1koGOaUMDPpbFIei4JkFimWUFPn90sbMNMXQAIVOlnYKJA==
            }
        engines: { node: '>=10' }

    array-buffer-byte-length@1.0.2:
        resolution:
            {
                integrity: sha512-LHE+8BuR7RYGDKvnrmcuSq3tDcKv9OFEXQt/HpbZhY7V6h0zlUXutnAD82GiFx9rdieCMjkvtcsPqBwgUl1Iiw==
            }
        engines: { node: '>= 0.4' }

    array-includes@3.1.9:
        resolution:
            {
                integrity: sha512-FmeCCAenzH0KH381SPT5FZmiA/TmpndpcaShhfgEN9eCVjnFBqq3l1xrI42y8+PPLI6hypzou4GXw00WHmPBLQ==
            }
        engines: { node: '>= 0.4' }

    array.prototype.findlast@1.2.5:
        resolution:
            {
                integrity: sha512-CVvd6FHg1Z3POpBLxO6E6zr+rSKEQ9L6rZHAaY7lLfhKsWYUBBOuMs0e9o24oopj6H+geRCX0YJ+TJLBK2eHyQ==
            }
        engines: { node: '>= 0.4' }

    array.prototype.flat@1.3.3:
        resolution:
            {
                integrity: sha512-rwG/ja1neyLqCuGZ5YYrznA62D4mZXg0i1cIskIUKSiqF3Cje9/wXAls9B9s1Wa2fomMsIv8czB8jZcPmxCXFg==
            }
        engines: { node: '>= 0.4' }

    array.prototype.flatmap@1.3.3:
        resolution:
            {
                integrity: sha512-Y7Wt51eKJSyi80hFrJCePGGNo5ktJCslFuboqJsbf57CCPcm5zztluPlc4/aD8sWsKvlwatezpV4U1efk8kpjg==
            }
        engines: { node: '>= 0.4' }

    array.prototype.tosorted@1.1.4:
        resolution:
            {
                integrity: sha512-p6Fx8B7b7ZhL/gmUsAy0D15WhvDccw3mnGNbZpi3pmeJdxtWsj2jEaI4Y6oo3XiHfzuSgPwKc04MYt6KgvC/wA==
            }
        engines: { node: '>= 0.4' }

    arraybuffer.prototype.slice@1.0.4:
        resolution:
            {
                integrity: sha512-BNoCY6SXXPQ7gF2opIP4GBE+Xw7U+pHMYKuzjgCN3GwiaIR09UUeKfheyIry77QtrCBlC0KK0q5/TER/tYh3PQ==
            }
        engines: { node: '>= 0.4' }

    asn1js@3.0.6:
        resolution:
            {
                integrity: sha512-UOCGPYbl0tv8+006qks/dTgV9ajs97X2p0FAbyS2iyCRrmLSRolDaHdp+v/CLgnzHc3fVB+CwYiUmei7ndFcgA==
            }
        engines: { node: '>=12.0.0' }

    async-function@1.0.0:
        resolution:
            {
                integrity: sha512-hsU18Ae8CDTR6Kgu9DYf0EbCr/a5iGL0rytQDobUcdpYOKokk8LEjVphnXkDkgpi0wYVsqrXuP0bZxJaTqdgoA==
            }
        engines: { node: '>= 0.4' }

    autoprefixer@10.4.21:
        resolution:
            {
                integrity: sha512-O+A6LWV5LDHSJD3LjHYoNi4VLsj/Whi7k6zG12xTYaU4cQ8oxQGckXNX8cRHK5yOZ/ppVHe0ZBXGzSV9jXdVbQ==
            }
        engines: { node: ^10 || ^12 || >=14 }
        hasBin: true
        peerDependencies:
            postcss: ^8.1.0

    available-typed-arrays@1.0.7:
        resolution:
            {
                integrity: sha512-wvUjBtSGN7+7SjNpq/9M2Tg350UZD3q62IFZLbRAR1bSMlCo1ZaeW+BJ+D090e4hIIZLBcTDWe4Mh4jvUDajzQ==
            }
        engines: { node: '>= 0.4' }

    balanced-match@1.0.2:
        resolution:
            {
                integrity: sha512-3oSeUO0TMV67hN1AmbXsK4yaqU7tjiHlbxRDZOpH0KW9+CeX4bRAaX0Anxt0tx2MrpRpWwQaPwIlISEJhYU5Pw==
            }

    base64-js@1.5.1:
        resolution:
            {
                integrity: sha512-AKpaYlHn8t4SVbOHCy+b5+KKgvR4vrsD8vbvrbiQJps7fKDTkjkDry6ji0rUJjC0kzbNePLwzxq8iypo41qeWA==
            }

    baseline-browser-mapping@2.8.22:
        resolution:
            {
                integrity: sha512-/tk9kky/d8T8CTXIQYASLyhAxR5VwL3zct1oAoVTaOUHwrmsGnfbRwNdEq+vOl2BN8i3PcDdP0o4Q+jjKQoFbQ==
            }
        hasBin: true

    bidi-js@1.0.3:
        resolution:
            {
                integrity: sha512-RKshQI1R3YQ+n9YJz2QQ147P66ELpa1FQEg20Dk8oW9t2KgLbpDLLp9aGZ7y8WHSshDknG0bknqGw5/tyCs5tw==
            }

    binary-extensions@2.3.0:
        resolution:
            {
                integrity: sha512-Ceh+7ox5qe7LJuLHoY0feh3pHuUDHAcRUeyL2VYghZwfpkNIy/+8Ocg0a3UuSoYzavmylwuLWQOf3hl0jjMMIw==
            }
        engines: { node: '>=8' }

    brace-expansion@1.1.12:
        resolution:
            {
                integrity: sha512-9T9UjW3r0UW5c1Q7GTwllptXwhvYmEzFhzMfZ9H7FQWt+uZePjZPjBP/W1ZEyZ1twGWom5/56TF4lPcqjnDHcg==
            }

    brace-expansion@2.0.2:
        resolution:
            {
                integrity: sha512-Jt0vHyM+jmUBqojB7E1NIYadt0vI0Qxjxd2TErW94wDz+E2LAm5vKMXXwg6ZZBTHPuUlDgQHKXvjGBdfcF1ZDQ==
            }

    braces@3.0.3:
        resolution:
            {
                integrity: sha512-yQbXgO/OSZVD2IsiLlro+7Hf6Q18EJrKSEsdoMzKePKXct3gvD8oLcOQdIzGupr5Fj+EDe8gO/lxc1BzfMpxvA==
            }
        engines: { node: '>=8' }

    browserslist@4.27.0:
        resolution:
            {
                integrity: sha512-AXVQwdhot1eqLihwasPElhX2tAZiBjWdJ9i/Zcj2S6QYIjkx62OKSfnobkriB81C3l4w0rVy3Nt4jaTBltYEpw==
            }
        engines: { node: ^6 || ^7 || ^8 || ^9 || ^10 || ^11 || ^12 || >=13.7 }
        hasBin: true

    buffer@6.0.3:
        resolution:
            {
                integrity: sha512-FTiCpNxtwiZZHEZbcbTIcZjERVICn9yq/pDFkTl95/AxzD1naBctN7YO68riM/gLSDY7sdrMby8hofADYuuqOA==
            }

    call-bind-apply-helpers@1.0.2:
        resolution:
            {
                integrity: sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ==
            }
        engines: { node: '>= 0.4' }

    call-bind@1.0.8:
        resolution:
            {
                integrity: sha512-oKlSFMcMwpUg2ednkhQ454wfWiU/ul3CkJe/PEHcTKuiX6RpbehUiFMXu13HalGZxfUwCQzZG747YXBn1im9ww==
            }
        engines: { node: '>= 0.4' }

    call-bound@1.0.4:
        resolution:
            {
                integrity: sha512-+ys997U96po4Kx/ABpBCqhA9EuxJaQWDQg7295H4hBphv3IZg0boBKuwYpt4YXp6MZ5AmZQnU/tyMTlRpaSejg==
            }
        engines: { node: '>= 0.4' }

    callsites@3.1.0:
        resolution:
            {
                integrity: sha512-P8BjAsXvZS+VIDUI11hHCQEv74YT67YUi5JJFNWIqL235sBmjX4+qx9Muvls5ivyNENctx46xQLQ3aTuE7ssaQ==
            }
        engines: { node: '>=6' }

    camelcase-css@2.0.1:
        resolution:
            {
                integrity: sha512-QOSvevhslijgYwRx6Rv7zKdMF8lbRmx+uQGx2+vDc+KI/eBnsy9kit5aj23AgGu3pa4t9AgwbnXWqS+iOY+2aA==
            }
        engines: { node: '>= 6' }

    camera-controls@2.10.1:
        resolution:
            {
                integrity: sha512-KnaKdcvkBJ1Irbrzl8XD6WtZltkRjp869Jx8c0ujs9K+9WD+1D7ryBsCiVqJYUqt6i/HR5FxT7RLASieUD+Q5w==
            }
        peerDependencies:
            three: '>=0.126.1'

    caniuse-lite@1.0.30001752:
        resolution:
            {
                integrity: sha512-vKUk7beoukxE47P5gcVNKkDRzXdVofotshHwfR9vmpeFKxmI5PBpgOMC18LUJUA/DvJ70Y7RveasIBraqsyO/g==
            }

    cannon-es-debugger@1.0.0:
        resolution:
            {
                integrity: sha512-sE9lDOBAYFKlh+0w+cvWKwUhJef8HYnUSVPWPL0jD15MAuVRQKno4QYZSGxgOoJkMR3mQqxL4bxys2b3RSWH8g==
            }
        peerDependencies:
            cannon-es: 0.x
            three: 0.x
            typescript: '>=3.8'
        peerDependenciesMeta:
            typescript:
                optional: true

    cannon-es@0.20.0:
        resolution:
            {
                integrity: sha512-eZhWTZIkFOnMAJOgfXJa9+b3kVlvG+FX4mdkpePev/w/rP5V8NRquGyEozcjPfEoXUlb+p7d9SUcmDSn14prOA==
            }

    chalk@4.1.2:
        resolution:
            {
                integrity: sha512-oKnbhFyRIXpUuez8iBMmyEa4nbj4IOQyuhc/wy9kY7/WVPcwIO9VA668Pu8RkO7+0G76SLROeyw9CpQ061i4mA==
            }
        engines: { node: '>=10' }

    chokidar@3.6.0:
        resolution:
            {
                integrity: sha512-7VT13fmjotKpGipCW9JEQAusEPE+Ei8nl6/g4FBAmIm0GOOLMua9NDDo/DWp0ZAxCr3cPq5ZpBqmPAQgDda2Pw==
            }
        engines: { node: '>= 8.10.0' }

    class-variance-authority@0.7.1:
        resolution:
            {
                integrity: sha512-Ka+9Trutv7G8M6WT6SeiRWz792K5qEqIGEGzXKhAE6xOWAY6pPH8U+9IY3oCMv6kqTmLsv7Xh/2w2RigkePMsg==
            }

    clsx@2.1.1:
        resolution:
            {
                integrity: sha512-eYm0QWBtUrBWZWG0d386OGAw16Z995PiOVo2B7bjWSbHedGl5e0ZWaq65kOGgUSNesEIDkB9ISbTg/JK9dhCZA==
            }
        engines: { node: '>=6' }

    cmdk@1.1.1:
        resolution:
            {
                integrity: sha512-Vsv7kFaXm+ptHDMZ7izaRsP70GgrW9NBNGswt9OZaVBLlE0SNpDq8eu/VGXyF9r7M0azK3Wy7OlYXsuyYLFzHg==
            }
        peerDependencies:
            react: ^18 || ^19 || ^19.0.0-rc
            react-dom: ^18 || ^19 || ^19.0.0-rc

    color-convert@2.0.1:
        resolution:
            {
                integrity: sha512-RRECPsj7iu/xb5oKYcsFHSppFNnsj/52OVTRKb4zP5onXwVF3zVmmToNcOfGC+CRDpfK/U584fMg38ZHCaElKQ==
            }
        engines: { node: '>=7.0.0' }

    color-name@1.1.4:
        resolution:
            {
                integrity: sha512-dOy+3AuW3a2wNbZHIuMZpTcgjGuLU/uBL/ubcZF9OXbDo8ff4O8yVp5Bf0efS8uEoYo5q4Fx7dY9OgQGXgAsQA==
            }

    commander@4.1.1:
        resolution:
            {
                integrity: sha512-NOKm8xhkzAjzFx8B2v5OAHT+u5pRQc2UCa2Vq9jYL/31o2wi9mxBA7LIFs3sV5VSC49z6pEhfbMULvShKj26WA==
            }
        engines: { node: '>= 6' }

    concat-map@0.0.1:
        resolution:
            {
                integrity: sha512-/Srv4dswyQNBfohGpz9o6Yb3Gz3SrUDqBH5rTuhGR7ahtlbYKnVxw2bCFMRljaA7EXHaXZ8wsHdodFvbkhKmqg==
            }

    convert-source-map@2.0.0:
        resolution:
            {
                integrity: sha512-Kvp459HrV2FEJ1CAsi1Ku+MY3kasH19TFykTz2xWmMeq6bk2NU3XXvfJ+Q61m0xktWwt+1HSYf3JZsTms3aRJg==
            }

    cookie-es@1.2.2:
        resolution:
            {
                integrity: sha512-+W7VmiVINB+ywl1HGXJXmrqkOhpKrIiVZV6tQuV54ZyQC7MMuBt81Vc336GMLoHBq5hV/F9eXgt5Mnx0Rha5Fg==
            }

    copy-to-clipboard@3.3.3:
        resolution:
            {
                integrity: sha512-2KV8NhB5JqC3ky0r9PMCAZKbUHSwtEo4CwCs0KXgruG43gX5PMqDEBbVU4OUzw2MuAWUfsuFmWvEKG5QRfSnJA==
            }

    cross-env@7.0.3:
        resolution:
            {
                integrity: sha512-+/HKd6EgcQCJGh2PSjZuUitQBQynKor4wrFbRg4DtAgS1aWO+gU52xpH7M9ScGgXSYmAVS9bIJ8EzuaGw0oNAw==
            }
        engines: { node: '>=10.14', npm: '>=6', yarn: '>=1' }
        hasBin: true

    cross-spawn@7.0.6:
        resolution:
            {
                integrity: sha512-uV2QOWP2nWzsy2aMp8aRibhi9dlzF5Hgh5SHaB9OiTGEyDTiJJyx0uy51QXdyWbtAHNua4XJzUKca3OzKUd3vA==
            }
        engines: { node: '>= 8' }

    css-in-js-utils@3.1.0:
        resolution:
            {
                integrity: sha512-fJAcud6B3rRu+KHYk+Bwf+WFL2MDCJJ1XG9x137tJQ0xYxor7XziQtuGFbWNdqrvF4Tk26O3H73nfVqXt/fW1A==
            }

    css-tree@1.1.3:
        resolution:
            {
                integrity: sha512-tRpdppF7TRazZrjJ6v3stzv93qxRcSsFmW6cX0Zm2NVKpxE1WV1HblnghVv9TreireHkqI/VDEsfolRF1p6y7Q==
            }
        engines: { node: '>=8.0.0' }

    cssesc@3.0.0:
        resolution:
            {
                integrity: sha512-/Tb/JcjK111nNScGob5MNtsntNM1aCNUDipB/TkwZFhyDrrE47SOx/18wF2bbjgc3ZzCSKW1T5nt5EbFoAz/Vg==
            }
        engines: { node: '>=4' }
        hasBin: true

    csstype@3.1.3:
        resolution:
            {
                integrity: sha512-M1uQkMl8rQK/szD0LNhtqxIPLpimGm8sOBwU7lLnCpSbTyY3yeU1Vc7l4KT5zT4s/yOxHH5O7tIuuLOCnLADRw==
            }

    d3-array@3.2.4:
        resolution:
            {
                integrity: sha512-tdQAmyA18i4J7wprpYq8ClcxZy3SC31QMeByyCFyRt7BVHdREQZ5lpzoe5mFEYZUWe+oq8HBvk9JjpibyEV4Jg==
            }
        engines: { node: '>=12' }

    d3-color@3.1.0:
        resolution:
            {
                integrity: sha512-zg/chbXyeBtMQ1LbD/WSoW2DpC3I0mpmPdW+ynRTj/x2DAWYrIY7qeZIHidozwV24m4iavr15lNwIwLxRmOxhA==
            }
        engines: { node: '>=12' }

    d3-ease@3.0.1:
        resolution:
            {
                integrity: sha512-wR/XK3D3XcLIZwpbvQwQ5fK+8Ykds1ip7A2Txe0yxncXSdq1L9skcG7blcedkOX+ZcgxGAmLX1FrRGbADwzi0w==
            }
        engines: { node: '>=12' }

    d3-format@3.1.0:
        resolution:
            {
                integrity: sha512-YyUI6AEuY/Wpt8KWLgZHsIU86atmikuoOmCfommt0LYHiQSPjvX2AcFc38PX0CBpr2RCyZhjex+NS/LPOv6YqA==
            }
        engines: { node: '>=12' }

    d3-interpolate@3.0.1:
        resolution:
            {
                integrity: sha512-3bYs1rOD33uo8aqJfKP3JWPAibgw8Zm2+L9vBKEHJ2Rg+viTR7o5Mmv5mZcieN+FRYaAOWX5SJATX6k1PWz72g==
            }
        engines: { node: '>=12' }

    d3-path@3.1.0:
        resolution:
            {
                integrity: sha512-p3KP5HCf/bvjBSSKuXid6Zqijx7wIfNW+J/maPs+iwR35at5JCbLUT0LzF1cnjbCHWhqzQTIN2Jpe8pRebIEFQ==
            }
        engines: { node: '>=12' }

    d3-scale@4.0.2:
        resolution:
            {
                integrity: sha512-GZW464g1SH7ag3Y7hXjf8RoUuAFIqklOAq3MRl4OaWabTFJY9PN/E1YklhXLh+OQ3fM9yS2nOkCoS+WLZ6kvxQ==
            }
        engines: { node: '>=12' }

    d3-shape@3.2.0:
        resolution:
            {
                integrity: sha512-SaLBuwGm3MOViRq2ABk3eLoxwZELpH6zhl3FbAoJ7Vm1gofKx6El1Ib5z23NUEhF9AsGl7y+dzLe5Cw2AArGTA==
            }
        engines: { node: '>=12' }

    d3-time-format@4.1.0:
        resolution:
            {
                integrity: sha512-dJxPBlzC7NugB2PDLwo9Q8JiTR3M3e4/XANkreKSUxF8vvXKqm1Yfq4Q5dl8budlunRVlUUaDUgFt7eA8D6NLg==
            }
        engines: { node: '>=12' }

    d3-time@3.1.0:
        resolution:
            {
                integrity: sha512-VqKjzBLejbSMT4IgbmVgDjpkYrNWUYJnbCGo874u7MMKIWsILRX+OpX/gTk8MqjpT1A/c6HY2dCA77ZN0lkQ2Q==
            }
        engines: { node: '>=12' }

    d3-timer@3.0.1:
        resolution:
            {
                integrity: sha512-ndfJ/JxxMd3nw31uyKoY2naivF+r29V+Lc0svZxe1JvvIRmi8hUsrMvdOwgS1o6uBHmiz91geQ0ylPP0aj1VUA==
            }
        engines: { node: '>=12' }

    data-view-buffer@1.0.2:
        resolution:
            {
                integrity: sha512-EmKO5V3OLXh1rtK2wgXRansaK1/mtVdTUEiEI0W8RkvgT05kfxaH29PliLnpLP73yYO6142Q72QNa8Wx/A5CqQ==
            }
        engines: { node: '>= 0.4' }

    data-view-byte-length@1.0.2:
        resolution:
            {
                integrity: sha512-tuhGbE6CfTM9+5ANGf+oQb72Ky/0+s3xKUpHvShfiz2RxMFgFPjsXuRLBVMtvMs15awe45SRb83D6wH4ew6wlQ==
            }
        engines: { node: '>= 0.4' }

    data-view-byte-offset@1.0.1:
        resolution:
            {
                integrity: sha512-BS8PfmtDGnrgYdOonGZQdLZslWIeCGFP9tpan0hi1Co2Zr2NKADsvGYA8XxuG/4UWgJ6Cjtv+YJnB6MM69QGlQ==
            }
        engines: { node: '>= 0.4' }

    date-fns-jalali@4.1.0-0:
        resolution:
            {
                integrity: sha512-hTIP/z+t+qKwBDcmmsnmjWTduxCg+5KfdqWQvb2X/8C9+knYY6epN/pfxdDuyVlSVeFz0sM5eEfwIUQ70U4ckg==
            }

    date-fns@3.6.0:
        resolution:
            {
                integrity: sha512-fRHTG8g/Gif+kSh50gaGEdToemgfj74aRX3swtiouboip5JDLAyDE9F11nHMIcvOaXeOC6D7SpNhi7uFyB7Uww==
            }

    date-fns@4.1.0:
        resolution:
            {
                integrity: sha512-Ukq0owbQXxa/U3EGtsdVBkR1w7KOQ5gIBqdH2hkvknzZPYvBxb/aa6E8L7tmjFtkwZBu3UXBbjIgPo/Ez4xaNg==
            }

    debug@4.4.3:
        resolution:
            {
                integrity: sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==
            }
        engines: { node: '>=6.0' }
        peerDependencies:
            supports-color: '*'
        peerDependenciesMeta:
            supports-color:
                optional: true

    decimal.js-light@2.5.1:
        resolution:
            {
                integrity: sha512-qIMFpTMZmny+MMIitAB6D7iVPEorVw6YQRWkvarTkT4tBeSLLiHzcwj6q0MmYSFCiVpiqPJTJEYIrpcPzVEIvg==
            }

    deep-is@0.1.4:
        resolution:
            {
                integrity: sha512-oIPzksmTg4/MriiaYGO+okXDT7ztn/w3Eptv/+gSIdMdKsJo0u4CfYNFJPy+4SKMuCqGw2wxnA+URMg3t8a/bQ==
            }

    define-data-property@1.1.4:
        resolution:
            {
                integrity: sha512-rBMvIzlpA8v6E+SJZoo++HAYqsLrkg7MSfIinMPFhmkorw7X+dOXVJQs+QT69zGkzMyfDnIMN2Wid1+NbL3T+A==
            }
        engines: { node: '>= 0.4' }

    define-properties@1.2.1:
        resolution:
            {
                integrity: sha512-8QmQKqEASLd5nx0U1B1okLElbUuuttJ/AnYmRXbbbGDWh6uS208EjD4Xqq/I9wK7u0v6O08XhTWnt5XtEbR6Dg==
            }
        engines: { node: '>= 0.4' }

    detect-gpu@5.0.70:
        resolution:
            {
                integrity: sha512-bqerEP1Ese6nt3rFkwPnGbsUF9a4q+gMmpTVVOEzoCyeCc+y7/RvJnQZJx1JwhgQI5Ntg0Kgat8Uu7XpBqnz1w==
            }

    detect-libc@2.1.2:
        resolution:
            {
                integrity: sha512-Btj2BOOO83o3WyH59e8MgXsxEQVcarkUOpEYrubB0urwnN10yQ364rsiByU11nZlqWYZm05i/of7io4mzihBtQ==
            }
        engines: { node: '>=8' }

    detect-node-es@1.1.0:
        resolution:
            {
                integrity: sha512-ypdmJU/TbBby2Dxibuv7ZLW3Bs1QEmM7nHjEANfohJLvE0XVujisn1qPJcZxg+qDucsr+bP6fLD1rPS3AhJ7EQ==
            }

    didyoumean@1.2.2:
        resolution:
            {
                integrity: sha512-gxtyfqMg7GKyhQmb056K7M3xszy/myH8w+B4RT+QXBQsvAOdc3XymqDDPHx1BgPgsdAA5SIifona89YtRATDzw==
            }

    dlv@1.1.3:
        resolution:
            {
                integrity: sha512-+HlytyjlPKnIG8XuRG8WvmBP8xs8P71y+SKKS6ZXWoEgLuePxtDoUEiH7WkdePWrQ5JBpE6aoVqfZfJUQkjXwA==
            }

    doctrine@2.1.0:
        resolution:
            {
                integrity: sha512-35mSku4ZXK0vfCuHEDAwt55dg2jNajHZ1odvF+8SSr82EsZY4QmXfuWso8oEd8zRhVObSN18aM0CjSdoBX7zIw==
            }
        engines: { node: '>=0.10.0' }

    doctrine@3.0.0:
        resolution:
            {
                integrity: sha512-yS+Q5i3hBf7GBkd4KG8a7eBNNWNGLTaEwwYWUijIYM7zrlYDM0BFXHjjPWlWZ1Rg7UaddZeIDmi9jF3HmqiQ2w==
            }
        engines: { node: '>=6.0.0' }

    dom-helpers@5.2.1:
        resolution:
            {
                integrity: sha512-nRCa7CK3VTrM2NmGkIy4cbK7IZlgBE/PYMn55rrXefr5xXDP0LdtfPnblFDoVdcAfslJ7or6iqAUnx0CCGIWQA==
            }

    dotenv-cli@8.0.0:
        resolution:
            {
                integrity: sha512-aLqYbK7xKOiTMIRf1lDPbI+Y+Ip/wo5k3eyp6ePysVaSqbyxjyK3dK35BTxG+rmd7djf5q2UPs4noPNH+cj0Qw==
            }
        hasBin: true

    dotenv-expand@10.0.0:
        resolution:
            {
                integrity: sha512-GopVGCpVS1UKH75VKHGuQFqS1Gusej0z4FyQkPdwjil2gNIv+LNsqBlboOzpJFZKVT95GkCyWJbBSdFEFUWI2A==
            }
        engines: { node: '>=12' }

    dotenv@16.6.1:
        resolution:
            {
                integrity: sha512-uBq4egWHTcTt33a72vpSG0z3HnPuIl6NqYcTrKEg2azoEyl2hpW0zqlxysq2pK9HlDIHyHyakeYaYnSAwd8bow==
            }
        engines: { node: '>=12' }

    draco3d@1.5.7:
        resolution:
            {
                integrity: sha512-m6WCKt/erDXcw+70IJXnG7M3awwQPAsZvJGX5zY7beBqpELw6RDGkYVU0W43AFxye4pDZ5i2Lbyc/NNGqwjUVQ==
            }

    dunder-proto@1.0.1:
        resolution:
            {
                integrity: sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A==
            }
        engines: { node: '>= 0.4' }

    eastasianwidth@0.2.0:
        resolution:
            {
                integrity: sha512-I88TYZWc9XiYHRQ4/3c5rjjfgkjhLyW2luGIheGERbNQ6OY7yTybanSpDXZa8y7VUP9YmDcYa+eyq4ca7iLqWA==
            }

    electron-to-chromium@1.5.244:
        resolution:
            {
                integrity: sha512-OszpBN7xZX4vWMPJwB9illkN/znA8M36GQqQxi6MNy9axWxhOfJyZZJtSLQCpEFLHP2xK33BiWx9aIuIEXVCcw==
            }

    embla-carousel-react@8.6.0:
        resolution:
            {
                integrity: sha512-0/PjqU7geVmo6F734pmPqpyHqiM99olvyecY7zdweCw+6tKEXnrE90pBiBbMMU8s5tICemzpQ3hi5EpxzGW+JA==
            }
        peerDependencies:
            react: ^16.8.0 || ^17.0.1 || ^18.0.0 || ^19.0.0 || ^19.0.0-rc

    embla-carousel-reactive-utils@8.6.0:
        resolution:
            {
                integrity: sha512-fMVUDUEx0/uIEDM0Mz3dHznDhfX+znCCDCeIophYb1QGVM7YThSWX+wz11zlYwWFOr74b4QLGg0hrGPJeG2s4A==
            }
        peerDependencies:
            embla-carousel: 8.6.0

    embla-carousel@8.6.0:
        resolution:
            {
                integrity: sha512-SjWyZBHJPbqxHOzckOfo8lHisEaJWmwd23XppYFYVh10bU66/Pn5tkVkbkCMZVdbUE5eTCI2nD8OyIP4Z+uwkA==
            }

    emoji-regex@8.0.0:
        resolution:
            {
                integrity: sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==
            }

    emoji-regex@9.2.2:
        resolution:
            {
                integrity: sha512-L18DaJsXSUk2+42pv8mLs5jJT2hqFkFE4j21wOmgbUqsZ2hL72NsUU785g9RXgo3s0ZNgVl42TiHp3ZtOv/Vyg==
            }

    error-stack-parser@2.1.4:
        resolution:
            {
                integrity: sha512-Sk5V6wVazPhq5MhpO+AUxJn5x7XSXGl1R93Vn7i+zS15KDVxQijejNCrz8340/2bgLBjR9GtEG8ZVKONDjcqGQ==
            }

    es-abstract@1.24.0:
        resolution:
            {
                integrity: sha512-WSzPgsdLtTcQwm4CROfS5ju2Wa1QQcVeT37jFjYzdFz1r9ahadC8B8/a4qxJxM+09F18iumCdRmlr96ZYkQvEg==
            }
        engines: { node: '>= 0.4' }

    es-define-property@1.0.1:
        resolution:
            {
                integrity: sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g==
            }
        engines: { node: '>= 0.4' }

    es-errors@1.3.0:
        resolution:
            {
                integrity: sha512-Zf5H2Kxt2xjTvbJvP2ZWLEICxA6j+hAmMzIlypy4xcBg1vKVnx89Wy0GbS+kf5cwCVFFzdCFh2XSCFNULS6csw==
            }
        engines: { node: '>= 0.4' }

    es-iterator-helpers@1.2.1:
        resolution:
            {
                integrity: sha512-uDn+FE1yrDzyC0pCo961B2IHbdM8y/ACZsKD4dG6WqrjV53BADjwa7D+1aom2rsNVfLyDgU/eigvlJGJ08OQ4w==
            }
        engines: { node: '>= 0.4' }

    es-object-atoms@1.1.1:
        resolution:
            {
                integrity: sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA==
            }
        engines: { node: '>= 0.4' }

    es-set-tostringtag@2.1.0:
        resolution:
            {
                integrity: sha512-j6vWzfrGVfyXxge+O0x5sh6cvxAog0a/4Rdd2K36zCMV5eJ+/+tOAngRO8cODMNWbVRdVlmGZQL2YS3yR8bIUA==
            }
        engines: { node: '>= 0.4' }

    es-shim-unscopables@1.1.0:
        resolution:
            {
                integrity: sha512-d9T8ucsEhh8Bi1woXCf+TIKDIROLG5WCkxg8geBCbvk22kzwC5G2OnXVMO6FUsvQlgUUXQ2itephWDLqDzbeCw==
            }
        engines: { node: '>= 0.4' }

    es-to-primitive@1.3.0:
        resolution:
            {
                integrity: sha512-w+5mJ3GuFL+NjVtJlvydShqE1eN3h3PbI7/5LAsYJP/2qtuMXjfL2LpHSRqo4b4eSF5K/DH1JXKUAHSB2UW50g==
            }
        engines: { node: '>= 0.4' }

    esbuild@0.21.5:
        resolution:
            {
                integrity: sha512-mg3OPMV4hXywwpoDxu3Qda5xCKQi+vCTZq8S9J/EpkhB2HzKXq4SNFZE3+NK93JYxc8VMSep+lOUSC/RVKaBqw==
            }
        engines: { node: '>=12' }
        hasBin: true

    escalade@3.2.0:
        resolution:
            {
                integrity: sha512-WUj2qlxaQtO4g6Pq5c29GTcWGDyd8itL8zTlipgECz3JesAiiOKotd8JU6otB3PACgG6xkJUyVhboMS+bje/jA==
            }
        engines: { node: '>=6' }

    escape-string-regexp@4.0.0:
        resolution:
            {
                integrity: sha512-TtpcNJ3XAzx3Gq8sWRzJaVajRs0uVxA2YAkdb1jm2YkPz4G6egUFAyA3n5vtEIZefPk5Wa4UXbKuS5fKkJWdgA==
            }
        engines: { node: '>=10' }

    eslint-plugin-react-hooks@5.2.0:
        resolution:
            {
                integrity: sha512-+f15FfK64YQwZdJNELETdn5ibXEUQmW1DZL6KXhNnc2heoy/sg9VJJeT7n8TlMWouzWqSWavFkIhHyIbIAEapg==
            }
        engines: { node: '>=10' }
        peerDependencies:
            eslint: ^3.0.0 || ^4.0.0 || ^5.0.0 || ^6.0.0 || ^7.0.0 || ^8.0.0-0 || ^9.0.0

    eslint-plugin-react@7.37.5:
        resolution:
            {
                integrity: sha512-Qteup0SqU15kdocexFNAJMvCJEfa2xUKNV4CC1xsVMrIIqEy3SQ/rqyxCWNzfrd3/ldy6HMlD2e0JDVpDg2qIA==
            }
        engines: { node: '>=4' }
        peerDependencies:
            eslint: ^3 || ^4 || ^5 || ^6 || ^7 || ^8 || ^9.7

    eslint-plugin-tailwindcss@3.18.2:
        resolution:
            {
                integrity: sha512-QbkMLDC/OkkjFQ1iz/5jkMdHfiMu/uwujUHLAJK5iwNHD8RTxVTlsUezE0toTZ6VhybNBsk+gYGPDq2agfeRNA==
            }
        engines: { node: '>=18.12.0' }
        peerDependencies:
            tailwindcss: ^3.4.0

    eslint-scope@7.2.2:
        resolution:
            {
                integrity: sha512-dOt21O7lTMhDM+X9mB4GX+DZrZtCUJPL/wlcTqxyrx5IvO0IYtILdtrQGQp+8n5S0gwSVmOf9NQrjMOgfQZlIg==
            }
        engines: { node: ^12.22.0 || ^14.17.0 || >=16.0.0 }

    eslint-scope@8.4.0:
        resolution:
            {
                integrity: sha512-sNXOfKCn74rt8RICKMvJS7XKV/Xk9kA7DyJr8mJik3S7Cwgy3qlkkmyS2uQB3jiJg6VNdZd/pDBJu0nvG2NlTg==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }

    eslint-visitor-keys@3.4.3:
        resolution:
            {
                integrity: sha512-wpc+LXeiyiisxPlEkUzU6svyS1frIO3Mgxj1fdy7Pm8Ygzguax2N3Fa/D/ag1WqbOprdI+uY6wMUl8/a2G+iag==
            }
        engines: { node: ^12.22.0 || ^14.17.0 || >=16.0.0 }

    eslint-visitor-keys@4.2.1:
        resolution:
            {
                integrity: sha512-Uhdk5sfqcee/9H/rCOJikYz67o0a2Tw2hGRPOG2Y1R2dg7brRe1uG0yaNQDHu+TO/uQPF/5eCapvYSmHUjt7JQ==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }

    eslint@8.57.1:
        resolution:
            {
                integrity: sha512-ypowyDxpVSYpkXr9WPv2PAZCtNip1Mv5KTW0SCurXv/9iOpcrH9PaqUElksqEB6pChqHGDRCFTyrZlGhnLNGiA==
            }
        engines: { node: ^12.22.0 || ^14.17.0 || >=16.0.0 }
        deprecated: This version is no longer supported. Please see https://eslint.org/version-support for other options.
        hasBin: true

    eslint@9.27.0:
        resolution:
            {
                integrity: sha512-ixRawFQuMB9DZ7fjU3iGGganFDp3+45bPOdaRurcFHSXO1e/sYwUX/FtQZpLZJR6SjMoJH8hR2pPEAfDyCoU2Q==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }
        hasBin: true
        peerDependencies:
            jiti: '*'
        peerDependenciesMeta:
            jiti:
                optional: true

    espree@10.4.0:
        resolution:
            {
                integrity: sha512-j6PAQ2uUr79PZhBjP5C5fhl8e39FmRnOjsD5lGnWrFU8i2G776tBK7+nP8KuQUTTyAZUwfQqXAgrVH5MbH9CYQ==
            }
        engines: { node: ^18.18.0 || ^20.9.0 || >=21.1.0 }

    espree@9.6.1:
        resolution:
            {
                integrity: sha512-oruZaFkjorTpF32kDSI5/75ViwGeZginGGy2NoOSg3Q9bnwlnmDm4HLnkl0RE3n+njDXR037aY1+x58Z/zFdwQ==
            }
        engines: { node: ^12.22.0 || ^14.17.0 || >=16.0.0 }

    esquery@1.6.0:
        resolution:
            {
                integrity: sha512-ca9pw9fomFcKPvFLXhBKUK90ZvGibiGOvRJNbjljY7s7uq/5YO4BOzcYtJqExdx99rF6aAcnRxHmcUHcz6sQsg==
            }
        engines: { node: '>=0.10' }

    esrecurse@4.3.0:
        resolution:
            {
                integrity: sha512-KmfKL3b6G+RXvP8N1vr3Tq1kL/oCFgn2NYXEtqP8/L3pKapUA4G8cFVaoF3SU323CD4XypR/ffioHmkti6/Tag==
            }
        engines: { node: '>=4.0' }

    estraverse@5.3.0:
        resolution:
            {
                integrity: sha512-MMdARuVEQziNTeJD8DgMqmhwR11BRQ/cBP+pLtYdSTnf3MIO8fFeiINEbX36ZdNlfU/7A9f3gUw49B3oQsvwBA==
            }
        engines: { node: '>=4.0' }

    esutils@2.0.3:
        resolution:
            {
                integrity: sha512-kVscqXk4OCp68SZ0dkgEKVi6/8ij300KBWTJq32P/dYeWTSwK41WyTxalN1eRmA5Z9UU/LX9D7FWSmV9SAYx6g==
            }
        engines: { node: '>=0.10.0' }

    eventemitter3@4.0.7:
        resolution:
            {
                integrity: sha512-8guHBZCwKnFhYdHr2ysuRWErTwhoN2X8XELRlrRwpmfeY2jjuUN4taQMsULKUVo1K4DvZl+0pgfyoysHxvmvEw==
            }

    eventemitter3@5.0.1:
        resolution:
            {
                integrity: sha512-GWkBvjiSZK87ELrYOSESUYeVIc9mvLLf/nXalMOS5dYrgZq9o5OVkbZAVM06CVxYsCwH9BDZFPlQTlPA1j4ahA==
            }

    fast-deep-equal@3.1.3:
        resolution:
            {
                integrity: sha512-f3qQ9oQy9j2AhBe/H9VC91wLmKBCCU/gDOnKNAYG5hswO7BLKj09Hc5HYNz9cGI++xlpDCIgDaitVs03ATR84Q==
            }

    fast-diff@1.3.0:
        resolution:
            {
                integrity: sha512-VxPP4NqbUjj6MaAOafWeUn2cXWLcCtljklUtZf0Ind4XQ+QPtmA0b18zZy0jIQx+ExRVCR/ZQpBmik5lXshNsw==
            }

    fast-equals@5.3.2:
        resolution:
            {
                integrity: sha512-6rxyATwPCkaFIL3JLqw8qXqMpIZ942pTX/tbQFkRsDGblS8tNGtlUauA/+mt6RUfqn/4MoEr+WDkYoIQbibWuQ==
            }
        engines: { node: '>=6.0.0' }

    fast-glob@3.3.3:
        resolution:
            {
                integrity: sha512-7MptL8U0cqcFdzIzwOTHoilX9x5BrNqye7Z/LuC7kCMRio1EMSyqRK3BEAUD7sXRq4iT4AzTVuZdhgQ2TCvYLg==
            }
        engines: { node: '>=8.6.0' }

    fast-json-stable-stringify@2.1.0:
        resolution:
            {
                integrity: sha512-lhd/wF+Lk98HZoTCtlVraHtfh5XYijIjalXck7saUtuanSDyLMxnHhSXEDJqHxD7msR8D0uCmqlkwjCV8xvwHw==
            }

    fast-levenshtein@2.0.6:
        resolution:
            {
                integrity: sha512-DCXu6Ifhqcks7TZKY3Hxp3y6qphY5SJZmrWMDrKcERSOXWQdMhU9Ig/PYrzyw/ul9jOIyh0N4M0tbC5hodg8dw==
            }

    fast-shallow-equal@1.0.0:
        resolution:
            {
                integrity: sha512-HPtaa38cPgWvaCFmRNhlc6NG7pv6NUHqjPgVAkWGoB9mQMwYB27/K0CvOM5Czy+qpT3e8XJ6Q4aPAnzpNpzNaw==
            }

    fastest-stable-stringify@2.0.2:
        resolution:
            {
                integrity: sha512-bijHueCGd0LqqNK9b5oCMHc0MluJAx0cwqASgbWMvkO01lCYgIhacVRLcaDz3QnyYIRNJRDwMb41VuT6pHJ91Q==
            }

    fastq@1.19.1:
        resolution:
            {
                integrity: sha512-GwLTyxkCXjXbxqIhTsMI2Nui8huMPtnxg7krajPJAjnEG/iiOS7i+zCtWGZR9G0NBKbXKh6X9m9UIsYX/N6vvQ==
            }

    fflate@0.6.10:
        resolution:
            {
                integrity: sha512-IQrh3lEPM93wVCEczc9SaAOvkmcoQn/G8Bo1e8ZPlY3X3bnAxWaBdvTdvM1hP62iZp0BXWDy4vTAy4fF0+Dlpg==
            }

    fflate@0.8.2:
        resolution:
            {
                integrity: sha512-cPJU47OaAoCbg0pBvzsgpTPhmhqI5eJjh/JIu8tPj5q+T7iLvW/JAYUqmE7KOB4R1ZyEhzBaIQpQpardBF5z8A==
            }

    file-entry-cache@6.0.1:
        resolution:
            {
                integrity: sha512-7Gps/XWymbLk2QLYK4NzpMOrYjMhdIxXuIvy2QBsLE6ljuodKvdkWs/cpyJJ3CVIVpH0Oi1Hvg1ovbMzLdFBBg==
            }
        engines: { node: ^10.12.0 || >=12.0.0 }

    file-entry-cache@8.0.0:
        resolution:
            {
                integrity: sha512-XXTUwCvisa5oacNGRP9SfNtYBNAMi+RPwBFmblZEF7N7swHYQS6/Zfk7SRwx4D5j3CH211YNRco1DEMNVfZCnQ==
            }
        engines: { node: '>=16.0.0' }

    fill-range@7.1.1:
        resolution:
            {
                integrity: sha512-YsGpe3WHLK8ZYi4tWDg2Jy3ebRz2rXowDxnld4bkQB00cc/1Zw9AWnC0i9ztDJitivtQvaI9KaLyKrc+hBW0yg==
            }
        engines: { node: '>=8' }

    find-up@5.0.0:
        resolution:
            {
                integrity: sha512-78/PXT1wlLLDgTzDs7sjq9hzz0vXD+zn+7wypEe4fXQxCmdmqfGsEPQxmiCSQI3ajFV91bVSsvNtrJRiW6nGng==
            }
        engines: { node: '>=10' }

    flat-cache@3.2.0:
        resolution:
            {
                integrity: sha512-CYcENa+FtcUKLmhhqyctpclsq7QF38pKjZHsGNiSQF5r4FtoKDWabFDl3hzaEQMvT1LHEysw5twgLvpYYb4vbw==
            }
        engines: { node: ^10.12.0 || >=12.0.0 }

    flat-cache@4.0.1:
        resolution:
            {
                integrity: sha512-f7ccFPK3SXFHpx15UIGyRJ/FJQctuKZ0zVuN3frBo4HnK3cay9VEW0R6yPYFHC0AgqhukPzKjq22t5DmAyqGyw==
            }
        engines: { node: '>=16' }

    flatted@3.3.3:
        resolution:
            {
                integrity: sha512-GX+ysw4PBCz0PzosHDepZGANEuFCMLrnRTiEy9McGjmkCQYwRq4A/X786G/fjM/+OjsWSU1ZrY5qyARZmO/uwg==
            }

    for-each@0.3.5:
        resolution:
            {
                integrity: sha512-dKx12eRCVIzqCxFGplyFKJMPvLEWgmNtUrpTiJIR5u97zEhRG8ySrtboPHZXx7daLxQVrl643cTzbab2tkQjxg==
            }
        engines: { node: '>= 0.4' }

    foreground-child@3.3.1:
        resolution:
            {
                integrity: sha512-gIXjKqtFuWEgzFRJA9WCQeSJLZDjgJUOMCMzxtvFq/37KojM1BFGufqsCy0r4qSQmYLsZYMeyRqzIWOMup03sw==
            }
        engines: { node: '>=14' }

    fraction.js@4.3.7:
        resolution:
            {
                integrity: sha512-ZsDfxO51wGAXREY55a7la9LScWpwv9RxIrYABrlvOFBlH/ShPnrtsXeuUIfXKKOVicNxQ+o8JTbJvjS4M89yew==
            }

    fs.realpath@1.0.0:
        resolution:
            {
                integrity: sha512-OO0pH2lK6a0hZnAdau5ItzHPI6pUlvI7jMVnxUQRtw4owF2wk8lOSabtGDCTP4Ggrg2MbGnWO9X8K1t4+fGMDw==
            }

    fsevents@2.3.3:
        resolution:
            {
                integrity: sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==
            }
        engines: { node: ^8.16.0 || ^10.6.0 || >=11.0.0 }
        os: [darwin]

    function-bind@1.1.2:
        resolution:
            {
                integrity: sha512-7XHNxH7qX9xG5mIwxkhumTox/MIRNcOgDrxWsMt2pAr23WHp6MrRlN7FBSFpCpr+oVO0F744iUgR82nJMfG2SA==
            }

    function.prototype.name@1.1.8:
        resolution:
            {
                integrity: sha512-e5iwyodOHhbMr/yNrc7fDYG4qlbIvI5gajyzPnb5TCwyhjApznQh1BMFou9b30SevY43gCJKXycoCBjMbsuW0Q==
            }
        engines: { node: '>= 0.4' }

    functions-have-names@1.2.3:
        resolution:
            {
                integrity: sha512-xckBUXyTIqT97tq2x2AMb+g163b5JFysYk0x4qxNFwbfQkmNZoiRHb6sPzI9/QV33WeuvVYBUIiD4NzNIyqaRQ==
            }

    generator-function@2.0.1:
        resolution:
            {
                integrity: sha512-SFdFmIJi+ybC0vjlHN0ZGVGHc3lgE0DxPAT0djjVg+kjOnSqclqmj0KQ7ykTOLP6YxoqOvuAODGdcHJn+43q3g==
            }
        engines: { node: '>= 0.4' }

    gensync@1.0.0-beta.2:
        resolution:
            {
                integrity: sha512-3hN7NaskYvMDLQY55gnW3NQ+mesEAepTqlg+VEbj7zzqEMBVNhzcGYYeqFo/TlYz6eQiFcp1HcsCZO+nGgS8zg==
            }
        engines: { node: '>=6.9.0' }

    get-intrinsic@1.3.0:
        resolution:
            {
                integrity: sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ==
            }
        engines: { node: '>= 0.4' }

    get-nonce@1.0.1:
        resolution:
            {
                integrity: sha512-FJhYRoDaiatfEkUK8HKlicmu/3SGFD51q3itKDGoSTysQJBnfOcxU5GxnhE1E6soB76MbT0MBtnKJuXyAx+96Q==
            }
        engines: { node: '>=6' }

    get-proto@1.0.1:
        resolution:
            {
                integrity: sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g==
            }
        engines: { node: '>= 0.4' }

    get-symbol-description@1.1.0:
        resolution:
            {
                integrity: sha512-w9UMqWwJxHNOvoNzSJ2oPF5wvYcvP7jUvYzhp67yEhTi17ZDBBC1z9pTdGuzjD+EFIqLSYRweZjqfiPzQ06Ebg==
            }
        engines: { node: '>= 0.4' }

    glob-parent@5.1.2:
        resolution:
            {
                integrity: sha512-AOIgSQCepiJYwP3ARnGx+5VnTu2HBYdzbGP45eLw1vr3zB3vZLeyed1sC9hnbcOc9/SrMyM5RPQrkGz4aS9Zow==
            }
        engines: { node: '>= 6' }

    glob-parent@6.0.2:
        resolution:
            {
                integrity: sha512-XxwI8EOhVQgWp6iDL+3b0r86f4d6AX6zSU55HfB4ydCEuXLXc5FcYeOu+nnGftS4TEju/11rt4KJPTMgbfmv4A==
            }
        engines: { node: '>=10.13.0' }

    glob@10.4.5:
        resolution:
            {
                integrity: sha512-7Bv8RF0k6xjo7d4A/PxYLbUCfb6c+Vpd2/mB2yRDlew7Jb5hEXiCD9ibfO7wpk8i4sevK6DFny9h7EYbM3/sHg==
            }
        hasBin: true

    glob@7.2.3:
        resolution:
            {
                integrity: sha512-nFR0zLpU2YCaRxwoCJvL6UvCH2JFyFVIvwTLsIf21AuHlMskA1hhTdk+LlYJtOlYt9v6dvszD2BGRqBL+iQK9Q==
            }
        deprecated: Glob versions prior to v9 are no longer supported

    globals@13.24.0:
        resolution:
            {
                integrity: sha512-AhO5QUcj8llrbG09iWhPU2B204J1xnPeL8kQmVorSsy+Sjj1sk8gIyh6cUocGmH4L0UuhAJy+hJMRA4mgA4mFQ==
            }
        engines: { node: '>=8' }

    globals@14.0.0:
        resolution:
            {
                integrity: sha512-oahGvuMGQlPw/ivIYBjVSrWAfWLBeku5tpPE2fOPLi+WHffIWbuh2tCjhyQhTBPMf5E9jDEH4FOmTYgYwbKwtQ==
            }
        engines: { node: '>=18' }

    globals@16.2.0:
        resolution:
            {
                integrity: sha512-O+7l9tPdHCU320IigZZPj5zmRCFG9xHmx9cU8FqU2Rp+JN714seHV+2S9+JslCpY4gJwU2vOGox0wzgae/MCEg==
            }
        engines: { node: '>=18' }

    globalthis@1.0.4:
        resolution:
            {
                integrity: sha512-DpLKbNU4WylpxJykQujfCcwYWiV/Jhm50Goo0wrVILAv5jOr9d+H+UR3PhSCD2rCCEIg0uc+G+muBTwD54JhDQ==
            }
        engines: { node: '>= 0.4' }

    glsl-noise@0.0.0:
        resolution:
            {
                integrity: sha512-b/ZCF6amfAUb7dJM/MxRs7AetQEahYzJ8PtgfrmEdtw6uyGOr+ZSGtgjFm6mfsBkxJ4d2W7kg+Nlqzqvn3Bc0w==
            }

    gopd@1.2.0:
        resolution:
            {
                integrity: sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg==
            }
        engines: { node: '>= 0.4' }

    graphemer@1.4.0:
        resolution:
            {
                integrity: sha512-EtKwoO6kxCL9WO5xipiHTZlSzBm7WLT627TqC/uVRd0HKmq8NXyebnNYxDoBi7wt8eTWrUrKXCOVaFq9x1kgag==
            }

    has-bigints@1.1.0:
        resolution:
            {
                integrity: sha512-R3pbpkcIqv2Pm3dUwgjclDRVmWpTJW2DcMzcIhEXEx1oh/CEMObMm3KLmRJOdvhM7o4uQBnwr8pzRK2sJWIqfg==
            }
        engines: { node: '>= 0.4' }

    has-flag@4.0.0:
        resolution:
            {
                integrity: sha512-EykJT/Q1KjTWctppgIAgfSO0tKVuZUjhgMr17kqTumMl6Afv3EISleU7qZUzoXDFTAHTDC4NOoG/ZxU3EvlMPQ==
            }
        engines: { node: '>=8' }

    has-property-descriptors@1.0.2:
        resolution:
            {
                integrity: sha512-55JNKuIW+vq4Ke1BjOTjM2YctQIvCT7GFzHwmfZPGo5wnrgkid0YQtnAleFSqumZm4az3n2BS+erby5ipJdgrg==
            }

    has-proto@1.2.0:
        resolution:
            {
                integrity: sha512-KIL7eQPfHQRC8+XluaIw7BHUwwqL19bQn4hzNgdr+1wXoU0KKj6rufu47lhY7KbJR2C6T6+PfyN0Ea7wkSS+qQ==
            }
        engines: { node: '>= 0.4' }

    has-symbols@1.1.0:
        resolution:
            {
                integrity: sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ==
            }
        engines: { node: '>= 0.4' }

    has-tostringtag@1.0.2:
        resolution:
            {
                integrity: sha512-NqADB8VjPFLM2V0VvHUewwwsw0ZWBaIdgo+ieHtK3hasLz4qeCRjYcqfB6AQrBggRKppKF8L52/VqdVsO47Dlw==
            }
        engines: { node: '>= 0.4' }

    hasown@2.0.2:
        resolution:
            {
                integrity: sha512-0hJU9SCPvmMzIBdZFqNPXWa6dqh7WdH0cII9y+CyS8rG3nL48Bclra9HmKhVVUHyPWNH5Y7xDwAB7bfgSjkUMQ==
            }
        engines: { node: '>= 0.4' }

    hls.js@1.6.13:
        resolution:
            {
                integrity: sha512-hNEzjZNHf5bFrUNvdS4/1RjIanuJ6szpWNfTaX5I6WfGynWXGT7K/YQLYtemSvFExzeMdgdE4SsyVLJbd5PcZA==
            }

    hyphenate-style-name@1.1.0:
        resolution:
            {
                integrity: sha512-WDC/ui2VVRrz3jOVi+XtjqkDjiVjTtFaAGiW37k6b+ohyQ5wYDOGkvCZa8+H0nx3gyvv0+BST9xuOgIyGQ00gw==
            }

    idb@7.1.1:
        resolution:
            {
                integrity: sha512-gchesWBzyvGHRO9W8tzUWFDycow5gwjvFKfyV9FF32Y7F50yZMp7mP+T2mJIWFx49zicqyC4uefHM17o6xKIVQ==
            }

    ieee754@1.2.1:
        resolution:
            {
                integrity: sha512-dcyqhDvX1C46lXZcVqCpK+FtMRQVdIMN6/Df5js2zouUsqG7I6sFxitIC+7KYK29KdXOLHdu9zL4sFnoVQnqaA==
            }

    ignore@5.3.2:
        resolution:
            {
                integrity: sha512-hsBTNUqQTDwkWtcdYI2i06Y/nUBEsNEDJKjWdigLvegy8kDuJAS8uRlpkkcQpyEXL0Z/pjDy5HBmMjRCJ2gq+g==
            }
        engines: { node: '>= 4' }

    ignore@7.0.5:
        resolution:
            {
                integrity: sha512-Hs59xBNfUIunMFgWAbGX5cq6893IbWg4KnrjbYwX3tx0ztorVgTDA6B2sxf8ejHJ4wz8BqGUMYlnzNBer5NvGg==
            }
        engines: { node: '>= 4' }

    immediate@3.0.6:
        resolution:
            {
                integrity: sha512-XXOFtyqDjNDAQxVfYxuF7g9Il/IbWmmlQg2MYKOH8ExIT1qg6xc4zyS3HaEEATgs1btfzxq15ciUiY7gjSXRGQ==
            }

    import-fresh@3.3.1:
        resolution:
            {
                integrity: sha512-TR3KfrTZTYLPB6jUjfx6MF9WcWrHL9su5TObK4ZkYgBdWKPOFoSoQIdEuTuR82pmtxH2spWG9h6etwfr1pLBqQ==
            }
        engines: { node: '>=6' }

    imurmurhash@0.1.4:
        resolution:
            {
                integrity: sha512-JmXMZ6wuvDmLiHEml9ykzqO6lwFbof0GG4IkcGaENdCRDDmMVnny7s5HsIgHCbaq0w2MyPhDqkhTUgS2LU2PHA==
            }
        engines: { node: '>=0.8.19' }

    inflight@1.0.6:
        resolution:
            {
                integrity: sha512-k92I/b08q4wvFscXCLvqfsHCrjrF7yiXsQuIVvVE7N82W3+aqpzuUdBbfhWcy/FZR3/4IgflMgKLOsvPDrGCJA==
            }
        deprecated: This module is not supported, and leaks memory. Do not use it. Check out lru-cache if you want a good and tested way to coalesce async requests by a key value, which is much more comprehensive and powerful.

    inherits@2.0.4:
        resolution:
            {
                integrity: sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ==
            }

    inline-style-prefixer@7.0.1:
        resolution:
            {
                integrity: sha512-lhYo5qNTQp3EvSSp3sRvXMbVQTLrvGV6DycRMJ5dm2BLMiJ30wpXKdDdgX+GmJZ5uQMucwRKHamXSst3Sj/Giw==
            }

    input-otp@1.4.2:
        resolution:
            {
                integrity: sha512-l3jWwYNvrEa6NTCt7BECfCm48GvwuZzkoeG3gBL2w4CHeOXW3eKFmf9UNYkNfYc3mxMrthMnxjIE07MT0zLBQA==
            }
        peerDependencies:
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0.0 || ^19.0.0-rc

    internal-slot@1.1.0:
        resolution:
            {
                integrity: sha512-4gd7VpWNQNB4UKKCFFVcp1AVv+FMOgs9NKzjHKusc8jTMhd5eL1NqQqOpE0KzMds804/yHlglp3uxgluOqAPLw==
            }
        engines: { node: '>= 0.4' }

    internmap@2.0.3:
        resolution:
            {
                integrity: sha512-5Hh7Y1wQbvY5ooGgPbDaL5iYLAPzMTUrjMulskHLH6wnv/A+1q5rgEaiuqEjB+oxGXIVZs1FF+R/KPN3ZSQYYg==
            }
        engines: { node: '>=12' }

    is-array-buffer@3.0.5:
        resolution:
            {
                integrity: sha512-DDfANUiiG2wC1qawP66qlTugJeL5HyzMpfr8lLK+jMQirGzNod0B12cFB/9q838Ru27sBwfw78/rdoU7RERz6A==
            }
        engines: { node: '>= 0.4' }

    is-async-function@2.1.1:
        resolution:
            {
                integrity: sha512-9dgM/cZBnNvjzaMYHVoxxfPj2QXt22Ev7SuuPrs+xav0ukGB0S6d4ydZdEiM48kLx5kDV+QBPrpVnFyefL8kkQ==
            }
        engines: { node: '>= 0.4' }

    is-bigint@1.1.0:
        resolution:
            {
                integrity: sha512-n4ZT37wG78iz03xPRKJrHTdZbe3IicyucEtdRsV5yglwc3GyUfbAfpSeD0FJ41NbUNSt5wbhqfp1fS+BgnvDFQ==
            }
        engines: { node: '>= 0.4' }

    is-binary-path@2.1.0:
        resolution:
            {
                integrity: sha512-ZMERYes6pDydyuGidse7OsHxtbI7WVeUEozgR/g7rd0xUimYNlvZRE/K2MgZTjWy725IfelLeVcEM97mmtRGXw==
            }
        engines: { node: '>=8' }

    is-boolean-object@1.2.2:
        resolution:
            {
                integrity: sha512-wa56o2/ElJMYqjCjGkXri7it5FbebW5usLw/nPmCMs5DeZ7eziSYZhSmPRn0txqeW4LnAmQQU7FgqLpsEFKM4A==
            }
        engines: { node: '>= 0.4' }

    is-callable@1.2.7:
        resolution:
            {
                integrity: sha512-1BC0BVFhS/p0qtw6enp8e+8OD0UrK0oFLztSjNzhcKA3WDuJxxAPXzPuPtKkjEY9UUoEWlX/8fgKeu2S8i9JTA==
            }
        engines: { node: '>= 0.4' }

    is-core-module@2.16.1:
        resolution:
            {
                integrity: sha512-UfoeMA6fIJ8wTYFEUjelnaGI67v6+N7qXJEvQuIGa99l4xsCruSYOVSQ0uPANn4dAzm8lkYPaKLrrijLq7x23w==
            }
        engines: { node: '>= 0.4' }

    is-data-view@1.0.2:
        resolution:
            {
                integrity: sha512-RKtWF8pGmS87i2D6gqQu/l7EYRlVdfzemCJN/P3UOs//x1QE7mfhvzHIApBTRf7axvT6DMGwSwBXYCT0nfB9xw==
            }
        engines: { node: '>= 0.4' }

    is-date-object@1.1.0:
        resolution:
            {
                integrity: sha512-PwwhEakHVKTdRNVOw+/Gyh0+MzlCl4R6qKvkhuvLtPMggI1WAHt9sOwZxQLSGpUaDnrdyDsomoRgNnCfKNSXXg==
            }
        engines: { node: '>= 0.4' }

    is-extglob@2.1.1:
        resolution:
            {
                integrity: sha512-SbKbANkN603Vi4jEZv49LeVJMn4yGwsbzZworEoyEiutsN3nJYdbO36zfhGJ6QEDpOZIFkDtnq5JRxmvl3jsoQ==
            }
        engines: { node: '>=0.10.0' }

    is-finalizationregistry@1.1.1:
        resolution:
            {
                integrity: sha512-1pC6N8qWJbWoPtEjgcL2xyhQOP491EQjeUo3qTKcmV8YSDDJrOepfG8pcC7h/QgnQHYSv0mJ3Z/ZWxmatVrysg==
            }
        engines: { node: '>= 0.4' }

    is-fullwidth-code-point@3.0.0:
        resolution:
            {
                integrity: sha512-zymm5+u+sCsSWyD9qNaejV3DFvhCKclKdizYaJUuHA83RLjb7nSuGnddCHGv0hk+KY7BMAlsWeK4Ueg6EV6XQg==
            }
        engines: { node: '>=8' }

    is-generator-function@1.1.2:
        resolution:
            {
                integrity: sha512-upqt1SkGkODW9tsGNG5mtXTXtECizwtS2kA161M+gJPc1xdb/Ax629af6YrTwcOeQHbewrPNlE5Dx7kzvXTizA==
            }
        engines: { node: '>= 0.4' }

    is-glob@4.0.3:
        resolution:
            {
                integrity: sha512-xelSayHH36ZgE7ZWhli7pW34hNbNl8Ojv5KVmkJD4hBdD3th8Tfk9vYasLM+mXWOZhFkgZfxhLSnrwRr4elSSg==
            }
        engines: { node: '>=0.10.0' }

    is-map@2.0.3:
        resolution:
            {
                integrity: sha512-1Qed0/Hr2m+YqxnM09CjA2d/i6YZNfF6R2oRAOj36eUdS6qIV/huPJNSEpKbupewFs+ZsJlxsjjPbc0/afW6Lw==
            }
        engines: { node: '>= 0.4' }

    is-negative-zero@2.0.3:
        resolution:
            {
                integrity: sha512-5KoIu2Ngpyek75jXodFvnafB6DJgr3u8uuK0LEZJjrU19DrMD3EVERaR8sjz8CCGgpZvxPl9SuE1GMVPFHx1mw==
            }
        engines: { node: '>= 0.4' }

    is-number-object@1.1.1:
        resolution:
            {
                integrity: sha512-lZhclumE1G6VYD8VHe35wFaIif+CTy5SJIi5+3y4psDgWu4wPDoBhF8NxUOinEc7pHgiTsT6MaBb92rKhhD+Xw==
            }
        engines: { node: '>= 0.4' }

    is-number@7.0.0:
        resolution:
            {
                integrity: sha512-41Cifkg6e8TylSpdtTpeLVMqvSBEVzTttHvERD741+pnZ8ANv0004MRL43QKPDlK9cGvNp6NZWZUBlbGXYxxng==
            }
        engines: { node: '>=0.12.0' }

    is-path-inside@3.0.3:
        resolution:
            {
                integrity: sha512-Fd4gABb+ycGAmKou8eMftCupSir5lRxqf4aD/vd0cD2qc4HL07OjCeuHMr8Ro4CoMaeCKDB0/ECBOVWjTwUvPQ==
            }
        engines: { node: '>=8' }

    is-promise@2.2.2:
        resolution:
            {
                integrity: sha512-+lP4/6lKUBfQjZ2pdxThZvLUAafmZb8OAxFb8XXtiQmS35INgr85hdOGoEs124ez1FCnZJt6jau/T+alh58QFQ==
            }

    is-regex@1.2.1:
        resolution:
            {
                integrity: sha512-MjYsKHO5O7mCsmRGxWcLWheFqN9DJ/2TmngvjKXihe6efViPqc274+Fx/4fYj/r03+ESvBdTXK0V6tA3rgez1g==
            }
        engines: { node: '>= 0.4' }

    is-set@2.0.3:
        resolution:
            {
                integrity: sha512-iPAjerrse27/ygGLxw+EBR9agv9Y6uLeYVJMu+QNCoouJ1/1ri0mGrcWpfCqFZuzzx3WjtwxG098X+n4OuRkPg==
            }
        engines: { node: '>= 0.4' }

    is-shared-array-buffer@1.0.4:
        resolution:
            {
                integrity: sha512-ISWac8drv4ZGfwKl5slpHG9OwPNty4jOWPRIhBpxOoD+hqITiwuipOQ2bNthAzwA3B4fIjO4Nln74N0S9byq8A==
            }
        engines: { node: '>= 0.4' }

    is-string@1.1.1:
        resolution:
            {
                integrity: sha512-BtEeSsoaQjlSPBemMQIrY1MY0uM6vnS1g5fmufYOtnxLGUZM2178PKbhsk7Ffv58IX+ZtcvoGwccYsh0PglkAA==
            }
        engines: { node: '>= 0.4' }

    is-symbol@1.1.1:
        resolution:
            {
                integrity: sha512-9gGx6GTtCQM73BgmHQXfDmLtfjjTUDSyoxTCbp5WtoixAhfgsDirWIcVQ/IHpvI5Vgd5i/J5F7B9cN/WlVbC/w==
            }
        engines: { node: '>= 0.4' }

    is-typed-array@1.1.15:
        resolution:
            {
                integrity: sha512-p3EcsicXjit7SaskXHs1hA91QxgTw46Fv6EFKKGS5DRFLD8yKnohjF3hxoju94b/OcMZoQukzpPpBE9uLVKzgQ==
            }
        engines: { node: '>= 0.4' }

    is-weakmap@2.0.2:
        resolution:
            {
                integrity: sha512-K5pXYOm9wqY1RgjpL3YTkF39tni1XajUIkawTLUo9EZEVUFga5gSQJF8nNS7ZwJQ02y+1YCNYcMh+HIf1ZqE+w==
            }
        engines: { node: '>= 0.4' }

    is-weakref@1.1.1:
        resolution:
            {
                integrity: sha512-6i9mGWSlqzNMEqpCp93KwRS1uUOodk2OJ6b+sq7ZPDSy2WuI5NFIxp/254TytR8ftefexkWn5xNiHUNpPOfSew==
            }
        engines: { node: '>= 0.4' }

    is-weakset@2.0.4:
        resolution:
            {
                integrity: sha512-mfcwb6IzQyOKTs84CQMrOwW4gQcaTOAWJ0zzJCl2WSPDrWk/OzDaImWFH3djXhb24g4eudZfLRozAvPGw4d9hQ==
            }
        engines: { node: '>= 0.4' }

    isarray@2.0.5:
        resolution:
            {
                integrity: sha512-xHjhDr3cNBK0BzdUJSPXZntQUx/mwMS5Rw4A7lPJ90XGAO6ISP/ePDNuo0vhqOZU+UD5JoodwCAAoZQd3FeAKw==
            }

    isbot@5.1.31:
        resolution:
            {
                integrity: sha512-DPgQshehErHAqSCKDb3rNW03pa2wS/v5evvUqtxt6TTnHRqAG8FdzcSSJs9656pK6Y+NT7K9R4acEYXLHYfpUQ==
            }
        engines: { node: '>=18' }

    isexe@2.0.0:
        resolution:
            {
                integrity: sha512-RHxMLp9lnKHGHRng9QFhRCMbYAcVpn69smSGcq3f36xjgVVWThj4qqLbTLlq7Ssj8B+fIQ1EuCEGI2lKsyQeIw==
            }

    iterator.prototype@1.1.5:
        resolution:
            {
                integrity: sha512-H0dkQoCa3b2VEeKQBOxFph+JAbcrQdE7KC0UkqwpLmv2EC4P41QXP+rqo9wYodACiG5/WM5s9oDApTU8utwj9g==
            }
        engines: { node: '>= 0.4' }

    its-fine@2.0.0:
        resolution:
            {
                integrity: sha512-KLViCmWx94zOvpLwSlsx6yOCeMhZYaxrJV87Po5k/FoZzcPSahvK5qJ7fYhS61sZi5ikmh2S3Hz55A2l3U69ng==
            }
        peerDependencies:
            react: ^19.0.0

    jackspeak@3.4.3:
        resolution:
            {
                integrity: sha512-OGlZQpz2yfahA/Rd1Y8Cd9SIEsqvXkLVoSw/cgwhnhFMDbsQFeZYoJJ7bIZBS9BcamUW96asq/npPWugM+RQBw==
            }

    jiti@1.21.7:
        resolution:
            {
                integrity: sha512-/imKNG4EbWNrVjoNC/1H5/9GFy+tqjGBHCaSsN+P2RnPqjsLmv6UD3Ej+Kj8nBWaRAwyk7kK5ZUc+OEatnTR3A==
            }
        hasBin: true

    js-cookie@2.2.1:
        resolution:
            {
                integrity: sha512-HvdH2LzI/EAZcUwA8+0nKNtWHqS+ZmijLA30RwZA0bo7ToCckjK5MkGhjED9KoRcXO6BaGI3I9UIzSA1FKFPOQ==
            }

    js-tokens@4.0.0:
        resolution:
            {
                integrity: sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ==
            }

    js-yaml@4.1.0:
        resolution:
            {
                integrity: sha512-wpxZs9NoxZaJESJGIZTyDEaYpl0FKSA+FB9aJiyemKhMwkxQg63h4T1KJgUGHpTqPDNRcmmYLugrRjJlBtWvRA==
            }
        hasBin: true

    jsesc@3.1.0:
        resolution:
            {
                integrity: sha512-/sM3dO2FOzXjKQhJuo0Q173wf2KOo8t4I8vHy6lF9poUp7bKT0/NHE8fPX23PwfhnykfqnC2xRxOnVw5XuGIaA==
            }
        engines: { node: '>=6' }
        hasBin: true

    json-buffer@3.0.1:
        resolution:
            {
                integrity: sha512-4bV5BfR2mqfQTJm+V5tPPdf+ZpuhiIvTuAB5g8kcrXOZpTT/QwwVRWBywX1ozr6lEuPdbHxwaJlm9G6mI2sfSQ==
            }

    json-schema-traverse@0.4.1:
        resolution:
            {
                integrity: sha512-xbbCH5dCYU5T8LcEhhuh7HJ88HXuW3qsI3Y0zOZFKfZEHcpWiHU/Jxzk629Brsab/mMiHQti9wMP+845RPe3Vg==
            }

    json-stable-stringify-without-jsonify@1.0.1:
        resolution:
            {
                integrity: sha512-Bdboy+l7tA3OGW6FjyFHWkP5LuByj1Tk33Ljyq0axyzdk9//JSi2u3fP1QSmd1KNwq6VOKYGlAu87CisVir6Pw==
            }

    json5@2.2.3:
        resolution:
            {
                integrity: sha512-XmOWe7eyHYH14cLdVPoyg+GOH3rYX++KpzrylJwSW98t3Nk+U8XOl8FWKOgwtzdb8lXGf6zYwDUzeHMWfxasyg==
            }
        engines: { node: '>=6' }
        hasBin: true

    jsx-ast-utils@3.3.5:
        resolution:
            {
                integrity: sha512-ZZow9HBI5O6EPgSJLUb8n2NKgmVWTwCvHGwFuJlMjvLFqlGG6pjirPhtdsseaLZjSibD8eegzmYpUZwoIlj2cQ==
            }
        engines: { node: '>=4.0' }

    keyv@4.5.4:
        resolution:
            {
                integrity: sha512-oxVHkHR/EJf2CNXnWxRLW6mg7JyCCUcG0DtEGmL2ctUo1PNTin1PUil+r/+4r5MpVgC/fn1kjsx7mjSujKqIpw==
            }

    levn@0.4.1:
        resolution:
            {
                integrity: sha512-+bT2uH4E5LGE7h/n3evcS/sQlJXCpIp6ym8OWJ5eV6+67Dsql/LaaT7qJBAt2rzfoa/5QBGBhxDix1dMt2kQKQ==
            }
        engines: { node: '>= 0.8.0' }

    lie@3.3.0:
        resolution:
            {
                integrity: sha512-UaiMJzeWRlEujzAuw5LokY1L5ecNQYZKfmyZ9L7wDHb/p5etKaxXhohBcrw0EYby+G/NA52vRSN4N39dxHAIwQ==
            }

    lilconfig@3.1.3:
        resolution:
            {
                integrity: sha512-/vlFKAoH5Cgt3Ie+JLhRbwOsCQePABiU3tJ1egGvyQ+33R/vcwM2Zl2QR/LzjsBeItPt3oSVXapn+m4nQDvpzw==
            }
        engines: { node: '>=14' }

    lines-and-columns@1.2.4:
        resolution:
            {
                integrity: sha512-7ylylesZQ/PV29jhEDl3Ufjo6ZX7gCqJr5F7PKrqc93v7fzSymt1BpwEU8nAUXs8qzzvqhbjhK5QZg6Mt/HkBg==
            }

    locate-path@6.0.0:
        resolution:
            {
                integrity: sha512-iPZK6eYjbxRu3uB4/WZ3EsEIMJFMqAoopl3R+zuq0UjcAm/MO6KCweDgPfP3elTztoKP3KtnVHxTn2NHBSDVUw==
            }
        engines: { node: '>=10' }

    lodash-es@4.17.21:
        resolution:
            {
                integrity: sha512-mKnC+QJ9pWVzv+C4/U3rRsHapFfHvQFoFB92e52xeyGMcX6/OlIl78je1u8vePzYZSkkogMPJ2yjxxsb89cxyw==
            }

    lodash.castarray@4.4.0:
        resolution:
            {
                integrity: sha512-aVx8ztPv7/2ULbArGJ2Y42bG1mEQ5mGjpdvrbJcJFU3TbYybe+QlLS4pst9zV52ymy2in1KpFPiZnAOATxD4+Q==
            }

    lodash.clonedeep@4.5.0:
        resolution:
            {
                integrity: sha512-H5ZhCF25riFd9uB5UCkVKo61m3S/xZk1x4wA6yp/L3RFP6Z/eHH1ymQcGLo7J3GMPfm0V/7m1tryHuGVxpqEBQ==
            }

    lodash.isequal@4.5.0:
        resolution:
            {
                integrity: sha512-pDo3lu8Jhfjqls6GkMgpahsF9kCyayhgykjyLMNFTKWrpVdAQtYyB4muAMWozBB4ig/dtWAmsMxLEI8wuz+DYQ==
            }
        deprecated: This package is deprecated. Use require('node:util').isDeepStrictEqual instead.

    lodash.isplainobject@4.0.6:
        resolution:
            {
                integrity: sha512-oSXzaWypCMHkPC3NvBEaPHf0KsA5mvPrOPgQWDsbg8n7orZ290M0BmC/jgRZ4vcJ6DTAhjrsSYgdsW/F+MFOBA==
            }

    lodash.merge@4.6.2:
        resolution:
            {
                integrity: sha512-0KpjqXRVvrYyCsX1swR/XTK0va6VQkQM6MNo7PqW77ByjAhoARA8EfrP1N4+KlKj8YS0ZUCtRT/YUuhyYDujIQ==
            }

    lodash@4.17.21:
        resolution:
            {
                integrity: sha512-v2kDEe57lecTulaDIuNTPy3Ry4gLGJ6Z1O3vE1krgXZNrsQ+LFTGHVxVjcXPs17LhbZVGedAJv8XZ1tvj5FvSg==
            }

    loose-envify@1.4.0:
        resolution:
            {
                integrity: sha512-lyuxPGr/Wfhrlem2CL/UcnUc1zcqKAImBDzukY7Y5F/yQiNdko6+fRLevlw1HgMySw7f611UIY408EtxRSoK3Q==
            }
        hasBin: true

    lru-cache@10.4.3:
        resolution:
            {
                integrity: sha512-JNAzZcXrCt42VGLuYz0zfAzDfAvJWW6AfYlDBQyDV5DClI2m5sAmK+OIO7s59XfsRsWHp02jAJrRadPRGTt6SQ==
            }

    lru-cache@5.1.1:
        resolution:
            {
                integrity: sha512-KpNARQA3Iwv+jTA0utUVVbrh+Jlrr1Fv0e56GGzAFOXN7dk/FviaDW8LHmK52DlcH4WP2n6gI8vN1aesBFgo9w==
            }

    lucide-react@0.511.0:
        resolution:
            {
                integrity: sha512-VK5a2ydJ7xm8GvBeKLS9mu1pVK6ucef9780JVUjw6bAjJL/QXnd4Y0p7SPeOUMC27YhzNCZvm5d/QX0Tp3rc0w==
            }
        peerDependencies:
            react: ^16.5.1 || ^17.0.0 || ^18.0.0 || ^19.0.0

    maath@0.10.8:
        resolution:
            {
                integrity: sha512-tRvbDF0Pgqz+9XUa4jjfgAQ8/aPKmQdWXilFu2tMy4GWj4NOsx99HlULO4IeREfbO3a0sA145DZYyvXPkybm0g==
            }
        peerDependencies:
            '@types/three': '>=0.134.0'
            three: '>=0.134.0'

    math-intrinsics@1.1.0:
        resolution:
            {
                integrity: sha512-/IXtbwEk5HTPyEwyKX6hGkYXxM9nbj64B+ilVJnC/R6B0pH5G4V3b0pVbL7DBj4tkhBAppbQUlf6F6Xl9LHu1g==
            }
        engines: { node: '>= 0.4' }

    mdn-data@2.0.14:
        resolution:
            {
                integrity: sha512-dn6wd0uw5GsdswPFfsgMp5NSB0/aDe6fK94YJV/AJDYXL6HVLWBsxeq7js7Ad+mU2K9LAlwpk6kN2D5mwCPVow==
            }

    merge2@1.4.1:
        resolution:
            {
                integrity: sha512-8q7VEgMJW4J8tcfVPy8g09NcQwZdbwFEqhe/WZkoIzjn/3TGDwtOCYtXGxA3O8tPzpczCCDgv+P2P5y00ZJOOg==
            }
        engines: { node: '>= 8' }

    meshline@3.3.1:
        resolution:
            {
                integrity: sha512-/TQj+JdZkeSUOl5Mk2J7eLcYTLiQm2IDzmlSvYm7ov15anEcDJ92GHqqazxTSreeNgfnYu24kiEvvv0WlbCdFQ==
            }
        peerDependencies:
            three: '>=0.137'

    meshoptimizer@0.18.1:
        resolution:
            {
                integrity: sha512-ZhoIoL7TNV4s5B6+rx5mC//fw8/POGyNxS/DZyCJeiZ12ScLfVwRE/GfsxwiTkMYYD5DmK2/JXnEVXqL4rF+Sw==
            }

    micromatch@4.0.8:
        resolution:
            {
                integrity: sha512-PXwfBhYu0hBCPw8Dn0E+WDYb7af3dSLVWKi3HGv84IdF4TyFoC0ysxFd0Goxw7nSv4T/PzEJQxsYsEiFCKo2BA==
            }
        engines: { node: '>=8.6' }

    minimatch@3.1.2:
        resolution:
            {
                integrity: sha512-J7p63hRiAjw1NDEww1W7i37+ByIrOWO5XQQAzZ3VOcL0PNybwpfmV/N05zFAzwQ9USyEcX6t3UO+K5aqBQOIHw==
            }

    minimatch@9.0.5:
        resolution:
            {
                integrity: sha512-G6T0ZX48xgozx7587koeX9Ys2NYy6Gmv//P89sEte9V9whIapMNF4idKxnW2QtCcLiTWlb/wfCabAtAFWhhBow==
            }
        engines: { node: '>=16 || 14 >=14.17' }

    minimist@1.2.8:
        resolution:
            {
                integrity: sha512-2yyAR8qBkN3YuheJanUpWC5U3bb5osDywNB8RzDVlDwDHbocAJveqqj1u8+SVD7jkWT4yvsHCpWqqWqAxb0zCA==
            }

    minipass@7.1.2:
        resolution:
            {
                integrity: sha512-qOOzS1cBTWYF4BH8fVePDBOO9iptMnGUEZwNc/cMWnTV2nVLZ7VoNWEPHkYczZA0pdoA7dl6e7FL659nX9S2aw==
            }
        engines: { node: '>=16 || 14 >=14.17' }

    ms@2.1.3:
        resolution:
            {
                integrity: sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==
            }

    mz@2.7.0:
        resolution:
            {
                integrity: sha512-z81GNO7nnYMEhrGh9LeymoE4+Yr0Wn5McHIZMK5cfQCl+NDX08sCZgUc9/6MHni9IWuFLm1Z3HTCXu2z9fN62Q==
            }

    nano-css@5.6.2:
        resolution:
            {
                integrity: sha512-+6bHaC8dSDGALM1HJjOHVXpuastdu2xFoZlC77Jh4cg+33Zcgm+Gxd+1xsnpZK14eyHObSp82+ll5y3SX75liw==
            }
        peerDependencies:
            react: '*'
            react-dom: '*'

    nanoid@3.3.11:
        resolution:
            {
                integrity: sha512-N8SpfPUnUp1bK+PMYW8qSWdl9U+wwNWI4QKxOYDy9JAro3WMX7p2OeVRF9v+347pnakNevPmiHhNmZ2HbFA76w==
            }
        engines: { node: ^10 || ^12 || ^13.7 || ^14 || >=15.0.1 }
        hasBin: true

    natural-compare@1.4.0:
        resolution:
            {
                integrity: sha512-OWND8ei3VtNC9h7V60qff3SVobHr996CTwgxubgyQYEpg290h9J0buyECNNJexkFm5sOajh5G116RYA1c8ZMSw==
            }

    next-themes@0.4.6:
        resolution:
            {
                integrity: sha512-pZvgD5L0IEvX5/9GWyHMf3m8BKiVQwsCMHfoFosXtXBMnaS0ZnIJ9ST4b4NqLVKDEm8QBxoNNGNaBv2JNF6XNA==
            }
        peerDependencies:
            react: ^16.8 || ^17 || ^18 || ^19 || ^19.0.0-rc
            react-dom: ^16.8 || ^17 || ^18 || ^19 || ^19.0.0-rc

    node-releases@2.0.27:
        resolution:
            {
                integrity: sha512-nmh3lCkYZ3grZvqcCH+fjmQ7X+H0OeZgP40OierEaAptX4XofMh5kwNbWh7lBduUzCcV/8kZ+NDLCwm2iorIlA==
            }

    normalize-path@3.0.0:
        resolution:
            {
                integrity: sha512-6eZs5Ls3WtCisHWp9S2GUy8dqkpGi4BVSz3GaqiE6ezub0512ESztXUwUB6C6IKbQkY2Pnb/mD4WYojCRwcwLA==
            }
        engines: { node: '>=0.10.0' }

    normalize-range@0.1.2:
        resolution:
            {
                integrity: sha512-bdok/XvKII3nUpklnV6P2hxtMNrCboOjAcyBuQnWEhO665FwrSNRxU+AqpsyvO6LgGYPspN+lu5CLtw4jPRKNA==
            }
        engines: { node: '>=0.10.0' }

    object-assign@4.1.1:
        resolution:
            {
                integrity: sha512-rJgTQnkUnH1sFw8yT6VSU3zD3sWmu6sZhIseY8VX+GRu3P6F7Fu+JNDoXfklElbLJSnc3FUQHVe4cU5hj+BcUg==
            }
        engines: { node: '>=0.10.0' }

    object-hash@3.0.0:
        resolution:
            {
                integrity: sha512-RSn9F68PjH9HqtltsSnqYC1XXoWe9Bju5+213R98cNGttag9q9yAOTzdbsqvIa7aNm5WffBZFpWYr2aWrklWAw==
            }
        engines: { node: '>= 6' }

    object-inspect@1.13.4:
        resolution:
            {
                integrity: sha512-W67iLl4J2EXEGTbfeHCffrjDfitvLANg0UlX3wFUUSTx92KXRFegMHUVgSqE+wvhAbi4WqjGg9czysTV2Epbew==
            }
        engines: { node: '>= 0.4' }

    object-keys@1.1.1:
        resolution:
            {
                integrity: sha512-NuAESUOUMrlIXOfHKzD6bpPu3tYt3xvjNdRIQ+FeT0lNb4K8WR70CaDxhuNguS2XG+GjkyMwOzsN5ZktImfhLA==
            }
        engines: { node: '>= 0.4' }

    object.assign@4.1.7:
        resolution:
            {
                integrity: sha512-nK28WOo+QIjBkDduTINE4JkF/UJJKyf2EJxvJKfblDpyg0Q+pkOHNTL0Qwy6NP6FhE/EnzV73BxxqcJaXY9anw==
            }
        engines: { node: '>= 0.4' }

    object.entries@1.1.9:
        resolution:
            {
                integrity: sha512-8u/hfXFRBD1O0hPUjioLhoWFHRmt6tKA4/vZPyckBr18l1KE9uHrFaFaUi8MDRTpi4uak2goyPTSNJLXX2k2Hw==
            }
        engines: { node: '>= 0.4' }

    object.fromentries@2.0.8:
        resolution:
            {
                integrity: sha512-k6E21FzySsSK5a21KRADBd/NGneRegFO5pLHfdQLpRDETUNJueLXs3WCzyQ3tFRDYgbq3KHGXfTbi2bs8WQ6rQ==
            }
        engines: { node: '>= 0.4' }

    object.values@1.2.1:
        resolution:
            {
                integrity: sha512-gXah6aZrcUxjWg2zR2MwouP2eHlCBzdV4pygudehaKXSGW4v2AsRQUK+lwwXhii6KFZcunEnmSUoYp5CXibxtA==
            }
        engines: { node: '>= 0.4' }

    once@1.4.0:
        resolution:
            {
                integrity: sha512-lNaJgI+2Q5URQBkccEKHTQOPaXdUxnZZElQTZY0MFUAuaEqe1E+Nyvgdz/aIyNi6Z9MzO5dv1H8n58/GELp3+w==
            }

    optionator@0.9.4:
        resolution:
            {
                integrity: sha512-6IpQ7mKUxRcZNLIObR0hz7lxsapSSIYNZJwXPGeF0mTVqGKFIXj1DQcMoT22S3ROcLyY/rz0PWaWZ9ayWmad9g==
            }
        engines: { node: '>= 0.8.0' }

    own-keys@1.0.1:
        resolution:
            {
                integrity: sha512-qFOyK5PjiWZd+QQIh+1jhdb9LpxTF0qs7Pm8o5QHYZ0M3vKqSqzsZaEB6oWlxZ+q2sJBMI/Ktgd2N5ZwQoRHfg==
            }
        engines: { node: '>= 0.4' }

    p-limit@3.1.0:
        resolution:
            {
                integrity: sha512-TYOanM3wGwNGsZN2cVTYPArw454xnXj5qmWF1bEoAc4+cU/ol7GVh7odevjp1FNHduHc3KZMcFduxU5Xc6uJRQ==
            }
        engines: { node: '>=10' }

    p-locate@5.0.0:
        resolution:
            {
                integrity: sha512-LaNjtRWUBY++zB5nE/NwcaoMylSPk+S+ZHNB1TzdbMJMny6dynpAGt7X/tl/QYq3TIeE6nxHppbo2LGymrG5Pw==
            }
        engines: { node: '>=10' }

    package-json-from-dist@1.0.1:
        resolution:
            {
                integrity: sha512-UEZIS3/by4OC8vL3P2dTXRETpebLI2NiI5vIrjaD/5UtrkFX/tNbwjTSRAGC/+7CAo2pIcBaRgWmcBBHcsaCIw==
            }

    parchment@3.0.0:
        resolution:
            {
                integrity: sha512-HUrJFQ/StvgmXRcQ1ftY6VEZUq3jA2t9ncFN4F84J/vN0/FPpQF+8FKXb3l6fLces6q0uOHj6NJn+2xvZnxO6A==
            }

    parent-module@1.0.1:
        resolution:
            {
                integrity: sha512-GQ2EWRpQV8/o+Aw8YqtfZZPfNRWZYkbidE9k5rpl/hC3vtHHBfGm2Ifi6qWV+coDGkrUKZAxE3Lot5kcsRlh+g==
            }
        engines: { node: '>=6' }

    path-exists@4.0.0:
        resolution:
            {
                integrity: sha512-ak9Qy5Q7jYb2Wwcey5Fpvg2KoAc/ZIhLSLOSBmRmygPsGwkVVt0fZa0qrtMz+m6tJTAHfZQ8FnmB4MG4LWy7/w==
            }
        engines: { node: '>=8' }

    path-is-absolute@1.0.1:
        resolution:
            {
                integrity: sha512-AVbw3UJ2e9bq64vSaS9Am0fje1Pa8pbGqTTsmXfaIiMpnr5DlDhfJOuLj9Sf95ZPVDAUerDfEk88MPmPe7UCQg==
            }
        engines: { node: '>=0.10.0' }

    path-key@3.1.1:
        resolution:
            {
                integrity: sha512-ojmeN0qd+y0jszEtoY48r0Peq5dwMEkIlCOu6Q5f41lfkswXuKtYrhgoTpLnyIcHm24Uhqx+5Tqm2InSwLhE6Q==
            }
        engines: { node: '>=8' }

    path-parse@1.0.7:
        resolution:
            {
                integrity: sha512-LDJzPVEEEPR+y48z93A0Ed0yXb8pAByGWo/k5YYdYgpY2/2EsOsksJrq7lOHxryrVOn1ejG6oAp8ahvOIQD8sw==
            }

    path-scurry@1.11.1:
        resolution:
            {
                integrity: sha512-Xa4Nw17FS9ApQFJ9umLiJS4orGjm7ZzwUrwamcGQuHSzDyth9boKDaycYdDcZDuqYATXw4HFXgaqWTctW/v1HA==
            }
        engines: { node: '>=16 || 14 >=14.18' }

    picocolors@1.1.1:
        resolution:
            {
                integrity: sha512-xceH2snhtb5M9liqDsmEw56le376mTZkEX/jEb/RxNFyegNul7eNslCXP9FDj/Lcu0X8KEyMceP2ntpaHrDEVA==
            }

    picomatch@2.3.1:
        resolution:
            {
                integrity: sha512-JU3teHTNjmE2VCGFzuY8EXzCDVwEqB2a8fsIvwaStHhAWJEeVd1o1QD80CU6+ZdEXXSLbSsuLwJjkCBWqRQUVA==
            }
        engines: { node: '>=8.6' }

    pify@2.3.0:
        resolution:
            {
                integrity: sha512-udgsAY+fTnvv7kI7aaxbqwWNb0AHiB0qBO89PZKPkoTmGOgdbrHDKD+0B2X4uTfJ/FT1R09r9gTsjUjNJotuog==
            }
        engines: { node: '>=0.10.0' }

    pirates@4.0.7:
        resolution:
            {
                integrity: sha512-TfySrs/5nm8fQJDcBDuUng3VOUKsd7S+zqvbOTiGXHfxX4wK31ard+hoNuvkicM/2YFzlpDgABOevKSsB4G/FA==
            }
        engines: { node: '>= 6' }

    possible-typed-array-names@1.1.0:
        resolution:
            {
                integrity: sha512-/+5VFTchJDoVj3bhoqi6UeymcD00DAwb1nJwamzPvHEszJ4FpF6SNNbUbOS8yI56qHzdV8eK0qEfOSiodkTdxg==
            }
        engines: { node: '>= 0.4' }

    postcss-import@15.1.0:
        resolution:
            {
                integrity: sha512-hpr+J05B2FVYUAXHeK1YyI267J/dDDhMU6B6civm8hSY1jYJnBXxzKDKDswzJmtLHryrjhnDjqqp/49t8FALew==
            }
        engines: { node: '>=14.0.0' }
        peerDependencies:
            postcss: ^8.0.0

    postcss-js@4.1.0:
        resolution:
            {
                integrity: sha512-oIAOTqgIo7q2EOwbhb8UalYePMvYoIeRY2YKntdpFQXNosSu3vLrniGgmH9OKs/qAkfoj5oB3le/7mINW1LCfw==
            }
        engines: { node: ^12 || ^14 || >= 16 }
        peerDependencies:
            postcss: ^8.4.21

    postcss-load-config@6.0.1:
        resolution:
            {
                integrity: sha512-oPtTM4oerL+UXmx+93ytZVN82RrlY/wPUV8IeDxFrzIjXOLF1pN+EmKPLbubvKHT2HC20xXsCAH2Z+CKV6Oz/g==
            }
        engines: { node: '>= 18' }
        peerDependencies:
            jiti: '>=1.21.0'
            postcss: '>=8.0.9'
            tsx: ^4.8.1
            yaml: ^2.4.2
        peerDependenciesMeta:
            jiti:
                optional: true
            postcss:
                optional: true
            tsx:
                optional: true
            yaml:
                optional: true

    postcss-nested@6.2.0:
        resolution:
            {
                integrity: sha512-HQbt28KulC5AJzG+cZtj9kvKB93CFCdLvog1WFLf1D+xmMvPGlBstkpTEZfK5+AN9hfJocyBFCNiqyS48bpgzQ==
            }
        engines: { node: '>=12.0' }
        peerDependencies:
            postcss: ^8.2.14

    postcss-selector-parser@6.0.10:
        resolution:
            {
                integrity: sha512-IQ7TZdoaqbT+LCpShg46jnZVlhWD2w6iQYAcYXfHARZ7X1t/UGhhceQDs5X0cGqKvYlHNOuv7Oa1xmb0oQuA3w==
            }
        engines: { node: '>=4' }

    postcss-selector-parser@6.1.2:
        resolution:
            {
                integrity: sha512-Q8qQfPiZ+THO/3ZrOrO0cJJKfpYCagtMUkXbnEfmgUjwXg6z/WBeOyS9APBBPCTSiDV+s4SwQGu8yFsiMRIudg==
            }
        engines: { node: '>=4' }

    postcss-value-parser@4.2.0:
        resolution:
            {
                integrity: sha512-1NNCs6uurfkVbeXG4S8JFT9t19m45ICnif8zWLd5oPSZ50QnwMfK+H3jv408d4jw/7Bttv5axS5IiHoLaVNHeQ==
            }

    postcss@8.5.6:
        resolution:
            {
                integrity: sha512-3Ybi1tAuwAP9s0r1UQ2J4n5Y0G05bJkpUIO0/bI9MhwmD70S5aTWbXGBwxHrelT+XM1k6dM0pk+SwNkpTRN7Pg==
            }
        engines: { node: ^10 || ^12 || >=14 }

    potpack@1.0.2:
        resolution:
            {
                integrity: sha512-choctRBIV9EMT9WGAZHn3V7t0Z2pMQyl0EZE6pFc/6ml3ssw7Dlf/oAOvFwjm1HVsqfQN8GfeFyJ+d8tRzqueQ==
            }

    prelude-ls@1.2.1:
        resolution:
            {
                integrity: sha512-vkcDPrRZo1QZLbn5RLGPpg/WmIQ65qoWWhcGKf/b5eplkkarX0m9z8ppCat4mlOqUsWpyNuYgO3VRyrYHSzX5g==
            }
        engines: { node: '>= 0.8.0' }

    promise-worker-transferable@1.0.4:
        resolution:
            {
                integrity: sha512-bN+0ehEnrXfxV2ZQvU2PetO0n4gqBD4ulq3MI1WOPLgr7/Mg9yRQkX5+0v1vagr74ZTsl7XtzlaYDo2EuCeYJw==
            }

    prop-types@15.8.1:
        resolution:
            {
                integrity: sha512-oj87CgZICdulUohogVAR7AjlC0327U4el4L6eAvOqCeudMDVU0NThNaV+b9Df4dXgSP1gXMTnPdhfe/2qDH5cg==
            }

    punycode@2.3.1:
        resolution:
            {
                integrity: sha512-vYt7UD1U9Wg6138shLtLOvdAu+8DsC/ilFtEVHcH+wydcSpNE20AfSOduf6MkRFahL5FY7X1oU7nKVZFtfq8Fg==
            }
        engines: { node: '>=6' }

    pvtsutils@1.3.6:
        resolution:
            {
                integrity: sha512-PLgQXQ6H2FWCaeRak8vvk1GW462lMxB5s3Jm673N82zI4vqtVUPuZdffdZbPDFRoU8kAhItWFtPCWiPpp4/EDg==
            }

    pvutils@1.1.5:
        resolution:
            {
                integrity: sha512-KTqnxsgGiQ6ZAzZCVlJH5eOjSnvlyEgx1m8bkRJfOhmGRqfo5KLvmAlACQkrjEtOQ4B7wF9TdSLIs9O90MX9xA==
            }
        engines: { node: '>=16.0.0' }

    queue-microtask@1.2.3:
        resolution:
            {
                integrity: sha512-NuaNSa6flKT5JaSYQzJok04JzTL1CA6aGhv5rfLW3PgqA+M2ChpZQnAC8h8i4ZFkBS8X5RqkDBHA7r4hej3K9A==
            }

    quill-delta@5.1.0:
        resolution:
            {
                integrity: sha512-X74oCeRI4/p0ucjb5Ma8adTXd9Scumz367kkMK5V/IatcX6A0vlgLgKbzXWy5nZmCGeNJm2oQX0d2Eqj+ZIlCA==
            }
        engines: { node: '>= 12.0.0' }

    quill@2.0.3:
        resolution:
            {
                integrity: sha512-xEYQBqfYx/sfb33VJiKnSJp8ehloavImQ2A6564GAbqG55PGw1dAWUn1MUbQB62t0azawUS2CZZhWCjO8gRvTw==
            }
        engines: { npm: '>=8.2.3' }

    react-day-picker@9.11.1:
        resolution:
            {
                integrity: sha512-l3ub6o8NlchqIjPKrRFUCkTUEq6KwemQlfv3XZzzwpUeGwmDJ+0u0Upmt38hJyd7D/vn2dQoOoLV/qAp0o3uUw==
            }
        engines: { node: '>=18' }
        peerDependencies:
            react: '>=16.8.0'

    react-dom@19.1.1:
        resolution:
            {
                integrity: sha512-Dlq/5LAZgF0Gaz6yiqZCf6VCcZs1ghAJyrsu84Q/GT0gV+mCxbfmKNoGRKBYMJ8IEdGPqu49YWXD02GCknEDkw==
            }
        peerDependencies:
            react: ^19.1.1

    react-hook-form@7.65.0:
        resolution:
            {
                integrity: sha512-xtOzDz063WcXvGWaHgLNrNzlsdFgtUWcb32E6WFaGTd7kPZG3EeDusjdZfUsPwKCKVXy1ZlntifaHZ4l8pAsmw==
            }
        engines: { node: '>=18.0.0' }
        peerDependencies:
            react: ^16.8.0 || ^17 || ^18 || ^19

    react-icons@5.5.0:
        resolution:
            {
                integrity: sha512-MEFcXdkP3dLo8uumGI5xN3lDFNsRtrjbOEKDLD7yv76v4wpnEq2Lt2qeHaQOr34I/wPN3s3+N08WkQ+CW37Xiw==
            }
        peerDependencies:
            react: '*'

    react-is@16.13.1:
        resolution:
            {
                integrity: sha512-24e6ynE2H+OKt4kqsOvNd8kBpV65zoxbA4BVsEOB3ARVWQki/DHzaUoC5KuON/BiccDaCCTZBuOcfZs70kR8bQ==
            }

    react-is@18.3.1:
        resolution:
            {
                integrity: sha512-/LLMVyas0ljjAtoYiPqYiL8VWXzUUdThrmU5+n20DZv+a+ClRoevUzw5JxU+Ieh5/c87ytoTBV9G1FiKfNJdmg==
            }

    react-quill-new@3.4.6:
        resolution:
            {
                integrity: sha512-S2kEAwoKRo+xUIAEpb94fwiPe2QU3FmwIfQ+7Lkchf+izPa2nRu1mr4i4QxyVYg8TjHDryDUiOEYZuFEV45QFA==
            }
        peerDependencies:
            quill-delta: ^5.1.0
            react: ^16 || ^17 || ^18 || ^19
            react-dom: ^16 || ^17 || ^18 || ^19

    react-reconciler@0.31.0:
        resolution:
            {
                integrity: sha512-7Ob7Z+URmesIsIVRjnLoDGwBEG/tVitidU0nMsqX/eeJaLY89RISO/10ERe0MqmzuKUUB1rmY+h1itMbUHg9BQ==
            }
        engines: { node: '>=0.10.0' }
        peerDependencies:
            react: ^19.0.0

    react-refresh@0.17.0:
        resolution:
            {
                integrity: sha512-z6F7K9bV85EfseRCp2bzrpyQ0Gkw1uLoCel9XBVWPg/TjRj94SkJzUTGfOa4bs7iJvBWtQG0Wq7wnI0syw3EBQ==
            }
        engines: { node: '>=0.10.0' }

    react-remove-scroll-bar@2.3.8:
        resolution:
            {
                integrity: sha512-9r+yi9+mgU33AKcj6IbT9oRCO78WriSj6t/cF8DWBZJ9aOGPOTEDvdUDz1FwKim7QXWwmHqtdHnRJfhAxEG46Q==
            }
        engines: { node: '>=10' }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0
        peerDependenciesMeta:
            '@types/react':
                optional: true

    react-remove-scroll@2.7.1:
        resolution:
            {
                integrity: sha512-HpMh8+oahmIdOuS5aFKKY6Pyog+FNaZV/XyJOq7b4YFwsFHe5yYfdbIalI4k3vU2nSDql7YskmUseHsRrJqIPA==
            }
        engines: { node: '>=10' }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true

    react-resizable-panels@2.1.9:
        resolution:
            {
                integrity: sha512-z77+X08YDIrgAes4jl8xhnUu1LNIRp4+E7cv4xHmLOxxUPO/ML7PSrE813b90vj7xvQ1lcf7g2uA9GeMZonjhQ==
            }
        peerDependencies:
            react: ^16.14.0 || ^17.0.0 || ^18.0.0 || ^19.0.0 || ^19.0.0-rc
            react-dom: ^16.14.0 || ^17.0.0 || ^18.0.0 || ^19.0.0 || ^19.0.0-rc

    react-smooth@4.0.4:
        resolution:
            {
                integrity: sha512-gnGKTpYwqL0Iii09gHobNolvX4Kiq4PKx6eWBCYYix+8cdw+cGo3do906l1NBPKkSWx1DghC1dlWG9L2uGd61Q==
            }
        peerDependencies:
            react: ^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0
            react-dom: ^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0

    react-style-singleton@2.2.3:
        resolution:
            {
                integrity: sha512-b6jSvxvVnyptAiLjbkWLE/lOnR4lfTtDAl+eUC7RZy+QQWc6wRzIV2CE6xBuMmDxc2qIihtDCZD5NPOFl7fRBQ==
            }
        engines: { node: '>=10' }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true

    react-transition-group@4.4.5:
        resolution:
            {
                integrity: sha512-pZcd1MCJoiKiBR2NRxeCRg13uCXbydPnmB4EOeRrY7480qNWO8IIgQG6zlDkm6uRMsURXPuKq0GWtiM59a5Q6g==
            }
        peerDependencies:
            react: '>=16.6.0'
            react-dom: '>=16.6.0'

    react-universal-interface@0.6.2:
        resolution:
            {
                integrity: sha512-dg8yXdcQmvgR13RIlZbTRQOoUrDciFVoSBZILwjE2LFISxZZ8loVJKAkuzswl5js8BHda79bIb2b84ehU8IjXw==
            }
        peerDependencies:
            react: '*'
            tslib: '*'

    react-use-measure@2.1.7:
        resolution:
            {
                integrity: sha512-KrvcAo13I/60HpwGO5jpW7E9DfusKyLPLvuHlUyP5zqnmAPhNc6qTRjUQrdTADl0lpPpDVU2/Gg51UlOGHXbdg==
            }
        peerDependencies:
            react: '>=16.13'
            react-dom: '>=16.13'
        peerDependenciesMeta:
            react-dom:
                optional: true

    react-use@17.6.0:
        resolution:
            {
                integrity: sha512-OmedEScUMKFfzn1Ir8dBxiLLSOzhKe/dPZwVxcujweSj45aNM7BEGPb9BEVIgVEqEXx6f3/TsXzwIktNgUR02g==
            }
        peerDependencies:
            react: '*'
            react-dom: '*'

    react@19.1.1:
        resolution:
            {
                integrity: sha512-w8nqGImo45dmMIfljjMwOGtbmC/mk4CMYhWIicdSflH91J9TyCyczcPFXJzrZ/ZXcgGRFeP6BU0BEJTw6tZdfQ==
            }
        engines: { node: '>=0.10.0' }

    read-cache@1.0.0:
        resolution:
            {
                integrity: sha512-Owdv/Ft7IjOgm/i0xvNDZ1LrRANRfew4b2prF3OWMQLxLfu3bS8FVhCsrSCMK4lR56Y9ya+AThoTpDCTxCmpRA==
            }

    readdirp@3.6.0:
        resolution:
            {
                integrity: sha512-hOS089on8RduqdbhvQ5Z37A0ESjsqz6qnRcffsMU3495FuTdqSm+7bhJ29JvIOsBDEEnan5DPu9t3To9VRlMzA==
            }
        engines: { node: '>=8.10.0' }

    recharts-scale@0.4.5:
        resolution:
            {
                integrity: sha512-kivNFO+0OcUNu7jQquLXAxz1FIwZj8nrj+YkOKc5694NbjCvcT6aSZiIzNzd2Kul4o4rTto8QVR9lMNtxD4G1w==
            }

    recharts@2.15.4:
        resolution:
            {
                integrity: sha512-UT/q6fwS3c1dHbXv2uFgYJ9BMFHu3fwnd7AYZaEQhXuYQ4hgsxLvsUXzGdKeZrW5xopzDCvuA2N41WJ88I7zIw==
            }
        engines: { node: '>=14' }
        peerDependencies:
            react: ^16.0.0 || ^17.0.0 || ^18.0.0 || ^19.0.0
            react-dom: ^16.0.0 || ^17.0.0 || ^18.0.0 || ^19.0.0

    reflect.getprototypeof@1.0.10:
        resolution:
            {
                integrity: sha512-00o4I+DVrefhv+nX0ulyi3biSHCPDe+yLv5o/p6d/UVlirijB8E16FtfwSAi4g3tcqrQ4lRAqQSoFEZJehYEcw==
            }
        engines: { node: '>= 0.4' }

    regexp.prototype.flags@1.5.4:
        resolution:
            {
                integrity: sha512-dYqgNSZbDwkaJ2ceRd9ojCGjBq+mOm9LmtXnAnEGyHhN/5R7iDW2TRw3h+o/jCFxus3P2LfWIIiwowAjANm7IA==
            }
        engines: { node: '>= 0.4' }

    require-from-string@2.0.2:
        resolution:
            {
                integrity: sha512-Xf0nWe6RseziFMu+Ap9biiUbmplq6S9/p+7w7YXP/JBHhrUDDUhwa+vANyubuqfZWTveU//DYVGsDG7RKL/vEw==
            }
        engines: { node: '>=0.10.0' }

    resize-observer-polyfill@1.5.1:
        resolution:
            {
                integrity: sha512-LwZrotdHOo12nQuZlHEmtuXdqGoOD0OhaxopaNFxWzInpEgaLWoVuAMbTzixuosCx2nEG58ngzW3vxdWoxIgdg==
            }

    resolve-from@4.0.0:
        resolution:
            {
                integrity: sha512-pb/MYmXstAkysRFx8piNI1tGFNQIFA3vkE3Gq4EuA1dF6gHp/+vgZqsCGJapvy8N3Q+4o7FwvquPJcnZ7RYy4g==
            }
        engines: { node: '>=4' }

    resolve@1.22.11:
        resolution:
            {
                integrity: sha512-RfqAvLnMl313r7c9oclB1HhUEAezcpLjz95wFH4LVuhk9JF/r22qmVP9AMmOU4vMX7Q8pN8jwNg/CSpdFnMjTQ==
            }
        engines: { node: '>= 0.4' }
        hasBin: true

    resolve@2.0.0-next.5:
        resolution:
            {
                integrity: sha512-U7WjGVG9sH8tvjW5SmGbQuui75FiyjAX72HX15DwBBwF9dNiQZRQAg9nnPhYy+TUnE0+VcrttuvNI8oSxZcocA==
            }
        hasBin: true

    reusify@1.1.0:
        resolution:
            {
                integrity: sha512-g6QUff04oZpHs0eG5p83rFLhHeV00ug/Yf9nZM6fLeUrPguBTkTQOdpAWWspMh55TZfVQDPaN3NQJfbVRAxdIw==
            }
        engines: { iojs: '>=1.0.0', node: '>=0.10.0' }

    rimraf@3.0.2:
        resolution:
            {
                integrity: sha512-JZkJMZkAGFFPP2YqXZXPbMlMBgsxzE8ILs4lMIX/2o0L9UBw9O/Y3o6wFw/i9YLapcUJWwqbi3kdxIPdC62TIA==
            }
        deprecated: Rimraf versions prior to v4 are no longer supported
        hasBin: true

    rollup@4.52.5:
        resolution:
            {
                integrity: sha512-3GuObel8h7Kqdjt0gxkEzaifHTqLVW56Y/bjN7PSQtkKr0w3V/QYSdt6QWYtd7A1xUtYQigtdUfgj1RvWVtorw==
            }
        engines: { node: '>=18.0.0', npm: '>=8.0.0' }
        hasBin: true

    rtl-css-js@1.16.1:
        resolution:
            {
                integrity: sha512-lRQgou1mu19e+Ya0LsTvKrVJ5TYUbqCVPAiImX3UfLTenarvPUl1QFdvu5Z3PYmHT9RCcwIfbjRQBntExyj3Zg==
            }

    run-parallel@1.2.0:
        resolution:
            {
                integrity: sha512-5l4VyZR86LZ/lDxZTR6jqL8AFE2S0IFLMP26AbjsLVADxHdhB/c0GUsH+y39UfCi3dzz8OlQuPmnaJOMoDHQBA==
            }

    safe-array-concat@1.1.3:
        resolution:
            {
                integrity: sha512-AURm5f0jYEOydBj7VQlVvDrjeFgthDdEF5H1dP+6mNpoXOMo1quQqJ4wvJDyRZ9+pO3kGWoOdmV08cSv2aJV6Q==
            }
        engines: { node: '>=0.4' }

    safe-push-apply@1.0.0:
        resolution:
            {
                integrity: sha512-iKE9w/Z7xCzUMIZqdBsp6pEQvwuEebH4vdpjcDWnyzaI6yl6O9FHvVpmGelvEHNsoY6wGblkxR6Zty/h00WiSA==
            }
        engines: { node: '>= 0.4' }

    safe-regex-test@1.1.0:
        resolution:
            {
                integrity: sha512-x/+Cz4YrimQxQccJf5mKEbIa1NzeCRNI5Ecl/ekmlYaampdNLPalVyIcCZNNH3MvmqBugV5TMYZXv0ljslUlaw==
            }
        engines: { node: '>= 0.4' }

    scheduler@0.25.0:
        resolution:
            {
                integrity: sha512-xFVuu11jh+xcO7JOAGJNOXld8/TcEHK/4CituBUeUb5hqxJLj9YuemAEuvm9gQ/+pgXYfbQuqAkiYu+u7YEsNA==
            }

    scheduler@0.26.0:
        resolution:
            {
                integrity: sha512-NlHwttCI/l5gCPR3D1nNXtWABUmBwvZpEQiD4IXSbIDq8BzLIK/7Ir5gTFSGZDUu37K5cMNp0hFtzO38sC7gWA==
            }

    screenfull@5.2.0:
        resolution:
            {
                integrity: sha512-9BakfsO2aUQN2K9Fdbj87RJIEZ82Q9IGim7FqM5OsebfoFC6ZHXgDq/KvniuLTPdeM8wY2o6Dj3WQ7KeQCj3cA==
            }
        engines: { node: '>=0.10.0' }

    semver@6.3.1:
        resolution:
            {
                integrity: sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==
            }
        hasBin: true

    semver@7.7.3:
        resolution:
            {
                integrity: sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q==
            }
        engines: { node: '>=10' }
        hasBin: true

    seroval-plugins@1.3.3:
        resolution:
            {
                integrity: sha512-16OL3NnUBw8JG1jBLUoZJsLnQq0n5Ua6aHalhJK4fMQkz1lqR7Osz1sA30trBtd9VUDc2NgkuRCn8+/pBwqZ+w==
            }
        engines: { node: '>=10' }
        peerDependencies:
            seroval: ^1.0

    seroval@1.3.2:
        resolution:
            {
                integrity: sha512-RbcPH1n5cfwKrru7v7+zrZvjLurgHhGyso3HTyGtRivGWgYjbOmGuivCQaORNELjNONoK35nj28EoWul9sb1zQ==
            }
        engines: { node: '>=10' }

    set-function-length@1.2.2:
        resolution:
            {
                integrity: sha512-pgRc4hJ4/sNjWCSS9AmnS40x3bNMDTknHgL5UaMBTMyJnU90EgWh1Rz+MC9eFu4BuN/UwZjKQuY/1v3rM7HMfg==
            }
        engines: { node: '>= 0.4' }

    set-function-name@2.0.2:
        resolution:
            {
                integrity: sha512-7PGFlmtwsEADb0WYyvCMa1t+yke6daIG4Wirafur5kcf+MhUnPms1UeR0CKQdTZD81yESwMHbtn+TR+dMviakQ==
            }
        engines: { node: '>= 0.4' }

    set-harmonic-interval@1.0.1:
        resolution:
            {
                integrity: sha512-AhICkFV84tBP1aWqPwLZqFvAwqEoVA9kxNMniGEUvzOlm4vLmOFLiTT3UZ6bziJTy4bOVpzWGTfSCbmaayGx8g==
            }
        engines: { node: '>=6.9' }

    set-proto@1.0.0:
        resolution:
            {
                integrity: sha512-RJRdvCo6IAnPdsvP/7m6bsQqNnn1FCBX5ZNtFL98MmFF/4xAIJTIg1YbHW5DC2W5SKZanrC6i4HsJqlajw/dZw==
            }
        engines: { node: '>= 0.4' }

    sharp@0.34.4:
        resolution:
            {
                integrity: sha512-FUH39xp3SBPnxWvd5iib1X8XY7J0K0X7d93sie9CJg2PO8/7gmg89Nve6OjItK53/MlAushNNxteBYfM6DEuoA==
            }
        engines: { node: ^18.17.0 || ^20.3.0 || >=21.0.0 }

    shebang-command@2.0.0:
        resolution:
            {
                integrity: sha512-kHxr2zZpYtdmrN1qDjrrX/Z1rR1kG8Dx+gkpK1G4eXmvXswmcE1hTWBWYUzlraYw1/yZp6YuDY77YtvbN0dmDA==
            }
        engines: { node: '>=8' }

    shebang-regex@3.0.0:
        resolution:
            {
                integrity: sha512-7++dFhtcx3353uBaq8DDR4NuxBetBzC7ZQOhmTQInHEd6bSrXdiEyzCvG07Z44UYdLShWUyXt5M/yhz8ekcb1A==
            }
        engines: { node: '>=8' }

    side-channel-list@1.0.0:
        resolution:
            {
                integrity: sha512-FCLHtRD/gnpCiCHEiJLOwdmFP+wzCmDEkc9y7NsYxeF4u7Btsn1ZuwgwJGxImImHicJArLP4R0yX4c2KCrMrTA==
            }
        engines: { node: '>= 0.4' }

    side-channel-map@1.0.1:
        resolution:
            {
                integrity: sha512-VCjCNfgMsby3tTdo02nbjtM/ewra6jPHmpThenkTYh8pG9ucZ/1P8So4u4FGBek/BjpOVsDCMoLA/iuBKIFXRA==
            }
        engines: { node: '>= 0.4' }

    side-channel-weakmap@1.0.2:
        resolution:
            {
                integrity: sha512-WPS/HvHQTYnHisLo9McqBHOJk2FkHO/tlpvldyrnem4aeQp4hai3gythswg6p01oSoTl58rcpiFAjF2br2Ak2A==
            }
        engines: { node: '>= 0.4' }

    side-channel@1.1.0:
        resolution:
            {
                integrity: sha512-ZX99e6tRweoUXqR+VBrslhda51Nh5MTQwou5tnUDgbtyM0dBgmhEDtWGP/xbKn6hqfPRHujUNwz5fy/wbbhnpw==
            }
        engines: { node: '>= 0.4' }

    signal-exit@4.1.0:
        resolution:
            {
                integrity: sha512-bzyZ1e88w9O1iNJbKnOlvYTrWPDl46O1bG0D3XInv+9tkPrxrN8jUUTiFlDkkmKWgn1M6CfIA13SuGqOa9Korw==
            }
        engines: { node: '>=14' }

    sonner@1.7.4:
        resolution:
            {
                integrity: sha512-DIS8z4PfJRbIyfVFDVnK9rO3eYDtse4Omcm6bt0oEr5/jtLgysmjuBl1frJ9E/EQZrFmKx2A8m/s5s9CRXIzhw==
            }
        peerDependencies:
            react: ^18.0.0 || ^19.0.0 || ^19.0.0-rc
            react-dom: ^18.0.0 || ^19.0.0 || ^19.0.0-rc

    source-map-js@1.2.1:
        resolution:
            {
                integrity: sha512-UXWMKhLOwVKb728IUtQPXxfYU+usdybtUrK/8uGE8CQMvrhOpwvzDBwj0QhSL7MQc7vIsISBG8VQ8+IDQxpfQA==
            }
        engines: { node: '>=0.10.0' }

    source-map@0.5.6:
        resolution:
            {
                integrity: sha512-MjZkVp0NHr5+TPihLcadqnlVoGIoWo4IBHptutGh9wI3ttUYvCG26HkSuDi+K6lsZ25syXJXcctwgyVCt//xqA==
            }
        engines: { node: '>=0.10.0' }

    source-map@0.6.1:
        resolution:
            {
                integrity: sha512-UjgapumWlbMhkBgzT7Ykc5YXUT46F0iKu8SGXq0bcwP5dz/h0Plj6enJqjz1Zbq2l5WaqYnrVbwWOWMyF3F47g==
            }
        engines: { node: '>=0.10.0' }

    stack-generator@2.0.10:
        resolution:
            {
                integrity: sha512-mwnua/hkqM6pF4k8SnmZ2zfETsRUpWXREfA/goT8SLCV4iOFa4bzOX2nDipWAZFPTjLvQB82f5yaodMVhK0yJQ==
            }

    stackframe@1.3.4:
        resolution:
            {
                integrity: sha512-oeVtt7eWQS+Na6F//S4kJ2K2VbRlS9D43mAlMyVpVWovy9o+jfgH8O9agzANzaiLjclA0oYzUXEM4PurhSUChw==
            }

    stacktrace-gps@3.1.2:
        resolution:
            {
                integrity: sha512-GcUgbO4Jsqqg6RxfyTHFiPxdPqF+3LFmQhm7MgCuYQOYuWyqxo5pwRPz5d/u6/WYJdEnWfK4r+jGbyD8TSggXQ==
            }

    stacktrace-js@2.0.2:
        resolution:
            {
                integrity: sha512-Je5vBeY4S1r/RnLydLl0TBTi3F2qdfWmYsGvtfZgEI+SCprPppaIhQf5nGcal4gI4cGpCV/duLcAzT1np6sQqg==
            }

    stats-gl@2.4.2:
        resolution:
            {
                integrity: sha512-g5O9B0hm9CvnM36+v7SFl39T7hmAlv541tU81ME8YeSb3i1CIP5/QdDeSB3A0la0bKNHpxpwxOVRo2wFTYEosQ==
            }
        peerDependencies:
            '@types/three': '*'
            three: '*'

    stats.js@0.17.0:
        resolution:
            {
                integrity: sha512-hNKz8phvYLPEcRkeG1rsGmV5ChMjKDAWU7/OJJdDErPBNChQXxCo3WZurGpnWc6gZhAzEPFad1aVgyOANH1sMw==
            }

    stop-iteration-iterator@1.1.0:
        resolution:
            {
                integrity: sha512-eLoXW/DHyl62zxY4SCaIgnRhuMr6ri4juEYARS8E6sCEqzKpOiE521Ucofdx+KnDZl5xmvGYaaKCk5FEOxJCoQ==
            }
        engines: { node: '>= 0.4' }

    string-width@4.2.3:
        resolution:
            {
                integrity: sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==
            }
        engines: { node: '>=8' }

    string-width@5.1.2:
        resolution:
            {
                integrity: sha512-HnLOCR3vjcY8beoNLtcjZ5/nxn2afmME6lhrDrebokqMap+XbeW8n9TXpPDOqdGK5qcI3oT0GKTW6wC7EMiVqA==
            }
        engines: { node: '>=12' }

    string.prototype.matchall@4.0.12:
        resolution:
            {
                integrity: sha512-6CC9uyBL+/48dYizRf7H7VAYCMCNTBeM78x/VTUe9bFEaxBepPJDa1Ow99LqI/1yF7kuy7Q3cQsYMrcjGUcskA==
            }
        engines: { node: '>= 0.4' }

    string.prototype.repeat@1.0.0:
        resolution:
            {
                integrity: sha512-0u/TldDbKD8bFCQ/4f5+mNRrXwZ8hg2w7ZR8wa16e8z9XpePWl3eGEcUD0OXpEH/VJH/2G3gjUtR3ZOiBe2S/w==
            }

    string.prototype.trim@1.2.10:
        resolution:
            {
                integrity: sha512-Rs66F0P/1kedk5lyYyH9uBzuiI/kNRmwJAR9quK6VOtIpZ2G+hMZd+HQbbv25MgCA6gEffoMZYxlTod4WcdrKA==
            }
        engines: { node: '>= 0.4' }

    string.prototype.trimend@1.0.9:
        resolution:
            {
                integrity: sha512-G7Ok5C6E/j4SGfyLCloXTrngQIQU3PWtXGst3yM7Bea9FRURf1S42ZHlZZtsNque2FN2PoUhfZXYLNWwEr4dLQ==
            }
        engines: { node: '>= 0.4' }

    string.prototype.trimstart@1.0.8:
        resolution:
            {
                integrity: sha512-UXSH262CSZY1tfu3G3Secr6uGLCFVPMhIqHjlgCUtCCcgihYc/xKs9djMTMUOb2j1mVSeU8EU6NWc/iQKU6Gfg==
            }
        engines: { node: '>= 0.4' }

    strip-ansi@6.0.1:
        resolution:
            {
                integrity: sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==
            }
        engines: { node: '>=8' }

    strip-ansi@7.1.2:
        resolution:
            {
                integrity: sha512-gmBGslpoQJtgnMAvOVqGZpEz9dyoKTCzy2nfz/n8aIFhN/jCE/rCmcxabB6jOOHV+0WNnylOxaxBQPSvcWklhA==
            }
        engines: { node: '>=12' }

    strip-json-comments@3.1.1:
        resolution:
            {
                integrity: sha512-6fPc+R4ihwqP6N/aIv2f1gMH8lOVtWQHoqC4yK6oSDVVocumAsfCqjkXnqiYMhmMwS/mEHLp7Vehlt3ql6lEig==
            }
        engines: { node: '>=8' }

    stylis@4.3.6:
        resolution:
            {
                integrity: sha512-yQ3rwFWRfwNUY7H5vpU0wfdkNSnvnJinhF9830Swlaxl03zsOjCfmX0ugac+3LtK0lYSgwL/KXc8oYL3mG4YFQ==
            }

    sucrase@3.35.0:
        resolution:
            {
                integrity: sha512-8EbVDiu9iN/nESwxeSxDKe0dunta1GOlHufmSSXxMD2z2/tMZpDMpvXQGsc+ajGo8y2uYUmixaSRUc/QPoQ0GA==
            }
        engines: { node: '>=16 || 14 >=14.17' }
        hasBin: true

    supports-color@7.2.0:
        resolution:
            {
                integrity: sha512-qpCAvRl9stuOHveKsn7HncJRvv501qIacKzQlO/+Lwxc9+0q2wLyv4Dfvt80/DPn2pqOBsJdDiogXGR9+OvwRw==
            }
        engines: { node: '>=8' }

    supports-preserve-symlinks-flag@1.0.0:
        resolution:
            {
                integrity: sha512-ot0WnXS9fgdkgIcePe6RHNk1WA8+muPa6cSjeR3V8K27q9BB1rTE3R1p7Hv0z1ZyAc8s6Vvv8DIyWf681MAt0w==
            }
        engines: { node: '>= 0.4' }

    suspend-react@0.1.3:
        resolution:
            {
                integrity: sha512-aqldKgX9aZqpoDp3e8/BZ8Dm7x1pJl+qI3ZKxDN0i/IQTWUwBx/ManmlVJ3wowqbno6c2bmiIfs+Um6LbsjJyQ==
            }
        peerDependencies:
            react: '>=17.0'

    tailwind-merge@2.6.0:
        resolution:
            {
                integrity: sha512-P+Vu1qXfzediirmHOC3xKGAYeZtPcV9g76X+xg2FD4tYgR71ewMA35Y3sCz3zhiN/dwefRpJX0yBcgwi1fXNQA==
            }

    tailwindcss-animate@1.0.7:
        resolution:
            {
                integrity: sha512-bl6mpH3T7I3UFxuvDEXLxy/VuFxBk5bbzplh7tXI68mwMokNYd1t9qPBHlnyTwfa4JGC4zP516I1hYYtQ/vspA==
            }
        peerDependencies:
            tailwindcss: '>=3.0.0 || insiders'

    tailwindcss@3.4.18:
        resolution:
            {
                integrity: sha512-6A2rnmW5xZMdw11LYjhcI5846rt9pbLSabY5XPxo+XWdxwZaFEn47Go4NzFiHu9sNNmr/kXivP1vStfvMaK1GQ==
            }
        engines: { node: '>=14.0.0' }
        hasBin: true

    text-table@0.2.0:
        resolution:
            {
                integrity: sha512-N+8UisAXDGk8PFXP4HAzVR9nbfmVJ3zYLAWiTIoqC5v5isinhr+r5uaO8+7r3BMfuNIufIsA7RdpVgacC2cSpw==
            }

    thenify-all@1.6.0:
        resolution:
            {
                integrity: sha512-RNxQH/qI8/t3thXJDwcstUO4zeqo64+Uy/+sNVRBx4Xn2OX+OZ9oP+iJnNFqplFra2ZUVeKCSa2oVWi3T4uVmA==
            }
        engines: { node: '>=0.8' }

    thenify@3.3.1:
        resolution:
            {
                integrity: sha512-RVZSIV5IG10Hk3enotrhvz0T9em6cyHBLkH/YAZuKqd8hRkKhSfCGIcP2KUY0EPxndzANBmNllzWPwak+bheSw==
            }

    three-mesh-bvh@0.8.3:
        resolution:
            {
                integrity: sha512-4G5lBaF+g2auKX3P0yqx+MJC6oVt6sB5k+CchS6Ob0qvH0YIhuUk1eYr7ktsIpY+albCqE80/FVQGV190PmiAg==
            }
        peerDependencies:
            three: '>= 0.159.0'

    three-stdlib@2.36.0:
        resolution:
            {
                integrity: sha512-kv0Byb++AXztEGsULgMAs8U2jgUdz6HPpAB/wDJnLiLlaWQX2APHhiTJIN7rqW+Of0eRgcp7jn05U1BsCP3xBA==
            }
        peerDependencies:
            three: '>=0.128.0'

    three@0.176.0:
        resolution:
            {
                integrity: sha512-PWRKYWQo23ojf9oZSlRGH8K09q7nRSWx6LY/HF/UUrMdYgN9i1e2OwJYHoQjwc6HF/4lvvYLC5YC1X8UJL2ZpA==
            }

    throttle-debounce@3.0.1:
        resolution:
            {
                integrity: sha512-dTEWWNu6JmeVXY0ZYoPuH5cRIwc0MeGbJwah9KUNYSJwommQpCzTySTpEe8Gs1J23aeWEuAobe4Ag7EHVt/LOg==
            }
        engines: { node: '>=10' }

    tiny-invariant@1.3.3:
        resolution:
            {
                integrity: sha512-+FbBPE1o9QAYvviau/qC5SE3caw21q3xkvWKBtja5vgqOWIHHJ3ioaq1VPfn/Szqctz2bU/oYeKd9/z5BL+PVg==
            }

    tiny-warning@1.0.3:
        resolution:
            {
                integrity: sha512-lBN9zLN/oAf68o3zNXYrdCt1kP8WsiGW8Oo2ka41b2IM5JL/S1CTyX1rW0mb/zSuJun0ZUrDxx4sqvYS2FWzPA==
            }

    to-regex-range@5.0.1:
        resolution:
            {
                integrity: sha512-65P7iz6X5yEr1cwcgvQxbbIw7Uk3gOy5dIdtZ4rDveLqhrdJP+Li/Hx6tyK0NEb+2GCyneCMJiGqrADCSNk8sQ==
            }
        engines: { node: '>=8.0' }

    toggle-selection@1.0.6:
        resolution:
            {
                integrity: sha512-BiZS+C1OS8g/q2RRbJmy59xpyghNBqrr6k5L/uKBGRsTfxmu3ffiRnd8mlGPUVayg8pvfi5urfnu8TU7DVOkLQ==
            }

    troika-three-text@0.52.4:
        resolution:
            {
                integrity: sha512-V50EwcYGruV5rUZ9F4aNsrytGdKcXKALjEtQXIOBfhVoZU9VAqZNIoGQ3TMiooVqFAbR1w15T+f+8gkzoFzawg==
            }
        peerDependencies:
            three: '>=0.125.0'

    troika-three-utils@0.52.4:
        resolution:
            {
                integrity: sha512-NORAStSVa/BDiG52Mfudk4j1FG4jC4ILutB3foPnfGbOeIs9+G5vZLa0pnmnaftZUGm4UwSoqEpWdqvC7zms3A==
            }
        peerDependencies:
            three: '>=0.125.0'

    troika-worker-utils@0.52.0:
        resolution:
            {
                integrity: sha512-W1CpvTHykaPH5brv5VHLfQo9D1OYuo0cSBEUQFFT/nBUzM8iD6Lq2/tgG/f1OelbAS1WtaTPQzE5uM49egnngw==
            }

    ts-api-utils@2.1.0:
        resolution:
            {
                integrity: sha512-CUgTZL1irw8u29bzrOD/nH85jqyc74D6SshFgujOIA7osm2Rz7dYH77agkx7H4FBNxDq7Cjf+IjaX/8zwFW+ZQ==
            }
        engines: { node: '>=18.12' }
        peerDependencies:
            typescript: '>=4.8.4'

    ts-easing@0.2.0:
        resolution:
            {
                integrity: sha512-Z86EW+fFFh/IFB1fqQ3/+7Zpf9t2ebOAxNI/V6Wo7r5gqiqtxmgTlQ1qbqQcjLKYeSHPTsEmvlJUDg/EuL0uHQ==
            }

    ts-interface-checker@0.1.13:
        resolution:
            {
                integrity: sha512-Y/arvbn+rrz3JCKl9C4kVNfTfSm2/mEp5FSz5EsZSANGPSlQrpRI5M4PKF+mJnE52jOO90PnPSc3Ur3bTQw0gA==
            }

    tslib@2.8.1:
        resolution:
            {
                integrity: sha512-oJFu94HQb+KVduSUQL7wnpmqnfmLsOA/nAh6b6EH0wCEoK0/mPeXU6c3wKDV83MkOuHPRHtSXKKU99IBazS/2w==
            }

    tunnel-rat@0.1.2:
        resolution:
            {
                integrity: sha512-lR5VHmkPhzdhrM092lI2nACsLO4QubF0/yoOhzX7c+wIpbN1GjHNzCc91QlpxBi+cnx8vVJ+Ur6vL5cEoQPFpQ==
            }

    type-check@0.4.0:
        resolution:
            {
                integrity: sha512-XleUoc9uwGXqjWwXaUTZAmzMcFZ5858QA2vvx1Ur5xIcixXIP+8LnFDgRplU30us6teqdlskFfu+ae4K79Ooew==
            }
        engines: { node: '>= 0.8.0' }

    type-fest@0.20.2:
        resolution:
            {
                integrity: sha512-Ne+eE4r0/iWnpAxD852z3A+N0Bt5RN//NjJwRd2VFHEmrywxf5vsZlh4R6lixl6B+wz/8d+maTSAkN1FIkI3LQ==
            }
        engines: { node: '>=10' }

    typed-array-buffer@1.0.3:
        resolution:
            {
                integrity: sha512-nAYYwfY3qnzX30IkA6AQZjVbtK6duGontcQm1WSG1MD94YLqK0515GNApXkoxKOWMusVssAHWLh9SeaoefYFGw==
            }
        engines: { node: '>= 0.4' }

    typed-array-byte-length@1.0.3:
        resolution:
            {
                integrity: sha512-BaXgOuIxz8n8pIq3e7Atg/7s+DpiYrxn4vdot3w9KbnBhcRQq6o3xemQdIfynqSeXeDrF32x+WvfzmOjPiY9lg==
            }
        engines: { node: '>= 0.4' }

    typed-array-byte-offset@1.0.4:
        resolution:
            {
                integrity: sha512-bTlAFB/FBYMcuX81gbL4OcpH5PmlFHqlCCpAl8AlEzMz5k53oNDvN8p1PNOWLEmI2x4orp3raOFB51tv9X+MFQ==
            }
        engines: { node: '>= 0.4' }

    typed-array-length@1.0.7:
        resolution:
            {
                integrity: sha512-3KS2b+kL7fsuk/eJZ7EQdnEmQoaho/r6KUef7hxvltNA5DR8NAUM+8wJMbJyZ4G9/7i3v5zPBIMN5aybAh2/Jg==
            }
        engines: { node: '>= 0.4' }

    typescript@5.9.3:
        resolution:
            {
                integrity: sha512-jl1vZzPDinLr9eUt3J/t7V6FgNEw9QjvBPdysz9KfQDD41fQrC2Y4vKQdiaUpFT4bXlb1RHhLpp8wtm6M5TgSw==
            }
        engines: { node: '>=14.17' }
        hasBin: true

    unbox-primitive@1.1.0:
        resolution:
            {
                integrity: sha512-nWJ91DjeOkej/TA8pXQ3myruKpKEYgqvpw9lz4OPHj/NWFNluYrjbz9j01CJ8yKQd2g4jFoOkINCTW2I5LEEyw==
            }
        engines: { node: '>= 0.4' }

    undici-types@6.21.0:
        resolution:
            {
                integrity: sha512-iwDZqg0QAGrg9Rav5H4n0M64c3mkR59cJ6wQp+7C4nI0gsmExaedaYLNO44eT4AtBBwjbTiGPMlt2Md0T9H9JQ==
            }

    update-browserslist-db@1.1.4:
        resolution:
            {
                integrity: sha512-q0SPT4xyU84saUX+tomz1WLkxUbuaJnR1xWt17M7fJtEJigJeWUNGUqrauFXsHnqev9y9JTRGwk13tFBuKby4A==
            }
        hasBin: true
        peerDependencies:
            browserslist: '>= 4.21.0'

    uri-js@4.4.1:
        resolution:
            {
                integrity: sha512-7rKUyy33Q1yc98pQ1DAmLtwX109F7TIfWlW1Ydo8Wl1ii1SeHieeh0HHfPeL2fMXK6z0s8ecKs9frCuLJvndBg==
            }

    use-callback-ref@1.3.3:
        resolution:
            {
                integrity: sha512-jQL3lRnocaFtu3V00JToYz/4QkNWswxijDaCVNZRiRTO3HQDLsdu1ZtmIUvV4yPp+rvWm5j0y0TG/S61cuijTg==
            }
        engines: { node: '>=10' }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true

    use-sidecar@1.1.3:
        resolution:
            {
                integrity: sha512-Fedw0aZvkhynoPYlA5WXrMCAMm+nSWdZt6lzJQ7Ok8S6Q+VsHmHpRWndVRJ8Be0ZbkfPc5LRYH+5XrzXcEeLRQ==
            }
        engines: { node: '>=10' }
        peerDependencies:
            '@types/react': '*'
            react: ^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0 || ^19.0.0-rc
        peerDependenciesMeta:
            '@types/react':
                optional: true

    use-sync-external-store@1.6.0:
        resolution:
            {
                integrity: sha512-Pp6GSwGP/NrPIrxVFAIkOQeyw8lFenOHijQWkUTrDvrF4ALqylP2C/KCkeS9dpUM3KvYRQhna5vt7IL95+ZQ9w==
            }
        peerDependencies:
            react: ^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0

    util-deprecate@1.0.2:
        resolution:
            {
                integrity: sha512-EPD5q1uXyFxJpCrLnCc1nHnq3gOa6DZBocAIiI2TaSCA7VCJ1UJDMagCzIkXNsUYfD1daK//LTEQ8xiIbrHtcw==
            }

    utility-types@3.11.0:
        resolution:
            {
                integrity: sha512-6Z7Ma2aVEWisaL6TvBCy7P8rm2LQoPv6dJ7ecIaIixHcwfbJ0x7mWdbcwlIM5IGQxPZSFYeqRCqlOOeKoJYMkw==
            }
        engines: { node: '>= 4' }

    vaul@1.1.2:
        resolution:
            {
                integrity: sha512-ZFkClGpWyI2WUQjdLJ/BaGuV6AVQiJ3uELGk3OYtP+B6yCO7Cmn9vPFXVJkRaGkOJu3m8bQMgtyzNHixULceQA==
            }
        peerDependencies:
            react: ^16.8 || ^17.0 || ^18.0 || ^19.0.0 || ^19.0.0-rc
            react-dom: ^16.8 || ^17.0 || ^18.0 || ^19.0.0 || ^19.0.0-rc

    victory-vendor@36.9.2:
        resolution:
            {
                integrity: sha512-PnpQQMuxlwYdocC8fIJqVXvkeViHYzotI+NJrCuav0ZYFoq912ZHBk3mCeuj+5/VpodOjPe1z0Fk2ihgzlXqjQ==
            }

    vite-plugin-environment@1.1.3:
        resolution:
            {
                integrity: sha512-9LBhB0lx+2lXVBEWxFZC+WO7PKEyE/ykJ7EPWCq95NEcCpblxamTbs5Dm3DLBGzwODpJMEnzQywJU8fw6XGGGA==
            }
        peerDependencies:
            vite: '>= 2.7'

    vite@5.4.21:
        resolution:
            {
                integrity: sha512-o5a9xKjbtuhY6Bi5S3+HvbRERmouabWbyUcpXXUA1u+GNUKoROi9byOJ8M0nHbHYHkYICiMlqxkg1KkYmm25Sw==
            }
        engines: { node: ^18.0.0 || >=20.0.0 }
        hasBin: true
        peerDependencies:
            '@types/node': ^18.0.0 || >=20.0.0
            less: '*'
            lightningcss: ^1.21.0
            sass: '*'
            sass-embedded: '*'
            stylus: '*'
            sugarss: '*'
            terser: ^5.4.0
        peerDependenciesMeta:
            '@types/node':
                optional: true
            less:
                optional: true
            lightningcss:
                optional: true
            sass:
                optional: true
            sass-embedded:
                optional: true
            stylus:
                optional: true
            sugarss:
                optional: true
            terser:
                optional: true

    webgl-constants@1.1.1:
        resolution:
            {
                integrity: sha512-LkBXKjU5r9vAW7Gcu3T5u+5cvSvh5WwINdr0C+9jpzVB41cjQAP5ePArDtk/WHYdVj0GefCgM73BA7FlIiNtdg==
            }

    webgl-sdf-generator@1.1.1:
        resolution:
            {
                integrity: sha512-9Z0JcMTFxeE+b2x1LJTdnaT8rT8aEp7MVxkNwoycNmJWwPdzoXzMh0BjJSh/AEFP+KPYZUli814h8bJZFIZ2jA==
            }

    which-boxed-primitive@1.1.1:
        resolution:
            {
                integrity: sha512-TbX3mj8n0odCBFVlY8AxkqcHASw3L60jIuF8jFP78az3C2YhmGvqbHBpAjTRH2/xqYunrJ9g1jSyjCjpoWzIAA==
            }
        engines: { node: '>= 0.4' }

    which-builtin-type@1.2.1:
        resolution:
            {
                integrity: sha512-6iBczoX+kDQ7a3+YJBnh3T+KZRxM/iYNPXicqk66/Qfm1b93iu+yOImkg0zHbj5LNOcNv1TEADiZ0xa34B4q6Q==
            }
        engines: { node: '>= 0.4' }

    which-collection@1.0.2:
        resolution:
            {
                integrity: sha512-K4jVyjnBdgvc86Y6BkaLZEN933SwYOuBFkdmBu9ZfkcAbdVbpITnDmjvZ/aQjRXQrv5EPkTnD1s39GiiqbngCw==
            }
        engines: { node: '>= 0.4' }

    which-typed-array@1.1.19:
        resolution:
            {
                integrity: sha512-rEvr90Bck4WZt9HHFC4DJMsjvu7x+r6bImz0/BrbWb7A2djJ8hnZMrWnHo9F8ssv0OMErasDhftrfROTyqSDrw==
            }
        engines: { node: '>= 0.4' }

    which@2.0.2:
        resolution:
            {
                integrity: sha512-BLI3Tl1TW3Pvl70l3yq3Y64i+awpwXqsGBYWkkqMtnbXgrMD+yj7rhW0kuEDxzJaYXGjEW5ogapKNMEKNMjibA==
            }
        engines: { node: '>= 8' }
        hasBin: true

    word-wrap@1.2.5:
        resolution:
            {
                integrity: sha512-BN22B5eaMMI9UMtjrGd5g5eCYPpCPDUy0FJXbYsaT5zYxjFOckS53SQDE3pWkVoWpHXVb3BrYcEN4Twa55B5cA==
            }
        engines: { node: '>=0.10.0' }

    wrap-ansi@7.0.0:
        resolution:
            {
                integrity: sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q==
            }
        engines: { node: '>=10' }

    wrap-ansi@8.1.0:
        resolution:
            {
                integrity: sha512-si7QWI6zUMq56bESFvagtmzMdGOtoxfR+Sez11Mobfc7tm+VkUckk9bW2UeffTGVUbOksxmSw0AA2gs8g71NCQ==
            }
        engines: { node: '>=12' }

    wrappy@1.0.2:
        resolution:
            {
                integrity: sha512-l4Sp/DRseor9wL6EvV2+TuQn63dMkPjZ/sp9XkghTEbV9KlPS1xUsZ3u7/IQO4wxtcFB4bgpQPRcR3QCvezPcQ==
            }

    yallist@3.1.1:
        resolution:
            {
                integrity: sha512-a4UGQaWPH59mOXUYnAG2ewncQS4i4F43Tv3JoAM+s2VDAmS9NsK8GpDMLrCHPksFT7h3K6TOoUNn2pb7RoXx4g==
            }

    yocto-queue@0.1.0:
        resolution:
            {
                integrity: sha512-rVksvsnNCdJ/ohGc6xgPwyN8eheCxsiLM8mxuE/t/mOVqJewPuO1miLpTHQiRgTKCLexL4MeAFVagts7HmNZ2Q==
            }
        engines: { node: '>=10' }

    zustand@4.5.7:
        resolution:
            {
                integrity: sha512-CHOUy7mu3lbD6o6LJLfllpjkzhHXSBlX8B9+qPddUsIfeF5S/UZ5q0kmCsnRqT1UHFQZchNFDDzMbQsuesHWlw==
            }
        engines: { node: '>=12.7.0' }
        peerDependencies:
            '@types/react': '>=16.8'
            immer: '>=9.0.6'
            react: '>=16.8'
        peerDependenciesMeta:
            '@types/react':
                optional: true
            immer:
                optional: true
            react:
                optional: true

    zustand@5.0.8:
        resolution:
            {
                integrity: sha512-gyPKpIaxY9XcO2vSMrLbiER7QMAMGOQZVRdJ6Zi782jkbzZygq5GI9nG8g+sMgitRtndwaBSl7uiqC49o1SSiw==
            }
        engines: { node: '>=12.20.0' }
        peerDependencies:
            '@types/react': '>=18.0.0'
            immer: '>=9.0.6'
            react: '>=18.0.0'
            use-sync-external-store: '>=1.2.0'
        peerDependenciesMeta:
            '@types/react':
                optional: true
            immer:
                optional: true
            react:
                optional: true
            use-sync-external-store:
                optional: true

snapshots:
    '@alloc/quick-lru@5.2.0': {}

    '@babel/code-frame@7.27.1':
        dependencies:
            '@babel/helper-validator-identifier': 7.28.5
            js-tokens: 4.0.0
            picocolors: 1.1.1

    '@babel/compat-data@7.28.5': {}

    '@babel/core@7.28.5':
        dependencies:
            '@babel/code-frame': 7.27.1
            '@babel/generator': 7.28.5
            '@babel/helper-compilation-targets': 7.27.2
            '@babel/helper-module-transforms': 7.28.3(@babel/core@7.28.5)
            '@babel/helpers': 7.28.4
            '@babel/parser': 7.28.5
            '@babel/template': 7.27.2
            '@babel/traverse': 7.28.5
            '@babel/types': 7.28.5
            '@jridgewell/remapping': 2.3.5
            convert-source-map: 2.0.0
            debug: 4.4.3
            gensync: 1.0.0-beta.2
            json5: 2.2.3
            semver: 6.3.1
        transitivePeerDependencies:
            - supports-color

    '@babel/generator@7.28.5':
        dependencies:
            '@babel/parser': 7.28.5
            '@babel/types': 7.28.5
            '@jridgewell/gen-mapping': 0.3.13
            '@jridgewell/trace-mapping': 0.3.31
            jsesc: 3.1.0

    '@babel/helper-compilation-targets@7.27.2':
        dependencies:
            '@babel/compat-data': 7.28.5
            '@babel/helper-validator-option': 7.27.1
            browserslist: 4.27.0
            lru-cache: 5.1.1
            semver: 6.3.1

    '@babel/helper-globals@7.28.0': {}

    '@babel/helper-module-imports@7.27.1':
        dependencies:
            '@babel/traverse': 7.28.5
            '@babel/types': 7.28.5
        transitivePeerDependencies:
            - supports-color

    '@babel/helper-module-transforms@7.28.3(@babel/core@7.28.5)':
        dependencies:
            '@babel/core': 7.28.5
            '@babel/helper-module-imports': 7.27.1
            '@babel/helper-validator-identifier': 7.28.5
            '@babel/traverse': 7.28.5
        transitivePeerDependencies:
            - supports-color

    '@babel/helper-plugin-utils@7.27.1': {}

    '@babel/helper-string-parser@7.27.1': {}

    '@babel/helper-validator-identifier@7.28.5': {}

    '@babel/helper-validator-option@7.27.1': {}

    '@babel/helpers@7.28.4':
        dependencies:
            '@babel/template': 7.27.2
            '@babel/types': 7.28.5

    '@babel/parser@7.28.5':
        dependencies:
            '@babel/types': 7.28.5

    '@babel/plugin-transform-react-jsx-self@7.27.1(@babel/core@7.28.5)':
        dependencies:
            '@babel/core': 7.28.5
            '@babel/helper-plugin-utils': 7.27.1

    '@babel/plugin-transform-react-jsx-source@7.27.1(@babel/core@7.28.5)':
        dependencies:
            '@babel/core': 7.28.5
            '@babel/helper-plugin-utils': 7.27.1

    '@babel/runtime@7.28.4': {}

    '@babel/template@7.27.2':
        dependencies:
            '@babel/code-frame': 7.27.1
            '@babel/parser': 7.28.5
            '@babel/types': 7.28.5

    '@babel/traverse@7.28.5':
        dependencies:
            '@babel/code-frame': 7.27.1
            '@babel/generator': 7.28.5
            '@babel/helper-globals': 7.28.0
            '@babel/parser': 7.28.5
            '@babel/template': 7.27.2
            '@babel/types': 7.28.5
            debug: 4.4.3
        transitivePeerDependencies:
            - supports-color

    '@babel/types@7.28.5':
        dependencies:
            '@babel/helper-string-parser': 7.27.1
            '@babel/helper-validator-identifier': 7.28.5

    '@date-fns/tz@1.4.1': {}

    '@dfinity/agent@3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/hashes@1.8.0)':
        dependencies:
            '@dfinity/candid': 3.3.1(@dfinity/principal@3.3.1)
            '@dfinity/cbor': 0.2.2
            '@dfinity/principal': 3.3.1
            '@noble/curves': 1.9.7
            '@noble/hashes': 1.8.0

    '@dfinity/auth-client@3.3.1(@dfinity/agent@3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/hashes@1.8.0))(@dfinity/identity@3.3.1(@dfinity/agent@3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/hashes@1.8.0))(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/curves@1.9.7)(@noble/hashes@1.8.0))(@dfinity/principal@3.3.1)':
        dependencies:
            '@dfinity/agent': 3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/hashes@1.8.0)
            '@dfinity/identity': 3.3.1(@dfinity/agent@3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/hashes@1.8.0))(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/curves@1.9.7)(@noble/hashes@1.8.0)
            '@dfinity/principal': 3.3.1
            idb: 7.1.1

    '@dfinity/candid@3.3.1(@dfinity/principal@3.3.1)':
        dependencies:
            '@dfinity/principal': 3.3.1

    '@dfinity/cbor@0.2.2': {}

    '@dfinity/identity-secp256k1@3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/curves@1.9.7)(@noble/hashes@1.8.0)':
        dependencies:
            '@dfinity/agent': 3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/hashes@1.8.0)
            '@dfinity/candid': 3.3.1(@dfinity/principal@3.3.1)
            '@noble/curves': 1.9.7
            '@noble/hashes': 1.8.0
            '@scure/bip32': 1.7.0
            '@scure/bip39': 1.6.0
            asn1js: 3.0.6
        transitivePeerDependencies:
            - '@dfinity/principal'

    '@dfinity/identity@3.3.1(@dfinity/agent@3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/hashes@1.8.0))(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/curves@1.9.7)(@noble/hashes@1.8.0)':
        dependencies:
            '@dfinity/agent': 3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/hashes@1.8.0)
            '@dfinity/candid': 3.3.1(@dfinity/principal@3.3.1)
            '@dfinity/principal': 3.3.1
            '@noble/curves': 1.9.7
            '@noble/hashes': 1.8.0

    '@dfinity/principal@3.3.1':
        dependencies:
            '@noble/hashes': 1.8.0

    '@dimforge/rapier3d-compat@0.12.0': {}

    '@emnapi/runtime@1.6.0':
        dependencies:
            tslib: 2.8.1
        optional: true

    '@esbuild/aix-ppc64@0.21.5':
        optional: true

    '@esbuild/android-arm64@0.21.5':
        optional: true

    '@esbuild/android-arm@0.21.5':
        optional: true

    '@esbuild/android-x64@0.21.5':
        optional: true

    '@esbuild/darwin-arm64@0.21.5':
        optional: true

    '@esbuild/darwin-x64@0.21.5':
        optional: true

    '@esbuild/freebsd-arm64@0.21.5':
        optional: true

    '@esbuild/freebsd-x64@0.21.5':
        optional: true

    '@esbuild/linux-arm64@0.21.5':
        optional: true

    '@esbuild/linux-arm@0.21.5':
        optional: true

    '@esbuild/linux-ia32@0.21.5':
        optional: true

    '@esbuild/linux-loong64@0.21.5':
        optional: true

    '@esbuild/linux-mips64el@0.21.5':
        optional: true

    '@esbuild/linux-ppc64@0.21.5':
        optional: true

    '@esbuild/linux-riscv64@0.21.5':
        optional: true

    '@esbuild/linux-s390x@0.21.5':
        optional: true

    '@esbuild/linux-x64@0.21.5':
        optional: true

    '@esbuild/netbsd-x64@0.21.5':
        optional: true

    '@esbuild/openbsd-x64@0.21.5':
        optional: true

    '@esbuild/sunos-x64@0.21.5':
        optional: true

    '@esbuild/win32-arm64@0.21.5':
        optional: true

    '@esbuild/win32-ia32@0.21.5':
        optional: true

    '@esbuild/win32-x64@0.21.5':
        optional: true

    '@eslint-community/eslint-utils@4.9.0(eslint@8.57.1)':
        dependencies:
            eslint: 8.57.1
            eslint-visitor-keys: 3.4.3

    '@eslint-community/eslint-utils@4.9.0(eslint@9.27.0(jiti@1.21.7))':
        dependencies:
            eslint: 9.27.0(jiti@1.21.7)
            eslint-visitor-keys: 3.4.3

    '@eslint-community/regexpp@4.12.2': {}

    '@eslint/config-array@0.20.1':
        dependencies:
            '@eslint/object-schema': 2.1.7
            debug: 4.4.3
            minimatch: 3.1.2
        transitivePeerDependencies:
            - supports-color

    '@eslint/config-helpers@0.2.3': {}

    '@eslint/core@0.14.0':
        dependencies:
            '@types/json-schema': 7.0.15

    '@eslint/core@0.15.2':
        dependencies:
            '@types/json-schema': 7.0.15

    '@eslint/eslintrc@2.1.4':
        dependencies:
            ajv: 6.12.6
            debug: 4.4.3
            espree: 9.6.1
            globals: 13.24.0
            ignore: 5.3.2
            import-fresh: 3.3.1
            js-yaml: 4.1.0
            minimatch: 3.1.2
            strip-json-comments: 3.1.1
        transitivePeerDependencies:
            - supports-color

    '@eslint/eslintrc@3.3.1':
        dependencies:
            ajv: 6.12.6
            debug: 4.4.3
            espree: 10.4.0
            globals: 14.0.0
            ignore: 5.3.2
            import-fresh: 3.3.1
            js-yaml: 4.1.0
            minimatch: 3.1.2
            strip-json-comments: 3.1.1
        transitivePeerDependencies:
            - supports-color

    '@eslint/js@8.57.1': {}

    '@eslint/js@9.27.0': {}

    '@eslint/object-schema@2.1.7': {}

    '@eslint/plugin-kit@0.3.5':
        dependencies:
            '@eslint/core': 0.15.2
            levn: 0.4.1

    '@floating-ui/core@1.7.3':
        dependencies:
            '@floating-ui/utils': 0.2.10

    '@floating-ui/dom@1.7.4':
        dependencies:
            '@floating-ui/core': 1.7.3
            '@floating-ui/utils': 0.2.10

    '@floating-ui/react-dom@2.1.6(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@floating-ui/dom': 1.7.4
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)

    '@floating-ui/utils@0.2.10': {}

    '@humanfs/core@0.19.1': {}

    '@humanfs/node@0.16.7':
        dependencies:
            '@humanfs/core': 0.19.1
            '@humanwhocodes/retry': 0.4.3

    '@humanwhocodes/config-array@0.13.0':
        dependencies:
            '@humanwhocodes/object-schema': 2.0.3
            debug: 4.4.3
            minimatch: 3.1.2
        transitivePeerDependencies:
            - supports-color

    '@humanwhocodes/module-importer@1.0.1': {}

    '@humanwhocodes/object-schema@2.0.3': {}

    '@humanwhocodes/retry@0.4.3': {}

    '@icp-sdk/core@4.1.1(@dfinity/agent@3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/hashes@1.8.0))(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/identity-secp256k1@3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/curves@1.9.7)(@noble/hashes@1.8.0))(@dfinity/identity@3.3.1(@dfinity/agent@3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/hashes@1.8.0))(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/curves@1.9.7)(@noble/hashes@1.8.0))(@dfinity/principal@3.3.1)':
        dependencies:
            '@dfinity/agent': 3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/hashes@1.8.0)
            '@dfinity/candid': 3.3.1(@dfinity/principal@3.3.1)
            '@dfinity/identity': 3.3.1(@dfinity/agent@3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/hashes@1.8.0))(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/curves@1.9.7)(@noble/hashes@1.8.0)
            '@dfinity/identity-secp256k1': 3.3.1(@dfinity/candid@3.3.1(@dfinity/principal@3.3.1))(@dfinity/principal@3.3.1)(@noble/curves@1.9.7)(@noble/hashes@1.8.0)
            '@dfinity/principal': 3.3.1

    '@img/colour@1.0.0': {}

    '@img/sharp-darwin-arm64@0.34.4':
        optionalDependencies:
            '@img/sharp-libvips-darwin-arm64': 1.2.3
        optional: true

    '@img/sharp-darwin-x64@0.34.4':
        optionalDependencies:
            '@img/sharp-libvips-darwin-x64': 1.2.3
        optional: true

    '@img/sharp-libvips-darwin-arm64@1.2.3':
        optional: true

    '@img/sharp-libvips-darwin-x64@1.2.3':
        optional: true

    '@img/sharp-libvips-linux-arm64@1.2.3':
        optional: true

    '@img/sharp-libvips-linux-arm@1.2.3':
        optional: true

    '@img/sharp-libvips-linux-ppc64@1.2.3':
        optional: true

    '@img/sharp-libvips-linux-s390x@1.2.3':
        optional: true

    '@img/sharp-libvips-linux-x64@1.2.3':
        optional: true

    '@img/sharp-libvips-linuxmusl-arm64@1.2.3':
        optional: true

    '@img/sharp-libvips-linuxmusl-x64@1.2.3':
        optional: true

    '@img/sharp-linux-arm64@0.34.4':
        optionalDependencies:
            '@img/sharp-libvips-linux-arm64': 1.2.3
        optional: true

    '@img/sharp-linux-arm@0.34.4':
        optionalDependencies:
            '@img/sharp-libvips-linux-arm': 1.2.3
        optional: true

    '@img/sharp-linux-ppc64@0.34.4':
        optionalDependencies:
            '@img/sharp-libvips-linux-ppc64': 1.2.3
        optional: true

    '@img/sharp-linux-s390x@0.34.4':
        optionalDependencies:
            '@img/sharp-libvips-linux-s390x': 1.2.3
        optional: true

    '@img/sharp-linux-x64@0.34.4':
        optionalDependencies:
            '@img/sharp-libvips-linux-x64': 1.2.3
        optional: true

    '@img/sharp-linuxmusl-arm64@0.34.4':
        optionalDependencies:
            '@img/sharp-libvips-linuxmusl-arm64': 1.2.3
        optional: true

    '@img/sharp-linuxmusl-x64@0.34.4':
        optionalDependencies:
            '@img/sharp-libvips-linuxmusl-x64': 1.2.3
        optional: true

    '@img/sharp-wasm32@0.34.4':
        dependencies:
            '@emnapi/runtime': 1.6.0
        optional: true

    '@img/sharp-win32-arm64@0.34.4':
        optional: true

    '@img/sharp-win32-ia32@0.34.4':
        optional: true

    '@img/sharp-win32-x64@0.34.4':
        optional: true

    '@isaacs/cliui@8.0.2':
        dependencies:
            string-width: 5.1.2
            string-width-cjs: string-width@4.2.3
            strip-ansi: 7.1.2
            strip-ansi-cjs: strip-ansi@6.0.1
            wrap-ansi: 8.1.0
            wrap-ansi-cjs: wrap-ansi@7.0.0

    '@jridgewell/gen-mapping@0.3.13':
        dependencies:
            '@jridgewell/sourcemap-codec': 1.5.5
            '@jridgewell/trace-mapping': 0.3.31

    '@jridgewell/remapping@2.3.5':
        dependencies:
            '@jridgewell/gen-mapping': 0.3.13
            '@jridgewell/trace-mapping': 0.3.31

    '@jridgewell/resolve-uri@3.1.2': {}

    '@jridgewell/sourcemap-codec@1.5.5': {}

    '@jridgewell/trace-mapping@0.3.31':
        dependencies:
            '@jridgewell/resolve-uri': 3.1.2
            '@jridgewell/sourcemap-codec': 1.5.5

    '@mediapipe/tasks-vision@0.10.17': {}

    '@monogrid/gainmap-js@3.1.0(three@0.176.0)':
        dependencies:
            promise-worker-transferable: 1.0.4
            three: 0.176.0

    '@noble/curves@1.9.7':
        dependencies:
            '@noble/hashes': 1.8.0

    '@noble/hashes@1.8.0': {}

    '@nodelib/fs.scandir@2.1.5':
        dependencies:
            '@nodelib/fs.stat': 2.0.5
            run-parallel: 1.2.0

    '@nodelib/fs.stat@2.0.5': {}

    '@nodelib/fs.walk@1.2.8':
        dependencies:
            '@nodelib/fs.scandir': 2.1.5
            fastq: 1.19.1

    '@pkgjs/parseargs@0.11.0':
        optional: true

    '@pmndrs/cannon-worker-api@2.4.0(three@0.176.0)':
        dependencies:
            three: 0.176.0

    '@radix-ui/number@1.1.1': {}

    '@radix-ui/primitive@1.1.3': {}

    '@radix-ui/react-accordion@1.2.12(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-collapsible': 1.1.12(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-collection': 1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-direction': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-id': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-controllable-state': 1.2.2(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-alert-dialog@1.1.15(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-dialog': 1.1.15(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-slot': 1.2.3(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-arrow@1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-aspect-ratio@1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-avatar@1.1.10(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-callback-ref': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-is-hydrated': 0.1.0(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-layout-effect': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-checkbox@1.3.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-presence': 1.1.5(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-controllable-state': 1.2.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-previous': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-size': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-collapsible@1.1.12(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-id': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-presence': 1.1.5(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-controllable-state': 1.2.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-layout-effect': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-collection@1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-slot': 1.2.3(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-compose-refs@1.1.2(@types/react@19.1.17)(react@19.1.1)':
        dependencies:
            react: 19.1.1
        optionalDependencies:
            '@types/react': 19.1.17

    '@radix-ui/react-context-menu@2.2.16(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-menu': 2.1.16(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-callback-ref': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-controllable-state': 1.2.2(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-context@1.1.2(@types/react@19.1.17)(react@19.1.1)':
        dependencies:
            react: 19.1.1
        optionalDependencies:
            '@types/react': 19.1.17

    '@radix-ui/react-dialog@1.1.15(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-dismissable-layer': 1.1.11(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-focus-guards': 1.1.3(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-focus-scope': 1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-id': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-portal': 1.1.9(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-presence': 1.1.5(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-slot': 1.2.3(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-controllable-state': 1.2.2(@types/react@19.1.17)(react@19.1.1)
            aria-hidden: 1.2.6
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
            react-remove-scroll: 2.7.1(@types/react@19.1.17)(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-direction@1.1.1(@types/react@19.1.17)(react@19.1.1)':
        dependencies:
            react: 19.1.1
        optionalDependencies:
            '@types/react': 19.1.17

    '@radix-ui/react-dismissable-layer@1.1.11(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-callback-ref': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-escape-keydown': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-dropdown-menu@2.1.16(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-id': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-menu': 2.1.16(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-controllable-state': 1.2.2(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-focus-guards@1.1.3(@types/react@19.1.17)(react@19.1.1)':
        dependencies:
            react: 19.1.1
        optionalDependencies:
            '@types/react': 19.1.17

    '@radix-ui/react-focus-scope@1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-callback-ref': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-hover-card@1.1.15(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-dismissable-layer': 1.1.11(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-popper': 1.2.8(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-portal': 1.1.9(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-presence': 1.1.5(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-controllable-state': 1.2.2(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-id@1.1.1(@types/react@19.1.17)(react@19.1.1)':
        dependencies:
            '@radix-ui/react-use-layout-effect': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
        optionalDependencies:
            '@types/react': 19.1.17

    '@radix-ui/react-label@2.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-menu@2.1.16(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-collection': 1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-direction': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-dismissable-layer': 1.1.11(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-focus-guards': 1.1.3(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-focus-scope': 1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-id': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-popper': 1.2.8(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-portal': 1.1.9(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-presence': 1.1.5(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-roving-focus': 1.1.11(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-slot': 1.2.3(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-callback-ref': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            aria-hidden: 1.2.6
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
            react-remove-scroll: 2.7.1(@types/react@19.1.17)(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-menubar@1.1.16(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-collection': 1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-direction': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-id': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-menu': 2.1.16(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-roving-focus': 1.1.11(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-controllable-state': 1.2.2(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-navigation-menu@1.2.14(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-collection': 1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-direction': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-dismissable-layer': 1.1.11(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-id': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-presence': 1.1.5(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-callback-ref': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-controllable-state': 1.2.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-layout-effect': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-previous': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-visually-hidden': 1.2.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-popover@1.1.15(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-dismissable-layer': 1.1.11(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-focus-guards': 1.1.3(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-focus-scope': 1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-id': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-popper': 1.2.8(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-portal': 1.1.9(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-presence': 1.1.5(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-slot': 1.2.3(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-controllable-state': 1.2.2(@types/react@19.1.17)(react@19.1.1)
            aria-hidden: 1.2.6
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
            react-remove-scroll: 2.7.1(@types/react@19.1.17)(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-popper@1.2.8(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@floating-ui/react-dom': 2.1.6(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-arrow': 1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-callback-ref': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-layout-effect': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-rect': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-size': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/rect': 1.1.1
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-portal@1.1.9(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-layout-effect': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-presence@1.1.5(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-layout-effect': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-primitive@2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/react-slot': 1.2.3(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-progress@1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-radio-group@1.3.8(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-direction': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-presence': 1.1.5(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-roving-focus': 1.1.11(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-controllable-state': 1.2.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-previous': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-size': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-roving-focus@1.1.11(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-collection': 1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-direction': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-id': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-callback-ref': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-controllable-state': 1.2.2(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-scroll-area@1.2.10(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/number': 1.1.1
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-direction': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-presence': 1.1.5(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-callback-ref': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-layout-effect': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-select@2.2.6(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/number': 1.1.1
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-collection': 1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-direction': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-dismissable-layer': 1.1.11(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-focus-guards': 1.1.3(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-focus-scope': 1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-id': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-popper': 1.2.8(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-portal': 1.1.9(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-slot': 1.2.3(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-callback-ref': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-controllable-state': 1.2.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-layout-effect': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-previous': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-visually-hidden': 1.2.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            aria-hidden: 1.2.6
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
            react-remove-scroll: 2.7.1(@types/react@19.1.17)(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-separator@1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-slider@1.3.6(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/number': 1.1.1
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-collection': 1.1.7(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-direction': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-controllable-state': 1.2.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-layout-effect': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-previous': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-size': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-slot@1.2.3(@types/react@19.1.17)(react@19.1.1)':
        dependencies:
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
        optionalDependencies:
            '@types/react': 19.1.17

    '@radix-ui/react-switch@1.2.6(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-controllable-state': 1.2.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-previous': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-size': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-tabs@1.1.13(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-direction': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-id': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-presence': 1.1.5(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-roving-focus': 1.1.11(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-controllable-state': 1.2.2(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-toggle-group@1.1.11(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-direction': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-roving-focus': 1.1.11(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-toggle': 1.1.10(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-controllable-state': 1.2.2(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-toggle@1.1.10(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-use-controllable-state': 1.2.2(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-tooltip@1.2.8(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/primitive': 1.1.3
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-context': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-dismissable-layer': 1.1.11(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-id': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-popper': 1.2.8(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-portal': 1.1.9(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-presence': 1.1.5(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-slot': 1.2.3(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-controllable-state': 1.2.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-visually-hidden': 1.2.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/react-use-callback-ref@1.1.1(@types/react@19.1.17)(react@19.1.1)':
        dependencies:
            react: 19.1.1
        optionalDependencies:
            '@types/react': 19.1.17

    '@radix-ui/react-use-controllable-state@1.2.2(@types/react@19.1.17)(react@19.1.1)':
        dependencies:
            '@radix-ui/react-use-effect-event': 0.0.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-use-layout-effect': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
        optionalDependencies:
            '@types/react': 19.1.17

    '@radix-ui/react-use-effect-event@0.0.2(@types/react@19.1.17)(react@19.1.1)':
        dependencies:
            '@radix-ui/react-use-layout-effect': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
        optionalDependencies:
            '@types/react': 19.1.17

    '@radix-ui/react-use-escape-keydown@1.1.1(@types/react@19.1.17)(react@19.1.1)':
        dependencies:
            '@radix-ui/react-use-callback-ref': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
        optionalDependencies:
            '@types/react': 19.1.17

    '@radix-ui/react-use-is-hydrated@0.1.0(@types/react@19.1.17)(react@19.1.1)':
        dependencies:
            react: 19.1.1
            use-sync-external-store: 1.6.0(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17

    '@radix-ui/react-use-layout-effect@1.1.1(@types/react@19.1.17)(react@19.1.1)':
        dependencies:
            react: 19.1.1
        optionalDependencies:
            '@types/react': 19.1.17

    '@radix-ui/react-use-previous@1.1.1(@types/react@19.1.17)(react@19.1.1)':
        dependencies:
            react: 19.1.1
        optionalDependencies:
            '@types/react': 19.1.17

    '@radix-ui/react-use-rect@1.1.1(@types/react@19.1.17)(react@19.1.1)':
        dependencies:
            '@radix-ui/rect': 1.1.1
            react: 19.1.1
        optionalDependencies:
            '@types/react': 19.1.17

    '@radix-ui/react-use-size@1.1.1(@types/react@19.1.17)(react@19.1.1)':
        dependencies:
            '@radix-ui/react-use-layout-effect': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
        optionalDependencies:
            '@types/react': 19.1.17

    '@radix-ui/react-visually-hidden@1.2.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            '@types/react-dom': 19.1.11(@types/react@19.1.17)

    '@radix-ui/rect@1.1.1': {}

    '@react-three/cannon@6.6.0(@react-three/fiber@9.1.4(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)(three@0.176.0))(react@19.1.1)(three@0.176.0)(typescript@5.9.3)':
        dependencies:
            '@pmndrs/cannon-worker-api': 2.4.0(three@0.176.0)
            '@react-three/fiber': 9.1.4(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)(three@0.176.0)
            cannon-es: 0.20.0
            cannon-es-debugger: 1.0.0(cannon-es@0.20.0)(three@0.176.0)(typescript@5.9.3)
            react: 19.1.1
            three: 0.176.0
        transitivePeerDependencies:
            - typescript

    '@react-three/drei@10.0.8(@react-three/fiber@9.1.4(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)(three@0.176.0))(@types/react@19.1.17)(@types/three@0.176.0)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)(three@0.176.0)':
        dependencies:
            '@babel/runtime': 7.28.4
            '@mediapipe/tasks-vision': 0.10.17
            '@monogrid/gainmap-js': 3.1.0(three@0.176.0)
            '@react-three/fiber': 9.1.4(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)(three@0.176.0)
            '@use-gesture/react': 10.3.1(react@19.1.1)
            camera-controls: 2.10.1(three@0.176.0)
            cross-env: 7.0.3
            detect-gpu: 5.0.70
            glsl-noise: 0.0.0
            hls.js: 1.6.13
            maath: 0.10.8(@types/three@0.176.0)(three@0.176.0)
            meshline: 3.3.1(three@0.176.0)
            react: 19.1.1
            stats-gl: 2.4.2(@types/three@0.176.0)(three@0.176.0)
            stats.js: 0.17.0
            suspend-react: 0.1.3(react@19.1.1)
            three: 0.176.0
            three-mesh-bvh: 0.8.3(three@0.176.0)
            three-stdlib: 2.36.0(three@0.176.0)
            troika-three-text: 0.52.4(three@0.176.0)
            tunnel-rat: 0.1.2(@types/react@19.1.17)(react@19.1.1)
            use-sync-external-store: 1.6.0(react@19.1.1)
            utility-types: 3.11.0
            zustand: 5.0.8(@types/react@19.1.17)(react@19.1.1)(use-sync-external-store@1.6.0(react@19.1.1))
        optionalDependencies:
            react-dom: 19.1.1(react@19.1.1)
        transitivePeerDependencies:
            - '@types/react'
            - '@types/three'
            - immer

    '@react-three/eslint-plugin@0.1.2':
        dependencies:
            '@babel/runtime': 7.28.4
            eslint: 8.57.1
        transitivePeerDependencies:
            - supports-color

    '@react-three/fiber@9.1.4(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)(three@0.176.0)':
        dependencies:
            '@babel/runtime': 7.28.4
            '@types/react-reconciler': 0.28.9(@types/react@19.1.17)
            '@types/webxr': 0.5.24
            base64-js: 1.5.1
            buffer: 6.0.3
            its-fine: 2.0.0(@types/react@19.1.17)(react@19.1.1)
            react: 19.1.1
            react-reconciler: 0.31.0(react@19.1.1)
            react-use-measure: 2.1.7(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            scheduler: 0.25.0
            suspend-react: 0.1.3(react@19.1.1)
            three: 0.176.0
            use-sync-external-store: 1.6.0(react@19.1.1)
            zustand: 5.0.8(@types/react@19.1.17)(react@19.1.1)(use-sync-external-store@1.6.0(react@19.1.1))
        optionalDependencies:
            react-dom: 19.1.1(react@19.1.1)
        transitivePeerDependencies:
            - '@types/react'
            - immer

    '@rolldown/pluginutils@1.0.0-beta.27': {}

    '@rollup/rollup-android-arm-eabi@4.52.5':
        optional: true

    '@rollup/rollup-android-arm64@4.52.5':
        optional: true

    '@rollup/rollup-darwin-arm64@4.52.5':
        optional: true

    '@rollup/rollup-darwin-x64@4.52.5':
        optional: true

    '@rollup/rollup-freebsd-arm64@4.52.5':
        optional: true

    '@rollup/rollup-freebsd-x64@4.52.5':
        optional: true

    '@rollup/rollup-linux-arm-gnueabihf@4.52.5':
        optional: true

    '@rollup/rollup-linux-arm-musleabihf@4.52.5':
        optional: true

    '@rollup/rollup-linux-arm64-gnu@4.52.5':
        optional: true

    '@rollup/rollup-linux-arm64-musl@4.52.5':
        optional: true

    '@rollup/rollup-linux-loong64-gnu@4.52.5':
        optional: true

    '@rollup/rollup-linux-ppc64-gnu@4.52.5':
        optional: true

    '@rollup/rollup-linux-riscv64-gnu@4.52.5':
        optional: true

    '@rollup/rollup-linux-riscv64-musl@4.52.5':
        optional: true

    '@rollup/rollup-linux-s390x-gnu@4.52.5':
        optional: true

    '@rollup/rollup-linux-x64-gnu@4.52.5':
        optional: true

    '@rollup/rollup-linux-x64-musl@4.52.5':
        optional: true

    '@rollup/rollup-openharmony-arm64@4.52.5':
        optional: true

    '@rollup/rollup-win32-arm64-msvc@4.52.5':
        optional: true

    '@rollup/rollup-win32-ia32-msvc@4.52.5':
        optional: true

    '@rollup/rollup-win32-x64-gnu@4.52.5':
        optional: true

    '@rollup/rollup-win32-x64-msvc@4.52.5':
        optional: true

    '@scure/base@1.2.6': {}

    '@scure/bip32@1.7.0':
        dependencies:
            '@noble/curves': 1.9.7
            '@noble/hashes': 1.8.0
            '@scure/base': 1.2.6

    '@scure/bip39@1.6.0':
        dependencies:
            '@noble/hashes': 1.8.0
            '@scure/base': 1.2.6

    '@tailwindcss/container-queries@0.1.1(tailwindcss@3.4.18)':
        dependencies:
            tailwindcss: 3.4.18

    '@tailwindcss/typography@0.5.10(tailwindcss@3.4.18)':
        dependencies:
            lodash.castarray: 4.4.0
            lodash.isplainobject: 4.0.6
            lodash.merge: 4.6.2
            postcss-selector-parser: 6.0.10
            tailwindcss: 3.4.18

    '@tanstack/eslint-plugin-router@1.115.0(eslint@9.27.0(jiti@1.21.7))(typescript@5.9.3)':
        dependencies:
            '@typescript-eslint/utils': 8.46.2(eslint@9.27.0(jiti@1.21.7))(typescript@5.9.3)
            eslint: 9.27.0(jiti@1.21.7)
        transitivePeerDependencies:
            - supports-color
            - typescript

    '@tanstack/history@1.131.2': {}

    '@tanstack/query-core@5.90.5': {}

    '@tanstack/react-query@5.90.5(react@19.1.1)':
        dependencies:
            '@tanstack/query-core': 5.90.5
            react: 19.1.1

    '@tanstack/react-router@1.131.50(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@tanstack/history': 1.131.2
            '@tanstack/react-store': 0.7.7(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@tanstack/router-core': 1.131.50
            isbot: 5.1.31
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
            tiny-invariant: 1.3.3
            tiny-warning: 1.0.3

    '@tanstack/react-store@0.7.7(react-dom@19.1.1(react@19.1.1))(react@19.1.1)':
        dependencies:
            '@tanstack/store': 0.7.7
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
            use-sync-external-store: 1.6.0(react@19.1.1)

    '@tanstack/router-core@1.131.50':
        dependencies:
            '@tanstack/history': 1.131.2
            '@tanstack/store': 0.7.7
            cookie-es: 1.2.2
            seroval: 1.3.2
            seroval-plugins: 1.3.3(seroval@1.3.2)
            tiny-invariant: 1.3.3
            tiny-warning: 1.0.3

    '@tanstack/store@0.7.7': {}

    '@tweenjs/tween.js@23.1.3': {}

    '@types/babel__core@7.20.5':
        dependencies:
            '@babel/parser': 7.28.5
            '@babel/types': 7.28.5
            '@types/babel__generator': 7.27.0
            '@types/babel__template': 7.4.4
            '@types/babel__traverse': 7.28.0

    '@types/babel__generator@7.27.0':
        dependencies:
            '@babel/types': 7.28.5

    '@types/babel__template@7.4.4':
        dependencies:
            '@babel/parser': 7.28.5
            '@babel/types': 7.28.5

    '@types/babel__traverse@7.28.0':
        dependencies:
            '@babel/types': 7.28.5

    '@types/d3-array@3.2.2': {}

    '@types/d3-color@3.1.3': {}

    '@types/d3-ease@3.0.2': {}

    '@types/d3-interpolate@3.0.4':
        dependencies:
            '@types/d3-color': 3.1.3

    '@types/d3-path@3.1.1': {}

    '@types/d3-scale@4.0.9':
        dependencies:
            '@types/d3-time': 3.0.4

    '@types/d3-shape@3.1.7':
        dependencies:
            '@types/d3-path': 3.1.1

    '@types/d3-time@3.0.4': {}

    '@types/d3-timer@3.0.2': {}

    '@types/draco3d@1.4.10': {}

    '@types/estree@1.0.8': {}

    '@types/js-cookie@2.2.7': {}

    '@types/json-schema@7.0.15': {}

    '@types/node@20.19.24':
        dependencies:
            undici-types: 6.21.0

    '@types/offscreencanvas@2019.7.3': {}

    '@types/react-dom@19.1.11(@types/react@19.1.17)':
        dependencies:
            '@types/react': 19.1.17

    '@types/react-reconciler@0.28.9(@types/react@19.1.17)':
        dependencies:
            '@types/react': 19.1.17

    '@types/react@19.1.17':
        dependencies:
            csstype: 3.1.3

    '@types/stats.js@0.17.4': {}

    '@types/three@0.176.0':
        dependencies:
            '@dimforge/rapier3d-compat': 0.12.0
            '@tweenjs/tween.js': 23.1.3
            '@types/stats.js': 0.17.4
            '@types/webxr': 0.5.24
            '@webgpu/types': 0.1.66
            fflate: 0.8.2
            meshoptimizer: 0.18.1

    '@types/webxr@0.5.24': {}

    '@typescript-eslint/eslint-plugin@8.46.2(@typescript-eslint/parser@8.46.2(eslint@9.27.0(jiti@1.21.7))(typescript@5.9.3))(eslint@9.27.0(jiti@1.21.7))(typescript@5.9.3)':
        dependencies:
            '@eslint-community/regexpp': 4.12.2
            '@typescript-eslint/parser': 8.46.2(eslint@9.27.0(jiti@1.21.7))(typescript@5.9.3)
            '@typescript-eslint/scope-manager': 8.46.2
            '@typescript-eslint/type-utils': 8.46.2(eslint@9.27.0(jiti@1.21.7))(typescript@5.9.3)
            '@typescript-eslint/utils': 8.46.2(eslint@9.27.0(jiti@1.21.7))(typescript@5.9.3)
            '@typescript-eslint/visitor-keys': 8.46.2
            eslint: 9.27.0(jiti@1.21.7)
            graphemer: 1.4.0
            ignore: 7.0.5
            natural-compare: 1.4.0
            ts-api-utils: 2.1.0(typescript@5.9.3)
            typescript: 5.9.3
        transitivePeerDependencies:
            - supports-color

    '@typescript-eslint/parser@8.46.2(eslint@9.27.0(jiti@1.21.7))(typescript@5.9.3)':
        dependencies:
            '@typescript-eslint/scope-manager': 8.46.2
            '@typescript-eslint/types': 8.46.2
            '@typescript-eslint/typescript-estree': 8.46.2(typescript@5.9.3)
            '@typescript-eslint/visitor-keys': 8.46.2
            debug: 4.4.3
            eslint: 9.27.0(jiti@1.21.7)
            typescript: 5.9.3
        transitivePeerDependencies:
            - supports-color

    '@typescript-eslint/project-service@8.46.2(typescript@5.9.3)':
        dependencies:
            '@typescript-eslint/tsconfig-utils': 8.46.2(typescript@5.9.3)
            '@typescript-eslint/types': 8.46.2
            debug: 4.4.3
            typescript: 5.9.3
        transitivePeerDependencies:
            - supports-color

    '@typescript-eslint/scope-manager@8.46.2':
        dependencies:
            '@typescript-eslint/types': 8.46.2
            '@typescript-eslint/visitor-keys': 8.46.2

    '@typescript-eslint/tsconfig-utils@8.46.2(typescript@5.9.3)':
        dependencies:
            typescript: 5.9.3

    '@typescript-eslint/type-utils@8.46.2(eslint@9.27.0(jiti@1.21.7))(typescript@5.9.3)':
        dependencies:
            '@typescript-eslint/types': 8.46.2
            '@typescript-eslint/typescript-estree': 8.46.2(typescript@5.9.3)
            '@typescript-eslint/utils': 8.46.2(eslint@9.27.0(jiti@1.21.7))(typescript@5.9.3)
            debug: 4.4.3
            eslint: 9.27.0(jiti@1.21.7)
            ts-api-utils: 2.1.0(typescript@5.9.3)
            typescript: 5.9.3
        transitivePeerDependencies:
            - supports-color

    '@typescript-eslint/types@8.46.2': {}

    '@typescript-eslint/typescript-estree@8.46.2(typescript@5.9.3)':
        dependencies:
            '@typescript-eslint/project-service': 8.46.2(typescript@5.9.3)
            '@typescript-eslint/tsconfig-utils': 8.46.2(typescript@5.9.3)
            '@typescript-eslint/types': 8.46.2
            '@typescript-eslint/visitor-keys': 8.46.2
            debug: 4.4.3
            fast-glob: 3.3.3
            is-glob: 4.0.3
            minimatch: 9.0.5
            semver: 7.7.3
            ts-api-utils: 2.1.0(typescript@5.9.3)
            typescript: 5.9.3
        transitivePeerDependencies:
            - supports-color

    '@typescript-eslint/utils@8.46.2(eslint@9.27.0(jiti@1.21.7))(typescript@5.9.3)':
        dependencies:
            '@eslint-community/eslint-utils': 4.9.0(eslint@9.27.0(jiti@1.21.7))
            '@typescript-eslint/scope-manager': 8.46.2
            '@typescript-eslint/types': 8.46.2
            '@typescript-eslint/typescript-estree': 8.46.2(typescript@5.9.3)
            eslint: 9.27.0(jiti@1.21.7)
            typescript: 5.9.3
        transitivePeerDependencies:
            - supports-color

    '@typescript-eslint/visitor-keys@8.46.2':
        dependencies:
            '@typescript-eslint/types': 8.46.2
            eslint-visitor-keys: 4.2.1

    '@ungap/structured-clone@1.3.0': {}

    '@use-gesture/core@10.3.1': {}

    '@use-gesture/react@10.3.1(react@19.1.1)':
        dependencies:
            '@use-gesture/core': 10.3.1
            react: 19.1.1

    '@vitejs/plugin-react@4.7.0(vite@5.4.21(@types/node@20.19.24))':
        dependencies:
            '@babel/core': 7.28.5
            '@babel/plugin-transform-react-jsx-self': 7.27.1(@babel/core@7.28.5)
            '@babel/plugin-transform-react-jsx-source': 7.27.1(@babel/core@7.28.5)
            '@rolldown/pluginutils': 1.0.0-beta.27
            '@types/babel__core': 7.20.5
            react-refresh: 0.17.0
            vite: 5.4.21(@types/node@20.19.24)
        transitivePeerDependencies:
            - supports-color

    '@webgpu/types@0.1.66': {}

    '@xobotyi/scrollbar-width@1.9.5': {}

    acorn-jsx@5.3.2(acorn@8.15.0):
        dependencies:
            acorn: 8.15.0

    acorn@8.15.0: {}

    ajv@6.12.6:
        dependencies:
            fast-deep-equal: 3.1.3
            fast-json-stable-stringify: 2.1.0
            json-schema-traverse: 0.4.1
            uri-js: 4.4.1

    ansi-regex@5.0.1: {}

    ansi-regex@6.2.2: {}

    ansi-styles@4.3.0:
        dependencies:
            color-convert: 2.0.1

    ansi-styles@6.2.3: {}

    any-promise@1.3.0: {}

    anymatch@3.1.3:
        dependencies:
            normalize-path: 3.0.0
            picomatch: 2.3.1

    arg@5.0.2: {}

    argparse@2.0.1: {}

    aria-hidden@1.2.6:
        dependencies:
            tslib: 2.8.1

    array-buffer-byte-length@1.0.2:
        dependencies:
            call-bound: 1.0.4
            is-array-buffer: 3.0.5

    array-includes@3.1.9:
        dependencies:
            call-bind: 1.0.8
            call-bound: 1.0.4
            define-properties: 1.2.1
            es-abstract: 1.24.0
            es-object-atoms: 1.1.1
            get-intrinsic: 1.3.0
            is-string: 1.1.1
            math-intrinsics: 1.1.0

    array.prototype.findlast@1.2.5:
        dependencies:
            call-bind: 1.0.8
            define-properties: 1.2.1
            es-abstract: 1.24.0
            es-errors: 1.3.0
            es-object-atoms: 1.1.1
            es-shim-unscopables: 1.1.0

    array.prototype.flat@1.3.3:
        dependencies:
            call-bind: 1.0.8
            define-properties: 1.2.1
            es-abstract: 1.24.0
            es-shim-unscopables: 1.1.0

    array.prototype.flatmap@1.3.3:
        dependencies:
            call-bind: 1.0.8
            define-properties: 1.2.1
            es-abstract: 1.24.0
            es-shim-unscopables: 1.1.0

    array.prototype.tosorted@1.1.4:
        dependencies:
            call-bind: 1.0.8
            define-properties: 1.2.1
            es-abstract: 1.24.0
            es-errors: 1.3.0
            es-shim-unscopables: 1.1.0

    arraybuffer.prototype.slice@1.0.4:
        dependencies:
            array-buffer-byte-length: 1.0.2
            call-bind: 1.0.8
            define-properties: 1.2.1
            es-abstract: 1.24.0
            es-errors: 1.3.0
            get-intrinsic: 1.3.0
            is-array-buffer: 3.0.5

    asn1js@3.0.6:
        dependencies:
            pvtsutils: 1.3.6
            pvutils: 1.1.5
            tslib: 2.8.1

    async-function@1.0.0: {}

    autoprefixer@10.4.21(postcss@8.5.6):
        dependencies:
            browserslist: 4.27.0
            caniuse-lite: 1.0.30001752
            fraction.js: 4.3.7
            normalize-range: 0.1.2
            picocolors: 1.1.1
            postcss: 8.5.6
            postcss-value-parser: 4.2.0

    available-typed-arrays@1.0.7:
        dependencies:
            possible-typed-array-names: 1.1.0

    balanced-match@1.0.2: {}

    base64-js@1.5.1: {}

    baseline-browser-mapping@2.8.22: {}

    bidi-js@1.0.3:
        dependencies:
            require-from-string: 2.0.2

    binary-extensions@2.3.0: {}

    brace-expansion@1.1.12:
        dependencies:
            balanced-match: 1.0.2
            concat-map: 0.0.1

    brace-expansion@2.0.2:
        dependencies:
            balanced-match: 1.0.2

    braces@3.0.3:
        dependencies:
            fill-range: 7.1.1

    browserslist@4.27.0:
        dependencies:
            baseline-browser-mapping: 2.8.22
            caniuse-lite: 1.0.30001752
            electron-to-chromium: 1.5.244
            node-releases: 2.0.27
            update-browserslist-db: 1.1.4(browserslist@4.27.0)

    buffer@6.0.3:
        dependencies:
            base64-js: 1.5.1
            ieee754: 1.2.1

    call-bind-apply-helpers@1.0.2:
        dependencies:
            es-errors: 1.3.0
            function-bind: 1.1.2

    call-bind@1.0.8:
        dependencies:
            call-bind-apply-helpers: 1.0.2
            es-define-property: 1.0.1
            get-intrinsic: 1.3.0
            set-function-length: 1.2.2

    call-bound@1.0.4:
        dependencies:
            call-bind-apply-helpers: 1.0.2
            get-intrinsic: 1.3.0

    callsites@3.1.0: {}

    camelcase-css@2.0.1: {}

    camera-controls@2.10.1(three@0.176.0):
        dependencies:
            three: 0.176.0

    caniuse-lite@1.0.30001752: {}

    cannon-es-debugger@1.0.0(cannon-es@0.20.0)(three@0.176.0)(typescript@5.9.3):
        dependencies:
            cannon-es: 0.20.0
            three: 0.176.0
        optionalDependencies:
            typescript: 5.9.3

    cannon-es@0.20.0: {}

    chalk@4.1.2:
        dependencies:
            ansi-styles: 4.3.0
            supports-color: 7.2.0

    chokidar@3.6.0:
        dependencies:
            anymatch: 3.1.3
            braces: 3.0.3
            glob-parent: 5.1.2
            is-binary-path: 2.1.0
            is-glob: 4.0.3
            normalize-path: 3.0.0
            readdirp: 3.6.0
        optionalDependencies:
            fsevents: 2.3.3

    class-variance-authority@0.7.1:
        dependencies:
            clsx: 2.1.1

    clsx@2.1.1: {}

    cmdk@1.1.1(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1):
        dependencies:
            '@radix-ui/react-compose-refs': 1.1.2(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-dialog': 1.1.15(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            '@radix-ui/react-id': 1.1.1(@types/react@19.1.17)(react@19.1.1)
            '@radix-ui/react-primitive': 2.1.3(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        transitivePeerDependencies:
            - '@types/react'
            - '@types/react-dom'

    color-convert@2.0.1:
        dependencies:
            color-name: 1.1.4

    color-name@1.1.4: {}

    commander@4.1.1: {}

    concat-map@0.0.1: {}

    convert-source-map@2.0.0: {}

    cookie-es@1.2.2: {}

    copy-to-clipboard@3.3.3:
        dependencies:
            toggle-selection: 1.0.6

    cross-env@7.0.3:
        dependencies:
            cross-spawn: 7.0.6

    cross-spawn@7.0.6:
        dependencies:
            path-key: 3.1.1
            shebang-command: 2.0.0
            which: 2.0.2

    css-in-js-utils@3.1.0:
        dependencies:
            hyphenate-style-name: 1.1.0

    css-tree@1.1.3:
        dependencies:
            mdn-data: 2.0.14
            source-map: 0.6.1

    cssesc@3.0.0: {}

    csstype@3.1.3: {}

    d3-array@3.2.4:
        dependencies:
            internmap: 2.0.3

    d3-color@3.1.0: {}

    d3-ease@3.0.1: {}

    d3-format@3.1.0: {}

    d3-interpolate@3.0.1:
        dependencies:
            d3-color: 3.1.0

    d3-path@3.1.0: {}

    d3-scale@4.0.2:
        dependencies:
            d3-array: 3.2.4
            d3-format: 3.1.0
            d3-interpolate: 3.0.1
            d3-time: 3.1.0
            d3-time-format: 4.1.0

    d3-shape@3.2.0:
        dependencies:
            d3-path: 3.1.0

    d3-time-format@4.1.0:
        dependencies:
            d3-time: 3.1.0

    d3-time@3.1.0:
        dependencies:
            d3-array: 3.2.4

    d3-timer@3.0.1: {}

    data-view-buffer@1.0.2:
        dependencies:
            call-bound: 1.0.4
            es-errors: 1.3.0
            is-data-view: 1.0.2

    data-view-byte-length@1.0.2:
        dependencies:
            call-bound: 1.0.4
            es-errors: 1.3.0
            is-data-view: 1.0.2

    data-view-byte-offset@1.0.1:
        dependencies:
            call-bound: 1.0.4
            es-errors: 1.3.0
            is-data-view: 1.0.2

    date-fns-jalali@4.1.0-0: {}

    date-fns@3.6.0: {}

    date-fns@4.1.0: {}

    debug@4.4.3:
        dependencies:
            ms: 2.1.3

    decimal.js-light@2.5.1: {}

    deep-is@0.1.4: {}

    define-data-property@1.1.4:
        dependencies:
            es-define-property: 1.0.1
            es-errors: 1.3.0
            gopd: 1.2.0

    define-properties@1.2.1:
        dependencies:
            define-data-property: 1.1.4
            has-property-descriptors: 1.0.2
            object-keys: 1.1.1

    detect-gpu@5.0.70:
        dependencies:
            webgl-constants: 1.1.1

    detect-libc@2.1.2: {}

    detect-node-es@1.1.0: {}

    didyoumean@1.2.2: {}

    dlv@1.1.3: {}

    doctrine@2.1.0:
        dependencies:
            esutils: 2.0.3

    doctrine@3.0.0:
        dependencies:
            esutils: 2.0.3

    dom-helpers@5.2.1:
        dependencies:
            '@babel/runtime': 7.28.4
            csstype: 3.1.3

    dotenv-cli@8.0.0:
        dependencies:
            cross-spawn: 7.0.6
            dotenv: 16.6.1
            dotenv-expand: 10.0.0
            minimist: 1.2.8

    dotenv-expand@10.0.0: {}

    dotenv@16.6.1: {}

    draco3d@1.5.7: {}

    dunder-proto@1.0.1:
        dependencies:
            call-bind-apply-helpers: 1.0.2
            es-errors: 1.3.0
            gopd: 1.2.0

    eastasianwidth@0.2.0: {}

    electron-to-chromium@1.5.244: {}

    embla-carousel-react@8.6.0(react@19.1.1):
        dependencies:
            embla-carousel: 8.6.0
            embla-carousel-reactive-utils: 8.6.0(embla-carousel@8.6.0)
            react: 19.1.1

    embla-carousel-reactive-utils@8.6.0(embla-carousel@8.6.0):
        dependencies:
            embla-carousel: 8.6.0

    embla-carousel@8.6.0: {}

    emoji-regex@8.0.0: {}

    emoji-regex@9.2.2: {}

    error-stack-parser@2.1.4:
        dependencies:
            stackframe: 1.3.4

    es-abstract@1.24.0:
        dependencies:
            array-buffer-byte-length: 1.0.2
            arraybuffer.prototype.slice: 1.0.4
            available-typed-arrays: 1.0.7
            call-bind: 1.0.8
            call-bound: 1.0.4
            data-view-buffer: 1.0.2
            data-view-byte-length: 1.0.2
            data-view-byte-offset: 1.0.1
            es-define-property: 1.0.1
            es-errors: 1.3.0
            es-object-atoms: 1.1.1
            es-set-tostringtag: 2.1.0
            es-to-primitive: 1.3.0
            function.prototype.name: 1.1.8
            get-intrinsic: 1.3.0
            get-proto: 1.0.1
            get-symbol-description: 1.1.0
            globalthis: 1.0.4
            gopd: 1.2.0
            has-property-descriptors: 1.0.2
            has-proto: 1.2.0
            has-symbols: 1.1.0
            hasown: 2.0.2
            internal-slot: 1.1.0
            is-array-buffer: 3.0.5
            is-callable: 1.2.7
            is-data-view: 1.0.2
            is-negative-zero: 2.0.3
            is-regex: 1.2.1
            is-set: 2.0.3
            is-shared-array-buffer: 1.0.4
            is-string: 1.1.1
            is-typed-array: 1.1.15
            is-weakref: 1.1.1
            math-intrinsics: 1.1.0
            object-inspect: 1.13.4
            object-keys: 1.1.1
            object.assign: 4.1.7
            own-keys: 1.0.1
            regexp.prototype.flags: 1.5.4
            safe-array-concat: 1.1.3
            safe-push-apply: 1.0.0
            safe-regex-test: 1.1.0
            set-proto: 1.0.0
            stop-iteration-iterator: 1.1.0
            string.prototype.trim: 1.2.10
            string.prototype.trimend: 1.0.9
            string.prototype.trimstart: 1.0.8
            typed-array-buffer: 1.0.3
            typed-array-byte-length: 1.0.3
            typed-array-byte-offset: 1.0.4
            typed-array-length: 1.0.7
            unbox-primitive: 1.1.0
            which-typed-array: 1.1.19

    es-define-property@1.0.1: {}

    es-errors@1.3.0: {}

    es-iterator-helpers@1.2.1:
        dependencies:
            call-bind: 1.0.8
            call-bound: 1.0.4
            define-properties: 1.2.1
            es-abstract: 1.24.0
            es-errors: 1.3.0
            es-set-tostringtag: 2.1.0
            function-bind: 1.1.2
            get-intrinsic: 1.3.0
            globalthis: 1.0.4
            gopd: 1.2.0
            has-property-descriptors: 1.0.2
            has-proto: 1.2.0
            has-symbols: 1.1.0
            internal-slot: 1.1.0
            iterator.prototype: 1.1.5
            safe-array-concat: 1.1.3

    es-object-atoms@1.1.1:
        dependencies:
            es-errors: 1.3.0

    es-set-tostringtag@2.1.0:
        dependencies:
            es-errors: 1.3.0
            get-intrinsic: 1.3.0
            has-tostringtag: 1.0.2
            hasown: 2.0.2

    es-shim-unscopables@1.1.0:
        dependencies:
            hasown: 2.0.2

    es-to-primitive@1.3.0:
        dependencies:
            is-callable: 1.2.7
            is-date-object: 1.1.0
            is-symbol: 1.1.1

    esbuild@0.21.5:
        optionalDependencies:
            '@esbuild/aix-ppc64': 0.21.5
            '@esbuild/android-arm': 0.21.5
            '@esbuild/android-arm64': 0.21.5
            '@esbuild/android-x64': 0.21.5
            '@esbuild/darwin-arm64': 0.21.5
            '@esbuild/darwin-x64': 0.21.5
            '@esbuild/freebsd-arm64': 0.21.5
            '@esbuild/freebsd-x64': 0.21.5
            '@esbuild/linux-arm': 0.21.5
            '@esbuild/linux-arm64': 0.21.5
            '@esbuild/linux-ia32': 0.21.5
            '@esbuild/linux-loong64': 0.21.5
            '@esbuild/linux-mips64el': 0.21.5
            '@esbuild/linux-ppc64': 0.21.5
            '@esbuild/linux-riscv64': 0.21.5
            '@esbuild/linux-s390x': 0.21.5
            '@esbuild/linux-x64': 0.21.5
            '@esbuild/netbsd-x64': 0.21.5
            '@esbuild/openbsd-x64': 0.21.5
            '@esbuild/sunos-x64': 0.21.5
            '@esbuild/win32-arm64': 0.21.5
            '@esbuild/win32-ia32': 0.21.5
            '@esbuild/win32-x64': 0.21.5

    escalade@3.2.0: {}

    escape-string-regexp@4.0.0: {}

    eslint-plugin-react-hooks@5.2.0(eslint@9.27.0(jiti@1.21.7)):
        dependencies:
            eslint: 9.27.0(jiti@1.21.7)

    eslint-plugin-react@7.37.5(eslint@9.27.0(jiti@1.21.7)):
        dependencies:
            array-includes: 3.1.9
            array.prototype.findlast: 1.2.5
            array.prototype.flatmap: 1.3.3
            array.prototype.tosorted: 1.1.4
            doctrine: 2.1.0
            es-iterator-helpers: 1.2.1
            eslint: 9.27.0(jiti@1.21.7)
            estraverse: 5.3.0
            hasown: 2.0.2
            jsx-ast-utils: 3.3.5
            minimatch: 3.1.2
            object.entries: 1.1.9
            object.fromentries: 2.0.8
            object.values: 1.2.1
            prop-types: 15.8.1
            resolve: 2.0.0-next.5
            semver: 6.3.1
            string.prototype.matchall: 4.0.12
            string.prototype.repeat: 1.0.0

    eslint-plugin-tailwindcss@3.18.2(tailwindcss@3.4.18):
        dependencies:
            fast-glob: 3.3.3
            postcss: 8.5.6
            tailwindcss: 3.4.18

    eslint-scope@7.2.2:
        dependencies:
            esrecurse: 4.3.0
            estraverse: 5.3.0

    eslint-scope@8.4.0:
        dependencies:
            esrecurse: 4.3.0
            estraverse: 5.3.0

    eslint-visitor-keys@3.4.3: {}

    eslint-visitor-keys@4.2.1: {}

    eslint@8.57.1:
        dependencies:
            '@eslint-community/eslint-utils': 4.9.0(eslint@8.57.1)
            '@eslint-community/regexpp': 4.12.2
            '@eslint/eslintrc': 2.1.4
            '@eslint/js': 8.57.1
            '@humanwhocodes/config-array': 0.13.0
            '@humanwhocodes/module-importer': 1.0.1
            '@nodelib/fs.walk': 1.2.8
            '@ungap/structured-clone': 1.3.0
            ajv: 6.12.6
            chalk: 4.1.2
            cross-spawn: 7.0.6
            debug: 4.4.3
            doctrine: 3.0.0
            escape-string-regexp: 4.0.0
            eslint-scope: 7.2.2
            eslint-visitor-keys: 3.4.3
            espree: 9.6.1
            esquery: 1.6.0
            esutils: 2.0.3
            fast-deep-equal: 3.1.3
            file-entry-cache: 6.0.1
            find-up: 5.0.0
            glob-parent: 6.0.2
            globals: 13.24.0
            graphemer: 1.4.0
            ignore: 5.3.2
            imurmurhash: 0.1.4
            is-glob: 4.0.3
            is-path-inside: 3.0.3
            js-yaml: 4.1.0
            json-stable-stringify-without-jsonify: 1.0.1
            levn: 0.4.1
            lodash.merge: 4.6.2
            minimatch: 3.1.2
            natural-compare: 1.4.0
            optionator: 0.9.4
            strip-ansi: 6.0.1
            text-table: 0.2.0
        transitivePeerDependencies:
            - supports-color

    eslint@9.27.0(jiti@1.21.7):
        dependencies:
            '@eslint-community/eslint-utils': 4.9.0(eslint@9.27.0(jiti@1.21.7))
            '@eslint-community/regexpp': 4.12.2
            '@eslint/config-array': 0.20.1
            '@eslint/config-helpers': 0.2.3
            '@eslint/core': 0.14.0
            '@eslint/eslintrc': 3.3.1
            '@eslint/js': 9.27.0
            '@eslint/plugin-kit': 0.3.5
            '@humanfs/node': 0.16.7
            '@humanwhocodes/module-importer': 1.0.1
            '@humanwhocodes/retry': 0.4.3
            '@types/estree': 1.0.8
            '@types/json-schema': 7.0.15
            ajv: 6.12.6
            chalk: 4.1.2
            cross-spawn: 7.0.6
            debug: 4.4.3
            escape-string-regexp: 4.0.0
            eslint-scope: 8.4.0
            eslint-visitor-keys: 4.2.1
            espree: 10.4.0
            esquery: 1.6.0
            esutils: 2.0.3
            fast-deep-equal: 3.1.3
            file-entry-cache: 8.0.0
            find-up: 5.0.0
            glob-parent: 6.0.2
            ignore: 5.3.2
            imurmurhash: 0.1.4
            is-glob: 4.0.3
            json-stable-stringify-without-jsonify: 1.0.1
            lodash.merge: 4.6.2
            minimatch: 3.1.2
            natural-compare: 1.4.0
            optionator: 0.9.4
        optionalDependencies:
            jiti: 1.21.7
        transitivePeerDependencies:
            - supports-color

    espree@10.4.0:
        dependencies:
            acorn: 8.15.0
            acorn-jsx: 5.3.2(acorn@8.15.0)
            eslint-visitor-keys: 4.2.1

    espree@9.6.1:
        dependencies:
            acorn: 8.15.0
            acorn-jsx: 5.3.2(acorn@8.15.0)
            eslint-visitor-keys: 3.4.3

    esquery@1.6.0:
        dependencies:
            estraverse: 5.3.0

    esrecurse@4.3.0:
        dependencies:
            estraverse: 5.3.0

    estraverse@5.3.0: {}

    esutils@2.0.3: {}

    eventemitter3@4.0.7: {}

    eventemitter3@5.0.1: {}

    fast-deep-equal@3.1.3: {}

    fast-diff@1.3.0: {}

    fast-equals@5.3.2: {}

    fast-glob@3.3.3:
        dependencies:
            '@nodelib/fs.stat': 2.0.5
            '@nodelib/fs.walk': 1.2.8
            glob-parent: 5.1.2
            merge2: 1.4.1
            micromatch: 4.0.8

    fast-json-stable-stringify@2.1.0: {}

    fast-levenshtein@2.0.6: {}

    fast-shallow-equal@1.0.0: {}

    fastest-stable-stringify@2.0.2: {}

    fastq@1.19.1:
        dependencies:
            reusify: 1.1.0

    fflate@0.6.10: {}

    fflate@0.8.2: {}

    file-entry-cache@6.0.1:
        dependencies:
            flat-cache: 3.2.0

    file-entry-cache@8.0.0:
        dependencies:
            flat-cache: 4.0.1

    fill-range@7.1.1:
        dependencies:
            to-regex-range: 5.0.1

    find-up@5.0.0:
        dependencies:
            locate-path: 6.0.0
            path-exists: 4.0.0

    flat-cache@3.2.0:
        dependencies:
            flatted: 3.3.3
            keyv: 4.5.4
            rimraf: 3.0.2

    flat-cache@4.0.1:
        dependencies:
            flatted: 3.3.3
            keyv: 4.5.4

    flatted@3.3.3: {}

    for-each@0.3.5:
        dependencies:
            is-callable: 1.2.7

    foreground-child@3.3.1:
        dependencies:
            cross-spawn: 7.0.6
            signal-exit: 4.1.0

    fraction.js@4.3.7: {}

    fs.realpath@1.0.0: {}

    fsevents@2.3.3:
        optional: true

    function-bind@1.1.2: {}

    function.prototype.name@1.1.8:
        dependencies:
            call-bind: 1.0.8
            call-bound: 1.0.4
            define-properties: 1.2.1
            functions-have-names: 1.2.3
            hasown: 2.0.2
            is-callable: 1.2.7

    functions-have-names@1.2.3: {}

    generator-function@2.0.1: {}

    gensync@1.0.0-beta.2: {}

    get-intrinsic@1.3.0:
        dependencies:
            call-bind-apply-helpers: 1.0.2
            es-define-property: 1.0.1
            es-errors: 1.3.0
            es-object-atoms: 1.1.1
            function-bind: 1.1.2
            get-proto: 1.0.1
            gopd: 1.2.0
            has-symbols: 1.1.0
            hasown: 2.0.2
            math-intrinsics: 1.1.0

    get-nonce@1.0.1: {}

    get-proto@1.0.1:
        dependencies:
            dunder-proto: 1.0.1
            es-object-atoms: 1.1.1

    get-symbol-description@1.1.0:
        dependencies:
            call-bound: 1.0.4
            es-errors: 1.3.0
            get-intrinsic: 1.3.0

    glob-parent@5.1.2:
        dependencies:
            is-glob: 4.0.3

    glob-parent@6.0.2:
        dependencies:
            is-glob: 4.0.3

    glob@10.4.5:
        dependencies:
            foreground-child: 3.3.1
            jackspeak: 3.4.3
            minimatch: 9.0.5
            minipass: 7.1.2
            package-json-from-dist: 1.0.1
            path-scurry: 1.11.1

    glob@7.2.3:
        dependencies:
            fs.realpath: 1.0.0
            inflight: 1.0.6
            inherits: 2.0.4
            minimatch: 3.1.2
            once: 1.4.0
            path-is-absolute: 1.0.1

    globals@13.24.0:
        dependencies:
            type-fest: 0.20.2

    globals@14.0.0: {}

    globals@16.2.0: {}

    globalthis@1.0.4:
        dependencies:
            define-properties: 1.2.1
            gopd: 1.2.0

    glsl-noise@0.0.0: {}

    gopd@1.2.0: {}

    graphemer@1.4.0: {}

    has-bigints@1.1.0: {}

    has-flag@4.0.0: {}

    has-property-descriptors@1.0.2:
        dependencies:
            es-define-property: 1.0.1

    has-proto@1.2.0:
        dependencies:
            dunder-proto: 1.0.1

    has-symbols@1.1.0: {}

    has-tostringtag@1.0.2:
        dependencies:
            has-symbols: 1.1.0

    hasown@2.0.2:
        dependencies:
            function-bind: 1.1.2

    hls.js@1.6.13: {}

    hyphenate-style-name@1.1.0: {}

    idb@7.1.1: {}

    ieee754@1.2.1: {}

    ignore@5.3.2: {}

    ignore@7.0.5: {}

    immediate@3.0.6: {}

    import-fresh@3.3.1:
        dependencies:
            parent-module: 1.0.1
            resolve-from: 4.0.0

    imurmurhash@0.1.4: {}

    inflight@1.0.6:
        dependencies:
            once: 1.4.0
            wrappy: 1.0.2

    inherits@2.0.4: {}

    inline-style-prefixer@7.0.1:
        dependencies:
            css-in-js-utils: 3.1.0

    input-otp@1.4.2(react-dom@19.1.1(react@19.1.1))(react@19.1.1):
        dependencies:
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)

    internal-slot@1.1.0:
        dependencies:
            es-errors: 1.3.0
            hasown: 2.0.2
            side-channel: 1.1.0

    internmap@2.0.3: {}

    is-array-buffer@3.0.5:
        dependencies:
            call-bind: 1.0.8
            call-bound: 1.0.4
            get-intrinsic: 1.3.0

    is-async-function@2.1.1:
        dependencies:
            async-function: 1.0.0
            call-bound: 1.0.4
            get-proto: 1.0.1
            has-tostringtag: 1.0.2
            safe-regex-test: 1.1.0

    is-bigint@1.1.0:
        dependencies:
            has-bigints: 1.1.0

    is-binary-path@2.1.0:
        dependencies:
            binary-extensions: 2.3.0

    is-boolean-object@1.2.2:
        dependencies:
            call-bound: 1.0.4
            has-tostringtag: 1.0.2

    is-callable@1.2.7: {}

    is-core-module@2.16.1:
        dependencies:
            hasown: 2.0.2

    is-data-view@1.0.2:
        dependencies:
            call-bound: 1.0.4
            get-intrinsic: 1.3.0
            is-typed-array: 1.1.15

    is-date-object@1.1.0:
        dependencies:
            call-bound: 1.0.4
            has-tostringtag: 1.0.2

    is-extglob@2.1.1: {}

    is-finalizationregistry@1.1.1:
        dependencies:
            call-bound: 1.0.4

    is-fullwidth-code-point@3.0.0: {}

    is-generator-function@1.1.2:
        dependencies:
            call-bound: 1.0.4
            generator-function: 2.0.1
            get-proto: 1.0.1
            has-tostringtag: 1.0.2
            safe-regex-test: 1.1.0

    is-glob@4.0.3:
        dependencies:
            is-extglob: 2.1.1

    is-map@2.0.3: {}

    is-negative-zero@2.0.3: {}

    is-number-object@1.1.1:
        dependencies:
            call-bound: 1.0.4
            has-tostringtag: 1.0.2

    is-number@7.0.0: {}

    is-path-inside@3.0.3: {}

    is-promise@2.2.2: {}

    is-regex@1.2.1:
        dependencies:
            call-bound: 1.0.4
            gopd: 1.2.0
            has-tostringtag: 1.0.2
            hasown: 2.0.2

    is-set@2.0.3: {}

    is-shared-array-buffer@1.0.4:
        dependencies:
            call-bound: 1.0.4

    is-string@1.1.1:
        dependencies:
            call-bound: 1.0.4
            has-tostringtag: 1.0.2

    is-symbol@1.1.1:
        dependencies:
            call-bound: 1.0.4
            has-symbols: 1.1.0
            safe-regex-test: 1.1.0

    is-typed-array@1.1.15:
        dependencies:
            which-typed-array: 1.1.19

    is-weakmap@2.0.2: {}

    is-weakref@1.1.1:
        dependencies:
            call-bound: 1.0.4

    is-weakset@2.0.4:
        dependencies:
            call-bound: 1.0.4
            get-intrinsic: 1.3.0

    isarray@2.0.5: {}

    isbot@5.1.31: {}

    isexe@2.0.0: {}

    iterator.prototype@1.1.5:
        dependencies:
            define-data-property: 1.1.4
            es-object-atoms: 1.1.1
            get-intrinsic: 1.3.0
            get-proto: 1.0.1
            has-symbols: 1.1.0
            set-function-name: 2.0.2

    its-fine@2.0.0(@types/react@19.1.17)(react@19.1.1):
        dependencies:
            '@types/react-reconciler': 0.28.9(@types/react@19.1.17)
            react: 19.1.1
        transitivePeerDependencies:
            - '@types/react'

    jackspeak@3.4.3:
        dependencies:
            '@isaacs/cliui': 8.0.2
        optionalDependencies:
            '@pkgjs/parseargs': 0.11.0

    jiti@1.21.7: {}

    js-cookie@2.2.1: {}

    js-tokens@4.0.0: {}

    js-yaml@4.1.0:
        dependencies:
            argparse: 2.0.1

    jsesc@3.1.0: {}

    json-buffer@3.0.1: {}

    json-schema-traverse@0.4.1: {}

    json-stable-stringify-without-jsonify@1.0.1: {}

    json5@2.2.3: {}

    jsx-ast-utils@3.3.5:
        dependencies:
            array-includes: 3.1.9
            array.prototype.flat: 1.3.3
            object.assign: 4.1.7
            object.values: 1.2.1

    keyv@4.5.4:
        dependencies:
            json-buffer: 3.0.1

    levn@0.4.1:
        dependencies:
            prelude-ls: 1.2.1
            type-check: 0.4.0

    lie@3.3.0:
        dependencies:
            immediate: 3.0.6

    lilconfig@3.1.3: {}

    lines-and-columns@1.2.4: {}

    locate-path@6.0.0:
        dependencies:
            p-locate: 5.0.0

    lodash-es@4.17.21: {}

    lodash.castarray@4.4.0: {}

    lodash.clonedeep@4.5.0: {}

    lodash.isequal@4.5.0: {}

    lodash.isplainobject@4.0.6: {}

    lodash.merge@4.6.2: {}

    lodash@4.17.21: {}

    loose-envify@1.4.0:
        dependencies:
            js-tokens: 4.0.0

    lru-cache@10.4.3: {}

    lru-cache@5.1.1:
        dependencies:
            yallist: 3.1.1

    lucide-react@0.511.0(react@19.1.1):
        dependencies:
            react: 19.1.1

    maath@0.10.8(@types/three@0.176.0)(three@0.176.0):
        dependencies:
            '@types/three': 0.176.0
            three: 0.176.0

    math-intrinsics@1.1.0: {}

    mdn-data@2.0.14: {}

    merge2@1.4.1: {}

    meshline@3.3.1(three@0.176.0):
        dependencies:
            three: 0.176.0

    meshoptimizer@0.18.1: {}

    micromatch@4.0.8:
        dependencies:
            braces: 3.0.3
            picomatch: 2.3.1

    minimatch@3.1.2:
        dependencies:
            brace-expansion: 1.1.12

    minimatch@9.0.5:
        dependencies:
            brace-expansion: 2.0.2

    minimist@1.2.8: {}

    minipass@7.1.2: {}

    ms@2.1.3: {}

    mz@2.7.0:
        dependencies:
            any-promise: 1.3.0
            object-assign: 4.1.1
            thenify-all: 1.6.0

    nano-css@5.6.2(react-dom@19.1.1(react@19.1.1))(react@19.1.1):
        dependencies:
            '@jridgewell/sourcemap-codec': 1.5.5
            css-tree: 1.1.3
            csstype: 3.1.3
            fastest-stable-stringify: 2.0.2
            inline-style-prefixer: 7.0.1
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
            rtl-css-js: 1.16.1
            stacktrace-js: 2.0.2
            stylis: 4.3.6

    nanoid@3.3.11: {}

    natural-compare@1.4.0: {}

    next-themes@0.4.6(react-dom@19.1.1(react@19.1.1))(react@19.1.1):
        dependencies:
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)

    node-releases@2.0.27: {}

    normalize-path@3.0.0: {}

    normalize-range@0.1.2: {}

    object-assign@4.1.1: {}

    object-hash@3.0.0: {}

    object-inspect@1.13.4: {}

    object-keys@1.1.1: {}

    object.assign@4.1.7:
        dependencies:
            call-bind: 1.0.8
            call-bound: 1.0.4
            define-properties: 1.2.1
            es-object-atoms: 1.1.1
            has-symbols: 1.1.0
            object-keys: 1.1.1

    object.entries@1.1.9:
        dependencies:
            call-bind: 1.0.8
            call-bound: 1.0.4
            define-properties: 1.2.1
            es-object-atoms: 1.1.1

    object.fromentries@2.0.8:
        dependencies:
            call-bind: 1.0.8
            define-properties: 1.2.1
            es-abstract: 1.24.0
            es-object-atoms: 1.1.1

    object.values@1.2.1:
        dependencies:
            call-bind: 1.0.8
            call-bound: 1.0.4
            define-properties: 1.2.1
            es-object-atoms: 1.1.1

    once@1.4.0:
        dependencies:
            wrappy: 1.0.2

    optionator@0.9.4:
        dependencies:
            deep-is: 0.1.4
            fast-levenshtein: 2.0.6
            levn: 0.4.1
            prelude-ls: 1.2.1
            type-check: 0.4.0
            word-wrap: 1.2.5

    own-keys@1.0.1:
        dependencies:
            get-intrinsic: 1.3.0
            object-keys: 1.1.1
            safe-push-apply: 1.0.0

    p-limit@3.1.0:
        dependencies:
            yocto-queue: 0.1.0

    p-locate@5.0.0:
        dependencies:
            p-limit: 3.1.0

    package-json-from-dist@1.0.1: {}

    parchment@3.0.0: {}

    parent-module@1.0.1:
        dependencies:
            callsites: 3.1.0

    path-exists@4.0.0: {}

    path-is-absolute@1.0.1: {}

    path-key@3.1.1: {}

    path-parse@1.0.7: {}

    path-scurry@1.11.1:
        dependencies:
            lru-cache: 10.4.3
            minipass: 7.1.2

    picocolors@1.1.1: {}

    picomatch@2.3.1: {}

    pify@2.3.0: {}

    pirates@4.0.7: {}

    possible-typed-array-names@1.1.0: {}

    postcss-import@15.1.0(postcss@8.5.6):
        dependencies:
            postcss: 8.5.6
            postcss-value-parser: 4.2.0
            read-cache: 1.0.0
            resolve: 1.22.11

    postcss-js@4.1.0(postcss@8.5.6):
        dependencies:
            camelcase-css: 2.0.1
            postcss: 8.5.6

    postcss-load-config@6.0.1(jiti@1.21.7)(postcss@8.5.6):
        dependencies:
            lilconfig: 3.1.3
        optionalDependencies:
            jiti: 1.21.7
            postcss: 8.5.6

    postcss-nested@6.2.0(postcss@8.5.6):
        dependencies:
            postcss: 8.5.6
            postcss-selector-parser: 6.1.2

    postcss-selector-parser@6.0.10:
        dependencies:
            cssesc: 3.0.0
            util-deprecate: 1.0.2

    postcss-selector-parser@6.1.2:
        dependencies:
            cssesc: 3.0.0
            util-deprecate: 1.0.2

    postcss-value-parser@4.2.0: {}

    postcss@8.5.6:
        dependencies:
            nanoid: 3.3.11
            picocolors: 1.1.1
            source-map-js: 1.2.1

    potpack@1.0.2: {}

    prelude-ls@1.2.1: {}

    promise-worker-transferable@1.0.4:
        dependencies:
            is-promise: 2.2.2
            lie: 3.3.0

    prop-types@15.8.1:
        dependencies:
            loose-envify: 1.4.0
            object-assign: 4.1.1
            react-is: 16.13.1

    punycode@2.3.1: {}

    pvtsutils@1.3.6:
        dependencies:
            tslib: 2.8.1

    pvutils@1.1.5: {}

    queue-microtask@1.2.3: {}

    quill-delta@5.1.0:
        dependencies:
            fast-diff: 1.3.0
            lodash.clonedeep: 4.5.0
            lodash.isequal: 4.5.0

    quill@2.0.3:
        dependencies:
            eventemitter3: 5.0.1
            lodash-es: 4.17.21
            parchment: 3.0.0
            quill-delta: 5.1.0

    react-day-picker@9.11.1(react@19.1.1):
        dependencies:
            '@date-fns/tz': 1.4.1
            date-fns: 4.1.0
            date-fns-jalali: 4.1.0-0
            react: 19.1.1

    react-dom@19.1.1(react@19.1.1):
        dependencies:
            react: 19.1.1
            scheduler: 0.26.0

    react-hook-form@7.65.0(react@19.1.1):
        dependencies:
            react: 19.1.1

    react-icons@5.5.0(react@19.1.1):
        dependencies:
            react: 19.1.1

    react-is@16.13.1: {}

    react-is@18.3.1: {}

    react-quill-new@3.4.6(quill-delta@5.1.0)(react-dom@19.1.1(react@19.1.1))(react@19.1.1):
        dependencies:
            lodash-es: 4.17.21
            quill: 2.0.3
            quill-delta: 5.1.0
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)

    react-reconciler@0.31.0(react@19.1.1):
        dependencies:
            react: 19.1.1
            scheduler: 0.25.0

    react-refresh@0.17.0: {}

    react-remove-scroll-bar@2.3.8(@types/react@19.1.17)(react@19.1.1):
        dependencies:
            react: 19.1.1
            react-style-singleton: 2.2.3(@types/react@19.1.17)(react@19.1.1)
            tslib: 2.8.1
        optionalDependencies:
            '@types/react': 19.1.17

    react-remove-scroll@2.7.1(@types/react@19.1.17)(react@19.1.1):
        dependencies:
            react: 19.1.1
            react-remove-scroll-bar: 2.3.8(@types/react@19.1.17)(react@19.1.1)
            react-style-singleton: 2.2.3(@types/react@19.1.17)(react@19.1.1)
            tslib: 2.8.1
            use-callback-ref: 1.3.3(@types/react@19.1.17)(react@19.1.1)
            use-sidecar: 1.1.3(@types/react@19.1.17)(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17

    react-resizable-panels@2.1.9(react-dom@19.1.1(react@19.1.1))(react@19.1.1):
        dependencies:
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)

    react-smooth@4.0.4(react-dom@19.1.1(react@19.1.1))(react@19.1.1):
        dependencies:
            fast-equals: 5.3.2
            prop-types: 15.8.1
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
            react-transition-group: 4.4.5(react-dom@19.1.1(react@19.1.1))(react@19.1.1)

    react-style-singleton@2.2.3(@types/react@19.1.17)(react@19.1.1):
        dependencies:
            get-nonce: 1.0.1
            react: 19.1.1
            tslib: 2.8.1
        optionalDependencies:
            '@types/react': 19.1.17

    react-transition-group@4.4.5(react-dom@19.1.1(react@19.1.1))(react@19.1.1):
        dependencies:
            '@babel/runtime': 7.28.4
            dom-helpers: 5.2.1
            loose-envify: 1.4.0
            prop-types: 15.8.1
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)

    react-universal-interface@0.6.2(react@19.1.1)(tslib@2.8.1):
        dependencies:
            react: 19.1.1
            tslib: 2.8.1

    react-use-measure@2.1.7(react-dom@19.1.1(react@19.1.1))(react@19.1.1):
        dependencies:
            react: 19.1.1
        optionalDependencies:
            react-dom: 19.1.1(react@19.1.1)

    react-use@17.6.0(react-dom@19.1.1(react@19.1.1))(react@19.1.1):
        dependencies:
            '@types/js-cookie': 2.2.7
            '@xobotyi/scrollbar-width': 1.9.5
            copy-to-clipboard: 3.3.3
            fast-deep-equal: 3.1.3
            fast-shallow-equal: 1.0.0
            js-cookie: 2.2.1
            nano-css: 5.6.2(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
            react-universal-interface: 0.6.2(react@19.1.1)(tslib@2.8.1)
            resize-observer-polyfill: 1.5.1
            screenfull: 5.2.0
            set-harmonic-interval: 1.0.1
            throttle-debounce: 3.0.1
            ts-easing: 0.2.0
            tslib: 2.8.1

    react@19.1.1: {}

    read-cache@1.0.0:
        dependencies:
            pify: 2.3.0

    readdirp@3.6.0:
        dependencies:
            picomatch: 2.3.1

    recharts-scale@0.4.5:
        dependencies:
            decimal.js-light: 2.5.1

    recharts@2.15.4(react-dom@19.1.1(react@19.1.1))(react@19.1.1):
        dependencies:
            clsx: 2.1.1
            eventemitter3: 4.0.7
            lodash: 4.17.21
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
            react-is: 18.3.1
            react-smooth: 4.0.4(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            recharts-scale: 0.4.5
            tiny-invariant: 1.3.3
            victory-vendor: 36.9.2

    reflect.getprototypeof@1.0.10:
        dependencies:
            call-bind: 1.0.8
            define-properties: 1.2.1
            es-abstract: 1.24.0
            es-errors: 1.3.0
            es-object-atoms: 1.1.1
            get-intrinsic: 1.3.0
            get-proto: 1.0.1
            which-builtin-type: 1.2.1

    regexp.prototype.flags@1.5.4:
        dependencies:
            call-bind: 1.0.8
            define-properties: 1.2.1
            es-errors: 1.3.0
            get-proto: 1.0.1
            gopd: 1.2.0
            set-function-name: 2.0.2

    require-from-string@2.0.2: {}

    resize-observer-polyfill@1.5.1: {}

    resolve-from@4.0.0: {}

    resolve@1.22.11:
        dependencies:
            is-core-module: 2.16.1
            path-parse: 1.0.7
            supports-preserve-symlinks-flag: 1.0.0

    resolve@2.0.0-next.5:
        dependencies:
            is-core-module: 2.16.1
            path-parse: 1.0.7
            supports-preserve-symlinks-flag: 1.0.0

    reusify@1.1.0: {}

    rimraf@3.0.2:
        dependencies:
            glob: 7.2.3

    rollup@4.52.5:
        dependencies:
            '@types/estree': 1.0.8
        optionalDependencies:
            '@rollup/rollup-android-arm-eabi': 4.52.5
            '@rollup/rollup-android-arm64': 4.52.5
            '@rollup/rollup-darwin-arm64': 4.52.5
            '@rollup/rollup-darwin-x64': 4.52.5
            '@rollup/rollup-freebsd-arm64': 4.52.5
            '@rollup/rollup-freebsd-x64': 4.52.5
            '@rollup/rollup-linux-arm-gnueabihf': 4.52.5
            '@rollup/rollup-linux-arm-musleabihf': 4.52.5
            '@rollup/rollup-linux-arm64-gnu': 4.52.5
            '@rollup/rollup-linux-arm64-musl': 4.52.5
            '@rollup/rollup-linux-loong64-gnu': 4.52.5
            '@rollup/rollup-linux-ppc64-gnu': 4.52.5
            '@rollup/rollup-linux-riscv64-gnu': 4.52.5
            '@rollup/rollup-linux-riscv64-musl': 4.52.5
            '@rollup/rollup-linux-s390x-gnu': 4.52.5
            '@rollup/rollup-linux-x64-gnu': 4.52.5
            '@rollup/rollup-linux-x64-musl': 4.52.5
            '@rollup/rollup-openharmony-arm64': 4.52.5
            '@rollup/rollup-win32-arm64-msvc': 4.52.5
            '@rollup/rollup-win32-ia32-msvc': 4.52.5
            '@rollup/rollup-win32-x64-gnu': 4.52.5
            '@rollup/rollup-win32-x64-msvc': 4.52.5
            fsevents: 2.3.3

    rtl-css-js@1.16.1:
        dependencies:
            '@babel/runtime': 7.28.4

    run-parallel@1.2.0:
        dependencies:
            queue-microtask: 1.2.3

    safe-array-concat@1.1.3:
        dependencies:
            call-bind: 1.0.8
            call-bound: 1.0.4
            get-intrinsic: 1.3.0
            has-symbols: 1.1.0
            isarray: 2.0.5

    safe-push-apply@1.0.0:
        dependencies:
            es-errors: 1.3.0
            isarray: 2.0.5

    safe-regex-test@1.1.0:
        dependencies:
            call-bound: 1.0.4
            es-errors: 1.3.0
            is-regex: 1.2.1

    scheduler@0.25.0: {}

    scheduler@0.26.0: {}

    screenfull@5.2.0: {}

    semver@6.3.1: {}

    semver@7.7.3: {}

    seroval-plugins@1.3.3(seroval@1.3.2):
        dependencies:
            seroval: 1.3.2

    seroval@1.3.2: {}

    set-function-length@1.2.2:
        dependencies:
            define-data-property: 1.1.4
            es-errors: 1.3.0
            function-bind: 1.1.2
            get-intrinsic: 1.3.0
            gopd: 1.2.0
            has-property-descriptors: 1.0.2

    set-function-name@2.0.2:
        dependencies:
            define-data-property: 1.1.4
            es-errors: 1.3.0
            functions-have-names: 1.2.3
            has-property-descriptors: 1.0.2

    set-harmonic-interval@1.0.1: {}

    set-proto@1.0.0:
        dependencies:
            dunder-proto: 1.0.1
            es-errors: 1.3.0
            es-object-atoms: 1.1.1

    sharp@0.34.4:
        dependencies:
            '@img/colour': 1.0.0
            detect-libc: 2.1.2
            semver: 7.7.3
        optionalDependencies:
            '@img/sharp-darwin-arm64': 0.34.4
            '@img/sharp-darwin-x64': 0.34.4
            '@img/sharp-libvips-darwin-arm64': 1.2.3
            '@img/sharp-libvips-darwin-x64': 1.2.3
            '@img/sharp-libvips-linux-arm': 1.2.3
            '@img/sharp-libvips-linux-arm64': 1.2.3
            '@img/sharp-libvips-linux-ppc64': 1.2.3
            '@img/sharp-libvips-linux-s390x': 1.2.3
            '@img/sharp-libvips-linux-x64': 1.2.3
            '@img/sharp-libvips-linuxmusl-arm64': 1.2.3
            '@img/sharp-libvips-linuxmusl-x64': 1.2.3
            '@img/sharp-linux-arm': 0.34.4
            '@img/sharp-linux-arm64': 0.34.4
            '@img/sharp-linux-ppc64': 0.34.4
            '@img/sharp-linux-s390x': 0.34.4
            '@img/sharp-linux-x64': 0.34.4
            '@img/sharp-linuxmusl-arm64': 0.34.4
            '@img/sharp-linuxmusl-x64': 0.34.4
            '@img/sharp-wasm32': 0.34.4
            '@img/sharp-win32-arm64': 0.34.4
            '@img/sharp-win32-ia32': 0.34.4
            '@img/sharp-win32-x64': 0.34.4

    shebang-command@2.0.0:
        dependencies:
            shebang-regex: 3.0.0

    shebang-regex@3.0.0: {}

    side-channel-list@1.0.0:
        dependencies:
            es-errors: 1.3.0
            object-inspect: 1.13.4

    side-channel-map@1.0.1:
        dependencies:
            call-bound: 1.0.4
            es-errors: 1.3.0
            get-intrinsic: 1.3.0
            object-inspect: 1.13.4

    side-channel-weakmap@1.0.2:
        dependencies:
            call-bound: 1.0.4
            es-errors: 1.3.0
            get-intrinsic: 1.3.0
            object-inspect: 1.13.4
            side-channel-map: 1.0.1

    side-channel@1.1.0:
        dependencies:
            es-errors: 1.3.0
            object-inspect: 1.13.4
            side-channel-list: 1.0.0
            side-channel-map: 1.0.1
            side-channel-weakmap: 1.0.2

    signal-exit@4.1.0: {}

    sonner@1.7.4(react-dom@19.1.1(react@19.1.1))(react@19.1.1):
        dependencies:
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)

    source-map-js@1.2.1: {}

    source-map@0.5.6: {}

    source-map@0.6.1: {}

    stack-generator@2.0.10:
        dependencies:
            stackframe: 1.3.4

    stackframe@1.3.4: {}

    stacktrace-gps@3.1.2:
        dependencies:
            source-map: 0.5.6
            stackframe: 1.3.4

    stacktrace-js@2.0.2:
        dependencies:
            error-stack-parser: 2.1.4
            stack-generator: 2.0.10
            stacktrace-gps: 3.1.2

    stats-gl@2.4.2(@types/three@0.176.0)(three@0.176.0):
        dependencies:
            '@types/three': 0.176.0
            three: 0.176.0

    stats.js@0.17.0: {}

    stop-iteration-iterator@1.1.0:
        dependencies:
            es-errors: 1.3.0
            internal-slot: 1.1.0

    string-width@4.2.3:
        dependencies:
            emoji-regex: 8.0.0
            is-fullwidth-code-point: 3.0.0
            strip-ansi: 6.0.1

    string-width@5.1.2:
        dependencies:
            eastasianwidth: 0.2.0
            emoji-regex: 9.2.2
            strip-ansi: 7.1.2

    string.prototype.matchall@4.0.12:
        dependencies:
            call-bind: 1.0.8
            call-bound: 1.0.4
            define-properties: 1.2.1
            es-abstract: 1.24.0
            es-errors: 1.3.0
            es-object-atoms: 1.1.1
            get-intrinsic: 1.3.0
            gopd: 1.2.0
            has-symbols: 1.1.0
            internal-slot: 1.1.0
            regexp.prototype.flags: 1.5.4
            set-function-name: 2.0.2
            side-channel: 1.1.0

    string.prototype.repeat@1.0.0:
        dependencies:
            define-properties: 1.2.1
            es-abstract: 1.24.0

    string.prototype.trim@1.2.10:
        dependencies:
            call-bind: 1.0.8
            call-bound: 1.0.4
            define-data-property: 1.1.4
            define-properties: 1.2.1
            es-abstract: 1.24.0
            es-object-atoms: 1.1.1
            has-property-descriptors: 1.0.2

    string.prototype.trimend@1.0.9:
        dependencies:
            call-bind: 1.0.8
            call-bound: 1.0.4
            define-properties: 1.2.1
            es-object-atoms: 1.1.1

    string.prototype.trimstart@1.0.8:
        dependencies:
            call-bind: 1.0.8
            define-properties: 1.2.1
            es-object-atoms: 1.1.1

    strip-ansi@6.0.1:
        dependencies:
            ansi-regex: 5.0.1

    strip-ansi@7.1.2:
        dependencies:
            ansi-regex: 6.2.2

    strip-json-comments@3.1.1: {}

    stylis@4.3.6: {}

    sucrase@3.35.0:
        dependencies:
            '@jridgewell/gen-mapping': 0.3.13
            commander: 4.1.1
            glob: 10.4.5
            lines-and-columns: 1.2.4
            mz: 2.7.0
            pirates: 4.0.7
            ts-interface-checker: 0.1.13

    supports-color@7.2.0:
        dependencies:
            has-flag: 4.0.0

    supports-preserve-symlinks-flag@1.0.0: {}

    suspend-react@0.1.3(react@19.1.1):
        dependencies:
            react: 19.1.1

    tailwind-merge@2.6.0: {}

    tailwindcss-animate@1.0.7(tailwindcss@3.4.18):
        dependencies:
            tailwindcss: 3.4.18

    tailwindcss@3.4.18:
        dependencies:
            '@alloc/quick-lru': 5.2.0
            arg: 5.0.2
            chokidar: 3.6.0
            didyoumean: 1.2.2
            dlv: 1.1.3
            fast-glob: 3.3.3
            glob-parent: 6.0.2
            is-glob: 4.0.3
            jiti: 1.21.7
            lilconfig: 3.1.3
            micromatch: 4.0.8
            normalize-path: 3.0.0
            object-hash: 3.0.0
            picocolors: 1.1.1
            postcss: 8.5.6
            postcss-import: 15.1.0(postcss@8.5.6)
            postcss-js: 4.1.0(postcss@8.5.6)
            postcss-load-config: 6.0.1(jiti@1.21.7)(postcss@8.5.6)
            postcss-nested: 6.2.0(postcss@8.5.6)
            postcss-selector-parser: 6.1.2
            resolve: 1.22.11
            sucrase: 3.35.0
        transitivePeerDependencies:
            - tsx
            - yaml

    text-table@0.2.0: {}

    thenify-all@1.6.0:
        dependencies:
            thenify: 3.3.1

    thenify@3.3.1:
        dependencies:
            any-promise: 1.3.0

    three-mesh-bvh@0.8.3(three@0.176.0):
        dependencies:
            three: 0.176.0

    three-stdlib@2.36.0(three@0.176.0):
        dependencies:
            '@types/draco3d': 1.4.10
            '@types/offscreencanvas': 2019.7.3
            '@types/webxr': 0.5.24
            draco3d: 1.5.7
            fflate: 0.6.10
            potpack: 1.0.2
            three: 0.176.0

    three@0.176.0: {}

    throttle-debounce@3.0.1: {}

    tiny-invariant@1.3.3: {}

    tiny-warning@1.0.3: {}

    to-regex-range@5.0.1:
        dependencies:
            is-number: 7.0.0

    toggle-selection@1.0.6: {}

    troika-three-text@0.52.4(three@0.176.0):
        dependencies:
            bidi-js: 1.0.3
            three: 0.176.0
            troika-three-utils: 0.52.4(three@0.176.0)
            troika-worker-utils: 0.52.0
            webgl-sdf-generator: 1.1.1

    troika-three-utils@0.52.4(three@0.176.0):
        dependencies:
            three: 0.176.0

    troika-worker-utils@0.52.0: {}

    ts-api-utils@2.1.0(typescript@5.9.3):
        dependencies:
            typescript: 5.9.3

    ts-easing@0.2.0: {}

    ts-interface-checker@0.1.13: {}

    tslib@2.8.1: {}

    tunnel-rat@0.1.2(@types/react@19.1.17)(react@19.1.1):
        dependencies:
            zustand: 4.5.7(@types/react@19.1.17)(react@19.1.1)
        transitivePeerDependencies:
            - '@types/react'
            - immer
            - react

    type-check@0.4.0:
        dependencies:
            prelude-ls: 1.2.1

    type-fest@0.20.2: {}

    typed-array-buffer@1.0.3:
        dependencies:
            call-bound: 1.0.4
            es-errors: 1.3.0
            is-typed-array: 1.1.15

    typed-array-byte-length@1.0.3:
        dependencies:
            call-bind: 1.0.8
            for-each: 0.3.5
            gopd: 1.2.0
            has-proto: 1.2.0
            is-typed-array: 1.1.15

    typed-array-byte-offset@1.0.4:
        dependencies:
            available-typed-arrays: 1.0.7
            call-bind: 1.0.8
            for-each: 0.3.5
            gopd: 1.2.0
            has-proto: 1.2.0
            is-typed-array: 1.1.15
            reflect.getprototypeof: 1.0.10

    typed-array-length@1.0.7:
        dependencies:
            call-bind: 1.0.8
            for-each: 0.3.5
            gopd: 1.2.0
            is-typed-array: 1.1.15
            possible-typed-array-names: 1.1.0
            reflect.getprototypeof: 1.0.10

    typescript@5.9.3: {}

    unbox-primitive@1.1.0:
        dependencies:
            call-bound: 1.0.4
            has-bigints: 1.1.0
            has-symbols: 1.1.0
            which-boxed-primitive: 1.1.1

    undici-types@6.21.0: {}

    update-browserslist-db@1.1.4(browserslist@4.27.0):
        dependencies:
            browserslist: 4.27.0
            escalade: 3.2.0
            picocolors: 1.1.1

    uri-js@4.4.1:
        dependencies:
            punycode: 2.3.1

    use-callback-ref@1.3.3(@types/react@19.1.17)(react@19.1.1):
        dependencies:
            react: 19.1.1
            tslib: 2.8.1
        optionalDependencies:
            '@types/react': 19.1.17

    use-sidecar@1.1.3(@types/react@19.1.17)(react@19.1.1):
        dependencies:
            detect-node-es: 1.1.0
            react: 19.1.1
            tslib: 2.8.1
        optionalDependencies:
            '@types/react': 19.1.17

    use-sync-external-store@1.6.0(react@19.1.1):
        dependencies:
            react: 19.1.1

    util-deprecate@1.0.2: {}

    utility-types@3.11.0: {}

    vaul@1.1.2(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1):
        dependencies:
            '@radix-ui/react-dialog': 1.1.15(@types/react-dom@19.1.11(@types/react@19.1.17))(@types/react@19.1.17)(react-dom@19.1.1(react@19.1.1))(react@19.1.1)
            react: 19.1.1
            react-dom: 19.1.1(react@19.1.1)
        transitivePeerDependencies:
            - '@types/react'
            - '@types/react-dom'

    victory-vendor@36.9.2:
        dependencies:
            '@types/d3-array': 3.2.2
            '@types/d3-ease': 3.0.2
            '@types/d3-interpolate': 3.0.4
            '@types/d3-scale': 4.0.9
            '@types/d3-shape': 3.1.7
            '@types/d3-time': 3.0.4
            '@types/d3-timer': 3.0.2
            d3-array: 3.2.4
            d3-ease: 3.0.1
            d3-interpolate: 3.0.1
            d3-scale: 4.0.2
            d3-shape: 3.2.0
            d3-time: 3.1.0
            d3-timer: 3.0.1

    vite-plugin-environment@1.1.3(vite@5.4.21(@types/node@20.19.24)):
        dependencies:
            vite: 5.4.21(@types/node@20.19.24)

    vite@5.4.21(@types/node@20.19.24):
        dependencies:
            esbuild: 0.21.5
            postcss: 8.5.6
            rollup: 4.52.5
        optionalDependencies:
            '@types/node': 20.19.24
            fsevents: 2.3.3

    webgl-constants@1.1.1: {}

    webgl-sdf-generator@1.1.1: {}

    which-boxed-primitive@1.1.1:
        dependencies:
            is-bigint: 1.1.0
            is-boolean-object: 1.2.2
            is-number-object: 1.1.1
            is-string: 1.1.1
            is-symbol: 1.1.1

    which-builtin-type@1.2.1:
        dependencies:
            call-bound: 1.0.4
            function.prototype.name: 1.1.8
            has-tostringtag: 1.0.2
            is-async-function: 2.1.1
            is-date-object: 1.1.0
            is-finalizationregistry: 1.1.1
            is-generator-function: 1.1.2
            is-regex: 1.2.1
            is-weakref: 1.1.1
            isarray: 2.0.5
            which-boxed-primitive: 1.1.1
            which-collection: 1.0.2
            which-typed-array: 1.1.19

    which-collection@1.0.2:
        dependencies:
            is-map: 2.0.3
            is-set: 2.0.3
            is-weakmap: 2.0.2
            is-weakset: 2.0.4

    which-typed-array@1.1.19:
        dependencies:
            available-typed-arrays: 1.0.7
            call-bind: 1.0.8
            call-bound: 1.0.4
            for-each: 0.3.5
            get-proto: 1.0.1
            gopd: 1.2.0
            has-tostringtag: 1.0.2

    which@2.0.2:
        dependencies:
            isexe: 2.0.0

    word-wrap@1.2.5: {}

    wrap-ansi@7.0.0:
        dependencies:
            ansi-styles: 4.3.0
            string-width: 4.2.3
            strip-ansi: 6.0.1

    wrap-ansi@8.1.0:
        dependencies:
            ansi-styles: 6.2.3
            string-width: 5.1.2
            strip-ansi: 7.1.2

    wrappy@1.0.2: {}

    yallist@3.1.1: {}

    yocto-queue@0.1.0: {}

    zustand@4.5.7(@types/react@19.1.17)(react@19.1.1):
        dependencies:
            use-sync-external-store: 1.6.0(react@19.1.1)
        optionalDependencies:
            '@types/react': 19.1.17
            react: 19.1.1

    zustand@5.0.8(@types/react@19.1.17)(react@19.1.1)(use-sync-external-store@1.6.0(react@19.1.1)):
        optionalDependencies:
            '@types/react': 19.1.17
            react: 19.1.1
            use-sync-external-store: 1.6.0(react@19.1.1)
PK
build-template/pnpm-workspace.yamlpackages:
    - src/**/*
onlyBuiltDependencies:
    - esbuild
PK
build-template/tsconfig.json{
  "compilerOptions": {
    "strict": true,
    "target": "ES2020",
    "experimentalDecorators": true,
    "strictPropertyInitialization": false,
    "moduleResolution": "node",
    "allowJs": true,
    "outDir": "HACK_BECAUSE_OF_ALLOW_JS"
  }
}
PK
build-template/scripts/PK
build-template/scripts/prune-unused-images.jsimport { promises as fs } from 'fs';
import path from 'path';

const DIST_ASSETS_DIR = 'src/frontend/dist/assets';
const GENERATED_DIR = path.join(DIST_ASSETS_DIR, 'generated');

const IMAGE_EXTENSIONS = new Set(['.jpg', '.jpeg', '.png', '.webp', '.gif', '.svg', '.ico', '.avif']);

async function fileExists(filePath) {
    try {
        await fs.access(filePath);
        return true;
    } catch {
        return false;
    }
}

async function getAssetFiles(dir) {
    const files = [];

    try {
        const entries = await fs.readdir(dir, { withFileTypes: true });

        for (const entry of entries) {
            const fullPath = path.join(dir, entry.name);

            if (entry.isDirectory()) {
                // Skip the generated folder itself
                if (entry.name !== 'generated') {
                    files.push(...(await getAssetFiles(fullPath)));
                }
            } else if (entry.name.endsWith('.js') || entry.name.endsWith('.mjs') || entry.name.endsWith('.css')) {
                files.push(fullPath);
            }
        }
    } catch (error) {
        console.error(`Error reading directory ${dir}:`, error.message);
    }

    return files;
}

async function getGeneratedImages(dir) {
    const images = [];

    try {
        const entries = await fs.readdir(dir, { withFileTypes: true });

        for (const entry of entries) {
            if (entry.isFile()) {
                const ext = path.extname(entry.name).toLowerCase();
                if (IMAGE_EXTENSIONS.has(ext)) {
                    images.push(entry.name);
                }
            }
        }
    } catch (error) {
        if (error.code !== 'ENOENT') {
            console.error(`Error reading generated directory:`, error.message);
        }
    }

    return images;
}

/**
 * Algorithm for finding referenced images:
 * 1. Read all asset file contents into a single concatenated string
 * 2. For each generated image filename, check if it exists in the combined content
 *
 * This approach is O(n * avg_filename_length) for the search phase,
 * where n = number of images. V8's String.includes() uses optimized
 * substring search algorithms that are very fast in practice.
 *
 * For 500 images with ~30 char filenames against ~2MB of JS/CSS content,
 * this completes in milliseconds.
 */
async function findReferencedImages(assetFiles, generatedImages) {
    const contents = await Promise.all(assetFiles.map((file) => fs.readFile(file, 'utf-8').catch(() => '')));
    const combinedContent = contents.join('\n');

    const referencedImages = new Set();

    for (const filename of generatedImages) {
        // This catches references in any context: strings, paths, url(), etc.
        if (combinedContent.includes(filename)) {
            referencedImages.add(filename);
        }
    }

    return referencedImages;
}

async function pruneUnusedImages() {
    if (!(await fileExists(DIST_ASSETS_DIR))) {
        console.log(`Directory ${DIST_ASSETS_DIR} does not exist, skipping prune`);
        return;
    }

    if (!(await fileExists(GENERATED_DIR))) {
        console.log(`Directory ${GENERATED_DIR} does not exist, nothing to prune`);
        return;
    }

    const generatedImages = await getGeneratedImages(GENERATED_DIR);

    if (generatedImages.length === 0) {
        console.log('No images in generated folder, nothing to prune');
        return;
    }

    console.log(`Found ${generatedImages.length} image(s) in generated folder`);

    const assetFiles = await getAssetFiles(DIST_ASSETS_DIR);

    if (assetFiles.length === 0) {
        console.log('No JS/CSS files found in dist/assets, skipping prune');
        return;
    }

    const jsCount = assetFiles.filter((f) => f.endsWith('.js') || f.endsWith('.mjs')).length;
    const cssCount = assetFiles.filter((f) => f.endsWith('.css')).length;
    console.log(`Scanning ${jsCount} JS file(s) and ${cssCount} CSS file(s) for image references...`);

    const referencedImages = await findReferencedImages(assetFiles, generatedImages);
    console.log(`Found ${referencedImages.size} image reference(s) in compiled assets`);

    const unusedImages = generatedImages.filter((img) => !referencedImages.has(img));

    if (unusedImages.length === 0) {
        console.log('\nNo unused images to prune');
        return;
    }

    // Remove unused images in parallel (batch of 10 for reasonable I/O)
    let removedCount = 0;
    let savedBytes = 0;

    const BATCH_SIZE = 10;
    for (let i = 0; i < unusedImages.length; i += BATCH_SIZE) {
        const batch = unusedImages.slice(i, i + BATCH_SIZE);

        const results = await Promise.all(
            batch.map(async (image) => {
                const imagePath = path.join(GENERATED_DIR, image);
                try {
                    const stats = await fs.stat(imagePath);
                    await fs.unlink(imagePath);
                    return { success: true, image, size: stats.size };
                } catch (error) {
                    return { success: false, image, error: error.message };
                }
            })
        );

        for (const result of results) {
            if (result.success) {
                removedCount++;
                savedBytes += result.size;
                console.log(`  Removed: ${result.image} (${formatBytes(result.size)})`);
            } else {
                console.error(`  Failed to remove ${result.image}: ${result.error}`);
            }
        }
    }

    console.log(`\nPruned ${removedCount} unused image(s), saved ${formatBytes(savedBytes)}`);
}

function formatBytes(bytes) {
    if (bytes === 0) return '0 B';
    const k = 1024;
    const sizes = ['B', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return `${(bytes / Math.pow(k, i)).toFixed(1)} ${sizes[i]}`;
}

pruneUnusedImages().catch((error) => {
    console.error('Image prune process failed:', error);
    process.exit(1);
});
PK
build-template/scripts/resize-images.jsimport sharp from 'sharp';
import { promises as fs } from 'fs';
import path from 'path';

const DIMENSION_PATTERN = /^(.+?)\.dim_(\d+)x(\d+)(\.[^.]+)$/;
const ASSETS_DIR = 'src/frontend/dist/assets/generated';

async function fileExists(filePath) {
    try {
        await fs.access(filePath);
        return true;
    } catch {
        return false;
    }
}

function getOutputOptions(ext) {
    const extension = ext.toLowerCase();

    switch (extension) {
        case '.png':
            return {
                format: 'png',
                options: {
                    compressionLevel: 6, // (0-9) 6 for balance of speed and size
                    palette: true, // Quantize to 256 colors
                    quality: 80, // Quality for palette quantization
                    effort: 8, // (0-10)
                    adaptiveFiltering: true
                }
            };
        case '.jpg':
        case '.jpeg':
            return {
                format: 'jpeg',
                options: {
                    quality: 80, // 80 is a good balance
                    mozjpeg: true, // Use MozJPEG encoder (much better compression)
                    trellisQuantisation: true,
                    overshootDeringing: true,
                    optimizeScans: true
                }
            };
        case '.webp':
            return {
                format: 'webp',
                options: {
                    quality: 80,
                    effort: 6, // Max effort (0-6)
                    smartSubsample: true
                }
            };
        default:
            return null;
    }
}

async function resizeImages() {
    if (!(await fileExists(ASSETS_DIR))) {
        console.log(`Directory ${ASSETS_DIR} does not exist, skipping resize`);
        return;
    }

    let files;
    try {
        files = await fs.readdir(ASSETS_DIR);
    } catch (error) {
        console.log(`Could not read ${ASSETS_DIR}: ${error.message}`);
        return;
    }

    let resizedCount = 0;

    for (const file of files) {
        const match = file.match(DIMENSION_PATTERN);
        if (match) {
            const [, , width, height, ext] = match;
            const filePath = path.join(ASSETS_DIR, file);
            const outputConfig = getOutputOptions(ext);

            if (!outputConfig) {
                console.log(`Skipping unsupported format: ${file}`);
                continue;
            }

            try {
                let pipeline = sharp(filePath)
                    .resize(parseInt(width, 10), parseInt(height, 10), {
                        fit: 'cover',
                        withoutEnlargement: false,
                        position: 'center'
                    })
                    .keepIccProfile();

                // Apply format-specific optimization
                pipeline = pipeline[outputConfig.format](outputConfig.options);

                const resized = await pipeline.toBuffer();
                await fs.writeFile(filePath, resized);
                resizedCount++;
            } catch (error) {
                console.error(`Failed to resize ${file}:`, error.message);
            }
        }
    }
}

resizeImages().catch((error) => {
    console.error('Image resize process failed:', error);
    process.exit(1);
});
PK
build-template/src/PK
build-template/src/backend/PK
build-template/src/backend/system-idl/PK
build-template/src/backend/system-idl/aaaaa-aa.didtype canister_id = principal;
type wasm_module = blob;
type snapshot_id = blob;

type log_visibility = variant {
    controllers;
    public;
    allowed_viewers : vec principal;
};

type canister_settings = record {
    controllers : opt vec principal;
    compute_allocation : opt nat;
    memory_allocation : opt nat;
    freezing_threshold : opt nat;
    reserved_cycles_limit : opt nat;
    log_visibility : opt log_visibility;
    wasm_memory_limit : opt nat;
    wasm_memory_threshold : opt nat;
};

type definite_canister_settings = record {
    controllers : vec principal;
    compute_allocation : nat;
    memory_allocation : nat;
    freezing_threshold : nat;
    reserved_cycles_limit : nat;
    log_visibility : log_visibility;
    wasm_memory_limit : nat;
    wasm_memory_threshold : nat;
};

type change_origin = variant {
    from_user : record {
        user_id : principal;
    };
    from_canister : record {
        canister_id : principal;
        canister_version : opt nat64;
    };
};

type change_details = variant {
    creation : record {
        controllers : vec principal;
    };
    code_uninstall;
    code_deployment : record {
        mode : variant { install; reinstall; upgrade };
        module_hash : blob;
    };
    load_snapshot : record {
        canister_version : nat64;
        snapshot_id : snapshot_id;
        taken_at_timestamp : nat64;
    };
    controllers_change : record {
        controllers : vec principal;
    };
};

type change = record {
    timestamp_nanos : nat64;
    canister_version : nat64;
    origin : change_origin;
    details : change_details;
};

type chunk_hash = record {
    hash : blob;
};

type http_header = record {
    name : text;
    value : text;
};

type http_request_result = record {
    status : nat;
    headers : vec http_header;
    body : blob;
};

type ecdsa_curve = variant {
    secp256k1;
};

type schnorr_algorithm = variant {
    bip340secp256k1;
    ed25519;
};

type satoshi = nat64;

type bitcoin_network = variant {
    mainnet;
    testnet;
};

type bitcoin_address = text;

type bitcoin_block_hash = blob;

type bitcoin_block_header = blob;

type millisatoshi_per_byte = nat64;

type bitcoin_block_height = nat32;

type outpoint = record {
    txid : blob;
    vout : nat32;
};

type utxo = record {
    outpoint : outpoint;
    value : satoshi;
    height : nat32;
};

type bitcoin_get_utxos_args = record {
    address : bitcoin_address;
    network : bitcoin_network;
    filter : opt variant {
        min_confirmations : nat32;
        page : blob;
    };
};

type bitcoin_get_utxos_result = record {
    utxos : vec utxo;
    tip_block_hash : bitcoin_block_hash;
    tip_height : bitcoin_block_height;
    next_page : opt blob;
};

type bitcoin_get_balance_args = record {
    address : bitcoin_address;
    network : bitcoin_network;
    min_confirmations : opt nat32;
};

type bitcoin_get_balance_result = satoshi;

type bitcoin_get_current_fee_percentiles_args = record {
    network : bitcoin_network;
};

type bitcoin_get_current_fee_percentiles_result = vec millisatoshi_per_byte;

type bitcoin_send_transaction_args = record {
    transaction : blob;
    network : bitcoin_network;
};

type bitcoin_get_block_headers_args = record {
    start_height : bitcoin_block_height;
    end_height : opt bitcoin_block_height;
    network : bitcoin_network;
};

type bitcoin_get_block_headers_result = record {
    tip_height : bitcoin_block_height;
    block_headers : vec bitcoin_block_header;
};

type node_metrics = record {
    node_id : principal;
    num_blocks_proposed_total : nat64;
    num_block_failures_total : nat64;
};

type create_canister_args = record {
    settings : opt canister_settings;
    sender_canister_version : opt nat64;
};

type create_canister_result = record {
    canister_id : canister_id;
};

type update_settings_args = record {
    canister_id : principal;
    settings : canister_settings;
    sender_canister_version : opt nat64;
};

type upload_chunk_args = record {
    canister_id : principal;
    chunk : blob;
};

type clear_chunk_store_args = record {
    canister_id : canister_id;
};

type stored_chunks_args = record {
    canister_id : canister_id;
};

type canister_install_mode = variant {
    install;
    reinstall;
    upgrade : opt record {
        skip_pre_upgrade : opt bool;
        wasm_memory_persistence : opt variant {
            keep;
            replace;
        };
    };
};

type install_code_args = record {
    mode : canister_install_mode;
    canister_id : canister_id;
    wasm_module : wasm_module;
    arg : blob;
    sender_canister_version : opt nat64;
};

type install_chunked_code_args = record {
    mode : canister_install_mode;
    target_canister : canister_id;
    store_canister : opt canister_id;
    chunk_hashes_list : vec chunk_hash;
    wasm_module_hash : blob;
    arg : blob;
    sender_canister_version : opt nat64;
};

type uninstall_code_args = record {
    canister_id : canister_id;
    sender_canister_version : opt nat64;
};

type start_canister_args = record {
    canister_id : canister_id;
};

type stop_canister_args = record {
    canister_id : canister_id;
};

type canister_status_args = record {
    canister_id : canister_id;
};

type canister_status_result = record {
    status : variant { running; stopping; stopped };
    settings : definite_canister_settings;
    module_hash : opt blob;
    memory_size : nat;
    memory_metrics : record {
        wasm_memory_size : nat;
        stable_memory_size : nat;
        global_memory_size : nat;
        wasm_binary_size : nat;
        custom_sections_size : nat;
        canister_history_size : nat;
        wasm_chunk_store_size : nat;
        snapshots_size : nat;
    };
    cycles : nat;
    reserved_cycles : nat;
    idle_cycles_burned_per_day : nat;
    query_stats : record {
        num_calls_total : nat;
        num_instructions_total : nat;
        request_payload_bytes_total : nat;
        response_payload_bytes_total : nat;
    };
};

type canister_info_args = record {
    canister_id : canister_id;
    num_requested_changes : opt nat64;
};

type canister_info_result = record {
    total_num_changes : nat64;
    recent_changes : vec change;
    module_hash : opt blob;
    controllers : vec principal;
};

type delete_canister_args = record {
    canister_id : canister_id;
};

type deposit_cycles_args = record {
    canister_id : canister_id;
};

type http_request_args = record {
    url : text;
    max_response_bytes : opt nat64;
    method : variant { get; head; post };
    headers : vec http_header;
    body : opt blob;
    transform : opt record {
        function : func(record { response : http_request_result; context : blob }) -> (http_request_result) query;
        context : blob;
    };
    is_replicated : opt bool;
};

type ecdsa_public_key_args = record {
    canister_id : opt canister_id;
    derivation_path : vec blob;
    key_id : record { curve : ecdsa_curve; name : text };
};

type ecdsa_public_key_result = record {
    public_key : blob;
    chain_code : blob;
};

type sign_with_ecdsa_args = record {
    message_hash : blob;
    derivation_path : vec blob;
    key_id : record { curve : ecdsa_curve; name : text };
};

type sign_with_ecdsa_result = record {
    signature : blob;
};

type schnorr_public_key_args = record {
    canister_id : opt canister_id;
    derivation_path : vec blob;
    key_id : record { algorithm : schnorr_algorithm; name : text };
};

type schnorr_public_key_result = record {
    public_key : blob;
    chain_code : blob;
};

type schnorr_aux = variant {
    bip341 : record {
        merkle_root_hash : blob;
    };
};

type sign_with_schnorr_args = record {
    message : blob;
    derivation_path : vec blob;
    key_id : record { algorithm : schnorr_algorithm; name : text };
    aux : opt schnorr_aux;
};

type sign_with_schnorr_result = record {
    signature : blob;
};

type node_metrics_history_args = record {
    subnet_id : principal;
    start_at_timestamp_nanos : nat64;
};

type node_metrics_history_result = vec record {
    timestamp_nanos : nat64;
    node_metrics : vec node_metrics;
};

type subnet_info_args = record {
    subnet_id : principal;
};

type subnet_info_result = record {
    replica_version : text;
};

type provisional_create_canister_with_cycles_args = record {
    amount : opt nat;
    settings : opt canister_settings;
    specified_id : opt canister_id;
    sender_canister_version : opt nat64;
};

type provisional_create_canister_with_cycles_result = record {
    canister_id : canister_id;
};

type provisional_top_up_canister_args = record {
    canister_id : canister_id;
    amount : nat;
};

type raw_rand_result = blob;

type stored_chunks_result = vec chunk_hash;

type upload_chunk_result = chunk_hash;

type snapshot = record {
    id : snapshot_id;
    taken_at_timestamp : nat64;
    total_size : nat64;
};

type take_canister_snapshot_args = record {
    canister_id : canister_id;
    replace_snapshot : opt snapshot_id;
};

type take_canister_snapshot_result = snapshot;

type load_canister_snapshot_args = record {
    canister_id : canister_id;
    snapshot_id : snapshot_id;
    sender_canister_version : opt nat64;
};

type list_canister_snapshots_args = record {
    canister_id : canister_id;
};

type list_canister_snapshots_result = vec snapshot;

type delete_canister_snapshot_args = record {
    canister_id : canister_id;
    snapshot_id : snapshot_id;
};

type fetch_canister_logs_args = record {
    canister_id : canister_id;
};

type canister_log_record = record {
    idx : nat64;
    timestamp_nanos : nat64;
    content : blob;
};

type fetch_canister_logs_result = record {
    canister_log_records : vec canister_log_record;
};

service ic : {
    create_canister : (create_canister_args) -> (create_canister_result);
    update_settings : (update_settings_args) -> ();
    upload_chunk : (upload_chunk_args) -> (upload_chunk_result);
    clear_chunk_store : (clear_chunk_store_args) -> ();
    stored_chunks : (stored_chunks_args) -> (stored_chunks_result);
    install_code : (install_code_args) -> ();
    install_chunked_code : (install_chunked_code_args) -> ();
    uninstall_code : (uninstall_code_args) -> ();
    start_canister : (start_canister_args) -> ();
    stop_canister : (stop_canister_args) -> ();
    canister_status : (canister_status_args) -> (canister_status_result);
    canister_info : (canister_info_args) -> (canister_info_result);
    delete_canister : (delete_canister_args) -> ();
    deposit_cycles : (deposit_cycles_args) -> ();
    raw_rand : () -> (raw_rand_result);
    http_request : (http_request_args) -> (http_request_result);

    // Threshold ECDSA signature
    ecdsa_public_key : (ecdsa_public_key_args) -> (ecdsa_public_key_result);
    sign_with_ecdsa : (sign_with_ecdsa_args) -> (sign_with_ecdsa_result);

    // Threshold Schnorr signature
    schnorr_public_key : (schnorr_public_key_args) -> (schnorr_public_key_result);
    sign_with_schnorr : (sign_with_schnorr_args) -> (sign_with_schnorr_result);

    // bitcoin interface
    bitcoin_get_balance : (bitcoin_get_balance_args) -> (bitcoin_get_balance_result);
    bitcoin_get_utxos : (bitcoin_get_utxos_args) -> (bitcoin_get_utxos_result);
    bitcoin_send_transaction : (bitcoin_send_transaction_args) -> ();
    bitcoin_get_current_fee_percentiles : (bitcoin_get_current_fee_percentiles_args) -> (bitcoin_get_current_fee_percentiles_result);
    bitcoin_get_block_headers : (bitcoin_get_block_headers_args) -> (bitcoin_get_block_headers_result);

    // metrics interface
    node_metrics_history : (node_metrics_history_args) -> (node_metrics_history_result);

    // subnet info
    subnet_info : (subnet_info_args) -> (subnet_info_result);

    // provisional interfaces for the pre-ledger world
    provisional_create_canister_with_cycles : (provisional_create_canister_with_cycles_args) -> (provisional_create_canister_with_cycles_result);
    provisional_top_up_canister : (provisional_top_up_canister_args) -> ();

    // Canister snapshots
    take_canister_snapshot : (take_canister_snapshot_args) -> (take_canister_snapshot_result);
    load_canister_snapshot : (load_canister_snapshot_args) -> ();
    list_canister_snapshots : (list_canister_snapshots_args) -> (list_canister_snapshots_result);
    delete_canister_snapshot : (delete_canister_snapshot_args) -> ();

    // canister logging
    fetch_canister_logs : (fetch_canister_logs_args) -> (fetch_canister_logs_result) query;
};
PK
build-template/src/frontend/PK
build-template/src/frontend/components.json{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "new-york",
  "rsc": false,
  "tsx": true,
  "tailwind": {
    "config": "tailwind.config.js",
    "css": "index.css",
    "baseColor": "neutral",
    "cssVariables": true,
    "prefix": ""
  },
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  },
  "iconLibrary": "lucide"
}
PK
build-template/src/frontend/env.json{
  "backend_host": "undefined",
  "backend_canister_id": "undefined",
  "project_id": "undefined",
  "ii_derivation_origin": "undefined"
}
PK
build-template/src/frontend/eslint.config.jsimport typescript from '@typescript-eslint/eslint-plugin';
import typescriptParser from '@typescript-eslint/parser';
import reactHooks from 'eslint-plugin-react-hooks';
import globals from 'globals';
import pluginRouter from '@tanstack/eslint-plugin-router';
import noBigIntInQueryKeys from './eslint-rules/no-bigint-in-query-keys.js';
import requireInternetIdentityProvider from './eslint-rules/require-internet-identity-provider.js';
import pluginTailwindcss from 'eslint-plugin-tailwindcss';

const customRules = {
    rules: {
        'no-bigint-in-query-keys': noBigIntInQueryKeys,
        'require-internet-identity-provider': requireInternetIdentityProvider
    }
};

export default [
    {
        ignores: [
            '**/backend.ts',
            '**/backend.d.ts',
            'dist/**',
            'node_modules/**',
            'build/**',
            '*.config.js',
            'eslint-rules/**'
            // 'components/ui/**'
        ]
    },
    ...pluginRouter.configs['flat/recommended'],
    ...pluginTailwindcss.configs['flat/recommended'],
    {
        files: ['**/*.ts', '**/*.tsx'],
        languageOptions: {
            parser: typescriptParser,
            parserOptions: {
                ecmaVersion: 2022,
                sourceType: 'module',
                project: './tsconfig.json',
                tsconfigRootDir: import.meta.dirname,
                ecmaFeatures: {
                    jsx: true
                }
            },
            globals: {
                ...globals.browser,
                ...globals.node,
                ...globals.es2021
            }
        },
        plugins: {
            '@typescript-eslint': typescript,
            'react-hooks': reactHooks,
            tailwindcss: pluginTailwindcss,
            custom: customRules
        },
        rules: {
            ...typescript.configs.recommended.rules,
            // Having warns pollutes in case of errors.
            'react-hooks/rules-of-hooks': 'error',
            'react-hooks/exhaustive-deps': 'off',
            '@typescript-eslint/no-explicit-any': 'off',
            '@typescript-eslint/no-unused-vars': ['off', { argsIgnorePattern: '^_' }],
            // '@typescript-eslint/no-floating-promises': 'error', -- enable in the future
            // Additional AI-friendly rules
            'no-useless-escape': 'off',
            '@typescript-eslint/ban-ts-comment': 'off', // Allow @ts-ignore when needed
            '@typescript-eslint/no-non-null-assertion': 'off', // Allow ! operator
            'no-console': 'off', // Allow console.log for debugging
            'prefer-const': 'off', // Warn instead of error for let vs const
            // tailwindcss rules
            'tailwindcss/no-custom-classname': 'off', // Allow custom classes
            'tailwindcss/classnames-order': 'off',
            'tailwindcss/no-unnecessary-arbitrary-value': 'off',
            'tailwindcss/enforces-shorthand': 'off',
            // custom rules
            'custom/no-bigint-in-query-keys': 'error',
            'custom/require-internet-identity-provider': 'error'
        },
        settings: {
            tailwindcss: {
                callees: ['cn', 'cva'],
                config: './tailwind.config.js'
            }
        }
    }
];
PK
build-template/src/frontend/package.json{
  "name": "@caffeine/template-frontend",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "setup": "pnpm i && dfx canister create backend && dfx generate backend && dfx deploy",
    "start": "vite --port 3000",
    "prebuild": "dfx generate backend",
    "build:skip-bindings": "vite build && pnpm copy:env",
    "copy:env": "cp env.json dist/",
    "typescript-check": "tsc --noEmit --pretty",
    "format": "prettier --write \"src/**/*.{json,js,jsx,ts,tsx,css,scss}\"",
    "lint": "eslint src --ext .ts,.tsx,.js,.jsx",
    "lint:fix": "eslint src --ext .ts,.tsx,.js,.jsx --fix"
  },
  "devDependencies": {
    "@eslint/js": "~9.27.0",
    "@tailwindcss/container-queries": "^0.1.1",
    "@react-three/eslint-plugin": "~0.1.2",
    "@types/node": "^20.9.0",
    "@types/react": "~19.1.0",
    "@types/react-dom": "~19.1.0",
    "@types/three": "0.176.0",
    "@typescript-eslint/eslint-plugin": "^8.32.1",
    "@typescript-eslint/parser": "^8.32.1",
    "@typescript-eslint/utils": "^8.32.1",
    "@vitejs/plugin-react": "^4.3.1",
    "autoprefixer": "^10.4.20",
    "dotenv": "^16.5.0",
    "dotenv-cli": "^8.0.0",
    "eslint": "~9.27.0",
    "eslint-plugin-react": "~7.37.5",
    "eslint-plugin-react-hooks": "~5.2.0",
    "eslint-plugin-tailwindcss": "~3.18.2",
    "globals": "~16.2.0",
    "postcss": "^8.4.41",
    "tailwindcss": "^3.4.17",
    "@tailwindcss/typography": "0.5.10",
    "tailwindcss-animate": "^1.0.7",
    "@tanstack/eslint-plugin-router": "~1.115.0",
    "typescript": "^5.8.3",
    "vite": "^5.4.1",
    "vite-plugin-environment": "^1.1.3"
  },
  "dependencies": {
    "@dfinity/agent": "~3.3.0",
    "@dfinity/identity": "~3.3.0",
    "@dfinity/auth-client": "~3.3.0",
    "@dfinity/candid": "~3.3.0",
    "@dfinity/principal": "~3.3.0",
    "@icp-sdk/core": "~4.1.0",
    "@react-three/cannon": "~6.6.0",
    "@react-three/drei": "~10.0.8",
    "@react-three/fiber": "~9.1.2",
    "@tanstack/react-query": "^5.24.0",
    "@tanstack/react-router": "~1.131.8",
    "lucide-react": "0.511.0",
    "react-icons": "^5.4.0",
    "@radix-ui/react-slot": "^1.1.0",
    "@radix-ui/react-dialog": "^1.1.1",
    "@radix-ui/react-dropdown-menu": "^2.1.1",
    "@radix-ui/react-label": "^2.1.0",
    "@radix-ui/react-select": "^2.1.2",
    "@radix-ui/react-tabs": "^1.1.0",
    "@radix-ui/react-tooltip": "^1.1.2",
    "@radix-ui/react-scroll-area": "^1.2.0",
    "@radix-ui/react-popover": "^1.1.1",
    "@radix-ui/react-checkbox": "^1.1.1",
    "@radix-ui/react-switch": "^1.1.1",
    "@radix-ui/react-separator": "^1.1.0",
    "@radix-ui/react-avatar": "^1.1.0",
    "@radix-ui/react-accordion": "^1.1.2",
    "@radix-ui/react-alert-dialog": "^1.1.2",
    "@radix-ui/react-aspect-ratio": "^1.1.0",
    "@radix-ui/react-hover-card": "^1.1.2",
    "@radix-ui/react-menubar": "^1.1.1",
    "@radix-ui/react-navigation-menu": "^1.2.0",
    "@radix-ui/react-progress": "^1.1.0",
    "@radix-ui/react-radio-group": "^1.2.0",
    "@radix-ui/react-slider": "^1.2.0",
    "@radix-ui/react-toggle": "^1.1.0",
    "@radix-ui/react-toggle-group": "^1.1.0",
    "@radix-ui/react-collapsible": "^1.1.0",
    "@radix-ui/react-context-menu": "^2.2.15",
    "class-variance-authority": "^0.7.0",
    "clsx": "^2.1.1",
    "tailwind-merge": "^2.5.2",
    "react-day-picker": "^9.5.0",
    "date-fns": "^3.6.0",
    "embla-carousel-react": "^8.2.1",
    "recharts": "^2.15.1",
    "cmdk": "^1.0.0",
    "vaul": "^1.1.2",
    "react-hook-form": "^7.53.0",
    "input-otp": "^1.4.1",
    "react-resizable-panels": "^2.1.7",
    "sonner": "^1.7.4",
    "next-themes": "~0.4.6",
    "react": "~19.1.0",
    "react-use": "~17.6.0",
    "react-dom": "~19.1.0",
    "react-quill-new": "3.4.6",
    "three": "^0.176.0",
    "zustand": "~5.0.5"
  }
}
PK
build-template/src/frontend/postcss.config.jsexport default {
    plugins: {
        tailwindcss: {},
        autoprefixer: {}
    }
};
PK
build-template/src/frontend/tsconfig.json{
  "compilerOptions": {
    "target": "ESNext",
    "useDefineForClassFields": true,
    "lib": ["DOM", "DOM.Iterable", "ESNext"],
    "allowJs": false,
    "skipLibCheck": true,
    "esModuleInterop": false,
    "allowSyntheticDefaultImports": true,
    "strict": true,
    "noImplicitAny": false,
    "forceConsistentCasingInFileNames": true,
    "module": "ESNext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "react-jsx",
    "types": ["vite/client", "node"],
    "paths": {
      "declarations/*": ["../declarations/*"],
      "@/*": ["./src/*"]
    }
  },
  "include": ["src"],
  "exclude": ["node_modules", "dist", "build", "*.config.js", "eslint-rules/**/*"]
}
PK
build-template/src/frontend/vite.config.jsimport { fileURLToPath, URL } from 'url';
import react from '@vitejs/plugin-react';
import { defineConfig } from 'vite';
import environment from 'vite-plugin-environment';

const ii_url =
    process.env.DFX_NETWORK === 'local'
        ? `http://rdmx6-jaaaa-aaaaa-aaadq-cai.localhost:8081/`
        : `https://identity.internetcomputer.org/`;

process.env.II_URL = process.env.II_URL || ii_url;
process.env.STORAGE_GATEWAY_URL = process.env.STORAGE_GATEWAY_URL || 'https://blob.caffeine.ai';

export default defineConfig({
    logLevel: 'error',
    build: {
        emptyOutDir: true,
        sourcemap: false,
        minify: false
    },
    css: {
        postcss: './postcss.config.js'
    },
    optimizeDeps: {
        esbuildOptions: {
            define: {
                global: 'globalThis'
            }
        }
    },
    server: {
        proxy: {
            '/api': {
                target: 'http://127.0.0.1:4943',
                changeOrigin: true
            }
        }
    },
    plugins: [
        environment('all', { prefix: 'CANISTER_' }),
        environment('all', { prefix: 'DFX_' }),
        environment(['II_URL']),
        environment(['STORAGE_GATEWAY_URL']),
        react()
    ],
    resolve: {
        alias: [
            {
                find: 'declarations',
                replacement: fileURLToPath(new URL('../declarations', import.meta.url))
            },
            {
                find: '@',
                replacement: fileURLToPath(new URL('./src', import.meta.url))
            }
        ],
        dedupe: ['@dfinity/agent']
    }
});
PK
build-template/src/frontend/eslint-rules/PK
build-template/src/frontend/eslint-rules/no-bigint-in-query-keys.js// eslint-rules/no-bigint-in-query-keys.js

import { getParserServices } from '@typescript-eslint/utils/eslint-utils';
import ts from 'typescript';

export default {
    meta: {
        type: 'problem',
        docs: {
            description: 'Disallow BigInt in TanStack Query keys',
            recommended: true
        },
        fixable: 'code',
        messages: {
            bigIntInQueryKey: 'BigInt detected in query key. Use .toString() to convert it.'
        },
        schema: []
    },
    create(context) {
        const sourceCode = context.getSourceCode();

        // Get parser services - this will handle TypeScript availability checks
        const services = getParserServices(context);
        const typeChecker = services.program.getTypeChecker();

        return {
            CallExpression(node) {
                const queryHooks = ['useQuery', 'useMutation', 'useInfiniteQuery', 'useSuspenseQuery'];

                const calleeName =
                    node.callee.type === 'Identifier'
                        ? node.callee.name
                        : node.callee.type === 'MemberExpression' && node.callee.property.type === 'Identifier'
                          ? node.callee.property.name
                          : null;

                if (!calleeName || !queryHooks.includes(calleeName)) return;

                // Find queryKey in options
                const options = node.arguments[0];
                if (!options || options.type !== 'ObjectExpression') return;

                const queryKeyProp = options.properties.find(
                    (prop) => prop.type === 'Property' && prop.key.type === 'Identifier' && prop.key.name === 'queryKey'
                );

                if (queryKeyProp && queryKeyProp.value) {
                    checkForBigInt(queryKeyProp.value);
                }

                function checkForBigInt(node) {
                    // Skip spread elements and null/undefined
                    if (!node || node.type === 'SpreadElement') return;

                    // For composite structures, check elements recursively first
                    // Don't check the type of the composite structure itself
                    if (node.type === 'ArrayExpression') {
                        node.elements.forEach((element) => {
                            if (element) checkForBigInt(element);
                        });
                        return; // Don't check the array type itself
                    } else if (node.type === 'ObjectExpression') {
                        node.properties.forEach((property) => {
                            if (property.type === 'Property' && property.value) {
                                checkForBigInt(property.value);
                            }
                        });
                        return; // Don't check the object type itself
                    } else if (node.type === 'TemplateLiteral') {
                        node.expressions.forEach((expr) => {
                            checkForBigInt(expr);
                        });
                        return; // Don't check the template literal type itself
                    } else if (node.type === 'ConditionalExpression') {
                        checkForBigInt(node.consequent);
                        checkForBigInt(node.alternate);
                        return; // Don't check the conditional expression type itself
                    } else if (node.type === 'LogicalExpression') {
                        checkForBigInt(node.left);
                        checkForBigInt(node.right);
                        return; // Don't check the logical expression type itself
                    }

                    // Only check types for leaf nodes (not composite structures)
                    // Get TypeScript type for this node using the services
                    const tsNode = services.esTreeNodeToTSNodeMap.get(node);
                    if (!tsNode) return;

                    const type = typeChecker.getTypeAtLocation(tsNode);

                    // Check if the type is bigint
                    if (isBigIntType(type)) {
                        context.report({
                            node,
                            messageId: 'bigIntInQueryKey',
                            fix(fixer) {
                                const nodeText = sourceCode.getText(node);

                                // Handle different node types appropriately
                                if (node.type === 'Literal' && typeof node.value === 'bigint') {
                                    // For BigInt literals like 123n
                                    return fixer.replaceText(node, `${nodeText}.toString()`);
                                } else if (
                                    node.type === 'CallExpression' &&
                                    node.callee.type === 'Identifier' &&
                                    node.callee.name === 'BigInt'
                                ) {
                                    // For BigInt() constructor calls
                                    return fixer.replaceText(node, `${nodeText}.toString()`);
                                } else {
                                    // For variables and other expressions
                                    return fixer.replaceText(node, `${nodeText}.toString()`);
                                }
                            }
                        });
                    }
                }

                function isBigIntType(type) {
                    // Get the string representation of the type
                    const typeString = typeChecker.typeToString(type);

                    // Check if it's literally "bigint"
                    if (typeString === 'bigint') {
                        return true;
                    }

                    // Check for bigint in union types (e.g., "string | bigint")
                    if (typeString.includes('bigint')) {
                        return true;
                    }

                    // Use TypeScript type flags for more reliable detection
                    if (ts.TypeFlags) {
                        // Check for BigInt literal type
                        if (type.flags & ts.TypeFlags.BigIntLiteral) {
                            return true;
                        }
                        // Check for generic bigint type
                        if (type.flags & ts.TypeFlags.BigInt) {
                            return true;
                        }
                    }

                    // Check for union types that might contain bigint
                    if (type.isUnion?.()) {
                        return type.types.some((t) => isBigIntType(t));
                    }

                    // Check for intersection types
                    if (type.isIntersection?.()) {
                        return type.types.some((t) => isBigIntType(t));
                    }

                    return false;
                }
            }
        };
    }
};
PK
build-template/src/frontend/eslint-rules/require-internet-identity-provider.js// eslint-rules/require-internet-identity-provider.js

import fs from 'fs';
import path from 'path';

export default {
    meta: {
        type: 'problem',
        docs: {
            description: 'Ensure InternetIdentityProvider is present when using Internet Identity hooks',
            recommended: true
        },
        messages: {
            hookUsedWithoutProvider:
                "Using {{hookName}}. Make sure InternetIdentityProvider is added in main.tsx or App.tsx. E.g. <InternetIdentityProvider> <App /> </InternetIdentityProvider>.  Import it using: import { useInternetIdentity } from './hooks/useInternetIdentity'"
        },
        schema: [
            {
                type: 'object',
                properties: {
                    checkAllFiles: {
                        type: 'boolean',
                        default: true
                    }
                },
                additionalProperties: false
            }
        ]
    },
    create(context) {
        const options = context.options[0] || {};
        const checkAllFiles = options.checkAllFiles !== false;
        const filename = context.getFilename();
        const hookUsages = [];
        const identityHooks = ['useInternetIdentity', 'useAuthClient', 'useIdentity', 'useAuth'];
        const importedHooks = new Set();

        // Cache for provider check across files
        let providerCheckCache = null;

        // Determine if an import source refers to the Internet Identity hook module
        function isInternetIdentityHookSource(sourceValue) {
            if (typeof sourceValue !== 'string') return false;
            // Legacy package name
            if (sourceValue === 'ic-use-internet-identity') return true;
            // Any path (relative or alias) that ends with hooks/useInternetIdentity(.ts|.tsx|.js|.jsx)
            const normalized = sourceValue.replace(/\\/g, '/');
            return /(^|\/)hooks\/useInternetIdentity(\.(t|j)sx?)?$/.test(normalized);
        }

        // Function to check if provider exists in main.tsx or App.tsx
        function checkProviderInEntryFiles() {
            if (providerCheckCache !== null) {
                return providerCheckCache;
            }

            const cwd = context.getCwd ? context.getCwd() : process.cwd();
            const srcDir = path.join(cwd, 'src');
            const filesToCheck = ['main.tsx', 'App.tsx'];

            for (const file of filesToCheck) {
                const filePath = path.join(srcDir, file);
                try {
                    if (fs.existsSync(filePath)) {
                        const content = fs.readFileSync(filePath, 'utf8');
                        // Check for InternetIdentityProvider usage
                        if (content.includes('InternetIdentityProvider')) {
                            // More specific check for JSX usage
                            const providerRegex = /<InternetIdentityProvider[\s>]/;
                            if (providerRegex.test(content)) {
                                providerCheckCache = true;
                                return true;
                            }
                        }
                    }
                } catch (error) {
                    // Ignore file read errors
                }
            }

            providerCheckCache = false;
            return false;
        }

        return {
            // Check for imports from ic-use-internet-identity
            ImportDeclaration(node) {
                if (isInternetIdentityHookSource(node.source.value)) {
                    node.specifiers.forEach((spec) => {
                        if (spec.type === 'ImportSpecifier' && identityHooks.includes(spec.imported.name)) {
                            importedHooks.add(spec.imported.name);
                        }
                    });
                }
            },

            // Check for hook usage
            CallExpression(node) {
                if (node.callee.type === 'Identifier' && importedHooks.has(node.callee.name)) {
                    hookUsages.push({
                        node: node,
                        hookName: node.callee.name
                    });
                }
            },

            // Check at the end of the file
            'Program:exit'() {
                if (hookUsages.length === 0) return;

                // Check if provider exists in main.tsx or App.tsx
                const hasProviderInEntryFiles = checkProviderInEntryFiles();

                if (checkAllFiles && !hasProviderInEntryFiles) {
                    // Only report once per file to avoid spam
                    context.report({
                        node: hookUsages[0].node,
                        messageId: 'hookUsedWithoutProvider',
                        data: {
                            hookName: hookUsages[0].hookName
                        }
                    });
                }
            }
        };
    }
};
PK
build-template/src/frontend/src/PK
uild-template/src/frontend/src/components/PK
build-template/src/frontend/src/components/ui/PK
build-template/src/frontend/src/components/ui/accordion.tsx'use client';

import * as React from 'react';
import * as AccordionPrimitive from '@radix-ui/react-accordion';
import { ChevronDownIcon } from 'lucide-react';

import { cn } from '@/lib/utils';

function Accordion({ ...props }: React.ComponentProps<typeof AccordionPrimitive.Root>) {
    return <AccordionPrimitive.Root data-slot="accordion" {...props} />;
}

function AccordionItem({ className, ...props }: React.ComponentProps<typeof AccordionPrimitive.Item>) {
    return (
        <AccordionPrimitive.Item
            data-slot="accordion-item"
            className={cn('border-b last:border-b-0', className)}
            {...props}
        />
    );
}

function AccordionTrigger({ className, children, ...props }: React.ComponentProps<typeof AccordionPrimitive.Trigger>) {
    return (
        <AccordionPrimitive.Header className="flex">
            <AccordionPrimitive.Trigger
                data-slot="accordion-trigger"
                className={cn(
                    'focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180',
                    className
                )}
                {...props}
            >
                {children}
                <ChevronDownIcon className="text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200" />
            </AccordionPrimitive.Trigger>
        </AccordionPrimitive.Header>
    );
}

function AccordionContent({ className, children, ...props }: React.ComponentProps<typeof AccordionPrimitive.Content>) {
    return (
        <AccordionPrimitive.Content
            data-slot="accordion-content"
            className="data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm"
            {...props}
        >
            <div className={cn('pt-0 pb-4', className)}>{children}</div>
        </AccordionPrimitive.Content>
    );
}

export { Accordion, AccordionItem, AccordionTrigger, AccordionContent };
PK
build-template/src/frontend/src/components/ui/alert-dialog.tsx'use client';

import * as React from 'react';
import * as AlertDialogPrimitive from '@radix-ui/react-alert-dialog';

import { cn } from '@/lib/utils';
import { buttonVariants } from '@/components/ui/button';

function AlertDialog({ ...props }: React.ComponentProps<typeof AlertDialogPrimitive.Root>) {
    return <AlertDialogPrimitive.Root data-slot="alert-dialog" {...props} />;
}

function AlertDialogTrigger({ ...props }: React.ComponentProps<typeof AlertDialogPrimitive.Trigger>) {
    return <AlertDialogPrimitive.Trigger data-slot="alert-dialog-trigger" {...props} />;
}

function AlertDialogPortal({ ...props }: React.ComponentProps<typeof AlertDialogPrimitive.Portal>) {
    return <AlertDialogPrimitive.Portal data-slot="alert-dialog-portal" {...props} />;
}

function AlertDialogOverlay({ className, ...props }: React.ComponentProps<typeof AlertDialogPrimitive.Overlay>) {
    return (
        <AlertDialogPrimitive.Overlay
            data-slot="alert-dialog-overlay"
            className={cn(
                'data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50',
                className
            )}
            {...props}
        />
    );
}

function AlertDialogContent({ className, ...props }: React.ComponentProps<typeof AlertDialogPrimitive.Content>) {
    return (
        <AlertDialogPortal>
            <AlertDialogOverlay />
            <AlertDialogPrimitive.Content
                data-slot="alert-dialog-content"
                className={cn(
                    'bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg',
                    className
                )}
                {...props}
            />
        </AlertDialogPortal>
    );
}

function AlertDialogHeader({ className, ...props }: React.ComponentProps<'div'>) {
    return (
        <div
            data-slot="alert-dialog-header"
            className={cn('flex flex-col gap-2 text-center sm:text-left', className)}
            {...props}
        />
    );
}

function AlertDialogFooter({ className, ...props }: React.ComponentProps<'div'>) {
    return (
        <div
            data-slot="alert-dialog-footer"
            className={cn('flex flex-col-reverse gap-2 sm:flex-row sm:justify-end', className)}
            {...props}
        />
    );
}

function AlertDialogTitle({ className, ...props }: React.ComponentProps<typeof AlertDialogPrimitive.Title>) {
    return (
        <AlertDialogPrimitive.Title
            data-slot="alert-dialog-title"
            className={cn('text-lg font-semibold', className)}
            {...props}
        />
    );
}

function AlertDialogDescription({
    className,
    ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Description>) {
    return (
        <AlertDialogPrimitive.Description
            data-slot="alert-dialog-description"
            className={cn('text-muted-foreground text-sm', className)}
            {...props}
        />
    );
}

function AlertDialogAction({ className, ...props }: React.ComponentProps<typeof AlertDialogPrimitive.Action>) {
    return <AlertDialogPrimitive.Action className={cn(buttonVariants(), className)} {...props} />;
}

function AlertDialogCancel({ className, ...props }: React.ComponentProps<typeof AlertDialogPrimitive.Cancel>) {
    return <AlertDialogPrimitive.Cancel className={cn(buttonVariants({ variant: 'outline' }), className)} {...props} />;
}

export {
    AlertDialog,
    AlertDialogPortal,
    AlertDialogOverlay,
    AlertDialogTrigger,
    AlertDialogContent,
    AlertDialogHeader,
    AlertDialogFooter,
    AlertDialogTitle,
    AlertDialogDescription,
    AlertDialogAction,
    AlertDialogCancel
};
PK
build-template/src/frontend/src/components/ui/alert.tsximport * as React from 'react';
import { cva, type VariantProps } from 'class-variance-authority';

import { cn } from '@/lib/utils';

const alertVariants = cva(
    'relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current',
    {
        variants: {
            variant: {
                default: 'bg-card text-card-foreground',
                destructive:
                    'text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90'
            }
        },
        defaultVariants: {
            variant: 'default'
        }
    }
);

function Alert({ className, variant, ...props }: React.ComponentProps<'div'> & VariantProps<typeof alertVariants>) {
    return <div data-slot="alert" role="alert" className={cn(alertVariants({ variant }), className)} {...props} />;
}

function AlertTitle({ className, ...props }: React.ComponentProps<'div'>) {
    return (
        <div
            data-slot="alert-title"
            className={cn('col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight', className)}
            {...props}
        />
    );
}

function AlertDescription({ className, ...props }: React.ComponentProps<'div'>) {
    return (
        <div
            data-slot="alert-description"
            className={cn(
                'text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed',
                className
            )}
            {...props}
        />
    );
}

export { Alert, AlertTitle, AlertDescription };
PK
build-template/src/frontend/src/components/ui/aspect-ratio.tsx'use client';

import * as AspectRatioPrimitive from '@radix-ui/react-aspect-ratio';

function AspectRatio({ ...props }: React.ComponentProps<typeof AspectRatioPrimitive.Root>) {
    return <AspectRatioPrimitive.Root data-slot="aspect-ratio" {...props} />;
}

export { AspectRatio };
PK
build-template/src/frontend/src/components/ui/avatar.tsx'use client';

import * as React from 'react';
import * as AvatarPrimitive from '@radix-ui/react-avatar';

import { cn } from '@/lib/utils';

function Avatar({ className, ...props }: React.ComponentProps<typeof AvatarPrimitive.Root>) {
    return (
        <AvatarPrimitive.Root
            data-slot="avatar"
            className={cn('relative flex size-8 shrink-0 overflow-hidden rounded-full', className)}
            {...props}
        />
    );
}

function AvatarImage({ className, ...props }: React.ComponentProps<typeof AvatarPrimitive.Image>) {
    return (
        <AvatarPrimitive.Image
            data-slot="avatar-image"
            className={cn('aspect-square size-full', className)}
            {...props}
        />
    );
}

function AvatarFallback({ className, ...props }: React.ComponentProps<typeof AvatarPrimitive.Fallback>) {
    return (
        <AvatarPrimitive.Fallback
            data-slot="avatar-fallback"
            className={cn('bg-muted flex size-full items-center justify-center rounded-full', className)}
            {...props}
        />
    );
}

export { Avatar, AvatarImage, AvatarFallback };
PK
build-template/src/frontend/src/components/ui/badge.tsximport * as React from 'react';
import { Slot } from '@radix-ui/react-slot';
import { cva, type VariantProps } from 'class-variance-authority';

import { cn } from '@/lib/utils';

const badgeVariants = cva(
    'inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden',
    {
        variants: {
            variant: {
                default: 'border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90',
                secondary: 'border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90',
                destructive:
                    'border-transparent bg-destructive text-destructive-foreground [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',
                outline: 'text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground'
            }
        },
        defaultVariants: {
            variant: 'default'
        }
    }
);

function Badge({
    className,
    variant,
    asChild = false,
    ...props
}: React.ComponentProps<'span'> & VariantProps<typeof badgeVariants> & { asChild?: boolean }) {
    const Comp = asChild ? Slot : 'span';

    return <Comp data-slot="badge" className={cn(badgeVariants({ variant }), className)} {...props} />;
}

export { Badge, badgeVariants };
PK
build-template/src/frontend/src/components/ui/breadcrumb.tsximport * as React from 'react';
import { Slot } from '@radix-ui/react-slot';
import { ChevronRight, MoreHorizontal } from 'lucide-react';

import { cn } from '@/lib/utils';

function Breadcrumb({ ...props }: React.ComponentProps<'nav'>) {
    return <nav aria-label="breadcrumb" data-slot="breadcrumb" {...props} />;
}

function BreadcrumbList({ className, ...props }: React.ComponentProps<'ol'>) {
    return (
        <ol
            data-slot="breadcrumb-list"
            className={cn(
                'text-muted-foreground flex flex-wrap items-center gap-1.5 text-sm break-words sm:gap-2.5',
                className
            )}
            {...props}
        />
    );
}

function BreadcrumbItem({ className, ...props }: React.ComponentProps<'li'>) {
    return <li data-slot="breadcrumb-item" className={cn('inline-flex items-center gap-1.5', className)} {...props} />;
}

function BreadcrumbLink({
    asChild,
    className,
    ...props
}: React.ComponentProps<'a'> & {
    asChild?: boolean;
}) {
    const Comp = asChild ? Slot : 'a';

    return (
        <Comp
            data-slot="breadcrumb-link"
            className={cn('hover:text-foreground transition-colors', className)}
            {...props}
        />
    );
}

function BreadcrumbPage({ className, ...props }: React.ComponentProps<'span'>) {
    return (
        <span
            data-slot="breadcrumb-page"
            role="link"
            aria-disabled="true"
            aria-current="page"
            className={cn('text-foreground font-normal', className)}
            {...props}
        />
    );
}

function BreadcrumbSeparator({ children, className, ...props }: React.ComponentProps<'li'>) {
    return (
        <li
            data-slot="breadcrumb-separator"
            role="presentation"
            aria-hidden="true"
            className={cn('[&>svg]:size-3.5', className)}
            {...props}
        >
            {children ?? <ChevronRight />}
        </li>
    );
}

function BreadcrumbEllipsis({ className, ...props }: React.ComponentProps<'span'>) {
    return (
        <span
            data-slot="breadcrumb-ellipsis"
            role="presentation"
            aria-hidden="true"
            className={cn('flex size-9 items-center justify-center', className)}
            {...props}
        >
            <MoreHorizontal className="size-4" />
            <span className="sr-only">More</span>
        </span>
    );
}

export {
    Breadcrumb,
    BreadcrumbList,
    BreadcrumbItem,
    BreadcrumbLink,
    BreadcrumbPage,
    BreadcrumbSeparator,
    BreadcrumbEllipsis
};
PK
build-template/src/frontend/src/components/ui/button.tsximport * as React from 'react';
import { Slot } from '@radix-ui/react-slot';
import { cva, type VariantProps } from 'class-variance-authority';

import { cn } from '@/lib/utils';

const buttonVariants = cva(
    "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
    {
        variants: {
            variant: {
                default: 'bg-primary text-primary-foreground shadow-xs hover:bg-primary/90',
                destructive:
                    'bg-destructive text-destructive-foreground shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',
                outline:
                    'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',
                secondary: 'bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80',
                ghost: 'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',
                link: 'text-primary underline-offset-4 hover:underline'
            },
            size: {
                default: 'h-9 px-4 py-2 has-[>svg]:px-3',
                sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',
                lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',
                icon: 'size-9'
            }
        },
        defaultVariants: {
            variant: 'default',
            size: 'default'
        }
    }
);

function Button({
    className,
    variant,
    size,
    asChild = false,
    ...props
}: React.ComponentProps<'button'> &
    VariantProps<typeof buttonVariants> & {
        asChild?: boolean;
    }) {
    const Comp = asChild ? Slot : 'button';

    return <Comp data-slot="button" className={cn(buttonVariants({ variant, size, className }))} {...props} />;
}

export { Button, buttonVariants };
PK
build-template/src/frontend/src/components/ui/calendar.tsx'use client';

import * as React from 'react';
import { ChevronDownIcon, ChevronLeftIcon, ChevronRightIcon } from 'lucide-react';
import { DayButton, DayPicker, getDefaultClassNames } from 'react-day-picker';

import { cn } from '@/lib/utils';
import { Button, buttonVariants } from '@/components/ui/button';

function Calendar({
    className,
    classNames,
    showOutsideDays = true,
    captionLayout = 'label',
    buttonVariant = 'ghost',
    formatters,
    components,
    ...props
}: React.ComponentProps<typeof DayPicker> & {
    buttonVariant?: React.ComponentProps<typeof Button>['variant'];
}) {
    const defaultClassNames = getDefaultClassNames();

    return (
        <DayPicker
            showOutsideDays={showOutsideDays}
            className={cn(
                'bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent',
                String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,
                String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,
                className
            )}
            captionLayout={captionLayout}
            formatters={{
                formatMonthDropdown: (date) => date.toLocaleString('default', { month: 'short' }),
                ...formatters
            }}
            classNames={{
                root: cn('w-fit', defaultClassNames.root),
                months: cn('flex gap-4 flex-col md:flex-row relative', defaultClassNames.months),
                month: cn('flex flex-col w-full gap-4', defaultClassNames.month),
                nav: cn(
                    'flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between',
                    defaultClassNames.nav
                ),
                button_previous: cn(
                    buttonVariants({ variant: buttonVariant }),
                    'size-(--cell-size) aria-disabled:opacity-50 p-0 select-none',
                    defaultClassNames.button_previous
                ),
                button_next: cn(
                    buttonVariants({ variant: buttonVariant }),
                    'size-(--cell-size) aria-disabled:opacity-50 p-0 select-none',
                    defaultClassNames.button_next
                ),
                month_caption: cn(
                    'flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)',
                    defaultClassNames.month_caption
                ),
                dropdowns: cn(
                    'w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5',
                    defaultClassNames.dropdowns
                ),
                dropdown_root: cn(
                    'relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md',
                    defaultClassNames.dropdown_root
                ),
                dropdown: cn('absolute bg-popover inset-0 opacity-0', defaultClassNames.dropdown),
                caption_label: cn(
                    'select-none font-medium',
                    captionLayout === 'label'
                        ? 'text-sm'
                        : 'rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5',
                    defaultClassNames.caption_label
                ),
                table: 'w-full border-collapse',
                weekdays: cn('flex', defaultClassNames.weekdays),
                weekday: cn(
                    'text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none',
                    defaultClassNames.weekday
                ),
                week: cn('flex w-full mt-2', defaultClassNames.week),
                week_number_header: cn('select-none w-(--cell-size)', defaultClassNames.week_number_header),
                week_number: cn('text-[0.8rem] select-none text-muted-foreground', defaultClassNames.week_number),
                day: cn(
                    'relative w-full h-full p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none',
                    defaultClassNames.day
                ),
                range_start: cn('rounded-l-md bg-accent', defaultClassNames.range_start),
                range_middle: cn('rounded-none', defaultClassNames.range_middle),
                range_end: cn('rounded-r-md bg-accent', defaultClassNames.range_end),
                today: cn(
                    'bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none',
                    defaultClassNames.today
                ),
                outside: cn('text-muted-foreground aria-selected:text-muted-foreground', defaultClassNames.outside),
                disabled: cn('text-muted-foreground opacity-50', defaultClassNames.disabled),
                hidden: cn('invisible', defaultClassNames.hidden),
                ...classNames
            }}
            components={{
                Root: ({ className, rootRef, ...props }) => {
                    return <div data-slot="calendar" ref={rootRef} className={cn(className)} {...props} />;
                },
                Chevron: ({ className, orientation, ...props }) => {
                    if (orientation === 'left') {
                        return <ChevronLeftIcon className={cn('size-4', className)} {...props} />;
                    }

                    if (orientation === 'right') {
                        return <ChevronRightIcon className={cn('size-4', className)} {...props} />;
                    }

                    return <ChevronDownIcon className={cn('size-4', className)} {...props} />;
                },
                DayButton: CalendarDayButton,
                WeekNumber: ({ children, ...props }) => {
                    return (
                        <td {...props}>
                            <div className="flex size-(--cell-size) items-center justify-center text-center">
                                {children}
                            </div>
                        </td>
                    );
                },
                ...components
            }}
            {...props}
        />
    );
}

function CalendarDayButton({ className, day, modifiers, ...props }: React.ComponentProps<typeof DayButton>) {
    const defaultClassNames = getDefaultClassNames();

    const ref = React.useRef<HTMLButtonElement>(null);
    React.useEffect(() => {
        if (modifiers.focused) ref.current?.focus();
    }, [modifiers.focused]);

    return (
        <Button
            ref={ref}
            variant="ghost"
            size="icon"
            data-day={day.date.toLocaleDateString()}
            data-selected-single={
                modifiers.selected && !modifiers.range_start && !modifiers.range_end && !modifiers.range_middle
            }
            data-range-start={modifiers.range_start}
            data-range-end={modifiers.range_end}
            data-range-middle={modifiers.range_middle}
            className={cn(
                'data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70',
                defaultClassNames.day,
                className
            )}
            {...props}
        />
    );
}

export { Calendar, CalendarDayButton };
PK
build-template/src/frontend/src/components/ui/card.tsximport * as React from 'react';

import { cn } from '@/lib/utils';

function Card({ className, ...props }: React.ComponentProps<'div'>) {
    return (
        <div
            data-slot="card"
            className={cn(
                'bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm',
                className
            )}
            {...props}
        />
    );
}

function CardHeader({ className, ...props }: React.ComponentProps<'div'>) {
    return (
        <div
            data-slot="card-header"
            className={cn(
                '@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6',
                className
            )}
            {...props}
        />
    );
}

function CardTitle({ className, ...props }: React.ComponentProps<'div'>) {
    return <div data-slot="card-title" className={cn('leading-none font-semibold', className)} {...props} />;
}

function CardDescription({ className, ...props }: React.ComponentProps<'div'>) {
    return <div data-slot="card-description" className={cn('text-muted-foreground text-sm', className)} {...props} />;
}

function CardAction({ className, ...props }: React.ComponentProps<'div'>) {
    return (
        <div
            data-slot="card-action"
            className={cn('col-start-2 row-span-2 row-start-1 self-start justify-self-end', className)}
            {...props}
        />
    );
}

function CardContent({ className, ...props }: React.ComponentProps<'div'>) {
    return <div data-slot="card-content" className={cn('px-6', className)} {...props} />;
}

function CardFooter({ className, ...props }: React.ComponentProps<'div'>) {
    return (
        <div data-slot="card-footer" className={cn('flex items-center px-6 [.border-t]:pt-6', className)} {...props} />
    );
}

export { Card, CardHeader, CardFooter, CardTitle, CardAction, CardDescription, CardContent };
PK
build-template/src/frontend/src/components/ui/carousel.tsx'use client';

import * as React from 'react';
import useEmblaCarousel, { type UseEmblaCarouselType } from 'embla-carousel-react';
import { ArrowLeft, ArrowRight } from 'lucide-react';

import { cn } from '@/lib/utils';
import { Button } from '@/components/ui/button';

type CarouselApi = UseEmblaCarouselType[1];
type UseCarouselParameters = Parameters<typeof useEmblaCarousel>;
type CarouselOptions = UseCarouselParameters[0];
type CarouselPlugin = UseCarouselParameters[1];

type CarouselProps = {
    opts?: CarouselOptions;
    plugins?: CarouselPlugin;
    orientation?: 'horizontal' | 'vertical';
    setApi?: (api: CarouselApi) => void;
};

type CarouselContextProps = {
    carouselRef: ReturnType<typeof useEmblaCarousel>[0];
    api: ReturnType<typeof useEmblaCarousel>[1];
    scrollPrev: () => void;
    scrollNext: () => void;
    canScrollPrev: boolean;
    canScrollNext: boolean;
} & CarouselProps;

const CarouselContext = React.createContext<CarouselContextProps | null>(null);

function useCarousel() {
    const context = React.useContext(CarouselContext);

    if (!context) {
        throw new Error('useCarousel must be used within a <Carousel />');
    }

    return context;
}

function Carousel({
    orientation = 'horizontal',
    opts,
    setApi,
    plugins,
    className,
    children,
    ...props
}: React.ComponentProps<'div'> & CarouselProps) {
    const [carouselRef, api] = useEmblaCarousel(
        {
            ...opts,
            axis: orientation === 'horizontal' ? 'x' : 'y'
        },
        plugins
    );
    const [canScrollPrev, setCanScrollPrev] = React.useState(false);
    const [canScrollNext, setCanScrollNext] = React.useState(false);

    const onSelect = React.useCallback((api: CarouselApi) => {
        if (!api) return;
        setCanScrollPrev(api.canScrollPrev());
        setCanScrollNext(api.canScrollNext());
    }, []);

    const scrollPrev = React.useCallback(() => {
        api?.scrollPrev();
    }, [api]);

    const scrollNext = React.useCallback(() => {
        api?.scrollNext();
    }, [api]);

    const handleKeyDown = React.useCallback(
        (event: React.KeyboardEvent<HTMLDivElement>) => {
            if (event.key === 'ArrowLeft') {
                event.preventDefault();
                scrollPrev();
            } else if (event.key === 'ArrowRight') {
                event.preventDefault();
                scrollNext();
            }
        },
        [scrollPrev, scrollNext]
    );

    React.useEffect(() => {
        if (!api || !setApi) return;
        setApi(api);
    }, [api, setApi]);

    React.useEffect(() => {
        if (!api) return;
        onSelect(api);
        api.on('reInit', onSelect);
        api.on('select', onSelect);

        return () => {
            api?.off('select', onSelect);
        };
    }, [api, onSelect]);

    return (
        <CarouselContext.Provider
            value={{
                carouselRef,
                api: api,
                opts,
                orientation: orientation || (opts?.axis === 'y' ? 'vertical' : 'horizontal'),
                scrollPrev,
                scrollNext,
                canScrollPrev,
                canScrollNext
            }}
        >
            <div
                onKeyDownCapture={handleKeyDown}
                className={cn('relative', className)}
                role="region"
                aria-roledescription="carousel"
                data-slot="carousel"
                {...props}
            >
                {children}
            </div>
        </CarouselContext.Provider>
    );
}

function CarouselContent({ className, ...props }: React.ComponentProps<'div'>) {
    const { carouselRef, orientation } = useCarousel();

    return (
        <div ref={carouselRef} className="overflow-hidden" data-slot="carousel-content">
            <div
                className={cn('flex', orientation === 'horizontal' ? '-ml-4' : '-mt-4 flex-col', className)}
                {...props}
            />
        </div>
    );
}

function CarouselItem({ className, ...props }: React.ComponentProps<'div'>) {
    const { orientation } = useCarousel();

    return (
        <div
            role="group"
            aria-roledescription="slide"
            data-slot="carousel-item"
            className={cn(
                'min-w-0 shrink-0 grow-0 basis-full',
                orientation === 'horizontal' ? 'pl-4' : 'pt-4',
                className
            )}
            {...props}
        />
    );
}

function CarouselPrevious({
    className,
    variant = 'outline',
    size = 'icon',
    ...props
}: React.ComponentProps<typeof Button>) {
    const { orientation, scrollPrev, canScrollPrev } = useCarousel();

    return (
        <Button
            data-slot="carousel-previous"
            variant={variant}
            size={size}
            className={cn(
                'absolute size-8 rounded-full',
                orientation === 'horizontal'
                    ? 'top-1/2 -left-12 -translate-y-1/2'
                    : '-top-12 left-1/2 -translate-x-1/2 rotate-90',
                className
            )}
            disabled={!canScrollPrev}
            onClick={scrollPrev}
            {...props}
        >
            <ArrowLeft />
            <span className="sr-only">Previous slide</span>
        </Button>
    );
}

function CarouselNext({
    className,
    variant = 'outline',
    size = 'icon',
    ...props
}: React.ComponentProps<typeof Button>) {
    const { orientation, scrollNext, canScrollNext } = useCarousel();

    return (
        <Button
            data-slot="carousel-next"
            variant={variant}
            size={size}
            className={cn(
                'absolute size-8 rounded-full',
                orientation === 'horizontal'
                    ? 'top-1/2 -right-12 -translate-y-1/2'
                    : '-bottom-12 left-1/2 -translate-x-1/2 rotate-90',
                className
            )}
            disabled={!canScrollNext}
            onClick={scrollNext}
            {...props}
        >
            <ArrowRight />
            <span className="sr-only">Next slide</span>
        </Button>
    );
}

export { type CarouselApi, Carousel, CarouselContent, CarouselItem, CarouselPrevious, CarouselNext };
PK
build-template/src/frontend/src/components/ui/chart.tsx'use client';

import * as React from 'react';
import * as RechartsPrimitive from 'recharts';

import { cn } from '@/lib/utils';

// Format: { THEME_NAME: CSS_SELECTOR }
const THEMES = { light: '', dark: '.dark' } as const;

export type ChartConfig = {
    [k in string]: {
        label?: React.ReactNode;
        icon?: React.ComponentType;
    } & ({ color?: string; theme?: never } | { color?: never; theme: Record<keyof typeof THEMES, string> });
};

type ChartContextProps = {
    config: ChartConfig;
};

const ChartContext = React.createContext<ChartContextProps | null>(null);

function useChart() {
    const context = React.useContext(ChartContext);

    if (!context) {
        throw new Error('useChart must be used within a <ChartContainer />');
    }

    return context;
}

function ChartContainer({
    id,
    className,
    children,
    config,
    ...props
}: React.ComponentProps<'div'> & {
    config: ChartConfig;
    children: React.ComponentProps<typeof RechartsPrimitive.ResponsiveContainer>['children'];
}) {
    const uniqueId = React.useId();
    const chartId = `chart-${id || uniqueId.replace(/:/g, '')}`;

    return (
        <ChartContext.Provider value={{ config }}>
            <div
                data-slot="chart"
                data-chart={chartId}
                className={cn(
                    "[&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border flex aspect-video justify-center text-xs [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden",
                    className
                )}
                {...props}
            >
                <ChartStyle id={chartId} config={config} />
                <RechartsPrimitive.ResponsiveContainer>{children}</RechartsPrimitive.ResponsiveContainer>
            </div>
        </ChartContext.Provider>
    );
}

const ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {
    const colorConfig = Object.entries(config).filter(([, config]) => config.theme || config.color);

    if (!colorConfig.length) {
        return null;
    }

    return (
        <style
            dangerouslySetInnerHTML={{
                __html: Object.entries(THEMES)
                    .map(
                        ([theme, prefix]) => `
${prefix} [data-chart=${id}] {
${colorConfig
    .map(([key, itemConfig]) => {
        const color = itemConfig.theme?.[theme as keyof typeof itemConfig.theme] || itemConfig.color;
        return color ? `  --color-${key}: ${color};` : null;
    })
    .join('\n')}
}
`
                    )
                    .join('\n')
            }}
        />
    );
};

const ChartTooltip = RechartsPrimitive.Tooltip;

function ChartTooltipContent({
    active,
    payload,
    className,
    indicator = 'dot',
    hideLabel = false,
    hideIndicator = false,
    label,
    labelFormatter,
    labelClassName,
    formatter,
    color,
    nameKey,
    labelKey
}: React.ComponentProps<typeof RechartsPrimitive.Tooltip> &
    React.ComponentProps<'div'> & {
        hideLabel?: boolean;
        hideIndicator?: boolean;
        indicator?: 'line' | 'dot' | 'dashed';
        nameKey?: string;
        labelKey?: string;
    }) {
    const { config } = useChart();

    const tooltipLabel = React.useMemo(() => {
        if (hideLabel || !payload?.length) {
            return null;
        }

        const [item] = payload;
        const key = `${labelKey || item?.dataKey || item?.name || 'value'}`;
        const itemConfig = getPayloadConfigFromPayload(config, item, key);
        const value =
            !labelKey && typeof label === 'string'
                ? config[label as keyof typeof config]?.label || label
                : itemConfig?.label;

        if (labelFormatter) {
            return <div className={cn('font-medium', labelClassName)}>{labelFormatter(value, payload)}</div>;
        }

        if (!value) {
            return null;
        }

        return <div className={cn('font-medium', labelClassName)}>{value}</div>;
    }, [label, labelFormatter, payload, hideLabel, labelClassName, config, labelKey]);

    if (!active || !payload?.length) {
        return null;
    }

    const nestLabel = payload.length === 1 && indicator !== 'dot';

    return (
        <div
            className={cn(
                'border-border/50 bg-background grid min-w-[8rem] items-start gap-1.5 rounded-lg border px-2.5 py-1.5 text-xs shadow-xl',
                className
            )}
        >
            {!nestLabel ? tooltipLabel : null}
            <div className="grid gap-1.5">
                {payload.map((item, index) => {
                    const key = `${nameKey || item.name || item.dataKey || 'value'}`;
                    const itemConfig = getPayloadConfigFromPayload(config, item, key);
                    const indicatorColor = color || item.payload.fill || item.color;

                    return (
                        <div
                            key={item.dataKey}
                            className={cn(
                                '[&>svg]:text-muted-foreground flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5',
                                indicator === 'dot' && 'items-center'
                            )}
                        >
                            {formatter && item?.value !== undefined && item.name ? (
                                formatter(item.value, item.name, item, index, item.payload)
                            ) : (
                                <>
                                    {itemConfig?.icon ? (
                                        <itemConfig.icon />
                                    ) : (
                                        !hideIndicator && (
                                            <div
                                                className={cn(
                                                    'shrink-0 rounded-[2px] border-(--color-border) bg-(--color-bg)',
                                                    {
                                                        'h-2.5 w-2.5': indicator === 'dot',
                                                        'w-1': indicator === 'line',
                                                        'w-0 border-[1.5px] border-dashed bg-transparent':
                                                            indicator === 'dashed',
                                                        'my-0.5': nestLabel && indicator === 'dashed'
                                                    }
                                                )}
                                                style={
                                                    {
                                                        '--color-bg': indicatorColor,
                                                        '--color-border': indicatorColor
                                                    } as React.CSSProperties
                                                }
                                            />
                                        )
                                    )}
                                    <div
                                        className={cn(
                                            'flex flex-1 justify-between leading-none',
                                            nestLabel ? 'items-end' : 'items-center'
                                        )}
                                    >
                                        <div className="grid gap-1.5">
                                            {nestLabel ? tooltipLabel : null}
                                            <span className="text-muted-foreground">
                                                {itemConfig?.label || item.name}
                                            </span>
                                        </div>
                                        {item.value && (
                                            <span className="text-foreground font-mono font-medium tabular-nums">
                                                {item.value.toLocaleString()}
                                            </span>
                                        )}
                                    </div>
                                </>
                            )}
                        </div>
                    );
                })}
            </div>
        </div>
    );
}

const ChartLegend = RechartsPrimitive.Legend;

function ChartLegendContent({
    className,
    hideIcon = false,
    payload,
    verticalAlign = 'bottom',
    nameKey
}: React.ComponentProps<'div'> &
    Pick<RechartsPrimitive.LegendProps, 'payload' | 'verticalAlign'> & {
        hideIcon?: boolean;
        nameKey?: string;
    }) {
    const { config } = useChart();

    if (!payload?.length) {
        return null;
    }

    return (
        <div
            className={cn(
                'flex items-center justify-center gap-4',
                verticalAlign === 'top' ? 'pb-3' : 'pt-3',
                className
            )}
        >
            {payload.map((item) => {
                const key = `${nameKey || item.dataKey || 'value'}`;
                const itemConfig = getPayloadConfigFromPayload(config, item, key);

                return (
                    <div
                        key={item.value}
                        className={cn(
                            '[&>svg]:text-muted-foreground flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3'
                        )}
                    >
                        {itemConfig?.icon && !hideIcon ? (
                            <itemConfig.icon />
                        ) : (
                            <div
                                className="h-2 w-2 shrink-0 rounded-[2px]"
                                style={{
                                    backgroundColor: item.color
                                }}
                            />
                        )}
                        {itemConfig?.label}
                    </div>
                );
            })}
        </div>
    );
}

// Helper to extract item config from a payload.
function getPayloadConfigFromPayload(config: ChartConfig, payload: unknown, key: string) {
    if (typeof payload !== 'object' || payload === null) {
        return undefined;
    }

    const payloadPayload =
        'payload' in payload && typeof payload.payload === 'object' && payload.payload !== null
            ? payload.payload
            : undefined;

    let configLabelKey: string = key;

    if (key in payload && typeof payload[key as keyof typeof payload] === 'string') {
        configLabelKey = payload[key as keyof typeof payload] as string;
    } else if (
        payloadPayload &&
        key in payloadPayload &&
        typeof payloadPayload[key as keyof typeof payloadPayload] === 'string'
    ) {
        configLabelKey = payloadPayload[key as keyof typeof payloadPayload] as string;
    }

    return configLabelKey in config ? config[configLabelKey] : config[key as keyof typeof config];
}

export { ChartContainer, ChartTooltip, ChartTooltipContent, ChartLegend, ChartLegendContent, ChartStyle };
PK
build-template/src/frontend/src/components/ui/checkbox.tsx'use client';

import * as React from 'react';
import * as CheckboxPrimitive from '@radix-ui/react-checkbox';
import { CheckIcon } from 'lucide-react';

import { cn } from '@/lib/utils';

function Checkbox({ className, ...props }: React.ComponentProps<typeof CheckboxPrimitive.Root>) {
    return (
        <CheckboxPrimitive.Root
            data-slot="checkbox"
            className={cn(
                'peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50',
                className
            )}
            {...props}
        >
            <CheckboxPrimitive.Indicator
                data-slot="checkbox-indicator"
                className="flex items-center justify-center text-current transition-none"
            >
                <CheckIcon className="size-3.5" />
            </CheckboxPrimitive.Indicator>
        </CheckboxPrimitive.Root>
    );
}

export { Checkbox };
PK
build-template/src/frontend/src/components/ui/collapsible.tsx'use client';

import * as CollapsiblePrimitive from '@radix-ui/react-collapsible';

function Collapsible({ ...props }: React.ComponentProps<typeof CollapsiblePrimitive.Root>) {
    return <CollapsiblePrimitive.Root data-slot="collapsible" {...props} />;
}

function CollapsibleTrigger({ ...props }: React.ComponentProps<typeof CollapsiblePrimitive.CollapsibleTrigger>) {
    return <CollapsiblePrimitive.CollapsibleTrigger data-slot="collapsible-trigger" {...props} />;
}

function CollapsibleContent({ ...props }: React.ComponentProps<typeof CollapsiblePrimitive.CollapsibleContent>) {
    return <CollapsiblePrimitive.CollapsibleContent data-slot="collapsible-content" {...props} />;
}

export { Collapsible, CollapsibleTrigger, CollapsibleContent };
PK
build-template/src/frontend/src/components/ui/command.tsx'use client';

import * as React from 'react';
import { Command as CommandPrimitive } from 'cmdk';
import { SearchIcon } from 'lucide-react';

import { cn } from '@/lib/utils';
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from '@/components/ui/dialog';

function Command({ className, ...props }: React.ComponentProps<typeof CommandPrimitive>) {
    return (
        <CommandPrimitive
            data-slot="command"
            className={cn(
                'bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md',
                className
            )}
            {...props}
        />
    );
}

function CommandDialog({
    title = 'Command Palette',
    description = 'Search for a command to run...',
    children,
    className,
    showCloseButton = true,
    ...props
}: React.ComponentProps<typeof Dialog> & {
    title?: string;
    description?: string;
    className?: string;
    showCloseButton?: boolean;
}) {
    return (
        <Dialog {...props}>
            <DialogHeader className="sr-only">
                <DialogTitle>{title}</DialogTitle>
                <DialogDescription>{description}</DialogDescription>
            </DialogHeader>
            <DialogContent className={cn('overflow-hidden p-0', className)} showCloseButton={showCloseButton}>
                <Command className="[&_[cmdk-group-heading]]:text-muted-foreground **:data-[slot=command-input-wrapper]:h-12 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group]]:px-2 [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5">
                    {children}
                </Command>
            </DialogContent>
        </Dialog>
    );
}

function CommandInput({ className, ...props }: React.ComponentProps<typeof CommandPrimitive.Input>) {
    return (
        <div data-slot="command-input-wrapper" className="flex h-9 items-center gap-2 border-b px-3">
            <SearchIcon className="size-4 shrink-0 opacity-50" />
            <CommandPrimitive.Input
                data-slot="command-input"
                className={cn(
                    'placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50',
                    className
                )}
                {...props}
            />
        </div>
    );
}

function CommandList({ className, ...props }: React.ComponentProps<typeof CommandPrimitive.List>) {
    return (
        <CommandPrimitive.List
            data-slot="command-list"
            className={cn('max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto', className)}
            {...props}
        />
    );
}

function CommandEmpty({ ...props }: React.ComponentProps<typeof CommandPrimitive.Empty>) {
    return <CommandPrimitive.Empty data-slot="command-empty" className="py-6 text-center text-sm" {...props} />;
}

function CommandGroup({ className, ...props }: React.ComponentProps<typeof CommandPrimitive.Group>) {
    return (
        <CommandPrimitive.Group
            data-slot="command-group"
            className={cn(
                'text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium',
                className
            )}
            {...props}
        />
    );
}

function CommandSeparator({ className, ...props }: React.ComponentProps<typeof CommandPrimitive.Separator>) {
    return (
        <CommandPrimitive.Separator
            data-slot="command-separator"
            className={cn('bg-border -mx-1 h-px', className)}
            {...props}
        />
    );
}

function CommandItem({ className, ...props }: React.ComponentProps<typeof CommandPrimitive.Item>) {
    return (
        <CommandPrimitive.Item
            data-slot="command-item"
            className={cn(
                "data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
                className
            )}
            {...props}
        />
    );
}

function CommandShortcut({ className, ...props }: React.ComponentProps<'span'>) {
    return (
        <span
            data-slot="command-shortcut"
            className={cn('text-muted-foreground ml-auto text-xs tracking-widest', className)}
            {...props}
        />
    );
}

export {
    Command,
    CommandDialog,
    CommandInput,
    CommandList,
    CommandEmpty,
    CommandGroup,
    CommandItem,
    CommandShortcut,
    CommandSeparator
};
PK
build-template/src/frontend/src/components/ui/context-menu.tsx'use client';

import * as React from 'react';
import * as ContextMenuPrimitive from '@radix-ui/react-context-menu';
import { CheckIcon, ChevronRightIcon, CircleIcon } from 'lucide-react';

import { cn } from '@/lib/utils';

function ContextMenu({ ...props }: React.ComponentProps<typeof ContextMenuPrimitive.Root>) {
    return <ContextMenuPrimitive.Root data-slot="context-menu" {...props} />;
}

function ContextMenuTrigger({ ...props }: React.ComponentProps<typeof ContextMenuPrimitive.Trigger>) {
    return <ContextMenuPrimitive.Trigger data-slot="context-menu-trigger" {...props} />;
}

function ContextMenuGroup({ ...props }: React.ComponentProps<typeof ContextMenuPrimitive.Group>) {
    return <ContextMenuPrimitive.Group data-slot="context-menu-group" {...props} />;
}

function ContextMenuPortal({ ...props }: React.ComponentProps<typeof ContextMenuPrimitive.Portal>) {
    return <ContextMenuPrimitive.Portal data-slot="context-menu-portal" {...props} />;
}

function ContextMenuSub({ ...props }: React.ComponentProps<typeof ContextMenuPrimitive.Sub>) {
    return <ContextMenuPrimitive.Sub data-slot="context-menu-sub" {...props} />;
}

function ContextMenuRadioGroup({ ...props }: React.ComponentProps<typeof ContextMenuPrimitive.RadioGroup>) {
    return <ContextMenuPrimitive.RadioGroup data-slot="context-menu-radio-group" {...props} />;
}

function ContextMenuSubTrigger({
    className,
    inset,
    children,
    ...props
}: React.ComponentProps<typeof ContextMenuPrimitive.SubTrigger> & {
    inset?: boolean;
}) {
    return (
        <ContextMenuPrimitive.SubTrigger
            data-slot="context-menu-sub-trigger"
            data-inset={inset}
            className={cn(
                "focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex cursor-default items-center rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
                className
            )}
            {...props}
        >
            {children}
            <ChevronRightIcon className="ml-auto" />
        </ContextMenuPrimitive.SubTrigger>
    );
}

function ContextMenuSubContent({ className, ...props }: React.ComponentProps<typeof ContextMenuPrimitive.SubContent>) {
    return (
        <ContextMenuPrimitive.SubContent
            data-slot="context-menu-sub-content"
            className={cn(
                'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg',
                className
            )}
            {...props}
        />
    );
}

function ContextMenuContent({ className, ...props }: React.ComponentProps<typeof ContextMenuPrimitive.Content>) {
    return (
        <ContextMenuPrimitive.Portal>
            <ContextMenuPrimitive.Content
                data-slot="context-menu-content"
                className={cn(
                    'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md',
                    className
                )}
                {...props}
            />
        </ContextMenuPrimitive.Portal>
    );
}

function ContextMenuItem({
    className,
    inset,
    variant = 'default',
    ...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Item> & {
    inset?: boolean;
    variant?: 'default' | 'destructive';
}) {
    return (
        <ContextMenuPrimitive.Item
            data-slot="context-menu-item"
            data-inset={inset}
            data-variant={variant}
            className={cn(
                "focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
                className
            )}
            {...props}
        />
    );
}

function ContextMenuCheckboxItem({
    className,
    children,
    checked,
    ...props
}: React.ComponentProps<typeof ContextMenuPrimitive.CheckboxItem>) {
    return (
        <ContextMenuPrimitive.CheckboxItem
            data-slot="context-menu-checkbox-item"
            className={cn(
                "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
                className
            )}
            checked={checked}
            {...props}
        >
            <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
                <ContextMenuPrimitive.ItemIndicator>
                    <CheckIcon className="size-4" />
                </ContextMenuPrimitive.ItemIndicator>
            </span>
            {children}
        </ContextMenuPrimitive.CheckboxItem>
    );
}

function ContextMenuRadioItem({
    className,
    children,
    ...props
}: React.ComponentProps<typeof ContextMenuPrimitive.RadioItem>) {
    return (
        <ContextMenuPrimitive.RadioItem
            data-slot="context-menu-radio-item"
            className={cn(
                "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
                className
            )}
            {...props}
        >
            <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
                <ContextMenuPrimitive.ItemIndicator>
                    <CircleIcon className="size-2 fill-current" />
                </ContextMenuPrimitive.ItemIndicator>
            </span>
            {children}
        </ContextMenuPrimitive.RadioItem>
    );
}

function ContextMenuLabel({
    className,
    inset,
    ...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Label> & {
    inset?: boolean;
}) {
    return (
        <ContextMenuPrimitive.Label
            data-slot="context-menu-label"
            data-inset={inset}
            className={cn('text-foreground px-2 py-1.5 text-sm font-medium data-[inset]:pl-8', className)}
            {...props}
        />
    );
}

function ContextMenuSeparator({ className, ...props }: React.ComponentProps<typeof ContextMenuPrimitive.Separator>) {
    return (
        <ContextMenuPrimitive.Separator
            data-slot="context-menu-separator"
            className={cn('bg-border -mx-1 my-1 h-px', className)}
            {...props}
        />
    );
}

function ContextMenuShortcut({ className, ...props }: React.ComponentProps<'span'>) {
    return (
        <span
            data-slot="context-menu-shortcut"
            className={cn('text-muted-foreground ml-auto text-xs tracking-widest', className)}
            {...props}
        />
    );
}

export {
    ContextMenu,
    ContextMenuTrigger,
    ContextMenuContent,
    ContextMenuItem,
    ContextMenuCheckboxItem,
    ContextMenuRadioItem,
    ContextMenuLabel,
    ContextMenuSeparator,
    ContextMenuShortcut,
    ContextMenuGroup,
    ContextMenuPortal,
    ContextMenuSub,
    ContextMenuSubContent,
    ContextMenuSubTrigger,
    ContextMenuRadioGroup
};
PK
build-template/src/frontend/src/components/ui/dialog.tsx'use client';

import * as React from 'react';
import * as DialogPrimitive from '@radix-ui/react-dialog';
import { XIcon } from 'lucide-react';

import { cn } from '@/lib/utils';

function Dialog({ ...props }: React.ComponentProps<typeof DialogPrimitive.Root>) {
    return <DialogPrimitive.Root data-slot="dialog" {...props} />;
}

function DialogTrigger({ ...props }: React.ComponentProps<typeof DialogPrimitive.Trigger>) {
    return <DialogPrimitive.Trigger data-slot="dialog-trigger" {...props} />;
}

function DialogPortal({ ...props }: React.ComponentProps<typeof DialogPrimitive.Portal>) {
    return <DialogPrimitive.Portal data-slot="dialog-portal" {...props} />;
}

function DialogClose({ ...props }: React.ComponentProps<typeof DialogPrimitive.Close>) {
    return <DialogPrimitive.Close data-slot="dialog-close" {...props} />;
}

function DialogOverlay({ className, ...props }: React.ComponentProps<typeof DialogPrimitive.Overlay>) {
    return (
        <DialogPrimitive.Overlay
            data-slot="dialog-overlay"
            className={cn(
                'data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50',
                className
            )}
            {...props}
        />
    );
}

function DialogContent({
    className,
    children,
    showCloseButton = true,
    ...props
}: React.ComponentProps<typeof DialogPrimitive.Content> & {
    showCloseButton?: boolean;
}) {
    return (
        <DialogPortal data-slot="dialog-portal">
            <DialogOverlay />
            <DialogPrimitive.Content
                data-slot="dialog-content"
                className={cn(
                    'bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg',
                    className
                )}
                {...props}
            >
                {children}
                {showCloseButton && (
                    <DialogPrimitive.Close
                        data-slot="dialog-close"
                        className="ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4"
                    >
                        <XIcon />
                        <span className="sr-only">Close</span>
                    </DialogPrimitive.Close>
                )}
            </DialogPrimitive.Content>
        </DialogPortal>
    );
}

function DialogHeader({ className, ...props }: React.ComponentProps<'div'>) {
    return (
        <div
            data-slot="dialog-header"
            className={cn('flex flex-col gap-2 text-center sm:text-left', className)}
            {...props}
        />
    );
}

function DialogFooter({ className, ...props }: React.ComponentProps<'div'>) {
    return (
        <div
            data-slot="dialog-footer"
            className={cn('flex flex-col-reverse gap-2 sm:flex-row sm:justify-end', className)}
            {...props}
        />
    );
}

function DialogTitle({ className, ...props }: React.ComponentProps<typeof DialogPrimitive.Title>) {
    return (
        <DialogPrimitive.Title
            data-slot="dialog-title"
            className={cn('text-lg leading-none font-semibold', className)}
            {...props}
        />
    );
}

function DialogDescription({ className, ...props }: React.ComponentProps<typeof DialogPrimitive.Description>) {
    return (
        <DialogPrimitive.Description
            data-slot="dialog-description"
            className={cn('text-muted-foreground text-sm', className)}
            {...props}
        />
    );
}

export {
    Dialog,
    DialogClose,
    DialogContent,
    DialogDescription,
    DialogFooter,
    DialogHeader,
    DialogOverlay,
    DialogPortal,
    DialogTitle,
    DialogTrigger
};
PK
build-template/src/frontend/src/components/ui/drawer.tsx'use client';

import * as React from 'react';
import { Drawer as DrawerPrimitive } from 'vaul';

import { cn } from '@/lib/utils';

function Drawer({ ...props }: React.ComponentProps<typeof DrawerPrimitive.Root>) {
    return <DrawerPrimitive.Root data-slot="drawer" {...props} />;
}

function DrawerTrigger({ ...props }: React.ComponentProps<typeof DrawerPrimitive.Trigger>) {
    return <DrawerPrimitive.Trigger data-slot="drawer-trigger" {...props} />;
}

function DrawerPortal({ ...props }: React.ComponentProps<typeof DrawerPrimitive.Portal>) {
    return <DrawerPrimitive.Portal data-slot="drawer-portal" {...props} />;
}

function DrawerClose({ ...props }: React.ComponentProps<typeof DrawerPrimitive.Close>) {
    return <DrawerPrimitive.Close data-slot="drawer-close" {...props} />;
}

function DrawerOverlay({ className, ...props }: React.ComponentProps<typeof DrawerPrimitive.Overlay>) {
    return (
        <DrawerPrimitive.Overlay
            data-slot="drawer-overlay"
            className={cn(
                'data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50',
                className
            )}
            {...props}
        />
    );
}

function DrawerContent({ className, children, ...props }: React.ComponentProps<typeof DrawerPrimitive.Content>) {
    return (
        <DrawerPortal data-slot="drawer-portal">
            <DrawerOverlay />
            <DrawerPrimitive.Content
                data-slot="drawer-content"
                className={cn(
                    'group/drawer-content bg-background fixed z-50 flex h-auto flex-col',
                    'data-[vaul-drawer-direction=top]:inset-x-0 data-[vaul-drawer-direction=top]:top-0 data-[vaul-drawer-direction=top]:mb-24 data-[vaul-drawer-direction=top]:max-h-[80vh] data-[vaul-drawer-direction=top]:rounded-b-lg data-[vaul-drawer-direction=top]:border-b',
                    'data-[vaul-drawer-direction=bottom]:inset-x-0 data-[vaul-drawer-direction=bottom]:bottom-0 data-[vaul-drawer-direction=bottom]:mt-24 data-[vaul-drawer-direction=bottom]:max-h-[80vh] data-[vaul-drawer-direction=bottom]:rounded-t-lg data-[vaul-drawer-direction=bottom]:border-t',
                    'data-[vaul-drawer-direction=right]:inset-y-0 data-[vaul-drawer-direction=right]:right-0 data-[vaul-drawer-direction=right]:w-3/4 data-[vaul-drawer-direction=right]:border-l data-[vaul-drawer-direction=right]:sm:max-w-sm',
                    'data-[vaul-drawer-direction=left]:inset-y-0 data-[vaul-drawer-direction=left]:left-0 data-[vaul-drawer-direction=left]:w-3/4 data-[vaul-drawer-direction=left]:border-r data-[vaul-drawer-direction=left]:sm:max-w-sm',
                    className
                )}
                {...props}
            >
                <div className="bg-muted mx-auto mt-4 hidden h-2 w-[100px] shrink-0 rounded-full group-data-[vaul-drawer-direction=bottom]/drawer-content:block" />
                {children}
            </DrawerPrimitive.Content>
        </DrawerPortal>
    );
}

function DrawerHeader({ className, ...props }: React.ComponentProps<'div'>) {
    return (
        <div
            data-slot="drawer-header"
            className={cn(
                'flex flex-col gap-0.5 p-4 group-data-[vaul-drawer-direction=bottom]/drawer-content:text-center group-data-[vaul-drawer-direction=top]/drawer-content:text-center md:gap-1.5 md:text-left',
                className
            )}
            {...props}
        />
    );
}

function DrawerFooter({ className, ...props }: React.ComponentProps<'div'>) {
    return <div data-slot="drawer-footer" className={cn('mt-auto flex flex-col gap-2 p-4', className)} {...props} />;
}

function DrawerTitle({ className, ...props }: React.ComponentProps<typeof DrawerPrimitive.Title>) {
    return (
        <DrawerPrimitive.Title
            data-slot="drawer-title"
            className={cn('text-foreground font-semibold', className)}
            {...props}
        />
    );
}

function DrawerDescription({ className, ...props }: React.ComponentProps<typeof DrawerPrimitive.Description>) {
    return (
        <DrawerPrimitive.Description
            data-slot="drawer-description"
            className={cn('text-muted-foreground text-sm', className)}
            {...props}
        />
    );
}

export {
    Drawer,
    DrawerPortal,
    DrawerOverlay,
    DrawerTrigger,
    DrawerClose,
    DrawerContent,
    DrawerHeader,
    DrawerFooter,
    DrawerTitle,
    DrawerDescription
};
PK
build-template/src/frontend/src/components/ui/dropdown-menu.tsx'use client';

import * as React from 'react';
import * as DropdownMenuPrimitive from '@radix-ui/react-dropdown-menu';
import { CheckIcon, ChevronRightIcon, CircleIcon } from 'lucide-react';

import { cn } from '@/lib/utils';

function DropdownMenu({ ...props }: React.ComponentProps<typeof DropdownMenuPrimitive.Root>) {
    return <DropdownMenuPrimitive.Root data-slot="dropdown-menu" {...props} />;
}

function DropdownMenuPortal({ ...props }: React.ComponentProps<typeof DropdownMenuPrimitive.Portal>) {
    return <DropdownMenuPrimitive.Portal data-slot="dropdown-menu-portal" {...props} />;
}

function DropdownMenuTrigger({ ...props }: React.ComponentProps<typeof DropdownMenuPrimitive.Trigger>) {
    return <DropdownMenuPrimitive.Trigger data-slot="dropdown-menu-trigger" {...props} />;
}

function DropdownMenuContent({
    className,
    sideOffset = 4,
    ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Content>) {
    return (
        <DropdownMenuPrimitive.Portal>
            <DropdownMenuPrimitive.Content
                data-slot="dropdown-menu-content"
                sideOffset={sideOffset}
                className={cn(
                    'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md',
                    className
                )}
                {...props}
            />
        </DropdownMenuPrimitive.Portal>
    );
}

function DropdownMenuGroup({ ...props }: React.ComponentProps<typeof DropdownMenuPrimitive.Group>) {
    return <DropdownMenuPrimitive.Group data-slot="dropdown-menu-group" {...props} />;
}

function DropdownMenuItem({
    className,
    inset,
    variant = 'default',
    ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Item> & {
    inset?: boolean;
    variant?: 'default' | 'destructive';
}) {
    return (
        <DropdownMenuPrimitive.Item
            data-slot="dropdown-menu-item"
            data-inset={inset}
            data-variant={variant}
            className={cn(
                "focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
                className
            )}
            {...props}
        />
    );
}

function DropdownMenuCheckboxItem({
    className,
    children,
    checked,
    ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.CheckboxItem>) {
    return (
        <DropdownMenuPrimitive.CheckboxItem
            data-slot="dropdown-menu-checkbox-item"
            className={cn(
                "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
                className
            )}
            checked={checked}
            {...props}
        >
            <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
                <DropdownMenuPrimitive.ItemIndicator>
                    <CheckIcon className="size-4" />
                </DropdownMenuPrimitive.ItemIndicator>
            </span>
            {children}
        </DropdownMenuPrimitive.CheckboxItem>
    );
}

function DropdownMenuRadioGroup({ ...props }: React.ComponentProps<typeof DropdownMenuPrimitive.RadioGroup>) {
    return <DropdownMenuPrimitive.RadioGroup data-slot="dropdown-menu-radio-group" {...props} />;
}

function DropdownMenuRadioItem({
    className,
    children,
    ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioItem>) {
    return (
        <DropdownMenuPrimitive.RadioItem
            data-slot="dropdown-menu-radio-item"
            className={cn(
                "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
                className
            )}
            {...props}
        >
            <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
                <DropdownMenuPrimitive.ItemIndicator>
                    <CircleIcon className="size-2 fill-current" />
                </DropdownMenuPrimitive.ItemIndicator>
            </span>
            {children}
        </DropdownMenuPrimitive.RadioItem>
    );
}

function DropdownMenuLabel({
    className,
    inset,
    ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Label> & {
    inset?: boolean;
}) {
    return (
        <DropdownMenuPrimitive.Label
            data-slot="dropdown-menu-label"
            data-inset={inset}
            className={cn('px-2 py-1.5 text-sm font-medium data-[inset]:pl-8', className)}
            {...props}
        />
    );
}

function DropdownMenuSeparator({ className, ...props }: React.ComponentProps<typeof DropdownMenuPrimitive.Separator>) {
    return (
        <DropdownMenuPrimitive.Separator
            data-slot="dropdown-menu-separator"
            className={cn('bg-border -mx-1 my-1 h-px', className)}
            {...props}
        />
    );
}

function DropdownMenuShortcut({ className, ...props }: React.ComponentProps<'span'>) {
    return (
        <span
            data-slot="dropdown-menu-shortcut"
            className={cn('text-muted-foreground ml-auto text-xs tracking-widest', className)}
            {...props}
        />
    );
}

function DropdownMenuSub({ ...props }: React.ComponentProps<typeof DropdownMenuPrimitive.Sub>) {
    return <DropdownMenuPrimitive.Sub data-slot="dropdown-menu-sub" {...props} />;
}

function DropdownMenuSubTrigger({
    className,
    inset,
    children,
    ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.SubTrigger> & {
    inset?: boolean;
}) {
    return (
        <DropdownMenuPrimitive.SubTrigger
            data-slot="dropdown-menu-sub-trigger"
            data-inset={inset}
            className={cn(
                'focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex cursor-default items-center rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8',
                className
            )}
            {...props}
        >
            {children}
            <ChevronRightIcon className="ml-auto size-4" />
        </DropdownMenuPrimitive.SubTrigger>
    );
}

function DropdownMenuSubContent({
    className,
    ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.SubContent>) {
    return (
        <DropdownMenuPrimitive.SubContent
            data-slot="dropdown-menu-sub-content"
            className={cn(
                'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg',
                className
            )}
            {...props}
        />
    );
}

export {
    DropdownMenu,
    DropdownMenuPortal,
    DropdownMenuTrigger,
    DropdownMenuContent,
    DropdownMenuGroup,
    DropdownMenuLabel,
    DropdownMenuItem,
    DropdownMenuCheckboxItem,
    DropdownMenuRadioGroup,
    DropdownMenuRadioItem,
    DropdownMenuSeparator,
    DropdownMenuShortcut,
    DropdownMenuSub,
    DropdownMenuSubTrigger,
    DropdownMenuSubContent
};
PK
build-template/src/frontend/src/components/ui/form.tsx'use client';

import * as React from 'react';
import * as LabelPrimitive from '@radix-ui/react-label';
import { Slot } from '@radix-ui/react-slot';
import {
    Controller,
    FormProvider,
    useFormContext,
    useFormState,
    type ControllerProps,
    type FieldPath,
    type FieldValues
} from 'react-hook-form';

import { cn } from '@/lib/utils';
import { Label } from '@/components/ui/label';

const Form = FormProvider;

type FormFieldContextValue<
    TFieldValues extends FieldValues = FieldValues,
    TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>
> = {
    name: TName;
};

const FormFieldContext = React.createContext<FormFieldContextValue>({} as FormFieldContextValue);

const FormField = <
    TFieldValues extends FieldValues = FieldValues,
    TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>
>({
    ...props
}: ControllerProps<TFieldValues, TName>) => {
    return (
        <FormFieldContext.Provider value={{ name: props.name }}>
            <Controller {...props} />
        </FormFieldContext.Provider>
    );
};

const useFormField = () => {
    const fieldContext = React.useContext(FormFieldContext);
    const itemContext = React.useContext(FormItemContext);
    const { getFieldState } = useFormContext();
    const formState = useFormState({ name: fieldContext.name });
    const fieldState = getFieldState(fieldContext.name, formState);

    if (!fieldContext) {
        throw new Error('useFormField should be used within <FormField>');
    }

    const { id } = itemContext;

    return {
        id,
        name: fieldContext.name,
        formItemId: `${id}-form-item`,
        formDescriptionId: `${id}-form-item-description`,
        formMessageId: `${id}-form-item-message`,
        ...fieldState
    };
};

type FormItemContextValue = {
    id: string;
};

const FormItemContext = React.createContext<FormItemContextValue>({} as FormItemContextValue);

function FormItem({ className, ...props }: React.ComponentProps<'div'>) {
    const id = React.useId();

    return (
        <FormItemContext.Provider value={{ id }}>
            <div data-slot="form-item" className={cn('grid gap-2', className)} {...props} />
        </FormItemContext.Provider>
    );
}

function FormLabel({ className, ...props }: React.ComponentProps<typeof LabelPrimitive.Root>) {
    const { error, formItemId } = useFormField();

    return (
        <Label
            data-slot="form-label"
            data-error={!!error}
            className={cn('data-[error=true]:text-destructive', className)}
            htmlFor={formItemId}
            {...props}
        />
    );
}

function FormControl({ ...props }: React.ComponentProps<typeof Slot>) {
    const { error, formItemId, formDescriptionId, formMessageId } = useFormField();

    return (
        <Slot
            data-slot="form-control"
            id={formItemId}
            aria-describedby={!error ? `${formDescriptionId}` : `${formDescriptionId} ${formMessageId}`}
            aria-invalid={!!error}
            {...props}
        />
    );
}

function FormDescription({ className, ...props }: React.ComponentProps<'p'>) {
    const { formDescriptionId } = useFormField();

    return (
        <p
            data-slot="form-description"
            id={formDescriptionId}
            className={cn('text-muted-foreground text-sm', className)}
            {...props}
        />
    );
}

function FormMessage({ className, ...props }: React.ComponentProps<'p'>) {
    const { error, formMessageId } = useFormField();
    const body = error ? String(error?.message ?? '') : props.children;

    if (!body) {
        return null;
    }

    return (
        <p data-slot="form-message" id={formMessageId} className={cn('text-destructive text-sm', className)} {...props}>
            {body}
        </p>
    );
}

export { useFormField, Form, FormItem, FormLabel, FormControl, FormDescription, FormMessage, FormField };
PK
build-template/src/frontend/src/components/ui/hover-card.tsx'use client';

import * as React from 'react';
import * as HoverCardPrimitive from '@radix-ui/react-hover-card';

import { cn } from '@/lib/utils';

function HoverCard({ ...props }: React.ComponentProps<typeof HoverCardPrimitive.Root>) {
    return <HoverCardPrimitive.Root data-slot="hover-card" {...props} />;
}

function HoverCardTrigger({ ...props }: React.ComponentProps<typeof HoverCardPrimitive.Trigger>) {
    return <HoverCardPrimitive.Trigger data-slot="hover-card-trigger" {...props} />;
}

function HoverCardContent({
    className,
    align = 'center',
    sideOffset = 4,
    ...props
}: React.ComponentProps<typeof HoverCardPrimitive.Content>) {
    return (
        <HoverCardPrimitive.Portal data-slot="hover-card-portal">
            <HoverCardPrimitive.Content
                data-slot="hover-card-content"
                align={align}
                sideOffset={sideOffset}
                className={cn(
                    'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-64 origin-(--radix-hover-card-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden',
                    className
                )}
                {...props}
            />
        </HoverCardPrimitive.Portal>
    );
}

export { HoverCard, HoverCardTrigger, HoverCardContent };
PK
build-template/src/frontend/src/components/ui/input-otp.tsx'use client';

import * as React from 'react';
import { OTPInput, OTPInputContext } from 'input-otp';
import { MinusIcon } from 'lucide-react';

import { cn } from '@/lib/utils';

function InputOTP({
    className,
    containerClassName,
    ...props
}: React.ComponentProps<typeof OTPInput> & {
    containerClassName?: string;
}) {
    return (
        <OTPInput
            data-slot="input-otp"
            containerClassName={cn('flex items-center gap-2 has-disabled:opacity-50', containerClassName)}
            className={cn('disabled:cursor-not-allowed', className)}
            {...props}
        />
    );
}

function InputOTPGroup({ className, ...props }: React.ComponentProps<'div'>) {
    return <div data-slot="input-otp-group" className={cn('flex items-center', className)} {...props} />;
}

function InputOTPSlot({
    index,
    className,
    ...props
}: React.ComponentProps<'div'> & {
    index: number;
}) {
    const inputOTPContext = React.useContext(OTPInputContext);
    const { char, hasFakeCaret, isActive } = inputOTPContext?.slots[index] ?? {};

    return (
        <div
            data-slot="input-otp-slot"
            data-active={isActive}
            className={cn(
                'data-[active=true]:border-ring data-[active=true]:ring-ring/50 data-[active=true]:aria-invalid:ring-destructive/20 dark:data-[active=true]:aria-invalid:ring-destructive/40 aria-invalid:border-destructive data-[active=true]:aria-invalid:border-destructive dark:bg-input/30 border-input relative flex h-9 w-9 items-center justify-center border-y border-r text-sm shadow-xs transition-all outline-none first:rounded-l-md first:border-l last:rounded-r-md data-[active=true]:z-10 data-[active=true]:ring-[3px]',
                className
            )}
            {...props}
        >
            {char}
            {hasFakeCaret && (
                <div className="pointer-events-none absolute inset-0 flex items-center justify-center">
                    <div className="animate-caret-blink bg-foreground h-4 w-px duration-1000" />
                </div>
            )}
        </div>
    );
}

function InputOTPSeparator({ ...props }: React.ComponentProps<'div'>) {
    return (
        <div data-slot="input-otp-separator" role="separator" {...props}>
            <MinusIcon />
        </div>
    );
}

export { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator };
PK
build-template/src/frontend/src/components/ui/input.tsximport * as React from 'react';

import { cn } from '@/lib/utils';

function Input({ className, type, ...props }: React.ComponentProps<'input'>) {
    return (
        <input
            type={type}
            data-slot="input"
            className={cn(
                'file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',
                'focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]',
                'aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive',
                className
            )}
            {...props}
        />
    );
}

export { Input };
PK
build-template/src/frontend/src/components/ui/label.tsx'use client';

import * as React from 'react';
import * as LabelPrimitive from '@radix-ui/react-label';

import { cn } from '@/lib/utils';

function Label({ className, ...props }: React.ComponentProps<typeof LabelPrimitive.Root>) {
    return (
        <LabelPrimitive.Root
            data-slot="label"
            className={cn(
                'flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50',
                className
            )}
            {...props}
        />
    );
}

export { Label };
PK
build-template/src/frontend/src/components/ui/menubar.tsx'use client';

import * as React from 'react';
import * as MenubarPrimitive from '@radix-ui/react-menubar';
import { CheckIcon, ChevronRightIcon, CircleIcon } from 'lucide-react';

import { cn } from '@/lib/utils';

function Menubar({ className, ...props }: React.ComponentProps<typeof MenubarPrimitive.Root>) {
    return (
        <MenubarPrimitive.Root
            data-slot="menubar"
            className={cn('bg-background flex h-9 items-center gap-1 rounded-md border p-1 shadow-xs', className)}
            {...props}
        />
    );
}

function MenubarMenu({ ...props }: React.ComponentProps<typeof MenubarPrimitive.Menu>) {
    return <MenubarPrimitive.Menu data-slot="menubar-menu" {...props} />;
}

function MenubarGroup({ ...props }: React.ComponentProps<typeof MenubarPrimitive.Group>) {
    return <MenubarPrimitive.Group data-slot="menubar-group" {...props} />;
}

function MenubarPortal({ ...props }: React.ComponentProps<typeof MenubarPrimitive.Portal>) {
    return <MenubarPrimitive.Portal data-slot="menubar-portal" {...props} />;
}

function MenubarRadioGroup({ ...props }: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {
    return <MenubarPrimitive.RadioGroup data-slot="menubar-radio-group" {...props} />;
}

function MenubarTrigger({ className, ...props }: React.ComponentProps<typeof MenubarPrimitive.Trigger>) {
    return (
        <MenubarPrimitive.Trigger
            data-slot="menubar-trigger"
            className={cn(
                'focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex items-center rounded-sm px-2 py-1 text-sm font-medium outline-hidden select-none',
                className
            )}
            {...props}
        />
    );
}

function MenubarContent({
    className,
    align = 'start',
    alignOffset = -4,
    sideOffset = 8,
    ...props
}: React.ComponentProps<typeof MenubarPrimitive.Content>) {
    return (
        <MenubarPortal>
            <MenubarPrimitive.Content
                data-slot="menubar-content"
                align={align}
                alignOffset={alignOffset}
                sideOffset={sideOffset}
                className={cn(
                    'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[12rem] origin-(--radix-menubar-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-md',
                    className
                )}
                {...props}
            />
        </MenubarPortal>
    );
}

function MenubarItem({
    className,
    inset,
    variant = 'default',
    ...props
}: React.ComponentProps<typeof MenubarPrimitive.Item> & {
    inset?: boolean;
    variant?: 'default' | 'destructive';
}) {
    return (
        <MenubarPrimitive.Item
            data-slot="menubar-item"
            data-inset={inset}
            data-variant={variant}
            className={cn(
                "focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
                className
            )}
            {...props}
        />
    );
}

function MenubarCheckboxItem({
    className,
    children,
    checked,
    ...props
}: React.ComponentProps<typeof MenubarPrimitive.CheckboxItem>) {
    return (
        <MenubarPrimitive.CheckboxItem
            data-slot="menubar-checkbox-item"
            className={cn(
                "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-xs py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
                className
            )}
            checked={checked}
            {...props}
        >
            <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
                <MenubarPrimitive.ItemIndicator>
                    <CheckIcon className="size-4" />
                </MenubarPrimitive.ItemIndicator>
            </span>
            {children}
        </MenubarPrimitive.CheckboxItem>
    );
}

function MenubarRadioItem({ className, children, ...props }: React.ComponentProps<typeof MenubarPrimitive.RadioItem>) {
    return (
        <MenubarPrimitive.RadioItem
            data-slot="menubar-radio-item"
            className={cn(
                "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-xs py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
                className
            )}
            {...props}
        >
            <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
                <MenubarPrimitive.ItemIndicator>
                    <CircleIcon className="size-2 fill-current" />
                </MenubarPrimitive.ItemIndicator>
            </span>
            {children}
        </MenubarPrimitive.RadioItem>
    );
}

function MenubarLabel({
    className,
    inset,
    ...props
}: React.ComponentProps<typeof MenubarPrimitive.Label> & {
    inset?: boolean;
}) {
    return (
        <MenubarPrimitive.Label
            data-slot="menubar-label"
            data-inset={inset}
            className={cn('px-2 py-1.5 text-sm font-medium data-[inset]:pl-8', className)}
            {...props}
        />
    );
}

function MenubarSeparator({ className, ...props }: React.ComponentProps<typeof MenubarPrimitive.Separator>) {
    return (
        <MenubarPrimitive.Separator
            data-slot="menubar-separator"
            className={cn('bg-border -mx-1 my-1 h-px', className)}
            {...props}
        />
    );
}

function MenubarShortcut({ className, ...props }: React.ComponentProps<'span'>) {
    return (
        <span
            data-slot="menubar-shortcut"
            className={cn('text-muted-foreground ml-auto text-xs tracking-widest', className)}
            {...props}
        />
    );
}

function MenubarSub({ ...props }: React.ComponentProps<typeof MenubarPrimitive.Sub>) {
    return <MenubarPrimitive.Sub data-slot="menubar-sub" {...props} />;
}

function MenubarSubTrigger({
    className,
    inset,
    children,
    ...props
}: React.ComponentProps<typeof MenubarPrimitive.SubTrigger> & {
    inset?: boolean;
}) {
    return (
        <MenubarPrimitive.SubTrigger
            data-slot="menubar-sub-trigger"
            data-inset={inset}
            className={cn(
                'focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex cursor-default items-center rounded-sm px-2 py-1.5 text-sm outline-none select-none data-[inset]:pl-8',
                className
            )}
            {...props}
        >
            {children}
            <ChevronRightIcon className="ml-auto h-4 w-4" />
        </MenubarPrimitive.SubTrigger>
    );
}

function MenubarSubContent({ className, ...props }: React.ComponentProps<typeof MenubarPrimitive.SubContent>) {
    return (
        <MenubarPrimitive.SubContent
            data-slot="menubar-sub-content"
            className={cn(
                'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-menubar-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg',
                className
            )}
            {...props}
        />
    );
}

export {
    Menubar,
    MenubarPortal,
    MenubarMenu,
    MenubarTrigger,
    MenubarContent,
    MenubarGroup,
    MenubarSeparator,
    MenubarLabel,
    MenubarItem,
    MenubarShortcut,
    MenubarCheckboxItem,
    MenubarRadioGroup,
    MenubarRadioItem,
    MenubarSub,
    MenubarSubTrigger,
    MenubarSubContent
};
PK
build-template/src/frontend/src/components/ui/navigation-menu.tsximport * as React from 'react';
import * as NavigationMenuPrimitive from '@radix-ui/react-navigation-menu';
import { cva } from 'class-variance-authority';
import { ChevronDownIcon } from 'lucide-react';

import { cn } from '@/lib/utils';

function NavigationMenu({
    className,
    children,
    viewport = true,
    ...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.Root> & {
    viewport?: boolean;
}) {
    return (
        <NavigationMenuPrimitive.Root
            data-slot="navigation-menu"
            data-viewport={viewport}
            className={cn(
                'group/navigation-menu relative flex max-w-max flex-1 items-center justify-center',
                className
            )}
            {...props}
        >
            {children}
            {viewport && <NavigationMenuViewport />}
        </NavigationMenuPrimitive.Root>
    );
}

function NavigationMenuList({ className, ...props }: React.ComponentProps<typeof NavigationMenuPrimitive.List>) {
    return (
        <NavigationMenuPrimitive.List
            data-slot="navigation-menu-list"
            className={cn('group flex flex-1 list-none items-center justify-center gap-1', className)}
            {...props}
        />
    );
}

function NavigationMenuItem({ className, ...props }: React.ComponentProps<typeof NavigationMenuPrimitive.Item>) {
    return (
        <NavigationMenuPrimitive.Item
            data-slot="navigation-menu-item"
            className={cn('relative', className)}
            {...props}
        />
    );
}

const navigationMenuTriggerStyle = cva(
    'group inline-flex h-9 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=open]:hover:bg-accent data-[state=open]:text-accent-foreground data-[state=open]:focus:bg-accent data-[state=open]:bg-accent/50 focus-visible:ring-ring/50 outline-none transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1'
);

function NavigationMenuTrigger({
    className,
    children,
    ...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.Trigger>) {
    return (
        <NavigationMenuPrimitive.Trigger
            data-slot="navigation-menu-trigger"
            className={cn(navigationMenuTriggerStyle(), 'group', className)}
            {...props}
        >
            {children}{' '}
            <ChevronDownIcon
                className="relative top-[1px] ml-1 size-3 transition duration-300 group-data-[state=open]:rotate-180"
                aria-hidden="true"
            />
        </NavigationMenuPrimitive.Trigger>
    );
}

function NavigationMenuContent({ className, ...props }: React.ComponentProps<typeof NavigationMenuPrimitive.Content>) {
    return (
        <NavigationMenuPrimitive.Content
            data-slot="navigation-menu-content"
            className={cn(
                'data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 top-0 left-0 w-full p-2 pr-2.5 md:absolute md:w-auto',
                'group-data-[viewport=false]/navigation-menu:bg-popover group-data-[viewport=false]/navigation-menu:text-popover-foreground group-data-[viewport=false]/navigation-menu:data-[state=open]:animate-in group-data-[viewport=false]/navigation-menu:data-[state=closed]:animate-out group-data-[viewport=false]/navigation-menu:data-[state=closed]:zoom-out-95 group-data-[viewport=false]/navigation-menu:data-[state=open]:zoom-in-95 group-data-[viewport=false]/navigation-menu:data-[state=open]:fade-in-0 group-data-[viewport=false]/navigation-menu:data-[state=closed]:fade-out-0 group-data-[viewport=false]/navigation-menu:top-full group-data-[viewport=false]/navigation-menu:mt-1.5 group-data-[viewport=false]/navigation-menu:overflow-hidden group-data-[viewport=false]/navigation-menu:rounded-md group-data-[viewport=false]/navigation-menu:border group-data-[viewport=false]/navigation-menu:shadow group-data-[viewport=false]/navigation-menu:duration-200 **:data-[slot=navigation-menu-link]:focus:ring-0 **:data-[slot=navigation-menu-link]:focus:outline-none',
                className
            )}
            {...props}
        />
    );
}

function NavigationMenuViewport({
    className,
    ...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.Viewport>) {
    return (
        <div className={cn('absolute top-full left-0 isolate z-50 flex justify-center')}>
            <NavigationMenuPrimitive.Viewport
                data-slot="navigation-menu-viewport"
                className={cn(
                    'origin-top-center bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border shadow md:w-[var(--radix-navigation-menu-viewport-width)]',
                    className
                )}
                {...props}
            />
        </div>
    );
}

function NavigationMenuLink({ className, ...props }: React.ComponentProps<typeof NavigationMenuPrimitive.Link>) {
    return (
        <NavigationMenuPrimitive.Link
            data-slot="navigation-menu-link"
            className={cn(
                "data-[active=true]:focus:bg-accent data-[active=true]:hover:bg-accent data-[active=true]:bg-accent/50 data-[active=true]:text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus-visible:ring-ring/50 [&_svg:not([class*='text-'])]:text-muted-foreground flex flex-col gap-1 rounded-sm p-2 text-sm transition-all outline-none focus-visible:ring-[3px] focus-visible:outline-1 [&_svg:not([class*='size-'])]:size-4",
                className
            )}
            {...props}
        />
    );
}

function NavigationMenuIndicator({
    className,
    ...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.Indicator>) {
    return (
        <NavigationMenuPrimitive.Indicator
            data-slot="navigation-menu-indicator"
            className={cn(
                'data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden',
                className
            )}
            {...props}
        >
            <div className="bg-border relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm shadow-md" />
        </NavigationMenuPrimitive.Indicator>
    );
}

export {
    NavigationMenu,
    NavigationMenuList,
    NavigationMenuItem,
    NavigationMenuContent,
    NavigationMenuTrigger,
    NavigationMenuLink,
    NavigationMenuIndicator,
    NavigationMenuViewport,
    navigationMenuTriggerStyle
};
PK
build-template/src/frontend/src/components/ui/pagination.tsximport * as React from 'react';
import { ChevronLeftIcon, ChevronRightIcon, MoreHorizontalIcon } from 'lucide-react';

import { cn } from '@/lib/utils';
import { Button, buttonVariants } from '@/components/ui/button';

function Pagination({ className, ...props }: React.ComponentProps<'nav'>) {
    return (
        <nav
            role="navigation"
            aria-label="pagination"
            data-slot="pagination"
            className={cn('mx-auto flex w-full justify-center', className)}
            {...props}
        />
    );
}

function PaginationContent({ className, ...props }: React.ComponentProps<'ul'>) {
    return (
        <ul data-slot="pagination-content" className={cn('flex flex-row items-center gap-1', className)} {...props} />
    );
}

function PaginationItem({ ...props }: React.ComponentProps<'li'>) {
    return <li data-slot="pagination-item" {...props} />;
}

type PaginationLinkProps = {
    isActive?: boolean;
} & Pick<React.ComponentProps<typeof Button>, 'size'> &
    React.ComponentProps<'a'>;

function PaginationLink({ className, isActive, size = 'icon', ...props }: PaginationLinkProps) {
    return (
        <a
            aria-current={isActive ? 'page' : undefined}
            data-slot="pagination-link"
            data-active={isActive}
            className={cn(
                buttonVariants({
                    variant: isActive ? 'outline' : 'ghost',
                    size
                }),
                className
            )}
            {...props}
        />
    );
}

function PaginationPrevious({ className, ...props }: React.ComponentProps<typeof PaginationLink>) {
    return (
        <PaginationLink
            aria-label="Go to previous page"
            size="default"
            className={cn('gap-1 px-2.5 sm:pl-2.5', className)}
            {...props}
        >
            <ChevronLeftIcon />
            <span className="hidden sm:block">Previous</span>
        </PaginationLink>
    );
}

function PaginationNext({ className, ...props }: React.ComponentProps<typeof PaginationLink>) {
    return (
        <PaginationLink
            aria-label="Go to next page"
            size="default"
            className={cn('gap-1 px-2.5 sm:pr-2.5', className)}
            {...props}
        >
            <span className="hidden sm:block">Next</span>
            <ChevronRightIcon />
        </PaginationLink>
    );
}

function PaginationEllipsis({ className, ...props }: React.ComponentProps<'span'>) {
    return (
        <span
            aria-hidden
            data-slot="pagination-ellipsis"
            className={cn('flex size-9 items-center justify-center', className)}
            {...props}
        >
            <MoreHorizontalIcon className="size-4" />
            <span className="sr-only">More pages</span>
        </span>
    );
}

export {
    Pagination,
    PaginationContent,
    PaginationLink,
    PaginationItem,
    PaginationPrevious,
    PaginationNext,
    PaginationEllipsis
};
PK
build-template/src/frontend/src/components/ui/popover.tsx'use client';

import * as React from 'react';
import * as PopoverPrimitive from '@radix-ui/react-popover';

import { cn } from '@/lib/utils';

function Popover({ ...props }: React.ComponentProps<typeof PopoverPrimitive.Root>) {
    return <PopoverPrimitive.Root data-slot="popover" {...props} />;
}

function PopoverTrigger({ ...props }: React.ComponentProps<typeof PopoverPrimitive.Trigger>) {
    return <PopoverPrimitive.Trigger data-slot="popover-trigger" {...props} />;
}

function PopoverContent({
    className,
    align = 'center',
    sideOffset = 4,
    ...props
}: React.ComponentProps<typeof PopoverPrimitive.Content>) {
    return (
        <PopoverPrimitive.Portal>
            <PopoverPrimitive.Content
                data-slot="popover-content"
                align={align}
                sideOffset={sideOffset}
                className={cn(
                    'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden',
                    className
                )}
                {...props}
            />
        </PopoverPrimitive.Portal>
    );
}

function PopoverAnchor({ ...props }: React.ComponentProps<typeof PopoverPrimitive.Anchor>) {
    return <PopoverPrimitive.Anchor data-slot="popover-anchor" {...props} />;
}

export { Popover, PopoverTrigger, PopoverContent, PopoverAnchor };
PK
build-template/src/frontend/src/components/ui/progress.tsx'use client';

import * as React from 'react';
import * as ProgressPrimitive from '@radix-ui/react-progress';

import { cn } from '@/lib/utils';

function Progress({ className, value, ...props }: React.ComponentProps<typeof ProgressPrimitive.Root>) {
    return (
        <ProgressPrimitive.Root
            data-slot="progress"
            className={cn('bg-primary/20 relative h-2 w-full overflow-hidden rounded-full', className)}
            {...props}
        >
            <ProgressPrimitive.Indicator
                data-slot="progress-indicator"
                className="bg-primary h-full w-full flex-1 transition-all"
                style={{ transform: `translateX(-${100 - (value || 0)}%)` }}
            />
        </ProgressPrimitive.Root>
    );
}

export { Progress };
PK
build-template/src/frontend/src/components/ui/radio-group.tsx'use client';

import * as React from 'react';
import * as RadioGroupPrimitive from '@radix-ui/react-radio-group';
import { CircleIcon } from 'lucide-react';

import { cn } from '@/lib/utils';

function RadioGroup({ className, ...props }: React.ComponentProps<typeof RadioGroupPrimitive.Root>) {
    return <RadioGroupPrimitive.Root data-slot="radio-group" className={cn('grid gap-3', className)} {...props} />;
}

function RadioGroupItem({ className, ...props }: React.ComponentProps<typeof RadioGroupPrimitive.Item>) {
    return (
        <RadioGroupPrimitive.Item
            data-slot="radio-group-item"
            className={cn(
                'border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50',
                className
            )}
            {...props}
        >
            <RadioGroupPrimitive.Indicator
                data-slot="radio-group-indicator"
                className="relative flex items-center justify-center"
            >
                <CircleIcon className="fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2" />
            </RadioGroupPrimitive.Indicator>
        </RadioGroupPrimitive.Item>
    );
}

export { RadioGroup, RadioGroupItem };
PK
build-template/src/frontend/src/components/ui/resizable.tsx'use client';

import * as React from 'react';
import { GripVerticalIcon } from 'lucide-react';
import * as ResizablePrimitive from 'react-resizable-panels';

import { cn } from '@/lib/utils';

function ResizablePanelGroup({ className, ...props }: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) {
    return (
        <ResizablePrimitive.PanelGroup
            data-slot="resizable-panel-group"
            className={cn('flex h-full w-full data-[panel-group-direction=vertical]:flex-col', className)}
            {...props}
        />
    );
}

function ResizablePanel({ ...props }: React.ComponentProps<typeof ResizablePrimitive.Panel>) {
    return <ResizablePrimitive.Panel data-slot="resizable-panel" {...props} />;
}

function ResizableHandle({
    withHandle,
    className,
    ...props
}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {
    withHandle?: boolean;
}) {
    return (
        <ResizablePrimitive.PanelResizeHandle
            data-slot="resizable-handle"
            className={cn(
                'bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:translate-x-0 data-[panel-group-direction=vertical]:after:-translate-y-1/2 [&[data-panel-group-direction=vertical]>div]:rotate-90',
                className
            )}
            {...props}
        >
            {withHandle && (
                <div className="bg-border z-10 flex h-4 w-3 items-center justify-center rounded-xs border">
                    <GripVerticalIcon className="size-2.5" />
                </div>
            )}
        </ResizablePrimitive.PanelResizeHandle>
    );
}

export { ResizablePanelGroup, ResizablePanel, ResizableHandle };
PK
build-template/src/frontend/src/components/ui/scroll-area.tsx'use client';

import * as React from 'react';
import * as ScrollAreaPrimitive from '@radix-ui/react-scroll-area';

import { cn } from '@/lib/utils';

function ScrollArea({ className, children, ...props }: React.ComponentProps<typeof ScrollAreaPrimitive.Root>) {
    return (
        <ScrollAreaPrimitive.Root data-slot="scroll-area" className={cn('relative', className)} {...props}>
            <ScrollAreaPrimitive.Viewport
                data-slot="scroll-area-viewport"
                className="focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1"
            >
                {children}
            </ScrollAreaPrimitive.Viewport>
            <ScrollBar />
            <ScrollAreaPrimitive.Corner />
        </ScrollAreaPrimitive.Root>
    );
}

function ScrollBar({
    className,
    orientation = 'vertical',
    ...props
}: React.ComponentProps<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>) {
    return (
        <ScrollAreaPrimitive.ScrollAreaScrollbar
            data-slot="scroll-area-scrollbar"
            orientation={orientation}
            className={cn(
                'flex touch-none p-px transition-colors select-none',
                orientation === 'vertical' && 'h-full w-2.5 border-l border-l-transparent',
                orientation === 'horizontal' && 'h-2.5 flex-col border-t border-t-transparent',
                className
            )}
            {...props}
        >
            <ScrollAreaPrimitive.ScrollAreaThumb
                data-slot="scroll-area-thumb"
                className="bg-border relative flex-1 rounded-full"
            />
        </ScrollAreaPrimitive.ScrollAreaScrollbar>
    );
}

export { ScrollArea, ScrollBar };
PK
build-template/src/frontend/src/components/ui/select.tsx'use client';

import * as React from 'react';
import * as SelectPrimitive from '@radix-ui/react-select';
import { CheckIcon, ChevronDownIcon, ChevronUpIcon } from 'lucide-react';

import { cn } from '@/lib/utils';

function Select({ ...props }: React.ComponentProps<typeof SelectPrimitive.Root>) {
    return <SelectPrimitive.Root data-slot="select" {...props} />;
}

function SelectGroup({ ...props }: React.ComponentProps<typeof SelectPrimitive.Group>) {
    return <SelectPrimitive.Group data-slot="select-group" {...props} />;
}

function SelectValue({ ...props }: React.ComponentProps<typeof SelectPrimitive.Value>) {
    return <SelectPrimitive.Value data-slot="select-value" {...props} />;
}

function SelectTrigger({
    className,
    size = 'default',
    children,
    ...props
}: React.ComponentProps<typeof SelectPrimitive.Trigger> & {
    size?: 'sm' | 'default';
}) {
    return (
        <SelectPrimitive.Trigger
            data-slot="select-trigger"
            data-size={size}
            className={cn(
                "border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
                className
            )}
            {...props}
        >
            {children}
            <SelectPrimitive.Icon asChild>
                <ChevronDownIcon className="size-4 opacity-50" />
            </SelectPrimitive.Icon>
        </SelectPrimitive.Trigger>
    );
}

function SelectContent({
    className,
    children,
    position = 'popper',
    ...props
}: React.ComponentProps<typeof SelectPrimitive.Content>) {
    return (
        <SelectPrimitive.Portal>
            <SelectPrimitive.Content
                data-slot="select-content"
                className={cn(
                    'bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md',
                    position === 'popper' &&
                        'data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1',
                    className
                )}
                position={position}
                {...props}
            >
                <SelectScrollUpButton />
                <SelectPrimitive.Viewport
                    className={cn(
                        'p-1',
                        position === 'popper' &&
                            'h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1'
                    )}
                >
                    {children}
                </SelectPrimitive.Viewport>
                <SelectScrollDownButton />
            </SelectPrimitive.Content>
        </SelectPrimitive.Portal>
    );
}

function SelectLabel({ className, ...props }: React.ComponentProps<typeof SelectPrimitive.Label>) {
    return (
        <SelectPrimitive.Label
            data-slot="select-label"
            className={cn('text-muted-foreground px-2 py-1.5 text-xs', className)}
            {...props}
        />
    );
}

function SelectItem({ className, children, ...props }: React.ComponentProps<typeof SelectPrimitive.Item>) {
    return (
        <SelectPrimitive.Item
            data-slot="select-item"
            className={cn(
                "focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",
                className
            )}
            {...props}
        >
            <span className="absolute right-2 flex size-3.5 items-center justify-center">
                <SelectPrimitive.ItemIndicator>
                    <CheckIcon className="size-4" />
                </SelectPrimitive.ItemIndicator>
            </span>
            <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
        </SelectPrimitive.Item>
    );
}

function SelectSeparator({ className, ...props }: React.ComponentProps<typeof SelectPrimitive.Separator>) {
    return (
        <SelectPrimitive.Separator
            data-slot="select-separator"
            className={cn('bg-border pointer-events-none -mx-1 my-1 h-px', className)}
            {...props}
        />
    );
}

function SelectScrollUpButton({ className, ...props }: React.ComponentProps<typeof SelectPrimitive.ScrollUpButton>) {
    return (
        <SelectPrimitive.ScrollUpButton
            data-slot="select-scroll-up-button"
            className={cn('flex cursor-default items-center justify-center py-1', className)}
            {...props}
        >
            <ChevronUpIcon className="size-4" />
        </SelectPrimitive.ScrollUpButton>
    );
}

function SelectScrollDownButton({
    className,
    ...props
}: React.ComponentProps<typeof SelectPrimitive.ScrollDownButton>) {
    return (
        <SelectPrimitive.ScrollDownButton
            data-slot="select-scroll-down-button"
            className={cn('flex cursor-default items-center justify-center py-1', className)}
            {...props}
        >
            <ChevronDownIcon className="size-4" />
        </SelectPrimitive.ScrollDownButton>
    );
}

export {
    Select,
    SelectContent,
    SelectGroup,
    SelectItem,
    SelectLabel,
    SelectScrollDownButton,
    SelectScrollUpButton,
    SelectSeparator,
    SelectTrigger,
    SelectValue
};
PK
build-template/src/frontend/src/components/ui/separator.tsx'use client';

import * as React from 'react';
import * as SeparatorPrimitive from '@radix-ui/react-separator';

import { cn } from '@/lib/utils';

function Separator({
    className,
    orientation = 'horizontal',
    decorative = true,
    ...props
}: React.ComponentProps<typeof SeparatorPrimitive.Root>) {
    return (
        <SeparatorPrimitive.Root
            data-slot="separator"
            decorative={decorative}
            orientation={orientation}
            className={cn(
                'bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px',
                className
            )}
            {...props}
        />
    );
}

export { Separator };
PK
build-template/src/frontend/src/components/ui/sheet.tsx'use client';

import * as React from 'react';
import * as SheetPrimitive from '@radix-ui/react-dialog';
import { XIcon } from 'lucide-react';

import { cn } from '@/lib/utils';

function Sheet({ ...props }: React.ComponentProps<typeof SheetPrimitive.Root>) {
    return <SheetPrimitive.Root data-slot="sheet" {...props} />;
}

function SheetTrigger({ ...props }: React.ComponentProps<typeof SheetPrimitive.Trigger>) {
    return <SheetPrimitive.Trigger data-slot="sheet-trigger" {...props} />;
}

function SheetClose({ ...props }: React.ComponentProps<typeof SheetPrimitive.Close>) {
    return <SheetPrimitive.Close data-slot="sheet-close" {...props} />;
}

function SheetPortal({ ...props }: React.ComponentProps<typeof SheetPrimitive.Portal>) {
    return <SheetPrimitive.Portal data-slot="sheet-portal" {...props} />;
}

function SheetOverlay({ className, ...props }: React.ComponentProps<typeof SheetPrimitive.Overlay>) {
    return (
        <SheetPrimitive.Overlay
            data-slot="sheet-overlay"
            className={cn(
                'data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50',
                className
            )}
            {...props}
        />
    );
}

function SheetContent({
    className,
    children,
    side = 'right',
    ...props
}: React.ComponentProps<typeof SheetPrimitive.Content> & {
    side?: 'top' | 'right' | 'bottom' | 'left';
}) {
    return (
        <SheetPortal>
            <SheetOverlay />
            <SheetPrimitive.Content
                data-slot="sheet-content"
                className={cn(
                    'bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500',
                    side === 'right' &&
                        'data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm',
                    side === 'left' &&
                        'data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm',
                    side === 'top' &&
                        'data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b',
                    side === 'bottom' &&
                        'data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t',
                    className
                )}
                {...props}
            >
                {children}
                <SheetPrimitive.Close className="ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none">
                    <XIcon className="size-4" />
                    <span className="sr-only">Close</span>
                </SheetPrimitive.Close>
            </SheetPrimitive.Content>
        </SheetPortal>
    );
}

function SheetHeader({ className, ...props }: React.ComponentProps<'div'>) {
    return <div data-slot="sheet-header" className={cn('flex flex-col gap-1.5 p-4', className)} {...props} />;
}

function SheetFooter({ className, ...props }: React.ComponentProps<'div'>) {
    return <div data-slot="sheet-footer" className={cn('mt-auto flex flex-col gap-2 p-4', className)} {...props} />;
}

function SheetTitle({ className, ...props }: React.ComponentProps<typeof SheetPrimitive.Title>) {
    return (
        <SheetPrimitive.Title
            data-slot="sheet-title"
            className={cn('text-foreground font-semibold', className)}
            {...props}
        />
    );
}

function SheetDescription({ className, ...props }: React.ComponentProps<typeof SheetPrimitive.Description>) {
    return (
        <SheetPrimitive.Description
            data-slot="sheet-description"
            className={cn('text-muted-foreground text-sm', className)}
            {...props}
        />
    );
}

export { Sheet, SheetTrigger, SheetClose, SheetContent, SheetHeader, SheetFooter, SheetTitle, SheetDescription };
PK
build-template/src/frontend/src/components/ui/sidebar.tsx'use client';

import * as React from 'react';
import { Slot } from '@radix-ui/react-slot';
import { cva, VariantProps } from 'class-variance-authority';
import { PanelLeftIcon } from 'lucide-react';

import { useIsMobile } from '@/hooks/use-mobile';
import { cn } from '@/lib/utils';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Separator } from '@/components/ui/separator';
import { Sheet, SheetContent, SheetDescription, SheetHeader, SheetTitle } from '@/components/ui/sheet';
import { Skeleton } from '@/components/ui/skeleton';
import { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';

const SIDEBAR_COOKIE_NAME = 'sidebar_state';
const SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7;
const SIDEBAR_WIDTH = '16rem';
const SIDEBAR_WIDTH_MOBILE = '18rem';
const SIDEBAR_WIDTH_ICON = '3rem';
const SIDEBAR_KEYBOARD_SHORTCUT = 'b';

type SidebarContextProps = {
    state: 'expanded' | 'collapsed';
    open: boolean;
    setOpen: (open: boolean) => void;
    openMobile: boolean;
    setOpenMobile: (open: boolean) => void;
    isMobile: boolean;
    toggleSidebar: () => void;
};

const SidebarContext = React.createContext<SidebarContextProps | null>(null);

function useSidebar() {
    const context = React.useContext(SidebarContext);
    if (!context) {
        throw new Error('useSidebar must be used within a SidebarProvider.');
    }

    return context;
}

function SidebarProvider({
    defaultOpen = true,
    open: openProp,
    onOpenChange: setOpenProp,
    className,
    style,
    children,
    ...props
}: React.ComponentProps<'div'> & {
    defaultOpen?: boolean;
    open?: boolean;
    onOpenChange?: (open: boolean) => void;
}) {
    const isMobile = useIsMobile();
    const [openMobile, setOpenMobile] = React.useState(false);

    // This is the internal state of the sidebar.
    // We use openProp and setOpenProp for control from outside the component.
    const [_open, _setOpen] = React.useState(defaultOpen);
    const open = openProp ?? _open;
    const setOpen = React.useCallback(
        (value: boolean | ((value: boolean) => boolean)) => {
            const openState = typeof value === 'function' ? value(open) : value;
            if (setOpenProp) {
                setOpenProp(openState);
            } else {
                _setOpen(openState);
            }

            // This sets the cookie to keep the sidebar state.
            document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`;
        },
        [setOpenProp, open]
    );

    // Helper to toggle the sidebar.
    const toggleSidebar = React.useCallback(() => {
        return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open);
    }, [isMobile, setOpen, setOpenMobile]);

    // Adds a keyboard shortcut to toggle the sidebar.
    React.useEffect(() => {
        const handleKeyDown = (event: KeyboardEvent) => {
            if (event.key === SIDEBAR_KEYBOARD_SHORTCUT && (event.metaKey || event.ctrlKey)) {
                event.preventDefault();
                toggleSidebar();
            }
        };

        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
    }, [toggleSidebar]);

    // We add a state so that we can do data-state="expanded" or "collapsed".
    // This makes it easier to style the sidebar with Tailwind classes.
    const state = open ? 'expanded' : 'collapsed';

    const contextValue = React.useMemo<SidebarContextProps>(
        () => ({
            state,
            open,
            setOpen,
            isMobile,
            openMobile,
            setOpenMobile,
            toggleSidebar
        }),
        [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]
    );

    return (
        <SidebarContext.Provider value={contextValue}>
            <TooltipProvider delayDuration={0}>
                <div
                    data-slot="sidebar-wrapper"
                    style={
                        {
                            '--sidebar-width': SIDEBAR_WIDTH,
                            '--sidebar-width-icon': SIDEBAR_WIDTH_ICON,
                            ...style
                        } as React.CSSProperties
                    }
                    className={cn(
                        'group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full',
                        className
                    )}
                    {...props}
                >
                    {children}
                </div>
            </TooltipProvider>
        </SidebarContext.Provider>
    );
}

function Sidebar({
    side = 'left',
    variant = 'sidebar',
    collapsible = 'offcanvas',
    className,
    children,
    ...props
}: React.ComponentProps<'div'> & {
    side?: 'left' | 'right';
    variant?: 'sidebar' | 'floating' | 'inset';
    collapsible?: 'offcanvas' | 'icon' | 'none';
}) {
    const { isMobile, state, openMobile, setOpenMobile } = useSidebar();

    if (collapsible === 'none') {
        return (
            <div
                data-slot="sidebar"
                className={cn('bg-sidebar text-sidebar-foreground flex h-full w-(--sidebar-width) flex-col', className)}
                {...props}
            >
                {children}
            </div>
        );
    }

    if (isMobile) {
        return (
            <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>
                <SheetContent
                    data-sidebar="sidebar"
                    data-slot="sidebar"
                    data-mobile="true"
                    className="bg-sidebar text-sidebar-foreground w-(--sidebar-width) p-0 [&>button]:hidden"
                    style={
                        {
                            '--sidebar-width': SIDEBAR_WIDTH_MOBILE
                        } as React.CSSProperties
                    }
                    side={side}
                >
                    <SheetHeader className="sr-only">
                        <SheetTitle>Sidebar</SheetTitle>
                        <SheetDescription>Displays the mobile sidebar.</SheetDescription>
                    </SheetHeader>
                    <div className="flex h-full w-full flex-col">{children}</div>
                </SheetContent>
            </Sheet>
        );
    }

    return (
        <div
            className="group peer text-sidebar-foreground hidden md:block"
            data-state={state}
            data-collapsible={state === 'collapsed' ? collapsible : ''}
            data-variant={variant}
            data-side={side}
            data-slot="sidebar"
        >
            {/* This is what handles the sidebar gap on desktop */}
            <div
                data-slot="sidebar-gap"
                className={cn(
                    'relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear',
                    'group-data-[collapsible=offcanvas]:w-0',
                    'group-data-[side=right]:rotate-180',
                    variant === 'floating' || variant === 'inset'
                        ? 'group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]'
                        : 'group-data-[collapsible=icon]:w-(--sidebar-width-icon)'
                )}
            />
            <div
                data-slot="sidebar-container"
                className={cn(
                    'fixed inset-y-0 z-10 hidden h-svh w-(--sidebar-width) transition-[left,right,width] duration-200 ease-linear md:flex',
                    side === 'left'
                        ? 'left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]'
                        : 'right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]',
                    // Adjust the padding for floating and inset variants.
                    variant === 'floating' || variant === 'inset'
                        ? 'p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)]'
                        : 'group-data-[collapsible=icon]:w-(--sidebar-width-icon) group-data-[side=left]:border-r group-data-[side=right]:border-l',
                    className
                )}
                {...props}
            >
                <div
                    data-sidebar="sidebar"
                    data-slot="sidebar-inner"
                    className="bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm"
                >
                    {children}
                </div>
            </div>
        </div>
    );
}

function SidebarTrigger({ className, onClick, ...props }: React.ComponentProps<typeof Button>) {
    const { toggleSidebar } = useSidebar();

    return (
        <Button
            data-sidebar="trigger"
            data-slot="sidebar-trigger"
            variant="ghost"
            size="icon"
            className={cn('size-7', className)}
            onClick={(event) => {
                onClick?.(event);
                toggleSidebar();
            }}
            {...props}
        >
            <PanelLeftIcon />
            <span className="sr-only">Toggle Sidebar</span>
        </Button>
    );
}

function SidebarRail({ className, ...props }: React.ComponentProps<'button'>) {
    const { toggleSidebar } = useSidebar();

    return (
        <button
            data-sidebar="rail"
            data-slot="sidebar-rail"
            aria-label="Toggle Sidebar"
            tabIndex={-1}
            onClick={toggleSidebar}
            title="Toggle Sidebar"
            className={cn(
                'hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex',
                'in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize',
                '[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize',
                'hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full',
                '[[data-side=left][data-collapsible=offcanvas]_&]:-right-2',
                '[[data-side=right][data-collapsible=offcanvas]_&]:-left-2',
                className
            )}
            {...props}
        />
    );
}

function SidebarInset({ className, ...props }: React.ComponentProps<'main'>) {
    return (
        <main
            data-slot="sidebar-inset"
            className={cn(
                'bg-background relative flex w-full flex-1 flex-col',
                'md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2',
                className
            )}
            {...props}
        />
    );
}

function SidebarInput({ className, ...props }: React.ComponentProps<typeof Input>) {
    return (
        <Input
            data-slot="sidebar-input"
            data-sidebar="input"
            className={cn('bg-background h-8 w-full shadow-none', className)}
            {...props}
        />
    );
}

function SidebarHeader({ className, ...props }: React.ComponentProps<'div'>) {
    return (
        <div
            data-slot="sidebar-header"
            data-sidebar="header"
            className={cn('flex flex-col gap-2 p-2', className)}
            {...props}
        />
    );
}

function SidebarFooter({ className, ...props }: React.ComponentProps<'div'>) {
    return (
        <div
            data-slot="sidebar-footer"
            data-sidebar="footer"
            className={cn('flex flex-col gap-2 p-2', className)}
            {...props}
        />
    );
}

function SidebarSeparator({ className, ...props }: React.ComponentProps<typeof Separator>) {
    return (
        <Separator
            data-slot="sidebar-separator"
            data-sidebar="separator"
            className={cn('bg-sidebar-border mx-2 w-auto', className)}
            {...props}
        />
    );
}

function SidebarContent({ className, ...props }: React.ComponentProps<'div'>) {
    return (
        <div
            data-slot="sidebar-content"
            data-sidebar="content"
            className={cn(
                'flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden',
                className
            )}
            {...props}
        />
    );
}

function SidebarGroup({ className, ...props }: React.ComponentProps<'div'>) {
    return (
        <div
            data-slot="sidebar-group"
            data-sidebar="group"
            className={cn('relative flex w-full min-w-0 flex-col p-2', className)}
            {...props}
        />
    );
}

function SidebarGroupLabel({
    className,
    asChild = false,
    ...props
}: React.ComponentProps<'div'> & { asChild?: boolean }) {
    const Comp = asChild ? Slot : 'div';

    return (
        <Comp
            data-slot="sidebar-group-label"
            data-sidebar="group-label"
            className={cn(
                'text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0',
                'group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0',
                className
            )}
            {...props}
        />
    );
}

function SidebarGroupAction({
    className,
    asChild = false,
    ...props
}: React.ComponentProps<'button'> & { asChild?: boolean }) {
    const Comp = asChild ? Slot : 'button';

    return (
        <Comp
            data-slot="sidebar-group-action"
            data-sidebar="group-action"
            className={cn(
                'text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0',
                // Increases the hit area of the button on mobile.
                'after:absolute after:-inset-2 md:after:hidden',
                'group-data-[collapsible=icon]:hidden',
                className
            )}
            {...props}
        />
    );
}

function SidebarGroupContent({ className, ...props }: React.ComponentProps<'div'>) {
    return (
        <div
            data-slot="sidebar-group-content"
            data-sidebar="group-content"
            className={cn('w-full text-sm', className)}
            {...props}
        />
    );
}

function SidebarMenu({ className, ...props }: React.ComponentProps<'ul'>) {
    return (
        <ul
            data-slot="sidebar-menu"
            data-sidebar="menu"
            className={cn('flex w-full min-w-0 flex-col gap-1', className)}
            {...props}
        />
    );
}

function SidebarMenuItem({ className, ...props }: React.ComponentProps<'li'>) {
    return (
        <li
            data-slot="sidebar-menu-item"
            data-sidebar="menu-item"
            className={cn('group/menu-item relative', className)}
            {...props}
        />
    );
}

const sidebarMenuButtonVariants = cva(
    'peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0',
    {
        variants: {
            variant: {
                default: 'hover:bg-sidebar-accent hover:text-sidebar-accent-foreground',
                outline:
                    'bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]'
            },
            size: {
                default: 'h-8 text-sm',
                sm: 'h-7 text-xs',
                lg: 'h-12 text-sm group-data-[collapsible=icon]:p-0!'
            }
        },
        defaultVariants: {
            variant: 'default',
            size: 'default'
        }
    }
);

function SidebarMenuButton({
    asChild = false,
    isActive = false,
    variant = 'default',
    size = 'default',
    tooltip,
    className,
    ...props
}: React.ComponentProps<'button'> & {
    asChild?: boolean;
    isActive?: boolean;
    tooltip?: string | React.ComponentProps<typeof TooltipContent>;
} & VariantProps<typeof sidebarMenuButtonVariants>) {
    const Comp = asChild ? Slot : 'button';
    const { isMobile, state } = useSidebar();

    const button = (
        <Comp
            data-slot="sidebar-menu-button"
            data-sidebar="menu-button"
            data-size={size}
            data-active={isActive}
            className={cn(sidebarMenuButtonVariants({ variant, size }), className)}
            {...props}
        />
    );

    if (!tooltip) {
        return button;
    }

    if (typeof tooltip === 'string') {
        tooltip = {
            children: tooltip
        };
    }

    return (
        <Tooltip>
            <TooltipTrigger asChild>{button}</TooltipTrigger>
            <TooltipContent side="right" align="center" hidden={state !== 'collapsed' || isMobile} {...tooltip} />
        </Tooltip>
    );
}

function SidebarMenuAction({
    className,
    asChild = false,
    showOnHover = false,
    ...props
}: React.ComponentProps<'button'> & {
    asChild?: boolean;
    showOnHover?: boolean;
}) {
    const Comp = asChild ? Slot : 'button';

    return (
        <Comp
            data-slot="sidebar-menu-action"
            data-sidebar="menu-action"
            className={cn(
                'text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0',
                // Increases the hit area of the button on mobile.
                'after:absolute after:-inset-2 md:after:hidden',
                'peer-data-[size=sm]/menu-button:top-1',
                'peer-data-[size=default]/menu-button:top-1.5',
                'peer-data-[size=lg]/menu-button:top-2.5',
                'group-data-[collapsible=icon]:hidden',
                showOnHover &&
                    'peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0',
                className
            )}
            {...props}
        />
    );
}

function SidebarMenuBadge({ className, ...props }: React.ComponentProps<'div'>) {
    return (
        <div
            data-slot="sidebar-menu-badge"
            data-sidebar="menu-badge"
            className={cn(
                'text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none',
                'peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground',
                'peer-data-[size=sm]/menu-button:top-1',
                'peer-data-[size=default]/menu-button:top-1.5',
                'peer-data-[size=lg]/menu-button:top-2.5',
                'group-data-[collapsible=icon]:hidden',
                className
            )}
            {...props}
        />
    );
}

function SidebarMenuSkeleton({
    className,
    showIcon = false,
    ...props
}: React.ComponentProps<'div'> & {
    showIcon?: boolean;
}) {
    // Random width between 50 to 90%.
    const width = React.useMemo(() => {
        return `${Math.floor(Math.random() * 40) + 50}%`;
    }, []);

    return (
        <div
            data-slot="sidebar-menu-skeleton"
            data-sidebar="menu-skeleton"
            className={cn('flex h-8 items-center gap-2 rounded-md px-2', className)}
            {...props}
        >
            {showIcon && <Skeleton className="size-4 rounded-md" data-sidebar="menu-skeleton-icon" />}
            <Skeleton
                className="h-4 max-w-(--skeleton-width) flex-1"
                data-sidebar="menu-skeleton-text"
                style={
                    {
                        '--skeleton-width': width
                    } as React.CSSProperties
                }
            />
        </div>
    );
}

function SidebarMenuSub({ className, ...props }: React.ComponentProps<'ul'>) {
    return (
        <ul
            data-slot="sidebar-menu-sub"
            data-sidebar="menu-sub"
            className={cn(
                'border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5',
                'group-data-[collapsible=icon]:hidden',
                className
            )}
            {...props}
        />
    );
}

function SidebarMenuSubItem({ className, ...props }: React.ComponentProps<'li'>) {
    return (
        <li
            data-slot="sidebar-menu-sub-item"
            data-sidebar="menu-sub-item"
            className={cn('group/menu-sub-item relative', className)}
            {...props}
        />
    );
}

function SidebarMenuSubButton({
    asChild = false,
    size = 'md',
    isActive = false,
    className,
    ...props
}: React.ComponentProps<'a'> & {
    asChild?: boolean;
    size?: 'sm' | 'md';
    isActive?: boolean;
}) {
    const Comp = asChild ? Slot : 'a';

    return (
        <Comp
            data-slot="sidebar-menu-sub-button"
            data-sidebar="menu-sub-button"
            data-size={size}
            data-active={isActive}
            className={cn(
                'text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0',
                'data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground',
                size === 'sm' && 'text-xs',
                size === 'md' && 'text-sm',
                'group-data-[collapsible=icon]:hidden',
                className
            )}
            {...props}
        />
    );
}

export {
    Sidebar,
    SidebarContent,
    SidebarFooter,
    SidebarGroup,
    SidebarGroupAction,
    SidebarGroupContent,
    SidebarGroupLabel,
    SidebarHeader,
    SidebarInput,
    SidebarInset,
    SidebarMenu,
    SidebarMenuAction,
    SidebarMenuBadge,
    SidebarMenuButton,
    SidebarMenuItem,
    SidebarMenuSkeleton,
    SidebarMenuSub,
    SidebarMenuSubButton,
    SidebarMenuSubItem,
    SidebarProvider,
    SidebarRail,
    SidebarSeparator,
    SidebarTrigger,
    useSidebar
};
PK
build-template/src/frontend/src/components/ui/skeleton.tsximport { cn } from '@/lib/utils';

function Skeleton({ className, ...props }: React.ComponentProps<'div'>) {
    return <div data-slot="skeleton" className={cn('bg-accent animate-pulse rounded-md', className)} {...props} />;
}

export { Skeleton };
PK
build-template/src/frontend/src/components/ui/slider.tsx'use client';

import * as React from 'react';
import * as SliderPrimitive from '@radix-ui/react-slider';

import { cn } from '@/lib/utils';

function Slider({
    className,
    defaultValue,
    value,
    min = 0,
    max = 100,
    ...props
}: React.ComponentProps<typeof SliderPrimitive.Root>) {
    const _values = React.useMemo(
        () => (Array.isArray(value) ? value : Array.isArray(defaultValue) ? defaultValue : [min, max]),
        [value, defaultValue, min, max]
    );

    return (
        <SliderPrimitive.Root
            data-slot="slider"
            defaultValue={defaultValue}
            value={value}
            min={min}
            max={max}
            className={cn(
                'relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col',
                className
            )}
            {...props}
        >
            <SliderPrimitive.Track
                data-slot="slider-track"
                className={cn(
                    'bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5'
                )}
            >
                <SliderPrimitive.Range
                    data-slot="slider-range"
                    className={cn(
                        'bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full'
                    )}
                />
            </SliderPrimitive.Track>
            {Array.from({ length: _values.length }, (_, index) => (
                <SliderPrimitive.Thumb
                    data-slot="slider-thumb"
                    key={index}
                    className="border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"
                />
            ))}
        </SliderPrimitive.Root>
    );
}

export { Slider };
PK
build-template/src/frontend/src/components/ui/sonner.tsx'use client';

import { useTheme } from 'next-themes';
import { Toaster as Sonner, ToasterProps } from 'sonner';

const Toaster = ({ ...props }: ToasterProps) => {
    const { theme = 'system' } = useTheme();

    return (
        <Sonner
            theme={theme as ToasterProps['theme']}
            className="toaster group"
            style={
                {
                    '--normal-bg': 'var(--popover)',
                    '--normal-text': 'var(--popover-foreground)',
                    '--normal-border': 'var(--border)'
                } as React.CSSProperties
            }
            {...props}
        />
    );
};

export { Toaster };
PK
build-template/src/frontend/src/components/ui/switch.tsx'use client';

import * as React from 'react';
import * as SwitchPrimitive from '@radix-ui/react-switch';

import { cn } from '@/lib/utils';

function Switch({ className, ...props }: React.ComponentProps<typeof SwitchPrimitive.Root>) {
    return (
        <SwitchPrimitive.Root
            data-slot="switch"
            className={cn(
                'peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50',
                className
            )}
            {...props}
        >
            <SwitchPrimitive.Thumb
                data-slot="switch-thumb"
                className={cn(
                    'bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0'
                )}
            />
        </SwitchPrimitive.Root>
    );
}

export { Switch };
PK
build-template/src/frontend/src/components/ui/table.tsx'use client';

import * as React from 'react';

import { cn } from '@/lib/utils';

function Table({ className, ...props }: React.ComponentProps<'table'>) {
    return (
        <div data-slot="table-container" className="relative w-full overflow-x-auto">
            <table data-slot="table" className={cn('w-full caption-bottom text-sm', className)} {...props} />
        </div>
    );
}

function TableHeader({ className, ...props }: React.ComponentProps<'thead'>) {
    return <thead data-slot="table-header" className={cn('[&_tr]:border-b', className)} {...props} />;
}

function TableBody({ className, ...props }: React.ComponentProps<'tbody'>) {
    return <tbody data-slot="table-body" className={cn('[&_tr:last-child]:border-0', className)} {...props} />;
}

function TableFooter({ className, ...props }: React.ComponentProps<'tfoot'>) {
    return (
        <tfoot
            data-slot="table-footer"
            className={cn('bg-muted/50 border-t font-medium [&>tr]:last:border-b-0', className)}
            {...props}
        />
    );
}

function TableRow({ className, ...props }: React.ComponentProps<'tr'>) {
    return (
        <tr
            data-slot="table-row"
            className={cn('hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors', className)}
            {...props}
        />
    );
}

function TableHead({ className, ...props }: React.ComponentProps<'th'>) {
    return (
        <th
            data-slot="table-head"
            className={cn(
                'text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]',
                className
            )}
            {...props}
        />
    );
}

function TableCell({ className, ...props }: React.ComponentProps<'td'>) {
    return (
        <td
            data-slot="table-cell"
            className={cn(
                'p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]',
                className
            )}
            {...props}
        />
    );
}

function TableCaption({ className, ...props }: React.ComponentProps<'caption'>) {
    return (
        <caption data-slot="table-caption" className={cn('text-muted-foreground mt-4 text-sm', className)} {...props} />
    );
}

export { Table, TableHeader, TableBody, TableFooter, TableHead, TableRow, TableCell, TableCaption };
PK
build-template/src/frontend/src/components/ui/tabs.tsx'use client';

import * as React from 'react';
import * as TabsPrimitive from '@radix-ui/react-tabs';

import { cn } from '@/lib/utils';

function Tabs({ className, ...props }: React.ComponentProps<typeof TabsPrimitive.Root>) {
    return <TabsPrimitive.Root data-slot="tabs" className={cn('flex flex-col gap-2', className)} {...props} />;
}

function TabsList({ className, ...props }: React.ComponentProps<typeof TabsPrimitive.List>) {
    return (
        <TabsPrimitive.List
            data-slot="tabs-list"
            className={cn(
                'bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]',
                className
            )}
            {...props}
        />
    );
}

function TabsTrigger({ className, ...props }: React.ComponentProps<typeof TabsPrimitive.Trigger>) {
    return (
        <TabsPrimitive.Trigger
            data-slot="tabs-trigger"
            className={cn(
                "data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
                className
            )}
            {...props}
        />
    );
}

function TabsContent({ className, ...props }: React.ComponentProps<typeof TabsPrimitive.Content>) {
    return (
        <TabsPrimitive.Content data-slot="tabs-content" className={cn('flex-1 outline-none', className)} {...props} />
    );
}

export { Tabs, TabsList, TabsTrigger, TabsContent };
PK
build-template/src/frontend/src/components/ui/textarea.tsximport * as React from 'react';

import { cn } from '@/lib/utils';

function Textarea({ className, ...props }: React.ComponentProps<'textarea'>) {
    return (
        <textarea
            data-slot="textarea"
            className={cn(
                'border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',
                className
            )}
            {...props}
        />
    );
}

export { Textarea };
PK
build-template/src/frontend/src/components/ui/toggle-group.tsx'use client';

import * as React from 'react';
import * as ToggleGroupPrimitive from '@radix-ui/react-toggle-group';
import { type VariantProps } from 'class-variance-authority';

import { cn } from '@/lib/utils';
import { toggleVariants } from '@/components/ui/toggle';

const ToggleGroupContext = React.createContext<VariantProps<typeof toggleVariants>>({
    size: 'default',
    variant: 'default'
});

function ToggleGroup({
    className,
    variant,
    size,
    children,
    ...props
}: React.ComponentProps<typeof ToggleGroupPrimitive.Root> & VariantProps<typeof toggleVariants>) {
    return (
        <ToggleGroupPrimitive.Root
            data-slot="toggle-group"
            data-variant={variant}
            data-size={size}
            className={cn(
                'group/toggle-group flex w-fit items-center rounded-md data-[variant=outline]:shadow-xs',
                className
            )}
            {...props}
        >
            <ToggleGroupContext.Provider value={{ variant, size }}>{children}</ToggleGroupContext.Provider>
        </ToggleGroupPrimitive.Root>
    );
}

function ToggleGroupItem({
    className,
    children,
    variant,
    size,
    ...props
}: React.ComponentProps<typeof ToggleGroupPrimitive.Item> & VariantProps<typeof toggleVariants>) {
    const context = React.useContext(ToggleGroupContext);

    return (
        <ToggleGroupPrimitive.Item
            data-slot="toggle-group-item"
            data-variant={context.variant || variant}
            data-size={context.size || size}
            className={cn(
                toggleVariants({
                    variant: context.variant || variant,
                    size: context.size || size
                }),
                'min-w-0 flex-1 shrink-0 rounded-none shadow-none first:rounded-l-md last:rounded-r-md focus:z-10 focus-visible:z-10 data-[variant=outline]:border-l-0 data-[variant=outline]:first:border-l',
                className
            )}
            {...props}
        >
            {children}
        </ToggleGroupPrimitive.Item>
    );
}

export { ToggleGroup, ToggleGroupItem };
PK
build-template/src/frontend/src/components/ui/toggle.tsx'use client';

import * as React from 'react';
import * as TogglePrimitive from '@radix-ui/react-toggle';
import { cva, type VariantProps } from 'class-variance-authority';

import { cn } from '@/lib/utils';

const toggleVariants = cva(
    "inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium hover:bg-muted hover:text-muted-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] outline-none transition-[color,box-shadow] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive whitespace-nowrap",
    {
        variants: {
            variant: {
                default: 'bg-transparent',
                outline: 'border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground'
            },
            size: {
                default: 'h-9 px-2 min-w-9',
                sm: 'h-8 px-1.5 min-w-8',
                lg: 'h-10 px-2.5 min-w-10'
            }
        },
        defaultVariants: {
            variant: 'default',
            size: 'default'
        }
    }
);

function Toggle({
    className,
    variant,
    size,
    ...props
}: React.ComponentProps<typeof TogglePrimitive.Root> & VariantProps<typeof toggleVariants>) {
    return (
        <TogglePrimitive.Root
            data-slot="toggle"
            className={cn(toggleVariants({ variant, size, className }))}
            {...props}
        />
    );
}

export { Toggle, toggleVariants };
PK
build-template/src/frontend/src/components/ui/tooltip.tsx'use client';

import * as React from 'react';
import * as TooltipPrimitive from '@radix-ui/react-tooltip';

import { cn } from '@/lib/utils';

function TooltipProvider({ delayDuration = 0, ...props }: React.ComponentProps<typeof TooltipPrimitive.Provider>) {
    return <TooltipPrimitive.Provider data-slot="tooltip-provider" delayDuration={delayDuration} {...props} />;
}

function Tooltip({ ...props }: React.ComponentProps<typeof TooltipPrimitive.Root>) {
    return (
        <TooltipProvider>
            <TooltipPrimitive.Root data-slot="tooltip" {...props} />
        </TooltipProvider>
    );
}

function TooltipTrigger({ ...props }: React.ComponentProps<typeof TooltipPrimitive.Trigger>) {
    return <TooltipPrimitive.Trigger data-slot="tooltip-trigger" {...props} />;
}

function TooltipContent({
    className,
    sideOffset = 0,
    children,
    ...props
}: React.ComponentProps<typeof TooltipPrimitive.Content>) {
    return (
        <TooltipPrimitive.Portal>
            <TooltipPrimitive.Content
                data-slot="tooltip-content"
                sideOffset={sideOffset}
                className={cn(
                    'bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance',
                    className
                )}
                {...props}
            >
                {children}
                <TooltipPrimitive.Arrow className="bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]" />
            </TooltipPrimitive.Content>
        </TooltipPrimitive.Portal>
    );
}

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider };
PK
build-template/src/frontend/src/hooks/PK
build-template/src/frontend/src/hooks/use-mobile.tsximport { useEffect, useState } from 'react';

export function useIsMobile(breakpoint = 768): boolean {
    const [isMobile, setIsMobile] = useState<boolean>(false);
    useEffect(() => {
        const update = () => setIsMobile(window.innerWidth < breakpoint);
        update();
        window.addEventListener('resize', update);
        return () => window.removeEventListener('resize', update);
    }, [breakpoint]);
    return isMobile;
}
PK
build-template/src/frontend/src/lib/PK
build-template/src/frontend/src/lib/utils.tsimport { type ClassValue } from 'clsx';
import { clsx } from 'clsx';
import { twMerge } from 'tailwind-merge';

export function cn(...inputs: ClassValue[]): string {
    return twMerge(clsx(inputs));
}
PK
frontend/PK
frontend/index.html<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/assets/generated/lflcei-eco-internet-main-logo-transparent.dim_400x400.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
    <meta name="description" content="LFLCEI 幸運草生態互聯網 - 全 3D WebGL 互動平台：Unity/Unreal 相容渲染引擎、Canister 模組化架構、Internet Identity 2.0 自動登入、雙端整合通信框架。跨平台響應式設計，完整繁體中文界面支援。" />
    <meta name="keywords" content="LFLCEI, 幸運草生態互聯網, 3D WebGL, Unity, Unreal, Internet Computer, Canister, Internet Identity 2.0, 雙端整合, 模組化架構, ICP, 繁體中文" />
    <meta name="theme-color" content="#fbbf24" />
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="/assets/generated/lflcei-eco-internet-main-logo-transparent.dim_400x400.png" as="image" />
    <link rel="preload" href="/assets/generated/3d-webgl-platform-showcase.dim_1200x800.png" as="image" />
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="LFLCEI 幸運草生態互聯網 - 全 3D WebGL 互動平台" />
    <meta property="og:description" content="Unity/Unreal 相容渲染引擎、Canister 模組化架構、Internet Identity 2.0 自動登入、雙端整合通信框架。" />
    <meta property="og:image" content="/assets/generated/lflcei-eco-internet-main-logo-transparent.dim_400x400.png" />
    <meta property="og:type" content="website" />
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="LFLCEI 幸運草生態互聯網" />
    <meta name="twitter:description" content="全 3D WebGL 互動平台 • Unity/Unreal 相容 • Canister 模組化架構" />
    <meta name="twitter:image" content="/assets/generated/lflcei-eco-internet-main-logo-transparent.dim_400x400.png" />
    
    <!-- Mobile Optimization -->
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="LFLCEI 生態互聯網" />
    
    <title>LFLCEI 幸運草生態互聯網 - 全 3D WebGL 互動平台</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
PK
frontend/tailwind.config.jsimport typography from '@tailwindcss/typography';
import containerQueries from '@tailwindcss/container-queries';
import animate from 'tailwindcss-animate';

/** @type {import('tailwindcss').Config} */
export default {
    darkMode: ['class'],
    content: ['index.html', 'src/**/*.{js,ts,jsx,tsx,html,css}'],
    theme: {
        container: {
            center: true,
            padding: '2rem',
            screens: {
                '2xl': '1400px'
            }
        },
        extend: {
            colors: {
                border: 'oklch(var(--border))',
                input: 'oklch(var(--input))',
                ring: 'oklch(var(--ring) / <alpha-value>)',
                background: 'oklch(var(--background))',
                foreground: 'oklch(var(--foreground))',
                primary: {
                    DEFAULT: 'oklch(var(--primary) / <alpha-value>)',
                    foreground: 'oklch(var(--primary-foreground))'
                },
                secondary: {
                    DEFAULT: 'oklch(var(--secondary) / <alpha-value>)',
                    foreground: 'oklch(var(--secondary-foreground))'
                },
                destructive: {
                    DEFAULT: 'oklch(var(--destructive) / <alpha-value>)',
                    foreground: 'oklch(var(--destructive-foreground))'
                },
                muted: {
                    DEFAULT: 'oklch(var(--muted) / <alpha-value>)',
                    foreground: 'oklch(var(--muted-foreground) / <alpha-value>)'
                },
                accent: {
                    DEFAULT: 'oklch(var(--accent) / <alpha-value>)',
                    foreground: 'oklch(var(--accent-foreground))'
                },
                popover: {
                    DEFAULT: 'oklch(var(--popover))',
                    foreground: 'oklch(var(--popover-foreground))'
                },
                card: {
                    DEFAULT: 'oklch(var(--card))',
                    foreground: 'oklch(var(--card-foreground))'
                },
                chart: {
                    1: 'oklch(var(--chart-1))',
                    2: 'oklch(var(--chart-2))',
                    3: 'oklch(var(--chart-3))',
                    4: 'oklch(var(--chart-4))',
                    5: 'oklch(var(--chart-5))'
                },
                sidebar: {
                    DEFAULT: 'oklch(var(--sidebar))',
                    foreground: 'oklch(var(--sidebar-foreground))',
                    primary: 'oklch(var(--sidebar-primary))',
                    'primary-foreground': 'oklch(var(--sidebar-primary-foreground))',
                    accent: 'oklch(var(--sidebar-accent))',
                    'accent-foreground': 'oklch(var(--sidebar-accent-foreground))',
                    border: 'oklch(var(--sidebar-border))',
                    ring: 'oklch(var(--sidebar-ring))'
                }
            },
            borderRadius: {
                lg: 'var(--radius)',
                md: 'calc(var(--radius) - 2px)',
                sm: 'calc(var(--radius) - 4px)'
            },
            boxShadow: {
                xs: '0 1px 2px 0 rgba(0,0,0,0.05)'
            },
            keyframes: {
                'accordion-down': {
                    from: { height: '0' },
                    to: { height: 'var(--radix-accordion-content-height)' }
                },
                'accordion-up': {
                    from: { height: 'var(--radix-accordion-content-height)' },
                    to: { height: '0' }
                }
            },
            animation: {
                'accordion-down': 'accordion-down 0.2s ease-out',
                'accordion-up': 'accordion-up 0.2s ease-out'
            }
        }
    },
    plugins: [typography, containerQueries, animate]
};
PK
frontend/src/PK
frontend/src/App.tsximport { RouterProvider, createRouter, createRoute, createRootRoute, Outlet, useNavigate, useParams } from '@tanstack/react-router';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import { Toaster } from '@/components/ui/sonner';
import { ThemeProvider } from 'next-themes';
import Header from './components/Header';
import Footer from './components/Footer';
import LoginPage from './pages/LoginPage';
import HomePage from './pages/HomePage';
import DailyCheckInPage from './pages/DailyCheckInPage';
import GachaPage from './pages/GachaPage';
import ProfilePage from './pages/ProfilePage';
import AdminPage from './pages/AdminPage';
import NFTManagementPage from './pages/NFTManagementPage';
import TransactionManagementPage from './pages/TransactionManagementPage';
import NewbornLuckyEntrancePage from './pages/NewbornLuckyEntrancePage';
import TemplateSelectionPage from './pages/TemplateSelectionPage';
import MetaverseAscensionPage from './pages/MetaverseAscensionPage';
import RealityConnectionPage from './pages/RealityConnectionPage';
import NineRealmsHubPage from './pages/NineRealmsHubPage';
import RealmDetailPage from './pages/RealmDetailPage';
import SubscriptionSuccessPage from './pages/SubscriptionSuccessPage';
import DualDomainSyncPage from './pages/DualDomainSyncPage';
import UnifiedLFLCDappPortalPage from './pages/UnifiedLFLCDappPortalPage';
import { useInternetIdentity } from './hooks/useInternetIdentity';
import ProfileSetupModal from './components/ProfileSetupModal';
import { useGetCallerUserProfile } from './hooks/useQueries';
import { useState, useEffect } from 'react';

const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      retry: 2,
      refetchOnWindowFocus: false,
      staleTime: 60000,
    },
  },
});

type Page = 'home' | 'checkin' | 'gacha' | 'profile' | 'admin' | 'newborn-entrance' | 'metaverse-ascension' | 'reality-connection' | 'nine-realms-hub' | 'realm' | 'unified-portal';

function Layout() {
  const { identity, isInitializing } = useInternetIdentity();
  const { data: userProfile, isLoading: profileLoading, isFetched } = useGetCallerUserProfile();
  const navigate = useNavigate();
  const [currentPage, setCurrentPage] = useState<Page>('home');
  
  const isAuthenticated = !!identity;
  const showProfileSetup = isAuthenticated && !profileLoading && isFetched && userProfile === null;

  useEffect(() => {
    const path = window.location.pathname;
    if (path === '/home') setCurrentPage('home');
    else if (path === '/daily-check-in') setCurrentPage('checkin');
    else if (path === '/gacha') setCurrentPage('gacha');
    else if (path === '/profile') setCurrentPage('profile');
    else if (path === '/admin' || path.startsWith('/admin/')) setCurrentPage('admin');
    else if (path === '/newborn-lucky-entrance') setCurrentPage('newborn-entrance');
    else if (path === '/metaverse-ascension') setCurrentPage('metaverse-ascension');
    else if (path === '/reality-connection') setCurrentPage('reality-connection');
    else if (path === '/nine-realms-hub') setCurrentPage('nine-realms-hub');
    else if (path.startsWith('/realm/')) setCurrentPage('realm');
    else if (path === '/unified-portal') setCurrentPage('unified-portal');
  }, []);

  const handleNavigate = (page: Page) => {
    setCurrentPage(page);
    switch (page) {
      case 'home':
        navigate({ to: '/home' });
        break;
      case 'checkin':
        navigate({ to: '/daily-check-in' });
        break;
      case 'gacha':
        navigate({ to: '/gacha' });
        break;
      case 'profile':
        navigate({ to: '/profile' });
        break;
      case 'admin':
        navigate({ to: '/admin' });
        break;
      case 'newborn-entrance':
        navigate({ to: '/newborn-lucky-entrance' });
        break;
      case 'metaverse-ascension':
        navigate({ to: '/metaverse-ascension' });
        break;
      case 'reality-connection':
        navigate({ to: '/reality-connection' });
        break;
      case 'nine-realms-hub':
        navigate({ to: '/nine-realms-hub' });
        break;
      case 'unified-portal':
        navigate({ to: '/unified-portal' });
        break;
    }
  };

  if (isInitializing) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-slate-950 via-emerald-950 to-green-950 flex items-center justify-center">
        <div className="text-center space-y-4 gpu-accelerated">
          <div className="h-16 w-16 animate-spin rounded-full border-4 border-amber-400 border-t-transparent mx-auto"></div>
          <p className="text-amber-400 text-lg font-semibold clover-glow">LFLCEI 3D 幸運草遊戲 初始化中...</p>
          <p className="text-emerald-300 text-sm">全 3D WebGL 互動平台載入中</p>
          <div className="flex items-center justify-center gap-2 text-xs text-emerald-200">
            <span className="animate-pulse">Unity/Unreal 相容引擎</span>
            <span className="text-amber-400">•</span>
            <span className="animate-pulse animation-delay-200">Canister 模組化架構</span>
            <span className="text-amber-400">•</span>
            <span className="animate-pulse animation-delay-400">Internet Identity 2.0</span>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-950 via-emerald-950 to-green-950 text-emerald-100">
      <Header currentPage={currentPage} onNavigate={handleNavigate} />
      <main className="container mx-auto px-4 py-8 min-h-[calc(100vh-200px)]">
        <Outlet />
      </main>
      <Footer />
      {showProfileSetup && <ProfileSetupModal />}
    </div>
  );
}

function HomePageWrapper() {
  const navigate = useNavigate();
  return <HomePage onNavigate={(page) => {
    switch (page) {
      case 'home': navigate({ to: '/home' }); break;
      case 'checkin': navigate({ to: '/daily-check-in' }); break;
      case 'gacha': navigate({ to: '/gacha' }); break;
      case 'profile': navigate({ to: '/profile' }); break;
      case 'admin': navigate({ to: '/admin' }); break;
      case 'newborn-entrance': navigate({ to: '/newborn-lucky-entrance' }); break;
      case 'reality-connection': navigate({ to: '/reality-connection' }); break;
      case 'nine-realms-hub': navigate({ to: '/nine-realms-hub' }); break;
    }
  }} />;
}

function UnifiedPortalWrapper() {
  const navigate = useNavigate();
  return <UnifiedLFLCDappPortalPage onNavigate={(page) => {
    switch (page) {
      case 'home': navigate({ to: '/home' }); break;
      case 'checkin': navigate({ to: '/daily-check-in' }); break;
      case 'gacha': navigate({ to: '/gacha' }); break;
      case 'profile': navigate({ to: '/profile' }); break;
      case 'admin': navigate({ to: '/admin' }); break;
      case 'newborn-entrance': navigate({ to: '/newborn-lucky-entrance' }); break;
      case 'metaverse-ascension': navigate({ to: '/metaverse-ascension' }); break;
      case 'reality-connection': navigate({ to: '/reality-connection' }); break;
      case 'nine-realms-hub': navigate({ to: '/nine-realms-hub' }); break;
    }
  }} />;
}

function NewbornLuckyEntrancePageWrapper() {
  const navigate = useNavigate();
  return <NewbornLuckyEntrancePage onNavigateBack={() => navigate({ to: '/home' })} />;
}

function TemplateSelectionPageWrapper() {
  const navigate = useNavigate();
  return <TemplateSelectionPage onSelectTemplate={(template) => {
    console.log('Selected template:', template);
    navigate({ to: '/home' });
  }} />;
}

function RealityConnectionPageWrapper() {
  const navigate = useNavigate();
  return <RealityConnectionPage onNavigateBack={() => navigate({ to: '/home' })} />;
}

function NineRealmsHubPageWrapper() {
  const navigate = useNavigate();
  return <NineRealmsHubPage 
    onNavigateBack={() => navigate({ to: '/home' })}
    onNavigateToRealm={(realmId) => navigate({ to: `/realm/${realmId}` })}
  />;
}

function RealmDetailPageWrapper() {
  const navigate = useNavigate();
  const params = useParams({ from: '/realm/$realmId' });
  const realmId = parseInt(params.realmId);
  return <RealmDetailPage 
    realmId={realmId}
    onNavigateBack={() => navigate({ to: '/nine-realms-hub' })}
  />;
}

function SubscriptionSuccessPageWrapper() {
  const navigate = useNavigate();
  return <SubscriptionSuccessPage onNavigateHome={() => navigate({ to: '/home' })} />;
}

const rootRoute = createRootRoute({
  component: Layout,
});

const indexRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: '/',
  component: LoginPage,
});

const homeRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: '/home',
  component: HomePageWrapper,
});

const unifiedPortalRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: '/unified-portal',
  component: UnifiedPortalWrapper,
});

const dailyCheckInRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: '/daily-check-in',
  component: DailyCheckInPage,
});

const gachaRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: '/gacha',
  component: GachaPage,
});

const profileRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: '/profile',
  component: ProfilePage,
});

const adminRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: '/admin',
  component: AdminPage,
});

const nftManagementRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: '/admin/nft-management',
  component: NFTManagementPage,
});

const transactionManagementRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: '/admin/transactions',
  component: TransactionManagementPage,
});

const newbornLuckyEntranceRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: '/newborn-lucky-entrance',
  component: NewbornLuckyEntrancePageWrapper,
});

const templateSelectionRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: '/template-selection',
  component: TemplateSelectionPageWrapper,
});

const metaverseAscensionRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: '/metaverse-ascension',
  component: MetaverseAscensionPage,
});

const realityConnectionRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: '/reality-connection',
  component: RealityConnectionPageWrapper,
});

const nineRealmsHubRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: '/nine-realms-hub',
  component: NineRealmsHubPageWrapper,
});

const realmDetailRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: '/realm/$realmId',
  component: RealmDetailPageWrapper,
});

const subscriptionSuccessRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: '/subscription-success',
  component: SubscriptionSuccessPageWrapper,
});

const dualDomainSyncRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: '/dual-domain-sync',
  component: DualDomainSyncPage,
});

const routeTree = rootRoute.addChildren([
  indexRoute,
  homeRoute,
  unifiedPortalRoute,
  dailyCheckInRoute,
  gachaRoute,
  profileRoute,
  adminRoute,
  nftManagementRoute,
  transactionManagementRoute,
  newbornLuckyEntranceRoute,
  templateSelectionRoute,
  metaverseAscensionRoute,
  realityConnectionRoute,
  nineRealmsHubRoute,
  realmDetailRoute,
  subscriptionSuccessRoute,
  dualDomainSyncRoute,
]);

const router = createRouter({ routeTree });

declare module '@tanstack/react-router' {
  interface Register {
    router: typeof router;
  }
}

export default function App() {
  return (
    <ThemeProvider attribute="class" defaultTheme="dark" enableSystem={false}>
      <QueryClientProvider client={queryClient}>
        <RouterProvider router={router} />
        <Toaster />
      </QueryClientProvider>
    </ThemeProvider>
  );
}
PK
frontend/src/index.css@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* LFLCEI Lucky Draw Games 系統全面調整優化版 - Light Mode */
    --background: oklch(0.98 0.01 220);
    --foreground: oklch(0.15 0.05 220);
    --card: oklch(0.96 0.02 220);
    --card-foreground: oklch(0.15 0.05 220);
    --popover: oklch(0.98 0.01 220);
    --popover-foreground: oklch(0.15 0.05 220);
    --primary: oklch(0.55 0.15 220);
    --primary-foreground: oklch(0.98 0.01 220);
    --secondary: oklch(0.75 0.12 200);
    --secondary-foreground: oklch(0.15 0.05 220);
    --muted: oklch(0.92 0.02 220);
    --muted-foreground: oklch(0.45 0.05 220);
    --accent: oklch(0.70 0.15 200);
    --accent-foreground: oklch(0.15 0.05 220);
    --destructive: oklch(0.55 0.20 25);
    --destructive-foreground: oklch(0.98 0.01 220);
    --border: oklch(0.85 0.03 220);
    --input: oklch(0.85 0.03 220);
    --ring: oklch(0.55 0.15 220);
    --radius: 0.75rem;
    
    /* 系統調整優化專用色彩 */
    --unified-primary: oklch(0.70 0.18 210);
    --unified-secondary: oklch(0.75 0.16 200);
    --unified-glow: oklch(0.80 0.20 205);
    --unified-aura: oklch(0.65 0.14 230);
    
    /* 每小時訂閱專用色彩 */
    --hourly-primary: oklch(0.75 0.18 45);
    --hourly-secondary: oklch(0.70 0.16 35);
    --hourly-glow: oklch(0.80 0.20 40);
  }

  .dark {
    /* LFLCEI Lucky Draw Games 系統全面調整優化版 - Dark Mode */
    --background: oklch(0.08 0.08 230);
    --foreground: oklch(0.92 0.03 210);
    --card: oklch(0.11 0.08 230);
    --card-foreground: oklch(0.92 0.03 210);
    --popover: oklch(0.08 0.08 230);
    --popover-foreground: oklch(0.92 0.03 210);
    --primary: oklch(0.65 0.18 210);
    --primary-foreground: oklch(0.98 0.01 230);
    --secondary: oklch(0.75 0.16 50);
    --secondary-foreground: oklch(0.98 0.01 230);
    --muted: oklch(0.16 0.08 230);
    --muted-foreground: oklch(0.68 0.05 210);
    --accent: oklch(0.80 0.18 50);
    --accent-foreground: oklch(0.98 0.01 230);
    --destructive: oklch(0.50 0.20 25);
    --destructive-foreground: oklch(0.98 0.01 230);
    --border: oklch(0.22 0.08 230);
    --input: oklch(0.22 0.08 230);
    --ring: oklch(0.75 0.16 210);
    
    /* 系統調整優化專用色彩 - 深色模式增強 */
    --unified-primary: oklch(0.72 0.20 205);
    --unified-secondary: oklch(0.78 0.18 195);
    --unified-glow: oklch(0.85 0.22 200);
    --unified-aura: oklch(0.68 0.16 220);
    
    /* 每小時訂閱專用色彩 - 深色模式 */
    --hourly-primary: oklch(0.78 0.20 45);
    --hourly-secondary: oklch(0.73 0.18 35);
    --hourly-glow: oklch(0.85 0.22 40);
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
    font-feature-settings: "rlig" 1, "calt" 1;
  }
}

/* ========================================
   GPU渲染效率優化 (GPU Rendering Efficiency Optimization)
   幀延遲減少 • 動畫時序一致性 • GPU資源管理 • 渲染批次優化 • 著色器性能調整
   ======================================== */

/* GPU 加速渲染 - 系統調整優化版本 */
.gpu-accelerated {
  transform: translate3d(0, 0, 0);
  backface-visibility: hidden;
  perspective: 1000px;
  will-change: transform;
}

/* 優化動畫關鍵幀 - 幀延遲減少 (界面層優化) */
@keyframes fade-in {
  from {
    opacity: 0;
    transform: translate3d(0, 4px, 0);
  }
  to {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
}

@keyframes pulse-slow {
  0%, 100% {
    opacity: 1;
    transform: scale3d(1, 1, 1);
  }
  50% {
    opacity: 0.8;
    transform: scale3d(1.025, 1.025, 1);
  }
}

@keyframes evolution-float {
  0% {
    transform: translate3d(0, 100vh, 0) rotate3d(0, 0, 1, 0deg) scale3d(1, 1, 1);
    opacity: 0;
  }
  10% {
    opacity: 1;
  }
  50% {
    transform: translate3d(0, 50vh, 0) rotate3d(0, 0, 1, 180deg) scale3d(1.1, 1.1, 1);
  }
  90% {
    opacity: 1;
  }
  100% {
    transform: translate3d(0, -100px, 0) rotate3d(0, 0, 1, 360deg) scale3d(0.9, 0.9, 1);
    opacity: 0;
  }
}

@keyframes manifestation-energy-pulse {
  0%, 100% {
    box-shadow: 
      0 0 14px oklch(0.72 0.20 205 / 0.5),
      0 0 28px oklch(0.78 0.18 195 / 0.4),
      0 0 42px oklch(0.85 0.22 200 / 0.3);
    filter: brightness(1) saturate(1);
  }
  50% {
    box-shadow: 
      0 0 24px oklch(0.72 0.20 205 / 0.7),
      0 0 48px oklch(0.78 0.18 195 / 0.6),
      0 0 72px oklch(0.85 0.22 200 / 0.5);
    filter: brightness(1.2) saturate(1.35);
  }
}

@keyframes hourly-billing-pulse {
  0%, 100% {
    box-shadow: 
      0 0 12px oklch(0.78 0.20 45 / 0.5),
      0 0 24px oklch(0.73 0.18 35 / 0.4),
      0 0 36px oklch(0.85 0.22 40 / 0.3);
    filter: brightness(1) saturate(1);
  }
  50% {
    box-shadow: 
      0 0 20px oklch(0.78 0.20 45 / 0.7),
      0 0 40px oklch(0.73 0.18 35 / 0.6),
      0 0 60px oklch(0.85 0.22 40 / 0.5);
    filter: brightness(1.15) saturate(1.3);
  }
}

@keyframes spiritual-aura-flow {
  0% {
    background-position: 0% 50%;
    opacity: 0.7;
  }
  50% {
    background-position: 100% 50%;
    opacity: 1;
  }
  100% {
    background-position: 0% 50%;
    opacity: 0.7;
  }
}

@keyframes evolution-page-transition {
  0% {
    opacity: 0;
    transform: perspective(1200px) rotateY(-4deg) translate3d(-8px, 0, -10px);
    filter: blur(1px);
  }
  100% {
    opacity: 1;
    transform: perspective(1200px) rotateY(0deg) translate3d(0, 0, 0);
    filter: blur(0);
  }
}

@keyframes glow-pulse {
  0%, 100% {
    box-shadow: 0 0 8px oklch(0.72 0.20 205 / 0.55);
  }
  50% {
    box-shadow: 0 0 14px oklch(0.78 0.18 195 / 0.8);
  }
}

@keyframes glow-pulse-evolution {
  0%, 100% {
    box-shadow: 0 0 12px oklch(0.72 0.20 205 / 0.65), 0 0 24px oklch(0.78 0.18 195 / 0.45);
  }
  50% {
    box-shadow: 0 0 20px oklch(0.72 0.20 205 / 0.9), 0 0 40px oklch(0.78 0.18 195 / 0.65);
  }
}

@keyframes enhanced-glow-transition {
  0%, 100% {
    text-shadow: 
      0 0 10px oklch(0.72 0.20 205 / 0.75),
      0 0 20px oklch(0.78 0.18 195 / 0.55);
  }
  50% {
    text-shadow: 
      0 0 16px oklch(0.72 0.20 205 / 0.95),
      0 0 32px oklch(0.78 0.18 195 / 0.75);
  }
}

/* 動畫類別 - 系統調整優化版本 */
.animate-fade-in {
  animation: fade-in 0.28s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  will-change: opacity, transform;
}

.animate-pulse-slow {
  animation: pulse-slow 2.4s ease-in-out infinite;
  will-change: opacity, transform;
}

.animate-manifestation-energy-pulse {
  animation: manifestation-energy-pulse 2.4s ease-in-out infinite;
  will-change: box-shadow, filter;
}

.animate-hourly-billing-pulse {
  animation: hourly-billing-pulse 2s ease-in-out infinite;
  will-change: box-shadow, filter;
}

.animate-spiritual-aura-flow {
  animation: spiritual-aura-flow 6.5s ease-in-out infinite;
  will-change: background-position, opacity;
}

.animate-glow-pulse {
  animation: glow-pulse 1.6s ease-in-out infinite;
  will-change: box-shadow;
}

.animate-glow-pulse-evolution {
  animation: glow-pulse-evolution 2s ease-in-out infinite;
  will-change: box-shadow;
}

.animate-enhanced-glow-transition {
  animation: enhanced-glow-transition 2.2s ease-in-out infinite;
  will-change: text-shadow;
}

.evolution-float {
  position: absolute;
  animation: evolution-float 13s linear infinite;
  will-change: transform, opacity;
  transform: translate3d(0, 0, 0);
  backface-visibility: hidden;
}

.evolution-page-transition {
  animation: evolution-page-transition 0.45s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  will-change: opacity, transform, filter;
  transform: translate3d(0, 0, 0);
  backface-visibility: hidden;
}

/* ========================================
   用戶界面響應性增強 (UI Responsiveness Enhancement)
   統一 UI/UX 元素 • 過渡動畫精煉 • 視覺層次統一 • 渲染一致性
   ======================================== */

/* 統一發光效果 - 系統調整優化版本 */
.manifestation-glow {
  text-shadow: 
    0 0 12px oklch(0.72 0.20 205 / 0.8),
    0 0 24px oklch(0.78 0.18 195 / 0.6),
    0 0 36px oklch(0.85 0.22 200 / 0.5),
    0 0 48px oklch(0.68 0.16 220 / 0.4);
  will-change: text-shadow;
}

.metaverse-glow {
  text-shadow: 
    0 0 14px oklch(0.72 0.20 205 / 0.85),
    0 0 28px oklch(0.78 0.18 195 / 0.7),
    0 0 42px oklch(0.85 0.22 200 / 0.5);
}

.clover-glow {
  text-shadow: 
    0 0 9px oklch(0.72 0.20 205 / 0.7),
    0 0 18px oklch(0.78 0.18 195 / 0.5);
}

.hourly-glow {
  text-shadow: 
    0 0 12px oklch(0.78 0.20 45 / 0.8),
    0 0 24px oklch(0.73 0.18 35 / 0.6),
    0 0 36px oklch(0.85 0.22 40 / 0.5);
  will-change: text-shadow;
}

/* 3D 卡片過渡效果 - 系統調整優化版本 (過渡動畫精煉) */
.card-transition {
  transition: 
    transform 0.24s cubic-bezier(0.34, 1.56, 0.64, 1), 
    box-shadow 0.24s cubic-bezier(0.34, 1.56, 0.64, 1),
    border-color 0.24s cubic-bezier(0.34, 1.56, 0.64, 1);
  will-change: transform, box-shadow;
  transform: translate3d(0, 0, 0);
  backface-visibility: hidden;
  transform-style: preserve-3d;
}

.card-transition:hover {
  transform: perspective(1000px) translate3d(0, -5px, 8px) rotateX(1.5deg);
  box-shadow: 
    0 14px 42px oklch(0.72 0.20 205 / 0.46), 
    0 7px 21px oklch(0.78 0.18 195 / 0.36),
    0 3px 10px oklch(0.85 0.22 200 / 0.26);
}

/* 統一粒子效果 - GPU 加速優化 (GPU資源管理) */
.evolution-particles {
  position: absolute;
  inset: 0;
  background-image: 
    radial-gradient(2px 2px at 20% 30%, oklch(0.72 0.20 205 / 0.44), transparent),
    radial-gradient(2px 2px at 60% 70%, oklch(0.78 0.18 195 / 0.44), transparent),
    radial-gradient(1px 1px at 50% 50%, oklch(0.85 0.22 200 / 0.34), transparent),
    radial-gradient(1px 1px at 80% 10%, oklch(0.68 0.16 220 / 0.34), transparent);
  background-size: 200% 200%;
  animation: evolution-particles-float 15s ease-in-out infinite;
  will-change: background-position;
  transform: translate3d(0, 0, 0);
}

@keyframes evolution-particles-float {
  0%, 100% {
    background-position: 0% 0%;
  }
  50% {
    background-position: 100% 100%;
  }
}

/* 載入狀態閃爍效果 - 系統調整優化版本 */
.shimmer {
  background: linear-gradient(
    90deg,
    oklch(0.72 0.20 205 / 0) 0%,
    oklch(0.78 0.18 195 / 0.46) 50%,
    oklch(0.72 0.20 205 / 0) 100%
  );
  background-size: 1000px 100%;
  animation: shimmer 1.6s infinite;
}

@keyframes shimmer {
  0% {
    background-position: -1000px 0;
  }
  100% {
    background-position: 1000px 0;
  }
}

/* ========================================
   跨平台兼容性 (Cross-Platform Compatibility) 系統調整優化版本
   響應式設計 • 桌面/平板/手機完美適配 • 性能調整
   ======================================== */

/* 響應式字體 - 系統調整優化版本 */
html {
  font-size: 16px;
  scroll-behavior: smooth;
}

@media (max-width: 640px) {
  html {
    font-size: 14px;
  }
  
  /* 移動端性能優化 - 減少粒子數量 (GPU資源管理) */
  .evolution-float:nth-child(n+4) {
    display: none;
  }
  
  /* 移動端動畫優化 - 幀延遲減少 */
  .animate-fade-in {
    animation-duration: 0.24s;
  }
  
  .evolution-page-transition {
    animation-duration: 0.38s;
    transform: perspective(800px) rotateY(0deg) translate3d(0, 0, 0);
  }
  
  /* 移動端 3D 效果簡化 (GPU渲染效率優化) */
  .card-transition:hover {
    transform: translate3d(0, -2px, 0);
    box-shadow: 0 6px 20px oklch(0.72 0.20 205 / 0.32);
  }
  
  /* 移動端發光效果簡化 (著色器性能調整) */
  .manifestation-glow {
    text-shadow: 
      0 0 9px oklch(0.72 0.20 205 / 0.7),
      0 0 18px oklch(0.78 0.18 195 / 0.5);
  }
  
  /* 移動端容器內距優化 */
  .container {
    padding-left: 1rem;
    padding-right: 1rem;
  }
  
  /* 移動端觸控目標優化 (UI響應性增強) */
  button {
    min-height: 44px;
    min-width: 44px;
    padding: 0.75rem 1rem;
  }
}

/* 平板端優化 */
@media (min-width: 641px) and (max-width: 1024px) {
  html {
    font-size: 15px;
  }
  
  .container {
    padding-left: 1.5rem;
    padding-right: 1.5rem;
  }
  
  /* 平板端適度 3D 效果 (過渡動畫精煉) */
  .card-transition:hover {
    transform: perspective(900px) translate3d(0, -4px, 6px) rotateX(1deg);
  }
}

/* 桌面端優化 */
@media (min-width: 1025px) {
  html {
    font-size: 16px;
  }
  
  .container {
    padding-left: 2rem;
    padding-right: 2rem;
  }
}

/* 觸控設備優化 (UI響應性增強) */
@media (hover: none) and (pointer: coarse) {
  button:hover:not(:active) {
    background-color: inherit;
    transform: none;
  }
  
  button:active:not(:disabled) {
    transform: scale3d(0.98, 0.98, 1);
    transition: transform 0.1s ease-out;
  }
  
  .card-transition:hover {
    transform: none;
    box-shadow: none;
  }
  
  button, a {
    touch-action: manipulation;
  }
}

/* ========================================
   錯誤處理與恢復機制強化 (Error Handling & Recovery Enhancement)
   按鈕交互 • 焦點狀態 • 滾動條樣式
   ======================================== */

button {
  transition: all 0.14s cubic-bezier(0.4, 0, 0.2, 1);
  transform: translate3d(0, 0, 0);
  backface-visibility: hidden;
  cursor: pointer;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

button:disabled {
  cursor: not-allowed;
  opacity: 0.5;
  pointer-events: none;
}

/* 焦點狀態 - 無障礙優化 */
button:focus-visible,
a:focus-visible,
input:focus-visible,
textarea:focus-visible {
  outline: 2px solid oklch(0.72 0.20 205);
  outline-offset: 3px;
}

/* 自定義滾動條 - 系統調整優化版本 */
::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

::-webkit-scrollbar-track {
  background: oklch(0.11 0.08 230);
  border-radius: 5px;
}

::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, oklch(0.72 0.20 205), oklch(0.78 0.18 195));
  border-radius: 5px;
  transition: background 0.24s ease;
}

::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(180deg, oklch(0.78 0.22 205), oklch(0.85 0.22 200));
}

/* 性能指示器 */
.performance-indicator {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: rgba(0, 0, 0, 0.8);
  color: oklch(0.72 0.20 205);
  padding: 6px 10px;
  border-radius: 6px;
  font-size: 10px;
  font-family: monospace;
  z-index: 9999;
  pointer-events: none;
  backdrop-filter: blur(10px);
}

/* 幀率優化類別 - 自適應資源管理 (GPU資源管理) */
.quality-high .evolution-float {
  animation-duration: 13s;
}

.quality-medium .evolution-float {
  animation-duration: 18s;
}

.quality-low .evolution-float {
  animation: none;
  opacity: 0.5;
}

/* 移動端性能優化 (GPU渲染效率優化) */
@media (max-width: 640px) {
  .quality-low .card-transition,
  .quality-medium .card-transition {
    transform: none !important;
  }
  
  .evolution-particles {
    opacity: 0.34;
    animation: none;
  }
  
  .card-transition {
    box-shadow: 0 3px 10px oklch(0.72 0.20 205 / 0.32);
  }
}

/* 減少動畫 - 無障礙支援 */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
  
  html {
    scroll-behavior: auto;
  }
  
  .evolution-float {
    animation: none;
  }
  
  .animate-fade-in,
  .animate-pulse-slow,
  .evolution-page-transition,
  .animate-manifestation-energy-pulse,
  .animate-spiritual-aura-flow,
  .animate-hourly-billing-pulse,
  .animate-enhanced-glow-transition {
    animation: none;
    opacity: 1;
    transform: none;
  }
  
  .card-transition:hover {
    transform: none;
  }
}

/* 文字渲染優化 - 跨平台一致性 */
body {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
}

/* 防止 FOUC */
#root {
  min-height: 100vh;
}

/* 系統調整優化專用工具類別 */
.unified-gradient-bg {
  background: linear-gradient(135deg, 
    oklch(0.72 0.20 205 / 0.15) 0%, 
    oklch(0.78 0.18 195 / 0.15) 50%, 
    oklch(0.85 0.22 200 / 0.15) 100%);
}

.unified-border {
  border-color: oklch(0.72 0.20 205 / 0.56);
}

.unified-text {
  color: oklch(0.72 0.20 205);
}

/* 每小時訂閱專用工具類別 */
.hourly-gradient-bg {
  background: linear-gradient(135deg, 
    oklch(0.78 0.20 45 / 0.2) 0%, 
    oklch(0.73 0.18 35 / 0.2) 50%, 
    oklch(0.85 0.22 40 / 0.2) 100%);
}

.hourly-border {
  border-color: oklch(0.78 0.20 45 / 0.56);
}

.hourly-text {
  color: oklch(0.78 0.20 45);
}

/* 響應式文字工具類別 - 跨平台一致性 (UI響應性增強) */
.text-responsive-xs {
  font-size: clamp(0.75rem, 2vw, 0.875rem);
}

.text-responsive-sm {
  font-size: clamp(0.875rem, 2.5vw, 1rem);
}

.text-responsive-base {
  font-size: clamp(1rem, 3vw, 1.125rem);
}

.text-responsive-lg {
  font-size: clamp(1.125rem, 3.5vw, 1.25rem);
}

.text-responsive-xl {
  font-size: clamp(1.25rem, 4vw, 1.5rem);
}

.text-responsive-2xl {
  font-size: clamp(1.5rem, 5vw, 2rem);
}

.text-responsive-3xl {
  font-size: clamp(1.875rem, 6vw, 2.5rem);
}

.text-responsive-4xl {
  font-size: clamp(2.25rem, 7vw, 3rem);
}

/* 動畫延遲工具類別 - 系統調整優化 */
.animation-delay-200 {
  animation-delay: 0.2s;
}

.animation-delay-400 {
  animation-delay: 0.4s;
}

.animation-delay-600 {
  animation-delay: 0.6s;
}
PK
frontend/src/main.tsximport ReactDOM from 'react-dom/client';
import { InternetIdentityProvider } from './hooks/useInternetIdentity';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import App from './App';
import './index.css';

const queryClient = new QueryClient();

ReactDOM.createRoot(document.getElementById('root')!).render(
    <QueryClientProvider client={queryClient}>
        <InternetIdentityProvider>
            <App />
        </InternetIdentityProvider>
    </QueryClientProvider>
);
PK
frontend/src/components/PK
frontend/src/components/AdvisoryPortalIntegration.tsximport { useState, useCallback } from 'react';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { ExternalLink, Shield } from 'lucide-react';
import { toast } from 'sonner';

interface AdvisoryPortalIntegrationProps {
  isAdmin: boolean;
  isRegisteredUser: boolean;
}

export default function AdvisoryPortalIntegration({ isAdmin, isRegisteredUser }: AdvisoryPortalIntegrationProps) {
  const [isOpening, setIsOpening] = useState(false);

  const handleOpenAdvisoryPortal = useCallback(async () => {
    if (!isRegisteredUser) {
      toast.error('請先完成個人資料設定');
      return;
    }

    setIsOpening(true);

    try {
      const advisoryPortalUrl = 'https://advisory-teal-yiq-draft.caffeine.xyz/';
      
      await new Promise(resolve => setTimeout(resolve, 300));
      
      const newWindow = window.open(advisoryPortalUrl, '_blank', 'noopener,noreferrer');
      
      if (!newWindow || newWindow.closed || typeof newWindow.closed === 'undefined') {
        toast.error('彈出視窗被阻擋，請允許彈出視窗後重試');
        setIsOpening(false);
        return;
      }

      newWindow.focus();
      toast.success('正在開啟 LFLC Advisory Portal...');
      
      setTimeout(() => {
        setIsOpening(false);
      }, 800);
    } catch (error) {
      console.error('Error opening Advisory Portal:', error);
      toast.error('開啟 Advisory Portal 失敗，請稍後再試');
      setIsOpening(false);
    }
  }, [isRegisteredUser]);

  return (
    <Card className="bg-gradient-to-r from-blue-900/50 to-indigo-800/50 border-blue-400/50 shadow-xl card-transition hover:shadow-blue-400/20">
      <CardHeader>
        <div className="flex items-center justify-between flex-wrap gap-4">
          <div className="flex-1">
            <CardTitle className="text-2xl sm:text-3xl text-blue-400 flex items-center gap-2">
              <img
                src="/assets/generated/advisory-portal-icon-transparent.dim_64x64.png"
                alt="Advisory Portal"
                className="h-8 w-8 animate-pulse"
              />
              LFLC Advisory Portal
              {isAdmin && <Shield className="h-5 w-5 text-amber-400" />}
            </CardTitle>
            <CardDescription className="text-blue-200 text-base sm:text-lg mt-2">
              專業諮詢服務平台 • 獲取專家建議與指導
            </CardDescription>
          </div>
          <img
            src="/assets/generated/advisory-portal-icon-transparent.dim_64x64.png"
            alt="Advisory Portal"
            className="h-16 w-16 sm:h-20 sm:w-20 rounded-full border-4 border-blue-400 shadow-lg animate-glow-pulse"
            loading="eager"
          />
        </div>
      </CardHeader>
      <CardContent className="space-y-4">
        <div className="bg-blue-950/50 rounded-xl p-4 sm:p-6 border border-blue-400/30">
          <p className="text-blue-100 text-sm sm:text-base leading-relaxed mb-4">
            LFLC Advisory Portal 提供專業的諮詢服務，包括技術支援、業務諮詢、策略規劃等。點擊下方按鈕進入諮詢平台。
          </p>
          <div className="flex flex-wrap gap-2 text-xs text-blue-200">
            <span className="bg-blue-900/30 px-3 py-1 rounded-full border border-blue-400/30">技術支援</span>
            <span className="bg-blue-900/30 px-3 py-1 rounded-full border border-blue-400/30">業務諮詢</span>
            <span className="bg-blue-900/30 px-3 py-1 rounded-full border border-blue-400/30">策略規劃</span>
            <span className="bg-blue-900/30 px-3 py-1 rounded-full border border-blue-400/30">專家指導</span>
          </div>
        </div>
        <Button
          onClick={handleOpenAdvisoryPortal}
          disabled={isOpening || !isRegisteredUser}
          className="w-full bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-bold text-base sm:text-lg py-6 transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-lg hover:shadow-blue-400/50"
        >
          {isOpening ? (
            <>
              <div className="h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent mr-2"></div>
              開啟中...
            </>
          ) : (
            <>
              <ExternalLink className="h-5 w-5 mr-2" />
              進入 Advisory Portal
            </>
          )}
        </Button>
        {!isRegisteredUser && (
          <p className="text-blue-300 text-sm text-center">
            請先完成個人資料設定以使用此功能
          </p>
        )}
      </CardContent>
    </Card>
  );
}

PK
frontend/src/components/CosmicCoreInterface.tsximport { useState, useEffect, useCallback, memo } from 'react';
import { Card, CardContent } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Progress } from '@/components/ui/progress';
import { 
  Orbit, 
  Zap, 
  Activity, 
  Sparkles, 
  TrendingUp,
  RefreshCw,
  ChevronDown,
  ChevronUp,
  Layers,
  Network,
  Clock,
  CheckCircle2,
  AlertCircle,
  WifiOff
} from 'lucide-react';
import { useGetSoulCollaborationSyncStatus, useGetCallerEnergyState, useGetCallerUserProfile, useUnifiedSystemSync } from '../hooks/useQueries';

interface CosmicCoreInterfaceProps {
  variant?: 'full' | 'compact' | 'minimal';
  showSyncControls?: boolean;
  className?: string;
  currentPage?: string;
}

function CosmicCoreInterface({ 
  variant = 'compact', 
  showSyncControls = true,
  className = '',
  currentPage = 'home'
}: CosmicCoreInterfaceProps) {
  const [isExpanded, setIsExpanded] = useState(false);
  const [syncProgress, setSyncProgress] = useState(0);
  const [moduleStatus, setModuleStatus] = useState<Record<string, 'active' | 'syncing' | 'idle'>>({
    '靈魂協作': 'active',
    'AI幸運': 'active',
    '元宇宙視覺化': 'active',
    '昇華系統': 'active',
    '支付模組': 'active',
    '跨平台介面': 'active',
  });
  
  const { data: syncStatus } = useGetSoulCollaborationSyncStatus();
  const { data: energyState } = useGetCallerEnergyState();
  const { data: userProfile } = useGetCallerUserProfile();
  const { performSync, lastSyncTime, isSyncing, syncError, retryCount, isIdle } = useUnifiedSystemSync();

  // Real-time module status simulation
  useEffect(() => {
    const interval = setInterval(() => {
      setModuleStatus(prev => {
        const updated = { ...prev };
        Object.keys(updated).forEach(key => {
          if (Math.random() > 0.95) {
            updated[key] = updated[key] === 'active' ? 'syncing' : 'active';
          }
        });
        return updated;
      });
    }, 3000);

    return () => clearInterval(interval);
  }, []);

  // Sync progress animation
  useEffect(() => {
    if (isSyncing) {
      setSyncProgress(0);
      const interval = setInterval(() => {
        setSyncProgress(prev => {
          if (prev >= 95) return 95;
          return prev + Math.random() * 15;
        });
      }, 200);
      
      return () => clearInterval(interval);
    } else {
      const timeout = setTimeout(() => setSyncProgress(0), 1000);
      return () => clearTimeout(timeout);
    }
  }, [isSyncing]);

  // Complete progress when sync finishes
  useEffect(() => {
    if (!isSyncing && syncProgress > 0 && syncProgress < 100) {
      setSyncProgress(100);
    }
  }, [isSyncing, syncProgress]);

  const handleManualSync = useCallback(async () => {
    try {
      setModuleStatus(prev => {
        const updated = { ...prev };
        Object.keys(updated).forEach(key => {
          updated[key] = 'syncing';
        });
        return updated;
      });

      await performSync(true);
      
      setModuleStatus(prev => {
        const updated = { ...prev };
        Object.keys(updated).forEach(key => {
          updated[key] = 'active';
        });
        return updated;
      });
    } catch (error) {
      console.error('Manual sync error:', error);
      setModuleStatus(prev => {
        const updated = { ...prev };
        Object.keys(updated).forEach(key => {
          updated[key] = 'active';
        });
        return updated;
      });
    }
  }, [performSync]);

  const getSyncStatusColor = () => {
    if (syncError) return 'text-red-400';
    if (isSyncing) return 'text-yellow-400';
    if (!syncStatus) return 'text-cyan-400';
    switch (syncStatus.lastSyncStatus) {
      case '統一同步成功':
      case '成功':
        return 'text-green-400';
      case '統一同步失敗':
      case '失敗':
        return 'text-red-400';
      case '統一同步中':
      case '同步中':
        return 'text-yellow-400';
      default:
        return 'text-amber-400';
    }
  };

  const formatTimestamp = (timestamp: bigint | number) => {
    const ts = typeof timestamp === 'bigint' ? Number(timestamp) : timestamp;
    if (ts === 0) return '尚未同步';
    
    const date = new Date(ts);
    const now = new Date();
    const diff = now.getTime() - date.getTime();
    const minutes = Math.floor(diff / 60000);
    
    if (minutes < 1) return '剛剛';
    if (minutes < 60) return `${minutes}分鐘前`;
    const hours = Math.floor(minutes / 60);
    if (hours < 24) return `${hours}小時前`;
    return date.toLocaleDateString('zh-TW');
  };

  const getNextSyncTime = () => {
    if (!lastSyncTime) return '待定';
    const interval = isIdle ? 300 : 60; // 5 minutes when idle, 60 seconds when active
    const nextSync = lastSyncTime + (interval * 1000);
    const remaining = Math.max(0, Math.floor((nextSync - Date.now()) / 1000));
    
    if (remaining === 0) return '即將同步';
    if (remaining < 60) return `${remaining}秒後`;
    const minutes = Math.floor(remaining / 60);
    return `${minutes}分鐘後`;
  };

  const getModuleStatusIndicator = (status: 'active' | 'syncing' | 'idle') => {
    switch (status) {
      case 'active':
        return <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse shadow-lg shadow-green-400/50" />;
      case 'syncing':
        return <div className="h-2 w-2 rounded-full bg-yellow-400 animate-spin border border-yellow-600" />;
      case 'idle':
        return <div className="h-2 w-2 rounded-full bg-gray-400" />;
    }
  };

  // Minimal variant - just a status indicator
  if (variant === 'minimal') {
    return (
      <div className={`flex items-center gap-2 ${className}`}>
        <div className="relative">
          <Orbit className="h-5 w-5 text-cyan-400 animate-spin" style={{ animationDuration: '8s' }} />
          <div className="absolute inset-0 bg-cyan-400/20 rounded-full blur-md animate-pulse"></div>
        </div>
        <span className={`text-sm ${getSyncStatusColor()}`}>
          {isSyncing ? '統一同步中' : syncError ? '同步失敗' : syncStatus?.lastSyncStatus || '待機中'}
        </span>
        {!syncError && (
          <span className="text-xs text-green-400 flex items-center gap-1">
            <CheckCircle2 className="h-3 w-3" />
            統一自動同步
          </span>
        )}
        {syncError && (
          <Button
            onClick={handleManualSync}
            disabled={isSyncing}
            size="sm"
            variant="ghost"
            className="text-red-400 hover:text-red-300 h-6 px-2"
          >
            <RefreshCw className="h-3 w-3" />
          </Button>
        )}
      </div>
    );
  }

  // Compact variant - collapsible panel with unified module status
  if (variant === 'compact') {
    return (
      <Card className={`bg-gradient-to-r from-cyan-950/80 to-blue-950/80 border-cyan-400/50 backdrop-blur-sm shadow-lg hover:shadow-cyan-400/30 transition-all gpu-accelerated ${className}`}>
        <CardContent className="p-4">
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3 flex-1">
              <div className="relative">
                <img
                  src="/assets/generated/cosmic-core-auto-sync-panel.dim_800x500.png"
                  alt="統一宇宙核心"
                  className="h-10 w-10 rounded-full border-2 border-cyan-400 animate-manifestation-energy-pulse"
                  loading="lazy"
                />
                <div className={`absolute -top-1 -right-1 h-3 w-3 rounded-full animate-pulse shadow-lg border border-cyan-950 ${
                  syncError ? 'bg-red-400 shadow-red-400/50' : 
                  isSyncing ? 'bg-yellow-400 shadow-yellow-400/50' : 
                  'bg-green-400 shadow-green-400/50'
                }`}></div>
                {!syncError && (
                  <div className="absolute -bottom-1 -right-1 h-3 w-3 rounded-full bg-blue-400 animate-pulse shadow-lg shadow-blue-400/50 border border-cyan-950"></div>
                )}
              </div>
              
              <div className="flex-1 min-w-0">
                <div className="flex items-center gap-2 mb-1 flex-wrap">
                  <h3 className="text-sm font-semibold text-cyan-400 manifestation-glow">統一宇宙核心</h3>
                  <span className={`text-xs ${getSyncStatusColor()}`}>
                    {isSyncing ? '統一同步中' : syncError ? `失敗 (重試 ${retryCount}/3)` : syncStatus?.lastSyncStatus || '待機'}
                  </span>
                  {!syncError && (
                    <span className="text-xs text-green-400 bg-green-900/30 px-2 py-0.5 rounded-full flex items-center gap-1">
                      <CheckCircle2 className="h-3 w-3" />
                      統一自動同步
                    </span>
                  )}
                  {isIdle && (
                    <span className="text-xs text-amber-400 bg-amber-900/30 px-2 py-0.5 rounded-full flex items-center gap-1">
                      <WifiOff className="h-3 w-3" />
                      閒置模式
                    </span>
                  )}
                  {currentPage && (
                    <span className="text-xs text-cyan-300 bg-cyan-900/30 px-2 py-0.5 rounded-full">
                      {currentPage}
                    </span>
                  )}
                </div>
                <div className="flex items-center gap-4 text-xs text-cyan-200 flex-wrap">
                  <span className="flex items-center gap-1">
                    <Sparkles className="h-3 w-3" />
                    {Number(userProfile?.points || 0n).toLocaleString()}
                  </span>
                  <span className="flex items-center gap-1">
                    <Zap className="h-3 w-3" />
                    {Number(energyState?.currentEnergy || 0n)}
                  </span>
                  <span className="flex items-center gap-1">
                    <Clock className="h-3 w-3" />
                    {formatTimestamp(lastSyncTime || syncStatus?.lastSyncTime || 0n)}
                  </span>
                </div>
              </div>
            </div>

            <div className="flex items-center gap-2">
              {showSyncControls && (
                <Button
                  onClick={handleManualSync}
                  disabled={isSyncing}
                  size="sm"
                  variant="ghost"
                  className={`${syncError ? 'text-red-400 hover:text-red-300' : 'text-cyan-400 hover:text-cyan-300'} hover:bg-cyan-400/10`}
                  title={syncError ? '手動重試統一同步' : '手動統一同步'}
                >
                  <RefreshCw className={`h-4 w-4 ${isSyncing ? 'animate-spin' : ''}`} />
                </Button>
              )}
              <Button
                onClick={() => setIsExpanded(!isExpanded)}
                size="sm"
                variant="ghost"
                className="text-cyan-400 hover:text-cyan-300 hover:bg-cyan-400/10"
              >
                {isExpanded ? <ChevronUp className="h-4 w-4" /> : <ChevronDown className="h-4 w-4" />}
              </Button>
            </div>
          </div>

          {/* Unified Sync Progress Bar with GPU Animation */}
          {isSyncing && (
            <div className="mt-3 animate-fade-in">
              <div className="relative">
                <Progress value={syncProgress} className="h-2 bg-cyan-950/50 overflow-hidden">
                  <div 
                    className="h-full bg-gradient-to-r from-cyan-400 via-blue-500 to-cyan-400 rounded-full transition-all duration-300 animate-spiritual-aura-flow relative"
                    style={{ width: `${syncProgress}%` }}
                  >
                    <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-shimmer"></div>
                  </div>
                </Progress>
                <img
                  src="/assets/generated/auto-sync-progress-indicator-transparent.dim_400x60.png"
                  alt="同步進度"
                  className="absolute top-0 left-0 h-2 w-full opacity-50 pointer-events-none"
                  loading="lazy"
                />
              </div>
              <p className="text-xs text-cyan-300 mt-1 text-center flex items-center justify-center gap-2">
                <Activity className="h-3 w-3 animate-pulse" />
                統一同步中... {Math.round(syncProgress)}%
              </p>
            </div>
          )}

          {/* Sync Error Display */}
          {syncError && !isSyncing && (
            <div className="mt-3 bg-red-900/30 border border-red-400/30 rounded-lg p-3 animate-fade-in">
              <div className="flex items-start gap-2">
                <AlertCircle className="h-4 w-4 text-red-400 flex-shrink-0 mt-0.5" />
                <div className="flex-1 min-w-0">
                  <p className="text-xs text-red-400 font-semibold mb-1">統一同步失敗</p>
                  <p className="text-xs text-red-300">{syncError}</p>
                  <p className="text-xs text-red-300 mt-1">已重試 {retryCount} 次，請使用手動同步按鈕重試</p>
                </div>
              </div>
            </div>
          )}

          {/* Expanded Unified Module Status */}
          {isExpanded && (
            <div className="mt-4 pt-4 border-t border-cyan-400/30 space-y-3 animate-fade-in">
              {/* Auto-Sync Status Card with Enhanced Info */}
              <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                <div className="flex items-center justify-between mb-2">
                  <div className="flex items-center gap-2">
                    <img
                      src="/assets/generated/sync-progress-indicator-transparent.dim_400x100.png"
                      alt="統一自動同步"
                      className="h-6 w-6"
                      loading="lazy"
                    />
                    <span className="text-xs text-cyan-200 font-semibold">統一自動同步狀態</span>
                  </div>
                  <div className="flex items-center gap-2">
                    {syncError && (
                      <span className="text-xs text-red-400 flex items-center gap-1">
                        <AlertCircle className="h-3 w-3" />
                        錯誤
                      </span>
                    )}
                    {!syncError && (
                      <span className="text-xs text-green-400 flex items-center gap-1">
                        <CheckCircle2 className="h-3 w-3" />
                        運行中
                      </span>
                    )}
                  </div>
                </div>
                <div className="space-y-1 text-xs">
                  <div className="flex items-center justify-between">
                    <span className="text-cyan-300">統一同步頻率</span>
                    <span className="text-cyan-400">{isIdle ? '每 5 分鐘 (閒置)' : '每 60 秒 (活躍)'}</span>
                  </div>
                  <div className="flex items-center justify-between">
                    <span className="text-cyan-300">最後同步</span>
                    <span className="text-cyan-400">{formatTimestamp(lastSyncTime)}</span>
                  </div>
                  <div className="flex items-center justify-between">
                    <span className="text-cyan-300">下次同步</span>
                    <span className="text-cyan-400">{getNextSyncTime()}</span>
                  </div>
                  {retryCount > 0 && (
                    <div className="flex items-center justify-between">
                      <span className="text-cyan-300">重試次數</span>
                      <span className="text-amber-400">{retryCount} / 3</span>
                    </div>
                  )}
                </div>
              </div>

              <div className="grid grid-cols-2 gap-3">
                <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                  <div className="flex items-center gap-2 mb-1">
                    <TrendingUp className="h-4 w-4 text-cyan-400" />
                    <span className="text-xs text-cyan-200">昇華等級</span>
                  </div>
                  <p className="text-lg font-bold text-cyan-400">
                    {Number(userProfile?.ascensionLevel || 0n)}
                  </p>
                </div>
                <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                  <div className="flex items-center gap-2 mb-1">
                    <Zap className="h-4 w-4 text-cyan-400" />
                    <span className="text-xs text-cyan-200">能量流動率</span>
                  </div>
                  <p className="text-lg font-bold text-cyan-400">
                    {energyState?.energyFlowRate.toFixed(2) || '0.00'}
                  </p>
                </div>
              </div>
              
              {/* Unified Module Status Grid */}
              <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                <div className="flex items-center gap-2 mb-3">
                  <Layers className="h-4 w-4 text-cyan-400" />
                  <p className="text-xs text-cyan-200 font-semibold">統一模組狀態</p>
                </div>
                <div className="grid grid-cols-2 gap-2">
                  {Object.entries(moduleStatus).map(([name, status]) => (
                    <div key={name} className="flex items-center justify-between text-xs bg-cyan-950/30 rounded-lg p-2">
                      <span className="text-cyan-300">{name}</span>
                      <div className="flex items-center gap-1">
                        {getModuleStatusIndicator(status)}
                        <span className={`text-xs ${
                          status === 'active' ? 'text-green-400' : 
                          status === 'syncing' ? 'text-yellow-400' : 
                          'text-gray-400'
                        }`}>
                          {status === 'active' ? '活躍' : status === 'syncing' ? '同步中' : '待機'}
                        </span>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              {/* Cross-Module Data Flow Indicator */}
              <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                <div className="flex items-center gap-2 mb-2">
                  <Network className="h-4 w-4 text-cyan-400" />
                  <p className="text-xs text-cyan-200 font-semibold">統一跨模組數據流</p>
                </div>
                <div className="flex items-center justify-between text-xs">
                  <span className="text-cyan-300">數據一致性</span>
                  <span className={syncError ? 'text-red-400' : 'text-green-400'}>
                    ● {syncError ? '異常' : '100%'}
                  </span>
                </div>
                <div className="flex items-center justify-between text-xs mt-1">
                  <span className="text-cyan-300">事件同步</span>
                  <span className={isSyncing ? 'text-yellow-400' : 'text-green-400'}>
                    ● {isSyncing ? '同步中' : '即時'}
                  </span>
                </div>
                <div className="flex items-center justify-between text-xs mt-1">
                  <span className="text-cyan-300">統一渲染管線</span>
                  <span className="text-green-400">● GPU加速</span>
                </div>
              </div>
            </div>
          )}
        </CardContent>
      </Card>
    );
  }

  // Full variant remains the same but with enhanced sync features
  return null;
}

export default memo(CosmicCoreInterface);
PK
frontend/src/components/EcosystemSyncDashboard.tsximport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import { useEcosystemSync, useEcosystemSyncStats } from '../hooks/useEcosystemSync';
import { Activity, CheckCircle2, XCircle, AlertCircle, Network, RefreshCw } from 'lucide-react';
import { Skeleton } from '@/components/ui/skeleton';
import { Button } from '@/components/ui/button';
import { useQueryClient } from '@tanstack/react-query';
import { toast } from 'sonner';

export default function EcosystemSyncDashboard() {
  const { data: endpoints, isLoading, refetch, isFetching } = useEcosystemSync();
  const stats = useEcosystemSyncStats();
  const queryClient = useQueryClient();

  const handleManualRefresh = async () => {
    toast.info('正在刷新生態系統連接狀態...');
    await refetch();
    toast.success('生態系統連接狀態已更新');
  };

  if (isLoading) {
    return (
      <Card className="bg-gradient-to-br from-indigo-900/50 via-purple-900/50 to-pink-900/50 border-indigo-400/50">
        <CardHeader>
          <CardTitle className="text-2xl text-indigo-400 flex items-center gap-2">
            <Network className="h-6 w-6 animate-pulse" />
            實時數據生態系統同步
          </CardTitle>
          <CardDescription className="text-indigo-200">18 個後端端點連接狀態</CardDescription>
        </CardHeader>
        <CardContent>
          <Skeleton className="h-40 w-full" />
        </CardContent>
      </Card>
    );
  }

  return (
    <Card className="bg-gradient-to-br from-indigo-900/50 via-purple-900/50 to-pink-900/50 border-indigo-400/50 shadow-xl">
      <CardHeader>
        <div className="flex items-center justify-between flex-wrap gap-4">
          <div className="flex items-center gap-3">
            <Network className="h-8 w-8 text-indigo-400 animate-pulse" />
            <div>
              <CardTitle className="text-2xl text-indigo-400">實時數據生態系統同步</CardTitle>
              <CardDescription className="text-indigo-200">18 個後端端點整合 • 每 30 秒自動刷新</CardDescription>
            </div>
          </div>
          <div className="flex items-center gap-3">
            <div className="text-right hidden sm:block">
              <p className="text-indigo-200 text-sm">連接率</p>
              <p className="text-3xl font-bold text-indigo-400">{stats.connectionRate.toFixed(0)}%</p>
            </div>
            <Button
              onClick={handleManualRefresh}
              disabled={isFetching}
              variant="outline"
              size="sm"
              className="border-indigo-400/50 text-indigo-200 hover:bg-indigo-400/20"
            >
              <RefreshCw className={`h-4 w-4 mr-2 ${isFetching ? 'animate-spin' : ''}`} />
              刷新
            </Button>
          </div>
        </div>
      </CardHeader>
      <CardContent className="space-y-4">
        {/* Stats Overview */}
        <div className="grid grid-cols-2 sm:grid-cols-4 gap-3">
          <div className="bg-indigo-950/50 rounded-lg p-3 border border-indigo-400/30">
            <p className="text-indigo-300 text-xs mb-1">總端點</p>
            <p className="text-2xl font-bold text-indigo-400">{stats.total}</p>
          </div>
          <div className="bg-green-950/50 rounded-lg p-3 border border-green-400/30">
            <p className="text-green-300 text-xs mb-1">已連接</p>
            <p className="text-2xl font-bold text-green-400">{stats.connected}</p>
          </div>
          <div className="bg-red-950/50 rounded-lg p-3 border border-red-400/30">
            <p className="text-red-300 text-xs mb-1">錯誤</p>
            <p className="text-2xl font-bold text-red-400">{stats.errors}</p>
          </div>
          <div className="bg-gray-950/50 rounded-lg p-3 border border-gray-400/30">
            <p className="text-gray-300 text-xs mb-1">未連接</p>
            <p className="text-2xl font-bold text-gray-400">{stats.disconnected}</p>
          </div>
        </div>

        {/* Endpoints List */}
        <div className="space-y-2 max-h-96 overflow-y-auto">
          {endpoints?.map((endpoint) => (
            <div
              key={endpoint.id}
              className={`flex items-center justify-between p-3 rounded-lg border transition-all ${
                endpoint.status === 'connected'
                  ? 'bg-green-950/30 border-green-400/30'
                  : endpoint.status === 'error'
                  ? 'bg-red-950/30 border-red-400/30'
                  : 'bg-gray-950/30 border-gray-400/30'
              }`}
            >
              <div className="flex items-center gap-3 flex-1">
                {endpoint.status === 'connected' ? (
                  <CheckCircle2 className="h-5 w-5 text-green-400 flex-shrink-0" />
                ) : endpoint.status === 'error' ? (
                  <XCircle className="h-5 w-5 text-red-400 flex-shrink-0" />
                ) : (
                  <AlertCircle className="h-5 w-5 text-gray-400 flex-shrink-0" />
                )}
                <div className="flex-1 min-w-0">
                  <p className="text-sm font-semibold text-indigo-200 truncate">{endpoint.name}</p>
                  <p className="text-xs text-indigo-300/70 truncate">{endpoint.canisterId}</p>
                </div>
              </div>
              <Badge
                variant={endpoint.status === 'connected' ? 'default' : 'destructive'}
                className={`ml-2 ${
                  endpoint.status === 'connected'
                    ? 'bg-green-500/20 text-green-400 border-green-400/50'
                    : endpoint.status === 'error'
                    ? 'bg-red-500/20 text-red-400 border-red-400/50'
                    : 'bg-gray-500/20 text-gray-400 border-gray-400/50'
                }`}
              >
                {endpoint.status === 'connected' ? '已連接' : endpoint.status === 'error' ? '錯誤' : '未連接'}
              </Badge>
            </div>
          ))}
        </div>

        {/* Sync Info */}
        <div className="bg-purple-950/30 rounded-lg p-3 border border-purple-400/30">
          <div className="flex items-center gap-2 mb-2">
            <Activity className="h-4 w-4 text-purple-400 animate-pulse" />
            <p className="text-sm font-semibold text-purple-300">實時同步狀態</p>
          </div>
          <p className="text-xs text-purple-200">
            系統正在與 {stats.total} 個後端端點進行實時數據同步，確保跨平台數據一致性和完整性。包含 Backend Ecosystem Hub、LFLCEI Anima、Oracle Platform、Natural Intelligence、Network Nervous System 等核心模組。
          </p>
        </div>

        {/* LFLC Response Envelope Info */}
        <div className="bg-cyan-950/30 rounded-lg p-3 border border-cyan-400/30">
          <div className="flex items-center gap-2 mb-2">
            <Network className="h-4 w-4 text-cyan-400" />
            <p className="text-sm font-semibold text-cyan-300">LFLC 統一響應協議</p>
          </div>
          <p className="text-xs text-cyan-200">
            所有後端通信遵循 LFLC_Response_Envelope 標準格式，包含 trace_id 追蹤、渲染提示處理和完整的錯誤恢復機制，確保界面連續性和後端完整性。
          </p>
        </div>
      </CardContent>
    </Card>
  );
}
PK
frontend/src/components/Footer.tsximport { Heart } from 'lucide-react';

export default function Footer() {
  return (
    <footer className="w-full border-t border-amber-400/30 bg-gradient-to-r from-slate-950/95 via-emerald-950/95 to-green-950/95 backdrop-blur-lg mt-auto gpu-accelerated">
      <div className="container mx-auto px-4 py-6">
        <div className="flex flex-col items-center justify-center gap-3 text-center">
          <div className="flex items-center gap-2 text-amber-400">
            <img
              src="/assets/generated/lflcei-eco-internet-main-logo-transparent.dim_400x400.png"
              alt="LFLCEI 幸運草生態互聯網"
              className="h-8 w-8 rounded-full border border-amber-400/50 animate-pulse"
              loading="lazy"
            />
            <span className="text-lg font-bold clover-glow">LFLCEI 幸運草生態互聯網</span>
          </div>
          
          <p className="text-sm text-emerald-300">
            全 3D WebGL 互動平台 • Unity/Unreal 相容 • Canister 模組化架構
          </p>
          
          <div className="flex items-center gap-2 text-sm text-emerald-200">
            <span>© 2025. Built with</span>
            <Heart className="h-4 w-4 text-pink-400 animate-pulse fill-pink-400" />
            <span>using</span>
            <a
              href="https://caffeine.ai"
              target="_blank"
              rel="noopener noreferrer"
              className="text-amber-400 hover:text-amber-300 font-semibold transition-colors underline decoration-amber-400/50 hover:decoration-amber-300"
            >
              caffeine.ai
            </a>
          </div>
          
          <p className="text-xs text-emerald-300/70 mt-2">
            桌面 • 平板 • 手機 跨平台 3D 完美兼容 • Internet Identity 2.0 自動登入
          </p>
        </div>
      </div>
    </footer>
  );
}
PK
frontend/src/components/FortuneSlipModal.tsximport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';
import { Sparkles } from 'lucide-react';
import type { FortuneMessage } from '../backend';

interface FortuneSlipModalProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  fortune: FortuneMessage | null;
}

export default function FortuneSlipModal({ open, onOpenChange, fortune }: FortuneSlipModalProps) {
  if (!fortune) return null;

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent className="bg-gradient-to-br from-emerald-900 to-emerald-800 border-amber-400 max-w-md">
        <DialogHeader>
          <DialogTitle className="text-2xl text-amber-400 text-center flex items-center justify-center gap-2">
            <Sparkles className="h-6 w-6" />
            今日幸運籤
            <Sparkles className="h-6 w-6" />
          </DialogTitle>
        </DialogHeader>
        <div className="py-8 px-4">
          <div className="relative">
            {/* Glowing clover background */}
            <div className="absolute inset-0 flex items-center justify-center opacity-20">
              <img
                src="/assets/generated/glowing-clover-transparent.dim_150x150.png"
                alt="Glowing Clover"
                className="h-32 w-32 animate-pulse"
              />
            </div>
            
            {/* Fortune scroll */}
            <div className="relative bg-gradient-to-b from-amber-100 to-amber-50 rounded-lg p-8 shadow-2xl border-4 border-amber-400 animate-scroll-reveal">
              <div className="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-amber-400 rounded-full p-2">
                <Sparkles className="h-5 w-5 text-emerald-900" />
              </div>
              
              <p className="text-center text-2xl font-bold text-emerald-900 leading-relaxed">
                {fortune.message}
              </p>
              
              <div className="mt-6 pt-4 border-t-2 border-amber-400/30">
                <p className="text-center text-sm text-emerald-700">
                  願幸運常伴您左右 🍀
                </p>
              </div>
            </div>
          </div>
        </div>
      </DialogContent>
    </Dialog>
  );
}
PK
frontend/src/components/FusionCoreInterface.tsximport { useState, useEffect, useCallback, memo } from 'react';
import { Card, CardContent } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Progress } from '@/components/ui/progress';
import { 
  Orbit, 
  Zap, 
  Activity, 
  Sparkles, 
  TrendingUp,
  RefreshCw,
  ChevronDown,
  ChevronUp,
  Layers,
  Network,
  Clock,
  CheckCircle2,
  AlertCircle,
  WifiOff
} from 'lucide-react';
import { useGetSoulCollaborationSyncStatus, useGetCallerEnergyState, useGetCallerUserProfile, useUnifiedSystemSync } from '../hooks/useQueries';

interface FusionCoreInterfaceProps {
  variant?: 'full' | 'compact' | 'minimal';
  showSyncControls?: boolean;
  className?: string;
  currentPage?: string;
}

function FusionCoreInterface({ 
  variant = 'compact', 
  showSyncControls = true,
  className = '',
  currentPage = 'home'
}: FusionCoreInterfaceProps) {
  const [isExpanded, setIsExpanded] = useState(false);
  const [syncProgress, setSyncProgress] = useState(0);
  const [moduleStatus, setModuleStatus] = useState<Record<string, 'active' | 'syncing' | 'idle'>>({
    '靈魂協作引擎': 'active',
    'AI同步邏輯': 'active',
    '訂閱支付系統': 'active',
    '九界融合模組': 'active',
    '現實連結系統': 'active',
    '跨平台渲染': 'active',
  });
  
  const { data: syncStatus } = useGetSoulCollaborationSyncStatus();
  const { data: energyState } = useGetCallerEnergyState();
  const { data: userProfile } = useGetCallerUserProfile();
  const { performSync, lastSyncTime, isSyncing, syncError, retryCount, isIdle } = useUnifiedSystemSync();

  // Real-time module status simulation
  useEffect(() => {
    const interval = setInterval(() => {
      setModuleStatus(prev => {
        const updated = { ...prev };
        Object.keys(updated).forEach(key => {
          if (Math.random() > 0.95) {
            updated[key] = updated[key] === 'active' ? 'syncing' : 'active';
          }
        });
        return updated;
      });
    }, 3000);

    return () => clearInterval(interval);
  }, []);

  // Sync progress animation
  useEffect(() => {
    if (isSyncing) {
      setSyncProgress(0);
      const interval = setInterval(() => {
        setSyncProgress(prev => {
          if (prev >= 95) return 95;
          return prev + Math.random() * 15;
        });
      }, 200);
      
      return () => clearInterval(interval);
    } else {
      const timeout = setTimeout(() => setSyncProgress(0), 1000);
      return () => clearTimeout(timeout);
    }
  }, [isSyncing]);

  // Complete progress when sync finishes
  useEffect(() => {
    if (!isSyncing && syncProgress > 0 && syncProgress < 100) {
      setSyncProgress(100);
    }
  }, [isSyncing, syncProgress]);

  const handleManualSync = useCallback(async () => {
    try {
      setModuleStatus(prev => {
        const updated = { ...prev };
        Object.keys(updated).forEach(key => {
          updated[key] = 'syncing';
        });
        return updated;
      });

      await performSync(true);
      
      setModuleStatus(prev => {
        const updated = { ...prev };
        Object.keys(updated).forEach(key => {
          updated[key] = 'active';
        });
        return updated;
      });
    } catch (error) {
      console.error('Manual sync error:', error);
      setModuleStatus(prev => {
        const updated = { ...prev };
        Object.keys(updated).forEach(key => {
          updated[key] = 'active';
        });
        return updated;
      });
    }
  }, [performSync]);

  const getSyncStatusColor = () => {
    if (syncError) return 'text-red-400';
    if (isSyncing) return 'text-yellow-400';
    if (!syncStatus) return 'text-cyan-400';
    switch (syncStatus.lastSyncStatus) {
      case '統一同步成功':
      case '成功':
        return 'text-green-400';
      case '統一同步失敗':
      case '失敗':
        return 'text-red-400';
      case '統一同步中':
      case '同步中':
        return 'text-yellow-400';
      default:
        return 'text-amber-400';
    }
  };

  const formatTimestamp = (timestamp: bigint | number) => {
    const ts = typeof timestamp === 'bigint' ? Number(timestamp) : timestamp;
    if (ts === 0) return '尚未同步';
    
    const date = new Date(ts);
    const now = new Date();
    const diff = now.getTime() - date.getTime();
    const minutes = Math.floor(diff / 60000);
    
    if (minutes < 1) return '剛剛';
    if (minutes < 60) return `${minutes}分鐘前`;
    const hours = Math.floor(minutes / 60);
    if (hours < 24) return `${hours}小時前`;
    return date.toLocaleDateString('zh-TW');
  };

  const getNextSyncTime = () => {
    if (!lastSyncTime) return '待定';
    const interval = isIdle ? 300 : 60; // 5 minutes when idle, 60 seconds when active
    const nextSync = lastSyncTime + (interval * 1000);
    const remaining = Math.max(0, Math.floor((nextSync - Date.now()) / 1000));
    
    if (remaining === 0) return '即將同步';
    if (remaining < 60) return `${remaining}秒後`;
    const minutes = Math.floor(remaining / 60);
    return `${minutes}分鐘後`;
  };

  const getModuleStatusIndicator = (status: 'active' | 'syncing' | 'idle') => {
    switch (status) {
      case 'active':
        return <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse shadow-lg shadow-green-400/50" />;
      case 'syncing':
        return <div className="h-2 w-2 rounded-full bg-yellow-400 animate-spin border border-yellow-600" />;
      case 'idle':
        return <div className="h-2 w-2 rounded-full bg-gray-400" />;
    }
  };

  // Minimal variant - just a status indicator
  if (variant === 'minimal') {
    return (
      <div className={`flex items-center gap-2 ${className}`}>
        <div className="relative">
          <Orbit className="h-5 w-5 text-cyan-400 animate-spin" style={{ animationDuration: '8s' }} />
          <div className="absolute inset-0 bg-cyan-400/20 rounded-full blur-md animate-pulse"></div>
        </div>
        <span className={`text-sm ${getSyncStatusColor()}`}>
          {isSyncing ? '融合中' : syncError ? '同步失敗' : syncStatus?.lastSyncStatus || '待機中'}
        </span>
        {!syncError && (
          <span className="text-xs text-green-400 flex items-center gap-1">
            <CheckCircle2 className="h-3 w-3" />
            自動融合
          </span>
        )}
        {syncError && (
          <Button
            onClick={handleManualSync}
            disabled={isSyncing}
            size="sm"
            variant="ghost"
            className="text-red-400 hover:text-red-300 h-6 px-2"
          >
            <RefreshCw className="h-3 w-3" />
          </Button>
        )}
      </div>
    );
  }

  // Compact variant - collapsible panel with unified module status
  if (variant === 'compact') {
    return (
      <Card className={`bg-gradient-to-r from-cyan-950/80 to-blue-950/80 border-cyan-400/50 backdrop-blur-sm shadow-lg hover:shadow-cyan-400/30 transition-all gpu-accelerated ${className}`}>
        <CardContent className="p-4">
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3 flex-1">
              <div className="relative">
                <img
                  src="/assets/generated/fusion-upgrade-core-engine-diagram.dim_800x600.png"
                  alt="融合核心"
                  className="h-10 w-10 rounded-full border-2 border-cyan-400 animate-manifestation-energy-pulse"
                  loading="lazy"
                />
                <div className={`absolute -top-1 -right-1 h-3 w-3 rounded-full animate-pulse shadow-lg border border-cyan-950 ${
                  syncError ? 'bg-red-400 shadow-red-400/50' : 
                  isSyncing ? 'bg-yellow-400 shadow-yellow-400/50' : 
                  'bg-green-400 shadow-green-400/50'
                }`}></div>
                {!syncError && (
                  <div className="absolute -bottom-1 -right-1 h-3 w-3 rounded-full bg-blue-400 animate-pulse shadow-lg shadow-blue-400/50 border border-cyan-950"></div>
                )}
              </div>
              
              <div className="flex-1 min-w-0">
                <div className="flex items-center gap-2 mb-1 flex-wrap">
                  <h3 className="text-sm font-semibold text-cyan-400 manifestation-glow">代碼之內融合核心</h3>
                  <span className={`text-xs ${getSyncStatusColor()}`}>
                    {isSyncing ? '融合中' : syncError ? `失敗 (重試 ${retryCount}/3)` : syncStatus?.lastSyncStatus || '待機'}
                  </span>
                  {!syncError && (
                    <span className="text-xs text-green-400 bg-green-900/30 px-2 py-0.5 rounded-full flex items-center gap-1">
                      <CheckCircle2 className="h-3 w-3" />
                      自動融合
                    </span>
                  )}
                  {isIdle && (
                    <span className="text-xs text-amber-400 bg-amber-900/30 px-2 py-0.5 rounded-full flex items-center gap-1">
                      <WifiOff className="h-3 w-3" />
                      閒置模式
                    </span>
                  )}
                  {currentPage && (
                    <span className="text-xs text-cyan-300 bg-cyan-900/30 px-2 py-0.5 rounded-full">
                      {currentPage}
                    </span>
                  )}
                </div>
                <div className="flex items-center gap-4 text-xs text-cyan-200 flex-wrap">
                  <span className="flex items-center gap-1">
                    <Sparkles className="h-3 w-3" />
                    {Number(userProfile?.points || 0n).toLocaleString()}
                  </span>
                  <span className="flex items-center gap-1">
                    <Zap className="h-3 w-3" />
                    {Number(energyState?.currentEnergy || 0n)}
                  </span>
                  <span className="flex items-center gap-1">
                    <Clock className="h-3 w-3" />
                    {formatTimestamp(lastSyncTime || syncStatus?.lastSyncTime || 0n)}
                  </span>
                </div>
              </div>
            </div>

            <div className="flex items-center gap-2">
              {showSyncControls && (
                <Button
                  onClick={handleManualSync}
                  disabled={isSyncing}
                  size="sm"
                  variant="ghost"
                  className={`${syncError ? 'text-red-400 hover:text-red-300' : 'text-cyan-400 hover:text-cyan-300'} hover:bg-cyan-400/10`}
                  title={syncError ? '手動重試融合' : '手動融合'}
                >
                  <RefreshCw className={`h-4 w-4 ${isSyncing ? 'animate-spin' : ''}`} />
                </Button>
              )}
              <Button
                onClick={() => setIsExpanded(!isExpanded)}
                size="sm"
                variant="ghost"
                className="text-cyan-400 hover:text-cyan-300 hover:bg-cyan-400/10"
              >
                {isExpanded ? <ChevronUp className="h-4 w-4" /> : <ChevronDown className="h-4 w-4" />}
              </Button>
            </div>
          </div>

          {/* Unified Fusion Progress Bar with GPU Animation */}
          {isSyncing && (
            <div className="mt-3 animate-fade-in">
              <div className="relative">
                <Progress value={syncProgress} className="h-2 bg-cyan-950/50 overflow-hidden">
                  <div 
                    className="h-full bg-gradient-to-r from-cyan-400 via-blue-500 to-cyan-400 rounded-full transition-all duration-300 animate-spiritual-aura-flow relative"
                    style={{ width: `${syncProgress}%` }}
                  >
                    <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-shimmer"></div>
                  </div>
                </Progress>
                <img
                  src="/assets/generated/animation-fluidity-indicator-transparent.dim_150x150.png"
                  alt="融合進度"
                  className="absolute top-0 left-0 h-2 w-full opacity-50 pointer-events-none"
                  loading="lazy"
                />
              </div>
              <p className="text-xs text-cyan-300 mt-1 text-center flex items-center justify-center gap-2">
                <Activity className="h-3 w-3 animate-pulse" />
                統一融合中... {Math.round(syncProgress)}%
              </p>
            </div>
          )}

          {/* Sync Error Display */}
          {syncError && !isSyncing && (
            <div className="mt-3 bg-red-900/30 border border-red-400/30 rounded-lg p-3 animate-fade-in">
              <div className="flex items-start gap-2">
                <AlertCircle className="h-4 w-4 text-red-400 flex-shrink-0 mt-0.5" />
                <div className="flex-1 min-w-0">
                  <p className="text-xs text-red-400 font-semibold mb-1">融合失敗</p>
                  <p className="text-xs text-red-300">{syncError}</p>
                  <p className="text-xs text-red-300 mt-1">已重試 {retryCount} 次，請使用手動融合按鈕重試</p>
                </div>
              </div>
            </div>
          )}

          {/* Expanded Unified Module Status */}
          {isExpanded && (
            <div className="mt-4 pt-4 border-t border-cyan-400/30 space-y-3 animate-fade-in">
              {/* Auto-Fusion Status Card with Enhanced Info */}
              <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                <div className="flex items-center justify-between mb-2">
                  <div className="flex items-center gap-2">
                    <img
                      src="/assets/generated/ai-sync-logic-system-visualization.dim_600x400.png"
                      alt="自動融合"
                      className="h-6 w-6"
                      loading="lazy"
                    />
                    <span className="text-xs text-cyan-200 font-semibold">自動融合狀態</span>
                  </div>
                  <div className="flex items-center gap-2">
                    {syncError && (
                      <span className="text-xs text-red-400 flex items-center gap-1">
                        <AlertCircle className="h-3 w-3" />
                        錯誤
                      </span>
                    )}
                    {!syncError && (
                      <span className="text-xs text-green-400 flex items-center gap-1">
                        <CheckCircle2 className="h-3 w-3" />
                        運行中
                      </span>
                    )}
                  </div>
                </div>
                <div className="space-y-1 text-xs">
                  <div className="flex items-center justify-between">
                    <span className="text-cyan-300">融合頻率</span>
                    <span className="text-cyan-400">{isIdle ? '每 5 分鐘 (閒置)' : '每 60 秒 (活躍)'}</span>
                  </div>
                  <div className="flex items-center justify-between">
                    <span className="text-cyan-300">最後融合</span>
                    <span className="text-cyan-400">{formatTimestamp(lastSyncTime)}</span>
                  </div>
                  <div className="flex items-center justify-between">
                    <span className="text-cyan-300">下次融合</span>
                    <span className="text-cyan-400">{getNextSyncTime()}</span>
                  </div>
                  {retryCount > 0 && (
                    <div className="flex items-center justify-between">
                      <span className="text-cyan-300">重試次數</span>
                      <span className="text-amber-400">{retryCount} / 3</span>
                    </div>
                  )}
                </div>
              </div>

              <div className="grid grid-cols-2 gap-3">
                <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                  <div className="flex items-center gap-2 mb-1">
                    <TrendingUp className="h-4 w-4 text-cyan-400" />
                    <span className="text-xs text-cyan-200">昇華等級</span>
                  </div>
                  <p className="text-lg font-bold text-cyan-400">
                    {Number(userProfile?.ascensionLevel || 0n)}
                  </p>
                </div>
                <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                  <div className="flex items-center gap-2 mb-1">
                    <Zap className="h-4 w-4 text-cyan-400" />
                    <span className="text-xs text-cyan-200">能量流動率</span>
                  </div>
                  <p className="text-lg font-bold text-cyan-400">
                    {energyState?.energyFlowRate.toFixed(2) || '0.00'}
                  </p>
                </div>
              </div>
              
              {/* Unified Module Status Grid */}
              <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                <div className="flex items-center gap-2 mb-3">
                  <Layers className="h-4 w-4 text-cyan-400" />
                  <p className="text-xs text-cyan-200 font-semibold">融合模組狀態</p>
                </div>
                <div className="grid grid-cols-2 gap-2">
                  {Object.entries(moduleStatus).map(([name, status]) => (
                    <div key={name} className="flex items-center justify-between text-xs bg-cyan-950/30 rounded-lg p-2">
                      <span className="text-cyan-300">{name}</span>
                      <div className="flex items-center gap-1">
                        {getModuleStatusIndicator(status)}
                        <span className={`text-xs ${
                          status === 'active' ? 'text-green-400' : 
                          status === 'syncing' ? 'text-yellow-400' : 
                          'text-gray-400'
                        }`}>
                          {status === 'active' ? '活躍' : status === 'syncing' ? '融合中' : '待機'}
                        </span>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              {/* Unified Data Flow Indicator */}
              <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                <div className="flex items-center gap-2 mb-2">
                  <Network className="h-4 w-4 text-cyan-400" />
                  <p className="text-xs text-cyan-200 font-semibold">統一數據流</p>
                </div>
                <div className="flex items-center justify-between text-xs">
                  <span className="text-cyan-300">數據一致性</span>
                  <span className={syncError ? 'text-red-400' : 'text-green-400'}>
                    ● {syncError ? '異常' : '100%'}
                  </span>
                </div>
                <div className="flex items-center justify-between text-xs mt-1">
                  <span className="text-cyan-300">事件同步</span>
                  <span className={isSyncing ? 'text-yellow-400' : 'text-green-400'}>
                    ● {isSyncing ? '融合中' : '即時'}
                  </span>
                </div>
                <div className="flex items-center justify-between text-xs mt-1">
                  <span className="text-cyan-300">渲染管線</span>
                  <span className="text-green-400">● GPU加速</span>
                </div>
                <div className="flex items-center justify-between text-xs mt-1">
                  <span className="text-cyan-300">跨平台兼容</span>
                  <span className="text-green-400">● 優化完成</span>
                </div>
              </div>
            </div>
          )}
        </CardContent>
      </Card>
    );
  }

  // Full variant remains the same but with enhanced fusion features
  return null;
}

export default memo(FusionCoreInterface);
PK
frontend/src/components/Header.tsximport { useState } from 'react';
import { useInternetIdentity } from '../hooks/useInternetIdentity';
import { useQueryClient } from '@tanstack/react-query';
import { Button } from '@/components/ui/button';
import { Menu, X, Home, Calendar, Gift, User, Shield, Sparkles, Globe, Layers, Zap, Wallet, Database, BarChart3, Orbit } from 'lucide-react';

type Page = 'home' | 'checkin' | 'gacha' | 'profile' | 'admin' | 'newborn-entrance' | 'metaverse-ascension' | 'reality-connection' | 'nine-realms-hub' | 'realm' | 'unified-portal';

interface HeaderProps {
  currentPage: Page;
  onNavigate: (page: Page) => void;
}

export default function Header({ currentPage, onNavigate }: HeaderProps) {
  const { login, clear, loginStatus, identity } = useInternetIdentity();
  const queryClient = useQueryClient();
  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);

  const isAuthenticated = !!identity;
  const disabled = loginStatus === 'logging-in';
  const text = loginStatus === 'logging-in' ? '登入中...' : isAuthenticated ? '登出' : '登入';

  const handleAuth = async () => {
    if (isAuthenticated) {
      await clear();
      queryClient.clear();
    } else {
      try {
        await login();
      } catch (error: any) {
        console.error('Login error:', error);
        if (error.message === 'User is already authenticated') {
          await clear();
          setTimeout(() => login(), 300);
        }
      }
    }
  };

  const handleNavigation = (page: Page) => {
    onNavigate(page);
    setMobileMenuOpen(false);
  };

  const handleOracleClick = () => {
    const overlay = document.createElement('div');
    overlay.className = 'fixed inset-0 z-[9999] pointer-events-none';
    overlay.style.background = 'radial-gradient(circle at center, rgba(251, 191, 36, 0.3) 0%, transparent 70%)';
    overlay.style.animation = 'oracle-transition 0.6s ease-out';
    document.body.appendChild(overlay);

    if (!document.getElementById('oracle-transition-style')) {
      const style = document.createElement('style');
      style.id = 'oracle-transition-style';
      style.textContent = `
        @keyframes oracle-transition {
          0% { opacity: 0; transform: scale(0.8); }
          50% { opacity: 1; transform: scale(1.1); }
          100% { opacity: 0; transform: scale(1.5); }
        }
      `;
      document.head.appendChild(style);
    }

    requestAnimationFrame(() => {
      window.open('https://lflc-oracle-4bu.caffeine.xyz', '_blank', 'noopener,noreferrer');
    });

    setTimeout(() => {
      overlay.remove();
    }, 600);
  };

  const handleNaturalIntelligenceClick = () => {
    window.open('https://lflc-natural-intelligence-spd.caffeine.xyz/', '_blank', 'noopener,noreferrer');
  };

  const handleWalletClick = () => {
    window.open('https://lflc-wallet-mm9.caffeine.xyz/', '_blank', 'noopener,noreferrer');
  };

  const handleDashboardClick = () => {
    window.open('https://lflc-backstage-supporter-ixz.caffeine.xyz/', '_blank', 'noopener,noreferrer');
  };

  return (
    <header className="sticky top-0 z-50 w-full border-b border-amber-400/30 bg-gradient-to-r from-slate-950/95 via-emerald-950/95 to-green-950/95 backdrop-blur-lg shadow-lg shadow-amber-400/10 gpu-accelerated">
      <div className="container mx-auto px-4 py-3 sm:py-4">
        <div className="flex items-center justify-between">
          <div className="flex items-center gap-3 cursor-pointer transition-transform hover:scale-105" onClick={() => handleNavigation('home')}>
            <img
              src="/assets/generated/lflcei-eco-internet-main-logo-transparent.dim_400x400.png"
              alt="LFLCEI 幸運草生態互聯網"
              className="h-10 w-10 sm:h-12 sm:w-12 rounded-full border-2 border-amber-400 shadow-lg shadow-amber-400/50 animate-manifestation-energy-pulse"
              loading="eager"
            />
            <div>
              <h1 className="text-base sm:text-lg md:text-xl font-bold text-amber-400 clover-glow leading-tight">
                LFLCEI 幸運草生態互聯網
              </h1>
              <p className="text-xs text-emerald-300 hidden sm:block">全 3D WebGL 互動平台</p>
            </div>
          </div>

          <nav className="hidden lg:flex items-center gap-2">
            <Button
              onClick={() => handleNavigation('unified-portal')}
              variant={currentPage === 'unified-portal' ? 'default' : 'ghost'}
              className={`transition-all gpu-accelerated ${
                currentPage === 'unified-portal'
                  ? 'bg-gradient-to-r from-amber-500 to-green-600 hover:from-amber-600 hover:to-green-700 text-white'
                  : 'text-amber-400 hover:text-amber-300 hover:bg-amber-400/10'
              }`}
            >
              <Orbit className="h-4 w-4 mr-2" />
              統一入口
            </Button>
            <Button
              onClick={() => handleNavigation('home')}
              variant={currentPage === 'home' ? 'default' : 'ghost'}
              className={`transition-all gpu-accelerated ${
                currentPage === 'home'
                  ? 'bg-amber-500 hover:bg-amber-600 text-emerald-950'
                  : 'text-amber-400 hover:text-amber-300 hover:bg-amber-400/10'
              }`}
            >
              <Home className="h-4 w-4 mr-2" />
              首頁
            </Button>
            <Button
              onClick={() => handleNavigation('nine-realms-hub')}
              variant={currentPage === 'nine-realms-hub' || currentPage === 'realm' ? 'default' : 'ghost'}
              className={`transition-all gpu-accelerated ${
                currentPage === 'nine-realms-hub' || currentPage === 'realm'
                  ? 'bg-purple-500 hover:bg-purple-600 text-white'
                  : 'text-purple-400 hover:text-purple-300 hover:bg-purple-400/10'
              }`}
            >
              <Layers className="h-4 w-4 mr-2" />
              九界核心
            </Button>
            <Button
              onClick={() => handleNavigation('reality-connection')}
              variant={currentPage === 'reality-connection' ? 'default' : 'ghost'}
              className={`transition-all gpu-accelerated ${
                currentPage === 'reality-connection'
                  ? 'bg-blue-500 hover:bg-blue-600 text-white'
                  : 'text-blue-400 hover:text-blue-300 hover:bg-blue-400/10'
              }`}
            >
              <Globe className="h-4 w-4 mr-2" />
              現實連結
            </Button>
            <Button
              onClick={handleOracleClick}
              variant="ghost"
              className="text-amber-400 hover:text-amber-300 hover:bg-amber-400/10 relative group transition-all gpu-accelerated"
            >
              <Zap className="h-4 w-4 mr-2 group-hover:animate-pulse" />
              Oracle
              <div className="absolute inset-0 bg-amber-400/20 rounded-md opacity-0 group-hover:opacity-100 transition-opacity blur-sm"></div>
            </Button>
            <Button
              onClick={handleNaturalIntelligenceClick}
              variant="ghost"
              className="text-emerald-400 hover:text-emerald-300 hover:bg-emerald-400/10 transition-all gpu-accelerated"
            >
              <Sparkles className="h-4 w-4 mr-2" />
              自然智能
            </Button>
            <Button
              onClick={handleWalletClick}
              variant="ghost"
              className="text-amber-400 hover:text-amber-300 hover:bg-amber-400/10 transition-all gpu-accelerated"
            >
              <Wallet className="h-4 w-4 mr-2" />
              錢包
            </Button>
            <Button
              onClick={handleDashboardClick}
              variant="ghost"
              className="text-pink-400 hover:text-pink-300 hover:bg-pink-400/10 transition-all gpu-accelerated"
            >
              <BarChart3 className="h-4 w-4 mr-2" />
              儀表板
            </Button>
            <Button
              onClick={() => handleNavigation('profile')}
              variant={currentPage === 'profile' ? 'default' : 'ghost'}
              className={`transition-all gpu-accelerated ${
                currentPage === 'profile'
                  ? 'bg-amber-500 hover:bg-amber-600 text-emerald-950'
                  : 'text-amber-400 hover:text-amber-300 hover:bg-amber-400/10'
              }`}
            >
              <User className="h-4 w-4 mr-2" />
              個人
            </Button>
          </nav>

          <div className="flex items-center gap-2">
            <Button
              onClick={handleAuth}
              disabled={disabled}
              className={`gpu-accelerated ${
                isAuthenticated
                  ? 'bg-gradient-to-r from-red-500 to-pink-600 hover:from-red-600 hover:to-pink-700'
                  : 'bg-gradient-to-r from-amber-500 to-green-600 hover:from-amber-600 hover:to-green-700'
              } text-white font-semibold shadow-lg transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed`}
            >
              {text}
            </Button>

            <Button
              onClick={() => setMobileMenuOpen(!mobileMenuOpen)}
              variant="ghost"
              className="lg:hidden text-amber-400 hover:text-amber-300 hover:bg-amber-400/10 transition-all gpu-accelerated"
            >
              {mobileMenuOpen ? <X className="h-6 w-6" /> : <Menu className="h-6 w-6" />}
            </Button>
          </div>
        </div>

        {mobileMenuOpen && (
          <nav className="lg:hidden mt-4 pb-4 space-y-2 animate-fade-in">
            <Button
              onClick={() => handleNavigation('unified-portal')}
              variant={currentPage === 'unified-portal' ? 'default' : 'ghost'}
              className={`w-full justify-start transition-all gpu-accelerated ${
                currentPage === 'unified-portal'
                  ? 'bg-gradient-to-r from-amber-500 to-green-600 text-white'
                  : 'text-amber-400 hover:text-amber-300 hover:bg-amber-400/10'
              }`}
            >
              <Orbit className="h-4 w-4 mr-2" />
              統一入口
            </Button>
            <Button
              onClick={() => handleNavigation('home')}
              variant={currentPage === 'home' ? 'default' : 'ghost'}
              className={`w-full justify-start transition-all gpu-accelerated ${
                currentPage === 'home'
                  ? 'bg-amber-500 hover:bg-amber-600 text-emerald-950'
                  : 'text-amber-400 hover:text-amber-300 hover:bg-amber-400/10'
              }`}
            >
              <Home className="h-4 w-4 mr-2" />
              首頁
            </Button>
            <Button
              onClick={() => handleNavigation('nine-realms-hub')}
              variant={currentPage === 'nine-realms-hub' || currentPage === 'realm' ? 'default' : 'ghost'}
              className={`w-full justify-start transition-all gpu-accelerated ${
                currentPage === 'nine-realms-hub' || currentPage === 'realm'
                  ? 'bg-purple-500 hover:bg-purple-600 text-white'
                  : 'text-purple-400 hover:text-purple-300 hover:bg-purple-400/10'
              }`}
            >
              <Layers className="h-4 w-4 mr-2" />
              九界核心框架
            </Button>
            <Button
              onClick={() => handleNavigation('reality-connection')}
              variant={currentPage === 'reality-connection' ? 'default' : 'ghost'}
              className={`w-full justify-start transition-all gpu-accelerated ${
                currentPage === 'reality-connection'
                  ? 'bg-blue-500 hover:bg-blue-600 text-white'
                  : 'text-blue-400 hover:text-blue-300 hover:bg-blue-400/10'
              }`}
            >
              <Globe className="h-4 w-4 mr-2" />
              現實連結模組
            </Button>
            <Button
              onClick={handleOracleClick}
              variant="ghost"
              className="w-full justify-start text-amber-400 hover:text-amber-300 hover:bg-amber-400/10 relative group transition-all gpu-accelerated"
            >
              <Zap className="h-4 w-4 mr-2 group-hover:animate-pulse" />
              Oracle平台
              <div className="absolute inset-0 bg-amber-400/20 rounded-md opacity-0 group-hover:opacity-100 transition-opacity blur-sm"></div>
            </Button>
            <Button
              onClick={handleNaturalIntelligenceClick}
              variant="ghost"
              className="w-full justify-start text-emerald-400 hover:text-emerald-300 hover:bg-emerald-400/10 transition-all gpu-accelerated"
            >
              <Sparkles className="h-4 w-4 mr-2" />
              自然智能系統
            </Button>
            <Button
              onClick={handleWalletClick}
              variant="ghost"
              className="w-full justify-start text-amber-400 hover:text-amber-300 hover:bg-amber-400/10 transition-all gpu-accelerated"
            >
              <Wallet className="h-4 w-4 mr-2" />
              錢包系統
            </Button>
            <Button
              onClick={handleDashboardClick}
              variant="ghost"
              className="w-full justify-start text-pink-400 hover:text-pink-300 hover:bg-pink-400/10 transition-all gpu-accelerated"
            >
              <BarChart3 className="h-4 w-4 mr-2" />
              儀表板系統
            </Button>
            <Button
              onClick={() => handleNavigation('checkin')}
              variant={currentPage === 'checkin' ? 'default' : 'ghost'}
              className={`w-full justify-start transition-all gpu-accelerated ${
                currentPage === 'checkin'
                  ? 'bg-amber-500 hover:bg-amber-600 text-emerald-950'
                  : 'text-amber-400 hover:text-amber-300 hover:bg-amber-400/10'
              }`}
            >
              <Calendar className="h-4 w-4 mr-2" />
              每日簽到
            </Button>
            <Button
              onClick={() => handleNavigation('gacha')}
              variant={currentPage === 'gacha' ? 'default' : 'ghost'}
              className={`w-full justify-start transition-all gpu-accelerated ${
                currentPage === 'gacha'
                  ? 'bg-amber-500 hover:bg-amber-600 text-emerald-950'
                  : 'text-amber-400 hover:text-amber-300 hover:bg-amber-400/10'
              }`}
            >
              <Gift className="h-4 w-4 mr-2" />
              3D 抽獎
            </Button>
            <Button
              onClick={() => handleNavigation('newborn-entrance')}
              variant={currentPage === 'newborn-entrance' ? 'default' : 'ghost'}
              className={`w-full justify-start transition-all gpu-accelerated ${
                currentPage === 'newborn-entrance'
                  ? 'bg-emerald-500 hover:bg-emerald-600 text-white'
                  : 'text-emerald-400 hover:text-emerald-300 hover:bg-emerald-400/10'
              }`}
            >
              <Sparkles className="h-4 w-4 mr-2" />
              初生之犢幸運入口
            </Button>
            <Button
              onClick={() => handleNavigation('profile')}
              variant={currentPage === 'profile' ? 'default' : 'ghost'}
              className={`w-full justify-start transition-all gpu-accelerated ${
                currentPage === 'profile'
                  ? 'bg-amber-500 hover:bg-amber-600 text-emerald-950'
                  : 'text-amber-400 hover:text-amber-300 hover:bg-amber-400/10'
              }`}
            >
              <User className="h-4 w-4 mr-2" />
              個人資訊
            </Button>
            <Button
              onClick={() => handleNavigation('admin')}
              variant={currentPage === 'admin' ? 'default' : 'ghost'}
              className={`w-full justify-start transition-all gpu-accelerated ${
                currentPage === 'admin'
                  ? 'bg-amber-500 hover:bg-amber-600 text-emerald-950'
                  : 'text-amber-400 hover:text-amber-300 hover:bg-amber-400/10'
              }`}
            >
              <Shield className="h-4 w-4 mr-2" />
              管理員
            </Button>
          </nav>
        )}
      </div>
    </header>
  );
}
PK
frontend/src/components/LFLCEINaturalIntelligenceIntegration.tsximport { useState, useCallback, useEffect } from 'react';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Sparkles, ExternalLink, Loader2 } from 'lucide-react';
import { toast } from 'sonner';
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from '@/components/ui/dialog';

interface LFLCEINaturalIntelligenceIntegrationProps {
  onFortuneGenerated?: (fortune: string) => void;
}

export default function LFLCEINaturalIntelligenceIntegration({
  onFortuneGenerated,
}: LFLCEINaturalIntelligenceIntegrationProps) {
  const [isLoading, setIsLoading] = useState(false);
  const [showModal, setShowModal] = useState(false);
  const [generatedFortune, setGeneratedFortune] = useState<string>('');
  const [iframeError, setIframeError] = useState(false);
  const [isPreloaded, setIsPreloaded] = useState(false);

  const primaryUrl = 'https://lflc-natural-intelligence-spd.caffeine.xyz/';
  const secondaryUrl = 'https://selective-green-lnx-draft.caffeine.xyz/';

  // GPU-accelerated lazy preloading
  useEffect(() => {
    if (isPreloaded) return;

    const preloadResources = () => {
      const link = document.createElement('link');
      link.rel = 'prefetch';
      link.href = primaryUrl;
      document.head.appendChild(link);
      setIsPreloaded(true);
    };

    const timer = setTimeout(preloadResources, 3000);
    return () => clearTimeout(timer);
  }, [isPreloaded, primaryUrl]);

  const handleGenerateFortune = useCallback(async () => {
    setIsLoading(true);
    setIframeError(false);

    // Audio-visual sync effect
    const button = document.activeElement as HTMLElement;
    if (button) {
      button.classList.add('audio-sync-pulse');
      setTimeout(() => button.classList.remove('audio-sync-pulse'), 600);
    }

    try {
      // Simulate fortune generation with fallback and optimized loading sequence
      const fortuneMessages = [
        '智慧如幸運草，四葉皆為福。今日運勢大吉，萬事順心如意。',
        '仿生智能預測：您的幸運指數今日達到巔峰，把握機會，勇往直前！',
        '自然智慧啟示：如同幸運草在陽光下生長，您的努力將迎來豐收。',
        'AI 幸運分析：今日適合開展新計劃，貴人相助，事半功倍。',
        '仿生預言：保持善良與耐心，幸運女神正在向您微笑。',
      ];

      // Optimized API delay with GPU-accelerated animation
      await new Promise((resolve) => setTimeout(resolve, 1000));

      const randomFortune = fortuneMessages[Math.floor(Math.random() * fortuneMessages.length)];
      setGeneratedFortune(randomFortune);
      
      // Use requestAnimationFrame for smooth modal opening
      requestAnimationFrame(() => {
        setShowModal(true);
      });

      if (onFortuneGenerated) {
        onFortuneGenerated(randomFortune);
      }

      toast.success('仿生幸運籤生成成功！');
    } catch (error) {
      console.error('Error generating fortune:', error);
      toast.error('生成幸運籤時發生錯誤，請稍後再試');
      setIframeError(true);
    } finally {
      setIsLoading(false);
    }
  }, [onFortuneGenerated]);

  const handleOpenExternalModule = useCallback((url: string) => {
    try {
      // GPU-accelerated window opening
      requestAnimationFrame(() => {
        const newWindow = window.open(url, '_blank', 'noopener,noreferrer');

        if (!newWindow || newWindow.closed || typeof newWindow.closed === 'undefined') {
          toast.error('彈出視窗被阻擋，請允許彈出視窗後重試');
          return;
        }

        newWindow.focus();
        toast.success('正在開啟 LFLCEI 仿生幸運籤模組...');
      });
    } catch (error) {
      console.error('Error opening external module:', error);
      toast.error('開啟外部模組失敗，請稍後再試');
    }
  }, []);

  return (
    <>
      <Card className="bg-gradient-to-br from-emerald-900/60 to-green-800/60 border-amber-400/50 shadow-xl hover:shadow-2xl transition-all gpu-accelerated card-transition">
        <CardHeader>
          <div className="flex items-center gap-3">
            <img
              src="/assets/generated/lflcei-natural-intelligence-icon-transparent.dim_64x64.png"
              alt="LFLCEI Natural Intelligence"
              className="h-12 w-12 animate-pulse gpu-accelerated"
              loading="lazy"
            />
            <div>
              <CardTitle className="text-xl sm:text-2xl text-amber-400 clover-glow">
                LFLCEI 仿生幸運籤
              </CardTitle>
              <CardDescription className="text-emerald-200 text-sm sm:text-base">
                Natural Intelligence Fortune Slip
              </CardDescription>
            </div>
          </div>
        </CardHeader>
        <CardContent className="space-y-4">
          <p className="text-emerald-100 text-sm sm:text-base leading-relaxed">
            結合自然智慧與仿生技術，為您生成專屬的智能幸運祝福。
          </p>

          <div className="grid sm:grid-cols-2 gap-3">
            <Button
              onClick={handleGenerateFortune}
              disabled={isLoading}
              className="w-full bg-amber-500 hover:bg-amber-600 active:bg-amber-700 text-emerald-950 font-bold text-base py-5 transition-all transform hover:scale-[1.02] active:scale-[0.98] relative overflow-hidden group gpu-accelerated"
            >
              {isLoading ? (
                <>
                  <Loader2 className="h-5 w-5 mr-2 animate-spin gpu-accelerated" />
                  生成中...
                </>
              ) : (
                <>
                  <div className="absolute inset-0 bg-gradient-to-r from-amber-400/0 via-amber-400/20 to-amber-400/0 opacity-0 group-hover:opacity-100 transition-opacity duration-500 animate-pulse-slow gpu-accelerated"></div>
                  <Sparkles className="h-5 w-5 mr-2 relative z-10" />
                  <span className="relative z-10">生成智能幸運籤</span>
                </>
              )}
            </Button>

            <Button
              onClick={() => handleOpenExternalModule(primaryUrl)}
              variant="outline"
              className="w-full border-amber-400/50 text-amber-100 hover:bg-amber-400/20 hover:text-amber-400 hover:border-amber-400 active:bg-amber-400/30 transition-all transform hover:scale-[1.02] active:scale-[0.98] gpu-accelerated"
            >
              <ExternalLink className="h-4 w-4 mr-2" />
              開啟完整模組
            </Button>
          </div>

          {iframeError && (
            <div className="bg-amber-900/30 border border-amber-400/50 rounded-lg p-3 animate-fade-in">
              <p className="text-amber-200 text-sm">
                無法連接外部模組，已使用本地智能生成功能。
              </p>
              <Button
                onClick={() => handleOpenExternalModule(secondaryUrl)}
                variant="link"
                className="text-amber-400 hover:text-amber-300 p-0 h-auto mt-2"
              >
                嘗試備用連結
              </Button>
            </div>
          )}
        </CardContent>
      </Card>

      <Dialog open={showModal} onOpenChange={setShowModal}>
        <DialogContent className="bg-gradient-to-br from-emerald-950 to-emerald-900 border-amber-400/50 max-w-md modal-enter gpu-accelerated">
          <DialogHeader>
            <div className="flex items-center justify-center mb-4">
              <img
                src="/assets/generated/glowing-clover-transparent.dim_150x150.png"
                alt="Glowing Clover"
                className="h-20 w-20 animate-pulse gpu-accelerated"
                loading="lazy"
              />
            </div>
            <DialogTitle className="text-2xl text-amber-400 text-center clover-glow">
              仿生智能幸運籤
            </DialogTitle>
            <DialogDescription className="text-emerald-200 text-center">
              Natural Intelligence Fortune Blessing
            </DialogDescription>
          </DialogHeader>
          <div className="space-y-4">
            <div className="bg-emerald-950/50 rounded-lg p-6 border border-amber-400/30 animate-scroll-reveal gpu-accelerated">
              <p className="text-lg sm:text-xl text-emerald-100 leading-relaxed text-center">
                {generatedFortune}
              </p>
            </div>
            <div className="flex gap-2">
              <Button
                onClick={() => setShowModal(false)}
                className="flex-1 bg-amber-500 hover:bg-amber-600 text-emerald-950 font-bold gpu-accelerated"
              >
                確認
              </Button>
              <Button
                onClick={() => handleOpenExternalModule(primaryUrl)}
                variant="outline"
                className="flex-1 border-amber-400/50 text-amber-100 hover:bg-amber-400/20 gpu-accelerated"
              >
                <ExternalLink className="h-4 w-4 mr-2" />
                查看詳情
              </Button>
            </div>
          </div>
        </DialogContent>
      </Dialog>
    </>
  );
}

PK
frontend/src/components/LFLCEISupportAscension.tsximport { useState, useCallback, useEffect } from 'react';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Progress } from '@/components/ui/progress';
import { Sparkles, TrendingUp, Award, Users, Zap, Heart, Star } from 'lucide-react';
import { toast } from 'sonner';
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogHeader,
  DialogTitle,
} from '@/components/ui/dialog';

interface LFLCEISupportAscensionProps {
  isAdmin?: boolean;
}

interface AscensionLevel {
  level: number;
  name: string;
  requiredEnergy: number;
  description: string;
  color: string;
}

const ascensionLevels: AscensionLevel[] = [
  { level: 1, name: '初心者', requiredEnergy: 0, description: '開始靈性昇華之旅', color: 'from-cyan-400 to-blue-500' },
  { level: 2, name: '探索者', requiredEnergy: 100, description: '探索內在靈性能量', color: 'from-blue-400 to-purple-500' },
  { level: 3, name: '覺醒者', requiredEnergy: 300, description: '覺醒靈魂深層意識', color: 'from-purple-400 to-pink-500' },
  { level: 4, name: '昇華者', requiredEnergy: 600, description: '達到靈性昇華境界', color: 'from-pink-400 to-rose-500' },
  { level: 5, name: '大師', requiredEnergy: 1000, description: '成為靈性昇華大師', color: 'from-rose-400 to-amber-500' },
];

export default function LFLCEISupportAscension({ isAdmin = false }: LFLCEISupportAscensionProps) {
  const [currentEnergy, setCurrentEnergy] = useState(250);
  const [showRitualModal, setShowRitualModal] = useState(false);
  const [isPerformingRitual, setIsPerformingRitual] = useState(false);
  const [energyBalance, setEnergyBalance] = useState({ physical: 75, mental: 80, spiritual: 85 });

  const currentLevel = ascensionLevels.reduce((prev, curr) => 
    currentEnergy >= curr.requiredEnergy ? curr : prev
  , ascensionLevels[0]);

  const nextLevel = ascensionLevels.find(level => level.requiredEnergy > currentEnergy);
  const progressToNextLevel = nextLevel 
    ? ((currentEnergy - currentLevel.requiredEnergy) / (nextLevel.requiredEnergy - currentLevel.requiredEnergy)) * 100
    : 100;

  const handlePerformRitual = useCallback(async () => {
    setIsPerformingRitual(true);
    setShowRitualModal(true);

    // Simulate ritual with enhanced visual feedback
    await new Promise(resolve => setTimeout(resolve, 3000));

    const energyGain = Math.floor(Math.random() * 30) + 20;
    setCurrentEnergy(prev => prev + energyGain);
    
    // Update energy balance with adaptive AI coordination
    setEnergyBalance(prev => ({
      physical: Math.min(100, prev.physical + Math.floor(Math.random() * 10)),
      mental: Math.min(100, prev.mental + Math.floor(Math.random() * 10)),
      spiritual: Math.min(100, prev.spiritual + Math.floor(Math.random() * 15)),
    }));

    setIsPerformingRitual(false);
    toast.success(`昇華儀式完成！獲得 ${energyGain} 靈性能量`);
  }, []);

  const handleOpenAscensionPortal = useCallback(() => {
    toast.info('正在開啟昇華傳送門...');
    // Simulate portal opening with GPU-accelerated animation
    setTimeout(() => {
      toast.success('昇華傳送門已開啟！');
    }, 1500);
  }, []);

  // Adaptive AI coordination for real-time interaction optimization
  useEffect(() => {
    const interval = setInterval(() => {
      // Simulate background energy flow optimization
      setEnergyBalance(prev => ({
        physical: Math.max(0, Math.min(100, prev.physical + (Math.random() - 0.5) * 2)),
        mental: Math.max(0, Math.min(100, prev.mental + (Math.random() - 0.5) * 2)),
        spiritual: Math.max(0, Math.min(100, prev.spiritual + (Math.random() - 0.5) * 2)),
      }));
    }, 5000);

    return () => clearInterval(interval);
  }, []);

  return (
    <>
      <Card className="bg-gradient-to-br from-purple-900/50 to-pink-800/50 border-purple-400/50 shadow-2xl card-transition hover:shadow-purple-400/20 animate-soul-manifestation">
        <CardHeader>
          <div className="flex items-center justify-between flex-wrap gap-4">
            <div className="flex-1">
              <CardTitle className="text-2xl sm:text-3xl text-purple-400 flex items-center gap-2 manifestation-glow">
                <img
                  src="/assets/generated/lflcei-support-ascension-icon-transparent.dim_64x64.png"
                  alt="Support Ascension"
                  className="h-8 w-8 animate-manifestation-energy-pulse"
                />
                LFLCEI Support Ascension
              </CardTitle>
              <CardDescription className="text-purple-200 text-base sm:text-lg mt-2">
                支援昇華 • 靈性成長與能量提升系統
              </CardDescription>
            </div>
            <img
              src="/assets/generated/soul-energy-balance-indicator-transparent.dim_200x200.png"
              alt="Energy Balance"
              className="h-16 w-auto rounded-lg shadow-lg animate-dynamic-spiritual-lighting"
              loading="lazy"
            />
          </div>
        </CardHeader>
        <CardContent className="space-y-6">
          {/* Ascension Level Progress */}
          <div className="bg-purple-950/50 rounded-xl p-4 sm:p-6 border border-purple-400/30 card-transition animate-fluid-adaptive-transition">
            <div className="flex items-center justify-between mb-4">
              <div className="flex items-center gap-3">
                <div className={`p-3 bg-gradient-to-r ${currentLevel.color} rounded-full animate-manifestation-energy-pulse`}>
                  <Star className="h-6 w-6 text-white" />
                </div>
                <div>
                  <h3 className="text-xl font-bold text-purple-400 manifestation-glow">{currentLevel.name}</h3>
                  <p className="text-purple-200 text-sm">{currentLevel.description}</p>
                </div>
              </div>
              <div className="text-right">
                <p className="text-3xl font-bold text-purple-400">{currentEnergy}</p>
                <p className="text-purple-200 text-xs">靈性能量</p>
              </div>
            </div>

            {nextLevel && (
              <div className="space-y-2">
                <div className="flex justify-between text-sm text-purple-200">
                  <span>進度至 {nextLevel.name}</span>
                  <span>{Math.round(progressToNextLevel)}%</span>
                </div>
                <Progress value={progressToNextLevel} className="h-3 bg-purple-950/50">
                  <div 
                    className={`h-full bg-gradient-to-r ${nextLevel.color} rounded-full transition-all duration-500 animate-spiritual-aura-flow`}
                    style={{ width: `${progressToNextLevel}%` }}
                  />
                </Progress>
                <p className="text-xs text-purple-300 text-center">
                  還需 {nextLevel.requiredEnergy - currentEnergy} 能量達到下一等級
                </p>
              </div>
            )}
          </div>

          {/* Energy Balance System */}
          <div className="bg-purple-950/50 rounded-xl p-4 sm:p-6 border border-purple-400/30 card-transition">
            <div className="flex items-center gap-2 mb-4">
              <Zap className="h-5 w-5 text-purple-400 animate-pulse" />
              <h3 className="text-lg font-semibold text-purple-400">能量平衡狀態</h3>
            </div>
            <div className="space-y-4">
              <div>
                <div className="flex justify-between text-sm text-purple-200 mb-2">
                  <span className="flex items-center gap-2">
                    <Heart className="h-4 w-4" />
                    身體能量
                  </span>
                  <span>{energyBalance.physical}%</span>
                </div>
                <Progress value={energyBalance.physical} className="h-2 bg-purple-950/50">
                  <div 
                    className="h-full bg-gradient-to-r from-red-400 to-pink-500 rounded-full transition-all duration-500"
                    style={{ width: `${energyBalance.physical}%` }}
                  />
                </Progress>
              </div>
              <div>
                <div className="flex justify-between text-sm text-purple-200 mb-2">
                  <span className="flex items-center gap-2">
                    <Sparkles className="h-4 w-4" />
                    心智能量
                  </span>
                  <span>{energyBalance.mental}%</span>
                </div>
                <Progress value={energyBalance.mental} className="h-2 bg-purple-950/50">
                  <div 
                    className="h-full bg-gradient-to-r from-blue-400 to-cyan-500 rounded-full transition-all duration-500"
                    style={{ width: `${energyBalance.mental}%` }}
                  />
                </Progress>
              </div>
              <div>
                <div className="flex justify-between text-sm text-purple-200 mb-2">
                  <span className="flex items-center gap-2">
                    <Star className="h-4 w-4" />
                    靈性能量
                  </span>
                  <span>{energyBalance.spiritual}%</span>
                </div>
                <Progress value={energyBalance.spiritual} className="h-2 bg-purple-950/50">
                  <div 
                    className="h-full bg-gradient-to-r from-purple-400 to-pink-500 rounded-full transition-all duration-500 animate-spiritual-aura-flow"
                    style={{ width: `${energyBalance.spiritual}%` }}
                  />
                </Progress>
              </div>
            </div>
          </div>

          {/* Action Buttons */}
          <div className="grid sm:grid-cols-2 gap-4">
            <Button
              onClick={handlePerformRitual}
              disabled={isPerformingRitual}
              className="w-full bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white font-bold text-base py-6 transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-lg hover:shadow-purple-500/50 animate-enhanced-glow-transition"
            >
              {isPerformingRitual ? (
                <>
                  <div className="h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent mr-2"></div>
                  進行中...
                </>
              ) : (
                <>
                  <Sparkles className="h-5 w-5 mr-2" />
                  執行昇華儀式
                </>
              )}
            </Button>

            <Button
              onClick={handleOpenAscensionPortal}
              variant="outline"
              className="w-full border-purple-400/50 text-purple-400 hover:bg-purple-400/20 hover:text-purple-300 font-bold text-base py-6 transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-lg hover:shadow-purple-400/30"
            >
              <TrendingUp className="h-5 w-5 mr-2" />
              開啟昇華傳送門
            </Button>
          </div>

          {/* Achievements Preview */}
          <div className="bg-purple-950/50 rounded-xl p-4 border border-purple-400/30 card-transition">
            <div className="flex items-center gap-2 mb-3">
              <Award className="h-5 w-5 text-purple-400" />
              <h3 className="text-base font-semibold text-purple-400">昇華成就</h3>
            </div>
            <div className="grid grid-cols-3 gap-3">
              {[1, 2, 3].map((i) => (
                <div
                  key={i}
                  className="bg-purple-900/30 rounded-lg p-3 border border-purple-400/20 text-center card-transition hover:border-purple-400/50"
                >
                  <img
                    src="/assets/generated/ascension-achievement-badge-transparent.dim_100x100.png"
                    alt={`Achievement ${i}`}
                    className="h-12 w-12 mx-auto mb-2 animate-pulse-slow"
                    loading="lazy"
                  />
                  <p className="text-xs text-purple-300">成就 {i}</p>
                </div>
              ))}
            </div>
          </div>

          {/* Community Connection */}
          <div className="bg-purple-950/50 rounded-xl p-4 border border-purple-400/30 card-transition">
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-2">
                <Users className="h-5 w-5 text-purple-400" />
                <div>
                  <h3 className="text-base font-semibold text-purple-400">昇華社群</h3>
                  <p className="text-xs text-purple-300">與其他昇華者連接</p>
                </div>
              </div>
              <Button
                variant="ghost"
                size="sm"
                className="text-purple-400 hover:text-purple-300 hover:bg-purple-400/20"
              >
                加入社群
              </Button>
            </div>
          </div>
        </CardContent>
      </Card>

      {/* Ritual Modal */}
      <Dialog open={showRitualModal} onOpenChange={setShowRitualModal}>
        <DialogContent className="bg-gradient-to-br from-purple-950 to-pink-900 border-purple-400/50 shadow-2xl max-w-md animate-soul-manifestation">
          <DialogHeader>
            <DialogTitle className="text-2xl text-purple-400 manifestation-glow flex items-center gap-2">
              <Sparkles className="h-6 w-6 animate-pulse" />
              昇華儀式進行中
            </DialogTitle>
            <DialogDescription className="text-purple-200">
              正在引導您的靈性能量流動...
            </DialogDescription>
          </DialogHeader>
          <div className="py-8">
            <div className="relative">
              <img
                src="/assets/generated/ascension-ritual-interface-bg.dim_800x600.png"
                alt="Ritual Interface"
                className="w-full h-48 object-cover rounded-lg animate-dynamic-spiritual-lighting"
                loading="lazy"
              />
              <div className="absolute inset-0 flex items-center justify-center">
                <div className="text-center">
                  <div className="h-16 w-16 mx-auto mb-4 rounded-full border-4 border-purple-400 border-t-transparent animate-spin"></div>
                  <p className="text-purple-200 font-semibold animate-enhanced-glow-transition">
                    {isPerformingRitual ? '能量聚集中...' : '儀式完成！'}
                  </p>
                </div>
              </div>
            </div>
          </div>
        </DialogContent>
      </Dialog>
    </>
  );
}
PK
frontend/src/components/LFLCResponseViewer.tsximport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import { ScrollArea } from '@/components/ui/scroll-area';
import { Button } from '@/components/ui/button';
import { 
  CheckCircle2, 
  XCircle, 
  Clock, 
  Zap, 
  Database,
  ArrowLeftRight,
  Trash2,
  Copy,
  Eye
} from 'lucide-react';
import { LFLC_Response_Envelope } from '../types/lflc-response';
import { useState } from 'react';
import { toast } from 'sonner';

interface LFLCResponseViewerProps {
  syncHistory: LFLC_Response_Envelope<any>[];
  onClearHistory: () => void;
}

export default function LFLCResponseViewer({ syncHistory, onClearHistory }: LFLCResponseViewerProps) {
  const [selectedEnvelope, setSelectedEnvelope] = useState<LFLC_Response_Envelope<any> | null>(null);

  const formatTimestamp = (timestamp: bigint) => {
    const date = new Date(Number(timestamp) / 1000000);
    return date.toLocaleString('zh-TW', {
      year: 'numeric',
      month: '2-digit',
      day: '2-digit',
      hour: '2-digit',
      minute: '2-digit',
      second: '2-digit',
    });
  };

  const getStatusBadge = (statusCode: number) => {
    if (statusCode >= 200 && statusCode < 300) {
      return <Badge className="bg-green-500/20 text-green-400 border-green-400/50">成功</Badge>;
    } else if (statusCode >= 400 && statusCode < 500) {
      return <Badge className="bg-amber-500/20 text-amber-400 border-amber-400/50">客戶端錯誤</Badge>;
    } else if (statusCode >= 500) {
      return <Badge className="bg-red-500/20 text-red-400 border-red-400/50">伺服器錯誤</Badge>;
    }
    return <Badge className="bg-gray-500/20 text-gray-400 border-gray-400/50">未知</Badge>;
  };

  const getDirectionIcon = (direction: string) => {
    switch (direction) {
      case 'send':
        return <ArrowLeftRight className="h-4 w-4 text-blue-400 rotate-90" />;
      case 'receive':
        return <ArrowLeftRight className="h-4 w-4 text-purple-400 -rotate-90" />;
      case 'bidirectional':
        return <ArrowLeftRight className="h-4 w-4 text-cyan-400" />;
      default:
        return <ArrowLeftRight className="h-4 w-4 text-gray-400" />;
    }
  };

  const copyTraceId = (traceId: string) => {
    navigator.clipboard.writeText(traceId);
    toast.success('Trace ID 已複製', {
      description: traceId,
    });
  };

  const viewDetails = (envelope: LFLC_Response_Envelope<any>) => {
    setSelectedEnvelope(envelope);
  };

  return (
    <div className="space-y-4">
      <Card className="bg-gradient-to-r from-cyan-950/90 to-blue-950/90 border-cyan-400/50">
        <CardHeader>
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3">
              <img
                src="/assets/generated/lflc-response-envelope-diagram.dim_800x600.png"
                alt="LFLC Response Envelope"
                className="h-12 w-12 rounded-lg border-2 border-cyan-400"
              />
              <div>
                <CardTitle className="text-2xl text-cyan-400">LFLC 統一響應封裝</CardTitle>
                <CardDescription className="text-cyan-200">
                  即時追蹤與視覺化同步記錄
                </CardDescription>
              </div>
            </div>
            <Button
              onClick={onClearHistory}
              variant="ghost"
              size="sm"
              className="text-red-400 hover:text-red-300 hover:bg-red-400/10"
              disabled={syncHistory.length === 0}
            >
              <Trash2 className="h-4 w-4 mr-2" />
              清除歷史
            </Button>
          </div>
        </CardHeader>
        <CardContent>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
            <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
              <div className="flex items-center gap-2 mb-1">
                <CheckCircle2 className="h-4 w-4 text-green-400" />
                <span className="text-xs text-cyan-200">成功同步</span>
              </div>
              <p className="text-2xl font-bold text-green-400">
                {syncHistory.filter(e => e.status_code >= 200 && e.status_code < 300).length}
              </p>
            </div>
            <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
              <div className="flex items-center gap-2 mb-1">
                <XCircle className="h-4 w-4 text-red-400" />
                <span className="text-xs text-cyan-200">失敗同步</span>
              </div>
              <p className="text-2xl font-bold text-red-400">
                {syncHistory.filter(e => e.status_code >= 400).length}
              </p>
            </div>
            <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
              <div className="flex items-center gap-2 mb-1">
                <Clock className="h-4 w-4 text-cyan-400" />
                <span className="text-xs text-cyan-200">總計記錄</span>
              </div>
              <p className="text-2xl font-bold text-cyan-400">
                {syncHistory.length}
              </p>
            </div>
          </div>

          <ScrollArea className="h-[400px] rounded-lg border border-cyan-400/30 bg-cyan-950/30 p-4">
            <div className="space-y-3">
              {syncHistory.length === 0 ? (
                <div className="text-center text-cyan-300 py-8">
                  <Database className="h-12 w-12 mx-auto mb-3 opacity-50" />
                  <p>尚無同步記錄</p>
                </div>
              ) : (
                syncHistory.map((envelope, index) => (
                  <div
                    key={`${envelope.trace_id}-${index}`}
                    className="bg-cyan-900/50 rounded-lg p-4 border border-cyan-400/30 hover:border-cyan-400/50 transition-all"
                  >
                    <div className="flex items-start justify-between mb-3">
                      <div className="flex items-center gap-2">
                        {getDirectionIcon(envelope.sync_metadata.sync_direction)}
                        <span className="text-cyan-200 font-medium">
                          {envelope.status_message}
                        </span>
                      </div>
                      {getStatusBadge(envelope.status_code)}
                    </div>

                    <div className="grid grid-cols-2 gap-2 text-xs mb-3">
                      <div className="bg-cyan-950/50 rounded p-2">
                        <span className="text-cyan-300">Trace ID</span>
                        <div className="flex items-center gap-1 mt-1">
                          <span className="text-cyan-400 font-mono text-[10px] truncate">
                            {envelope.trace_id}
                          </span>
                          <Button
                            onClick={() => copyTraceId(envelope.trace_id)}
                            variant="ghost"
                            size="sm"
                            className="h-4 w-4 p-0 text-cyan-400 hover:text-cyan-300"
                          >
                            <Copy className="h-3 w-3" />
                          </Button>
                        </div>
                      </div>
                      <div className="bg-cyan-950/50 rounded p-2">
                        <span className="text-cyan-300">時間戳</span>
                        <p className="text-cyan-400 mt-1 text-[10px]">
                          {formatTimestamp(envelope.timestamp)}
                        </p>
                      </div>
                    </div>

                    <div className="grid grid-cols-3 gap-2 text-xs mb-3">
                      <div className="bg-cyan-950/50 rounded p-2 text-center">
                        <span className="text-cyan-300 block mb-1">來源</span>
                        <span className="text-blue-400 font-semibold">
                          {envelope.sync_metadata.source_domain.split('.')[0]}
                        </span>
                      </div>
                      <div className="bg-cyan-950/50 rounded p-2 text-center">
                        <span className="text-cyan-300 block mb-1">方向</span>
                        <span className="text-cyan-400 font-semibold">
                          {envelope.sync_metadata.sync_direction === 'bidirectional' ? '雙向' :
                           envelope.sync_metadata.sync_direction === 'send' ? '發送' : '接收'}
                        </span>
                      </div>
                      <div className="bg-cyan-950/50 rounded p-2 text-center">
                        <span className="text-cyan-300 block mb-1">目標</span>
                        <span className="text-purple-400 font-semibold">
                          {envelope.sync_metadata.target_domain.split('.')[0]}
                        </span>
                      </div>
                    </div>

                    <div className="flex items-center justify-between">
                      <div className="flex items-center gap-3 text-xs">
                        {envelope.rendering_hints.gpu_accelerated && (
                          <span className="flex items-center gap-1 text-green-400">
                            <Zap className="h-3 w-3" />
                            GPU加速
                          </span>
                        )}
                        {envelope.rendering_hints.ui_update_trigger && (
                          <span className="flex items-center gap-1 text-blue-400">
                            <CheckCircle2 className="h-3 w-3" />
                            UI更新
                          </span>
                        )}
                        {envelope.sync_metadata.retry_count > 0 && (
                          <span className="flex items-center gap-1 text-amber-400">
                            重試 {envelope.sync_metadata.retry_count}/{envelope.sync_metadata.max_retries}
                          </span>
                        )}
                      </div>
                      <Button
                        onClick={() => viewDetails(envelope)}
                        variant="ghost"
                        size="sm"
                        className="h-6 px-2 text-cyan-400 hover:text-cyan-300 hover:bg-cyan-400/10"
                      >
                        <Eye className="h-3 w-3 mr-1" />
                        詳情
                      </Button>
                    </div>

                    {envelope.error_details && (
                      <div className="mt-3 bg-red-950/30 rounded p-2 border border-red-400/30">
                        <div className="flex items-start gap-2">
                          <XCircle className="h-4 w-4 text-red-400 flex-shrink-0 mt-0.5" />
                          <div className="flex-1 min-w-0">
                            <p className="text-xs text-red-400 font-semibold mb-1">
                              錯誤代碼: {envelope.error_details.error_code}
                            </p>
                            <p className="text-xs text-red-300 break-words">
                              {envelope.error_details.error_message}
                            </p>
                            {envelope.error_details.recovery_action && (
                              <p className="text-xs text-amber-400 mt-1">
                                恢復動作: {envelope.error_details.recovery_action}
                              </p>
                            )}
                          </div>
                        </div>
                      </div>
                    )}
                  </div>
                ))
              )}
            </div>
          </ScrollArea>
        </CardContent>
      </Card>

      {selectedEnvelope && (
        <Card className="bg-gradient-to-r from-blue-950/90 to-purple-950/90 border-blue-400/50">
          <CardHeader>
            <div className="flex items-center justify-between">
              <CardTitle className="text-xl text-blue-400">響應封裝詳情</CardTitle>
              <Button
                onClick={() => setSelectedEnvelope(null)}
                variant="ghost"
                size="sm"
                className="text-blue-400 hover:text-blue-300"
              >
                關閉
              </Button>
            </div>
          </CardHeader>
          <CardContent>
            <pre className="bg-blue-950/50 rounded-lg p-4 text-xs text-blue-200 overflow-x-auto border border-blue-400/30">
              {JSON.stringify(selectedEnvelope, (key, value) =>
                typeof value === 'bigint' ? value.toString() : value
              , 2)}
            </pre>
          </CardContent>
        </Card>
      )}
    </div>
  );
}
PK
frontend/src/components/LuckyClover3D.tsximport { useRef, useState, useMemo, useCallback, memo } from 'react';
import { Canvas, useFrame } from '@react-three/fiber';
import { OrbitControls, PerspectiveCamera } from '@react-three/drei';
import * as THREE from 'three';

interface CloverLeafProps {
  position: [number, number, number];
  rotation: [number, number, number];
  color: string;
}

const CloverLeaf = memo(({ position, rotation, color }: CloverLeafProps) => {
  const meshRef = useRef<THREE.Mesh>(null);
  const [hovered, setHovered] = useState(false);

  // Optimize animation with reduced calculations (GPU渲染效率優化)
  useFrame((state) => {
    if (meshRef.current) {
      const time = state.clock.elapsedTime;
      // Reduced calculation frequency for better performance and timing consistency (動畫時序一致性)
      meshRef.current.rotation.z = Math.sin(time * 0.35) * 0.07; // Optimized from 0.4 * 0.08
      if (hovered) {
        meshRef.current.scale.setScalar(1.07 + Math.sin(time * 2.3) * 0.035); // Optimized from 1.08 + 2.5 * 0.04
      } else {
        meshRef.current.scale.setScalar(1);
      }
    }
  });

  const handlePointerOver = useCallback(() => setHovered(true), []);
  const handlePointerOut = useCallback(() => setHovered(false), []);

  // Memoize geometry and material for better performance (GPU資源管理)
  const geometry = useMemo(() => new THREE.SphereGeometry(0.5, 18, 18), []); // Reduced from 20, 20 (渲染批次優化)
  const material = useMemo(
    () =>
      new THREE.MeshStandardMaterial({
        color,
        emissive: color,
        emissiveIntensity: hovered ? 0.42 : 0.16, // Optimized from 0.45 : 0.18 (著色器性能調整)
        metalness: 0.72, // Optimized from 0.75
        roughness: 0.28, // Optimized from 0.25
      }),
    [color, hovered]
  );

  return (
    <mesh
      ref={meshRef}
      position={position}
      rotation={rotation}
      onPointerOver={handlePointerOver}
      onPointerOut={handlePointerOut}
      geometry={geometry}
      material={material}
    />
  );
});

CloverLeaf.displayName = 'CloverLeaf';

const CloverStem = memo(() => {
  // Memoize geometry and material (GPU資源管理)
  const geometry = useMemo(() => new THREE.CylinderGeometry(0.08, 0.08, 1.6, 8), []); // Reduced from 10 (渲染批次優化)
  const material = useMemo(
    () => new THREE.MeshStandardMaterial({ color: '#10b981', metalness: 0.28, roughness: 0.72 }), // Optimized values
    []
  );

  return <mesh position={[0, -0.8, 0]} geometry={geometry} material={material} />;
});

CloverStem.displayName = 'CloverStem';

const LuckyCloverModel = memo(() => {
  const groupRef = useRef<THREE.Group>(null);

  // Optimize animation with reduced calculations (幀延遲減少 + 動畫時序一致性)
  useFrame((state) => {
    if (groupRef.current) {
      const time = state.clock.elapsedTime;
      groupRef.current.rotation.y = time * 0.25; // Optimized from 0.28 (動畫時序一致性)
      groupRef.current.position.y = Math.sin(time * 0.65) * 0.16; // Optimized from 0.7 * 0.18 (幀延遲減少)
    }
  });

  return (
    <group ref={groupRef}>
      <CloverLeaf position={[0, 0.5, 0]} rotation={[0, 0, 0]} color="#fbbf24" />
      <CloverLeaf position={[0.5, 0, 0]} rotation={[0, 0, Math.PI / 2]} color="#fbbf24" />
      <CloverLeaf position={[0, -0.5, 0]} rotation={[0, 0, Math.PI]} color="#fbbf24" />
      <CloverLeaf position={[-0.5, 0, 0]} rotation={[0, 0, -Math.PI / 2]} color="#fbbf24" />
      <CloverStem />
      
      {/* Optimized lighting - reduced intensity for better performance (著色器性能調整) */}
      <pointLight position={[2, 2, 2]} intensity={0.65} color="#fbbf24" /> {/* Optimized from 0.7 */}
      <pointLight position={[-2, -2, 2]} intensity={0.32} color="#10b981" /> {/* Optimized from 0.35 */}
    </group>
  );
});

LuckyCloverModel.displayName = 'LuckyCloverModel';

interface LuckyClover3DProps {
  className?: string;
  autoRotate?: boolean;
}

function LuckyClover3D({ className = '', autoRotate = true }: LuckyClover3DProps) {
  return (
    <div className={`w-full h-full ${className}`}>
      <Canvas
        dpr={[1, 1.4]} // Optimized pixel ratio (from 1.5 - GPU渲染效率優化)
        performance={{ min: 0.65 }} // Improved performance threshold (from 0.6 - 幀延遲減少)
        gl={{
          antialias: true,
          alpha: true,
          powerPreference: 'high-performance',
        }}
      >
        <PerspectiveCamera makeDefault position={[0, 0, 5]} fov={50} />
        
        {/* Optimized lighting setup (著色器性能調整) */}
        <ambientLight intensity={0.35} /> {/* Optimized from 0.38 */}
        <spotLight 
          position={[10, 10, 10]} 
          angle={0.15} 
          penumbra={1} 
          intensity={0.65} // Optimized from 0.7
          castShadow={false} // Disable shadows for better performance
        />
        
        <LuckyCloverModel />
        
        <OrbitControls
          enableZoom={false}
          enablePan={false}
          autoRotate={autoRotate}
          autoRotateSpeed={1.6} // Optimized from 1.8 (動畫時序一致性)
          minPolarAngle={Math.PI / 3}
          maxPolarAngle={Math.PI / 1.5}
          enableDamping={true}
          dampingFactor={0.035} // Optimized from 0.04 (UI響應性增強)
        />
      </Canvas>
    </div>
  );
}

export default memo(LuckyClover3D);
PK
frontend/src/components/ProfileSetupModal.tsximport { useState } from 'react';
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from '@/components/ui/dialog';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { useSaveCallerUserProfile } from '../hooks/useQueries';
import { toast } from 'sonner';
import type { UserProfile, Realm, RealmType } from '../backend';

const INITIAL_REALMS: Realm[] = [
  {
    id: 0n,
    name: "仙島",
    description: "仙境主題，飄逸靈氣，仙鶴飛舞，雲霧繚繞的3D環境",
    theming: "fairy",
    energyType: "仙靈氣",
    ambientSound: "/assets/sounds/fairy.mp3",
    backgroundAnimation: "/assets/animations/fairy.json",
    entryRequirements: [],
    realmType: "fairy" as RealmType,
    realmPoints: 0n,
    reputationPoints: 0n,
    challengeScores: 0n,
  },
  {
    id: 1n,
    name: "修真聖地",
    description: "修煉主題，靈力修煉，丹藥煉製，修真境界提升系統",
    theming: "cultivation",
    energyType: "修煉靈力",
    ambientSound: "/assets/sounds/cultivation.mp3",
    backgroundAnimation: "/assets/animations/cultivation.json",
    entryRequirements: ["初生"],
    realmType: "cultivation" as RealmType,
    realmPoints: 0n,
    reputationPoints: 0n,
    challengeScores: 0n,
  },
  {
    id: 2n,
    name: "武道聖地",
    description: "武術主題，武功修煉，內力提升，武道等級進階",
    theming: "martial",
    energyType: "武道能量",
    ambientSound: "/assets/sounds/martial.mp3",
    backgroundAnimation: "/assets/animations/martial.json",
    entryRequirements: ["初生"],
    realmType: "martial" as RealmType,
    realmPoints: 0n,
    reputationPoints: 0n,
    challengeScores: 0n,
  },
  {
    id: 3n,
    name: "佛國",
    description: "佛教主題，禪修靜心，佛光普照，蓮花綻放的寧靜空間",
    theming: "buddhist",
    energyType: "佛法能量",
    ambientSound: "/assets/sounds/buddhist.mp3",
    backgroundAnimation: "/assets/animations/buddhist.json",
    entryRequirements: ["初生"],
    realmType: "buddhist" as RealmType,
    realmPoints: 0n,
    reputationPoints: 0n,
    challengeScores: 0n,
  },
  {
    id: 4n,
    name: "天堂",
    description: "神聖主題，聖光環繞，天使翅膀，神聖音樂背景",
    theming: "heavenly",
    energyType: "聖潔能量",
    ambientSound: "/assets/sounds/heavenly.mp3",
    backgroundAnimation: "/assets/animations/heavenly.json",
    entryRequirements: ["初生"],
    realmType: "heavenly" as RealmType,
    realmPoints: 0n,
    reputationPoints: 0n,
    challengeScores: 0n,
  },
  {
    id: 5n,
    name: "地獄",
    description: "暗黑主題，烈火燃燒，惡魔元素，紅色火焰粒子效果",
    theming: "demonic",
    energyType: "黑暗能量",
    ambientSound: "/assets/sounds/demonic.mp3",
    backgroundAnimation: "/assets/animations/demonic.json",
    entryRequirements: ["初生"],
    realmType: "demonic" as RealmType,
    realmPoints: 0n,
    reputationPoints: 0n,
    challengeScores: 0n,
  },
  {
    id: 6n,
    name: "地府",
    description: "陰間主題，幽冥氣息，鬼魂飄渺，青綠色靈魂光芒",
    theming: "underworld",
    energyType: "陰世界能量",
    ambientSound: "/assets/sounds/underworld.mp3",
    backgroundAnimation: "/assets/animations/underworld.json",
    entryRequirements: ["初生"],
    realmType: "underworld" as RealmType,
    realmPoints: 0n,
    reputationPoints: 0n,
    challengeScores: 0n,
  },
  {
    id: 7n,
    name: "神殿",
    description: "神話主題，古典建築，神力光環，金色神聖粒子",
    theming: "divine",
    energyType: "神力能量",
    ambientSound: "/assets/sounds/divine.mp3",
    backgroundAnimation: "/assets/animations/divine.json",
    entryRequirements: ["初生"],
    realmType: "divine" as RealmType,
    realmPoints: 0n,
    reputationPoints: 0n,
    challengeScores: 0n,
  },
];

export default function ProfileSetupModal() {
  const [name, setName] = useState('');
  const saveProfile = useSaveCallerUserProfile();

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    
    if (!name.trim()) {
      toast.error('請輸入您的名字');
      return;
    }

    const newProfile: UserProfile = {
      name: name.trim(),
      points: 0n,
      cycleCompletedCount: 0n,
      dayCycle: [
        { day: 1n, rewardPoints: 3n, adMultiplier: false, timestamp: 0n },
        { day: 2n, rewardPoints: 5n, adMultiplier: false, timestamp: 0n },
        { day: 3n, rewardPoints: 7n, adMultiplier: false, timestamp: 0n },
        { day: 4n, rewardPoints: 9n, adMultiplier: false, timestamp: 0n },
        { day: 5n, rewardPoints: 10n, adMultiplier: false, timestamp: 0n },
        { day: 6n, rewardPoints: 15n, adMultiplier: false, timestamp: 0n },
        { day: 7n, rewardPoints: 20n, adMultiplier: false, timestamp: 0n },
      ],
      rewardHistory: [],
      ascensionLevel: 0n,
      ascensionProgress: 0,
      energyBalance: 0n,
      realms: INITIAL_REALMS,
    };

    try {
      await saveProfile.mutateAsync(newProfile);
      toast.success('個人資料設定成功！');
    } catch (error) {
      console.error('Failed to save profile:', error);
      toast.error('設定失敗，請稍後再試');
    }
  };

  return (
    <Dialog open={true}>
      <DialogContent className="sm:max-w-md bg-gradient-to-br from-emerald-900 to-green-800 border-amber-400/50">
        <DialogHeader>
          <DialogTitle className="text-2xl text-amber-400 clover-glow">歡迎來到幸運草元宇宙！</DialogTitle>
          <DialogDescription className="text-emerald-200">
            請設定您的個人資料以開始您的幸運之旅
          </DialogDescription>
        </DialogHeader>
        <form onSubmit={handleSubmit} className="space-y-4">
          <div className="space-y-2">
            <Label htmlFor="name" className="text-amber-400">您的名字</Label>
            <Input
              id="name"
              value={name}
              onChange={(e) => setName(e.target.value)}
              placeholder="請輸入您的名字"
              className="bg-emerald-950/50 border-amber-400/30 text-emerald-100 placeholder:text-emerald-400/50"
              autoFocus
            />
          </div>
          <Button
            type="submit"
            disabled={saveProfile.isPending}
            className="w-full bg-amber-500 hover:bg-amber-600 text-emerald-950 font-bold"
          >
            {saveProfile.isPending ? '設定中...' : '開始旅程'}
          </Button>
        </form>
      </DialogContent>
    </Dialog>
  );
}

PK
frontend/src/components/RealityConnectionModule.tsximport { useState, useEffect, useCallback, memo } from 'react';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Progress } from '@/components/ui/progress';
import { Globe, Clock, Zap, Activity, MapPin, Calendar, TrendingUp, RefreshCw } from 'lucide-react';
import { toast } from 'sonner';

interface RealityConnectionModuleProps {
  variant?: 'full' | 'compact';
  className?: string;
}

interface RealityContext {
  localTime: Date;
  timezone: string;
  dayOfWeek: string;
  timeOfDay: 'morning' | 'afternoon' | 'evening' | 'night';
  seasonalInfluence: number;
  cosmicAlignment: number;
}

function RealityConnectionModule({ variant = 'full', className = '' }: RealityConnectionModuleProps) {
  const [realityContext, setRealityContext] = useState<RealityContext>({
    localTime: new Date(),
    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
    dayOfWeek: new Date().toLocaleDateString('zh-TW', { weekday: 'long' }),
    timeOfDay: 'morning',
    seasonalInfluence: 0,
    cosmicAlignment: 0,
  });
  
  const [syncProgress, setSyncProgress] = useState(0);
  const [isSyncing, setIsSyncing] = useState(false);
  const [earthRotation, setEarthRotation] = useState(0);
  const [glowIntensity, setGlowIntensity] = useState(0.5);

  // Calculate time of day
  const getTimeOfDay = useCallback((hour: number): 'morning' | 'afternoon' | 'evening' | 'night' => {
    if (hour >= 5 && hour < 12) return 'morning';
    if (hour >= 12 && hour < 17) return 'afternoon';
    if (hour >= 17 && hour < 21) return 'evening';
    return 'night';
  }, []);

  // Calculate seasonal influence (0-100)
  const getSeasonalInfluence = useCallback((date: Date): number => {
    const month = date.getMonth();
    const day = date.getDate();
    const dayOfYear = Math.floor((date.getTime() - new Date(date.getFullYear(), 0, 0).getTime()) / 86400000);
    return Math.round((Math.sin((dayOfYear / 365) * Math.PI * 2) + 1) * 50);
  }, []);

  // Calculate cosmic alignment based on time
  const getCosmicAlignment = useCallback((date: Date): number => {
    const hour = date.getHours();
    const minute = date.getMinutes();
    const timeValue = (hour * 60 + minute) / 1440; // 0-1 range
    return Math.round((Math.sin(timeValue * Math.PI * 4) + 1) * 50);
  }, []);

  // Update reality context every second
  useEffect(() => {
    const updateContext = () => {
      const now = new Date();
      const hour = now.getHours();
      
      setRealityContext({
        localTime: now,
        timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
        dayOfWeek: now.toLocaleDateString('zh-TW', { weekday: 'long' }),
        timeOfDay: getTimeOfDay(hour),
        seasonalInfluence: getSeasonalInfluence(now),
        cosmicAlignment: getCosmicAlignment(now),
      });
    };

    updateContext();
    const interval = setInterval(updateContext, 1000);
    return () => clearInterval(interval);
  }, [getTimeOfDay, getSeasonalInfluence, getCosmicAlignment]);

  // Animate Earth rotation
  useEffect(() => {
    const interval = setInterval(() => {
      setEarthRotation(prev => (prev + 0.5) % 360);
    }, 50);
    return () => clearInterval(interval);
  }, []);

  // Animate glow intensity based on time of day
  useEffect(() => {
    const hour = realityContext.localTime.getHours();
    let targetIntensity = 0.5;
    
    switch (realityContext.timeOfDay) {
      case 'morning':
        targetIntensity = 0.7 + (hour - 5) * 0.05;
        break;
      case 'afternoon':
        targetIntensity = 0.9;
        break;
      case 'evening':
        targetIntensity = 0.8 - (hour - 17) * 0.1;
        break;
      case 'night':
        targetIntensity = 0.4;
        break;
    }
    
    setGlowIntensity(targetIntensity);
  }, [realityContext.timeOfDay, realityContext.localTime]);

  // Handle reality sync
  const handleRealitySync = useCallback(async () => {
    setIsSyncing(true);
    setSyncProgress(0);

    try {
      // Simulate sync progress
      const progressInterval = setInterval(() => {
        setSyncProgress(prev => {
          if (prev >= 95) {
            clearInterval(progressInterval);
            return 95;
          }
          return prev + Math.random() * 15;
        });
      }, 200);

      // Simulate sync delay
      await new Promise(resolve => setTimeout(resolve, 2000));
      
      clearInterval(progressInterval);
      setSyncProgress(100);
      
      toast.success('現實連結同步完成！', {
        description: `時間戳記已傳遞至所有模組 • ${realityContext.localTime.toLocaleString('zh-TW')}`,
      });
      
      setTimeout(() => {
        setSyncProgress(0);
        setIsSyncing(false);
      }, 1000);
    } catch (error) {
      console.error('Reality sync error:', error);
      toast.error('現實連結同步失敗');
      setSyncProgress(0);
      setIsSyncing(false);
    }
  }, [realityContext.localTime]);

  const getTimeOfDayColor = () => {
    switch (realityContext.timeOfDay) {
      case 'morning':
        return 'from-amber-400 to-orange-500';
      case 'afternoon':
        return 'from-yellow-400 to-amber-500';
      case 'evening':
        return 'from-orange-500 to-pink-500';
      case 'night':
        return 'from-blue-500 to-purple-600';
    }
  };

  const getTimeOfDayIcon = () => {
    switch (realityContext.timeOfDay) {
      case 'morning':
        return '🌅';
      case 'afternoon':
        return '☀️';
      case 'evening':
        return '🌆';
      case 'night':
        return '🌙';
    }
  };

  // Compact variant
  if (variant === 'compact') {
    return (
      <Card className={`bg-gradient-to-r from-blue-950/80 to-purple-950/80 border-blue-400/50 backdrop-blur-sm shadow-lg hover:shadow-blue-400/30 transition-all gpu-accelerated ${className}`}>
        <CardContent className="p-4">
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3 flex-1">
              <div className="relative">
                <img
                  src="/assets/generated/reality-earth-globe-3d.dim_400x400.png"
                  alt="現實連結"
                  className="h-10 w-10 rounded-full border-2 border-blue-400 animate-manifestation-energy-pulse"
                  style={{ transform: `rotate(${earthRotation}deg)` }}
                  loading="lazy"
                />
                <div 
                  className="absolute inset-0 rounded-full animate-pulse"
                  style={{
                    boxShadow: `0 0 ${20 * glowIntensity}px rgba(59, 130, 246, ${glowIntensity})`,
                    opacity: glowIntensity,
                  }}
                />
              </div>
              
              <div className="flex-1 min-w-0">
                <div className="flex items-center gap-2 mb-1">
                  <h3 className="text-sm font-semibold text-blue-400 manifestation-glow">現實連結</h3>
                  <span className="text-xs text-blue-300">{getTimeOfDayIcon()}</span>
                </div>
                <div className="flex items-center gap-3 text-xs text-blue-200">
                  <span className="flex items-center gap-1">
                    <Clock className="h-3 w-3" />
                    {realityContext.localTime.toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit' })}
                  </span>
                  <span className="flex items-center gap-1">
                    <Activity className="h-3 w-3" />
                    {realityContext.cosmicAlignment}%
                  </span>
                </div>
              </div>
            </div>

            <Button
              onClick={handleRealitySync}
              disabled={isSyncing}
              size="sm"
              variant="ghost"
              className="text-blue-400 hover:text-blue-300 hover:bg-blue-400/10"
            >
              <RefreshCw className={`h-4 w-4 ${isSyncing ? 'animate-spin' : ''}`} />
            </Button>
          </div>

          {isSyncing && (
            <div className="mt-3">
              <Progress value={syncProgress} className="h-2 bg-blue-950/50">
                <div 
                  className="h-full bg-gradient-to-r from-blue-400 via-purple-500 to-blue-400 rounded-full transition-all duration-300 animate-spiritual-aura-flow"
                  style={{ width: `${syncProgress}%` }}
                />
              </Progress>
              <p className="text-xs text-blue-300 mt-1 text-center">現實同步中... {Math.round(syncProgress)}%</p>
            </div>
          )}
        </CardContent>
      </Card>
    );
  }

  // Full variant
  return (
    <Card className={`bg-gradient-to-br from-blue-950/90 to-purple-950/90 border-blue-400/50 backdrop-blur-sm shadow-2xl hover:shadow-blue-400/30 transition-all gpu-accelerated overflow-hidden relative ${className}`}>
      {/* Animated background overlay */}
      <div className="absolute inset-0 opacity-20 pointer-events-none">
        <div className="absolute inset-0 bg-[url('/assets/generated/virtual-real-integration-concept.dim_800x500.png')] bg-cover bg-center animate-pulse-slow"></div>
        <div className="absolute inset-0 bg-gradient-to-br from-blue-400/10 via-transparent to-purple-400/10 animate-spiritual-aura-flow"></div>
      </div>

      <CardHeader className="relative z-10">
        <div className="flex items-center justify-between flex-wrap gap-4">
          <div className="flex items-center gap-4">
            <div className="relative">
              <img
                src="/assets/generated/reality-earth-globe-3d.dim_400x400.png"
                alt="現實連結"
                className="h-16 w-16 rounded-full border-4 border-blue-400 shadow-lg shadow-blue-400/50"
                style={{ transform: `rotate(${earthRotation}deg)` }}
                loading="eager"
              />
              <div 
                className="absolute inset-0 rounded-full animate-pulse"
                style={{
                  boxShadow: `0 0 ${30 * glowIntensity}px rgba(59, 130, 246, ${glowIntensity}), 0 0 ${60 * glowIntensity}px rgba(59, 130, 246, ${glowIntensity * 0.5})`,
                  opacity: glowIntensity,
                }}
              />
            </div>
            <div>
              <CardTitle className="text-2xl font-bold text-blue-400 manifestation-glow flex items-center gap-2">
                <Globe className="h-6 w-6" />
                現實連結模組
              </CardTitle>
              <CardDescription className="text-blue-200 text-sm">
                Reality Connection • 虛實融合狀態管理
              </CardDescription>
            </div>
          </div>

          <Button
            onClick={handleRealitySync}
            disabled={isSyncing}
            className="bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white shadow-lg hover:shadow-blue-400/50"
          >
            {isSyncing ? (
              <>
                <div className="h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent mr-2"></div>
                同步中...
              </>
            ) : (
              <>
                <RefreshCw className="h-4 w-4 mr-2" />
                現實同步
              </>
            )}
          </Button>
        </div>
      </CardHeader>

      <CardContent className="relative z-10 space-y-6">
        {/* Sync Progress */}
        {isSyncing && (
          <div>
            <Progress value={syncProgress} className="h-3 bg-blue-950/50">
              <div 
                className="h-full bg-gradient-to-r from-blue-400 via-purple-500 to-blue-400 rounded-full transition-all duration-300 animate-spiritual-aura-flow"
                style={{ width: `${syncProgress}%` }}
              />
            </Progress>
            <p className="text-sm text-blue-300 mt-2 text-center">正在同步現實時間戳記與情境影響... {Math.round(syncProgress)}%</p>
          </div>
        )}

        {/* Reality Context Grid */}
        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div className="bg-blue-900/30 rounded-xl p-4 border border-blue-400/30 card-transition hover:border-blue-400">
            <div className="flex items-center gap-3 mb-3">
              <Clock className="h-6 w-6 text-blue-400" />
              <div>
                <p className="text-xs text-blue-200">本地時間</p>
                <p className="text-2xl font-bold text-blue-400">
                  {realityContext.localTime.toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit', second: '2-digit' })}
                </p>
              </div>
            </div>
            <div className="text-xs text-blue-300">
              <p>{realityContext.dayOfWeek}</p>
              <p>{realityContext.timezone}</p>
            </div>
          </div>

          <div className="bg-blue-900/30 rounded-xl p-4 border border-blue-400/30 card-transition hover:border-blue-400">
            <div className="flex items-center gap-3 mb-3">
              <Zap className="h-6 w-6 text-blue-400" />
              <div>
                <p className="text-xs text-blue-200">時段影響</p>
                <p className="text-2xl font-bold text-blue-400 flex items-center gap-2">
                  {getTimeOfDayIcon()} {realityContext.timeOfDay === 'morning' ? '早晨' : realityContext.timeOfDay === 'afternoon' ? '午後' : realityContext.timeOfDay === 'evening' ? '傍晚' : '夜晚'}
                </p>
              </div>
            </div>
            <Progress 
              value={glowIntensity * 100} 
              className="h-2 bg-blue-950/50"
            >
              <div className={`h-full bg-gradient-to-r ${getTimeOfDayColor()} rounded-full`} />
            </Progress>
          </div>

          <div className="bg-blue-900/30 rounded-xl p-4 border border-blue-400/30 card-transition hover:border-blue-400">
            <div className="flex items-center gap-3 mb-3">
              <TrendingUp className="h-6 w-6 text-blue-400" />
              <div>
                <p className="text-xs text-blue-200">宇宙對齊度</p>
                <p className="text-2xl font-bold text-blue-400">
                  {realityContext.cosmicAlignment}%
                </p>
              </div>
            </div>
            <Progress 
              value={realityContext.cosmicAlignment} 
              className="h-2 bg-blue-950/50"
            >
              <div className="h-full bg-gradient-to-r from-purple-400 to-pink-500 rounded-full" />
            </Progress>
          </div>
        </div>

        {/* Seasonal Influence */}
        <div className="bg-blue-900/30 rounded-xl p-4 border border-blue-400/30">
          <div className="flex items-center justify-between mb-3">
            <div className="flex items-center gap-2">
              <Calendar className="h-5 w-5 text-blue-400" />
              <h3 className="text-sm font-semibold text-blue-400">季節影響力</h3>
            </div>
            <span className="text-lg font-bold text-blue-400">{realityContext.seasonalInfluence}%</span>
          </div>
          <Progress 
            value={realityContext.seasonalInfluence} 
            className="h-3 bg-blue-950/50"
          >
            <div className="h-full bg-gradient-to-r from-green-400 via-yellow-400 to-orange-500 rounded-full" />
          </Progress>
          <p className="text-xs text-blue-300 mt-2">
            季節能量影響您的幸運值與昇華進度
          </p>
        </div>

        {/* Virtual-Real Integration Concept */}
        <div className="bg-blue-900/30 rounded-xl p-4 border border-blue-400/30">
          <div className="flex items-center gap-2 mb-3">
            <MapPin className="h-5 w-5 text-blue-400" />
            <h3 className="text-sm font-semibold text-blue-400">虛實融合概念</h3>
          </div>
          <div className="space-y-2 text-sm text-blue-200">
            <p>
              現實連結模組將真實世界的時間、情境與事件同步至元宇宙系統，讓您的虛擬體驗與現實世界產生深度連結。
            </p>
            <div className="grid grid-cols-2 gap-2 mt-3">
              <div className="bg-blue-950/30 rounded-lg p-2 border border-blue-400/20">
                <p className="text-xs text-blue-300 mb-1">時間基礎事件</p>
                <p className="text-xs text-blue-100">根據本地時間觸發特殊事件與獎勵</p>
              </div>
              <div className="bg-blue-950/30 rounded-lg p-2 border border-blue-400/20">
                <p className="text-xs text-blue-300 mb-1">情境感知</p>
                <p className="text-xs text-blue-100">時段與季節影響幸運預測算法</p>
              </div>
              <div className="bg-blue-950/30 rounded-lg p-2 border border-blue-400/20">
                <p className="text-xs text-blue-300 mb-1">跨模組影響</p>
                <p className="text-xs text-blue-100">現實時間戳記傳遞至所有模組</p>
              </div>
              <div className="bg-blue-950/30 rounded-lg p-2 border border-blue-400/20">
                <p className="text-xs text-blue-300 mb-1">動態視覺化</p>
                <p className="text-xs text-blue-100">地球動畫與光暈效果即時反映</p>
              </div>
            </div>
          </div>
        </div>

        {/* Integration Status */}
        <div className="bg-blue-900/30 rounded-xl p-4 border border-blue-400/30">
          <h3 className="text-sm font-semibold text-blue-400 mb-3 flex items-center gap-2">
            <Activity className="h-4 w-4" />
            模組整合狀態
          </h3>
          <div className="grid grid-cols-2 gap-2">
            {[
              { name: '靈魂協作', status: 'active' },
              { name: 'AI幸運', status: 'active' },
              { name: '元宇宙視覺化', status: 'active' },
              { name: '昇華系統', status: 'active' },
            ].map(({ name, status }) => (
              <div key={name} className="flex items-center justify-between text-xs bg-blue-950/30 rounded-lg p-2">
                <span className="text-blue-300">{name}</span>
                <div className="flex items-center gap-1">
                  <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse shadow-lg shadow-green-400/50" />
                  <span className="text-green-400">已連結</span>
                </div>
              </div>
            ))}
          </div>
        </div>

        {/* Last Sync Info */}
        <div className="text-center">
          <p className="text-xs text-blue-300">
            現實時間戳記: {realityContext.localTime.toLocaleString('zh-TW')} • 
            狀態: <span className="text-green-400">● 即時同步</span>
          </p>
        </div>
      </CardContent>
    </Card>
  );
}

export default memo(RealityConnectionModule);
PK
frontend/src/components/RealityCoreInterface.tsximport { useState, useEffect, memo } from 'react';
import { Card, CardContent } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Progress } from '@/components/ui/progress';
import { Globe, Clock, Zap, RefreshCw, Activity, ChevronDown, ChevronUp, CheckCircle2, AlertCircle, WifiOff } from 'lucide-react';
import { useGetSoulCollaborationSyncStatus, useUnifiedSystemSync } from '../hooks/useQueries';

interface RealityCoreInterfaceProps {
  variant?: 'full' | 'compact';
  showSyncControls?: boolean;
  currentPage?: string;
  className?: string;
}

function RealityCoreInterface({ 
  variant = 'compact', 
  showSyncControls = true,
  currentPage = 'home',
  className = '' 
}: RealityCoreInterfaceProps) {
  const { data: syncStatus } = useGetSoulCollaborationSyncStatus();
  const { performSync, lastSyncTime, isSyncing, syncError, retryCount, isIdle } = useUnifiedSystemSync();
  const [localTime, setLocalTime] = useState(new Date());
  const [syncProgress, setSyncProgress] = useState(0);
  const [isExpanded, setIsExpanded] = useState(false);
  const [earthRotation, setEarthRotation] = useState(0);
  const [cosmicAlignment, setCosmicAlignment] = useState(0);

  // Update local time every second
  useEffect(() => {
    const interval = setInterval(() => {
      setLocalTime(new Date());
    }, 1000);
    return () => clearInterval(interval);
  }, []);

  // Animate Earth rotation
  useEffect(() => {
    const interval = setInterval(() => {
      setEarthRotation(prev => (prev + 0.5) % 360);
    }, 50);
    return () => clearInterval(interval);
  }, []);

  // Calculate cosmic alignment based on time
  useEffect(() => {
    const hour = localTime.getHours();
    const minute = localTime.getMinutes();
    const timeValue = (hour * 60 + minute) / 1440;
    const alignment = Math.round((Math.sin(timeValue * Math.PI * 4) + 1) * 50);
    setCosmicAlignment(alignment);
  }, [localTime]);

  // Sync progress animation
  useEffect(() => {
    if (isSyncing) {
      setSyncProgress(0);
      const interval = setInterval(() => {
        setSyncProgress(prev => {
          if (prev >= 95) return 95;
          return prev + Math.random() * 15;
        });
      }, 200);
      
      return () => clearInterval(interval);
    } else {
      const timeout = setTimeout(() => setSyncProgress(0), 1000);
      return () => clearTimeout(timeout);
    }
  }, [isSyncing]);

  // Complete progress when sync finishes
  useEffect(() => {
    if (!isSyncing && syncProgress > 0 && syncProgress < 100) {
      setSyncProgress(100);
    }
  }, [isSyncing, syncProgress]);

  const handleManualSync = async () => {
    await performSync(true);
  };

  const getTimeOfDay = () => {
    const hour = localTime.getHours();
    if (hour >= 5 && hour < 12) return { icon: '🌅', text: '早晨' };
    if (hour >= 12 && hour < 17) return { icon: '☀️', text: '午後' };
    if (hour >= 17 && hour < 21) return { icon: '🌆', text: '傍晚' };
    return { icon: '🌙', text: '夜晚' };
  };

  const timeOfDay = getTimeOfDay();

  const formatLastSyncTime = (timestamp: bigint | number) => {
    const ts = typeof timestamp === 'bigint' ? Number(timestamp) : timestamp;
    if (!ts || ts === 0) return '尚未同步';
    const date = new Date(ts);
    return date.toLocaleString('zh-TW', { 
      month: 'short', 
      day: 'numeric', 
      hour: '2-digit', 
      minute: '2-digit' 
    });
  };

  const getNextSyncTime = () => {
    if (!lastSyncTime) return '待定';
    const interval = isIdle ? 300 : 60; // 5 minutes when idle, 60 seconds when active
    const nextSync = lastSyncTime + (interval * 1000);
    const remaining = Math.max(0, Math.floor((nextSync - Date.now()) / 1000));
    
    if (remaining === 0) return '即將同步';
    if (remaining < 60) return `${remaining}秒後`;
    const minutes = Math.floor(remaining / 60);
    return `${minutes}分鐘後`;
  };

  const getSyncStatusColor = () => {
    if (syncError) return 'text-red-400';
    if (isSyncing) return 'text-yellow-400';
    return 'text-green-400';
  };

  if (variant === 'compact') {
    return (
      <Card className={`bg-gradient-to-r from-blue-950/90 to-purple-950/90 border-blue-400/50 backdrop-blur-sm shadow-lg hover:shadow-blue-400/30 transition-all gpu-accelerated ${className}`}>
        <CardContent className="p-4">
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3 flex-1">
              <div className="relative">
                <img
                  src="/assets/generated/reality-earth-globe-3d.dim_400x400.png"
                  alt="現實界核心"
                  className="h-12 w-12 rounded-full border-2 border-blue-400 animate-manifestation-energy-pulse"
                  style={{ transform: `rotate(${earthRotation}deg)` }}
                  loading="lazy"
                />
                <div className={`absolute -top-1 -right-1 h-3 w-3 rounded-full animate-pulse shadow-lg border border-blue-950 ${
                  syncError ? 'bg-red-400 shadow-red-400/50' : 
                  isSyncing ? 'bg-yellow-400 shadow-yellow-400/50' : 
                  'bg-green-400 shadow-green-400/50'
                }`}></div>
              </div>
              
              <div className="flex-1 min-w-0">
                <div className="flex items-center gap-2 mb-1 flex-wrap">
                  <h3 className="text-sm font-semibold text-blue-400 manifestation-glow">現實界核心</h3>
                  <span className="text-xs text-blue-300">{timeOfDay.icon}</span>
                  {!syncError && (
                    <span className="text-xs text-green-400 bg-green-900/30 px-2 py-0.5 rounded-full flex items-center gap-1">
                      <CheckCircle2 className="h-3 w-3" />
                      自動同步
                    </span>
                  )}
                  {syncError && (
                    <span className="text-xs text-red-400 bg-red-900/30 px-2 py-0.5 rounded-full flex items-center gap-1">
                      <AlertCircle className="h-3 w-3" />
                      同步失敗
                    </span>
                  )}
                  {isIdle && (
                    <span className="text-xs text-amber-400 bg-amber-900/30 px-2 py-0.5 rounded-full flex items-center gap-1">
                      <WifiOff className="h-3 w-3" />
                      閒置
                    </span>
                  )}
                </div>
                <div className="flex items-center gap-3 text-xs text-blue-200 flex-wrap">
                  <span className="flex items-center gap-1">
                    <Clock className="h-3 w-3" />
                    {localTime.toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit' })}
                  </span>
                  <span className="flex items-center gap-1">
                    <Activity className="h-3 w-3" />
                    {cosmicAlignment}%
                  </span>
                  <span className={`flex items-center gap-1 ${getSyncStatusColor()}`}>
                    <div className={`h-2 w-2 rounded-full ${syncError ? 'bg-red-400' : isSyncing ? 'bg-yellow-400 animate-spin' : 'bg-green-400 animate-pulse'}`} />
                    {isSyncing ? '同步中' : syncError ? '錯誤' : '運行中'}
                  </span>
                </div>
              </div>
            </div>

            <div className="flex items-center gap-2">
              {showSyncControls && (
                <Button
                  onClick={handleManualSync}
                  disabled={isSyncing}
                  size="sm"
                  variant="ghost"
                  className={`${syncError ? 'text-red-400 hover:text-red-300' : 'text-blue-400 hover:text-blue-300'} hover:bg-blue-400/10`}
                  title={syncError ? '手動重試同步' : '手動同步'}
                >
                  <RefreshCw className={`h-4 w-4 ${isSyncing ? 'animate-spin' : ''}`} />
                </Button>
              )}
              <Button
                onClick={() => setIsExpanded(!isExpanded)}
                size="sm"
                variant="ghost"
                className="text-blue-400 hover:text-blue-300 hover:bg-blue-400/10"
              >
                {isExpanded ? <ChevronUp className="h-4 w-4" /> : <ChevronDown className="h-4 w-4" />}
              </Button>
            </div>
          </div>

          {/* Sync Progress Bar with GPU Animation */}
          {isSyncing && (
            <div className="mt-3 animate-fade-in">
              <div className="relative">
                <Progress value={syncProgress} className="h-2 bg-blue-950/50 overflow-hidden">
                  <div 
                    className="h-full bg-gradient-to-r from-blue-400 via-purple-500 to-blue-400 rounded-full transition-all duration-300 animate-spiritual-aura-flow relative"
                    style={{ width: `${syncProgress}%` }}
                  >
                    <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-shimmer"></div>
                  </div>
                </Progress>
                <img
                  src="/assets/generated/auto-sync-progress-indicator-transparent.dim_400x60.png"
                  alt="同步進度"
                  className="absolute top-0 left-0 h-2 w-full opacity-50 pointer-events-none"
                  loading="lazy"
                />
              </div>
              <p className="text-xs text-blue-300 mt-1 text-center flex items-center justify-center gap-2">
                <Activity className="h-3 w-3 animate-pulse" />
                現實同步中... {Math.round(syncProgress)}%
              </p>
            </div>
          )}

          {/* Sync Error Display */}
          {syncError && !isSyncing && (
            <div className="mt-3 bg-red-900/30 border border-red-400/30 rounded-lg p-3 animate-fade-in">
              <div className="flex items-start gap-2">
                <AlertCircle className="h-4 w-4 text-red-400 flex-shrink-0 mt-0.5" />
                <div className="flex-1 min-w-0">
                  <p className="text-xs text-red-400 font-semibold mb-1">同步失敗</p>
                  <p className="text-xs text-red-300">{syncError}</p>
                  <p className="text-xs text-red-300 mt-1">已重試 {retryCount} 次，請使用手動同步按鈕重試</p>
                </div>
              </div>
            </div>
          )}

          {isExpanded && (
            <div className="mt-4 pt-4 border-t border-blue-400/30 space-y-3 animate-fade-in">
              {/* Auto-Sync Status Card */}
              <div className="bg-blue-900/30 rounded-lg p-3 border border-blue-400/30">
                <div className="flex items-center justify-between mb-2">
                  <div className="flex items-center gap-2">
                    <img
                      src="/assets/generated/last-sync-timestamp-panel.dim_300x80.png"
                      alt="同步時間戳"
                      className="h-6 w-6"
                      loading="lazy"
                    />
                    <span className="text-xs text-blue-200 font-semibold">自動同步時間戳</span>
                  </div>
                  <div className="flex items-center gap-2">
                    {syncError && (
                      <span className="text-xs text-red-400 flex items-center gap-1">
                        <AlertCircle className="h-3 w-3" />
                        錯誤
                      </span>
                    )}
                    {!syncError && (
                      <span className="text-xs text-green-400 flex items-center gap-1">
                        <CheckCircle2 className="h-3 w-3" />
                        運行中
                      </span>
                    )}
                  </div>
                </div>
                <div className="space-y-1 text-xs">
                  <div className="flex items-center justify-between">
                    <span className="text-blue-300">同步頻率</span>
                    <span className="text-blue-400">{isIdle ? '每 5 分鐘 (閒置)' : '每 60 秒 (活躍)'}</span>
                  </div>
                  <div className="flex items-center justify-between">
                    <span className="text-blue-300">最後同步</span>
                    <span className="text-blue-400">{formatLastSyncTime(lastSyncTime)}</span>
                  </div>
                  <div className="flex items-center justify-between">
                    <span className="text-blue-300">下次同步</span>
                    <span className="text-blue-400">{getNextSyncTime()}</span>
                  </div>
                  {retryCount > 0 && (
                    <div className="flex items-center justify-between">
                      <span className="text-blue-300">重試次數</span>
                      <span className="text-amber-400">{retryCount} / 3</span>
                    </div>
                  )}
                </div>
              </div>

              <div className="grid grid-cols-2 gap-3">
                <div className="bg-blue-900/30 rounded-lg p-3 border border-blue-400/30">
                  <div className="flex items-center gap-2 mb-2">
                    <Globe className="h-4 w-4 text-blue-400" />
                    <span className="text-xs text-blue-200">時段</span>
                  </div>
                  <p className="text-sm font-bold text-blue-400">{timeOfDay.text}</p>
                </div>
                <div className="bg-blue-900/30 rounded-lg p-3 border border-blue-400/30">
                  <div className="flex items-center gap-2 mb-2">
                    <Zap className="h-4 w-4 text-blue-400" />
                    <span className="text-xs text-blue-200">對齊度</span>
                  </div>
                  <p className="text-sm font-bold text-blue-400">{cosmicAlignment}%</p>
                </div>
              </div>
              
              {syncStatus && (
                <div className="bg-blue-900/30 rounded-lg p-3 border border-blue-400/30">
                  <div className="flex items-center justify-between text-xs">
                    <span className="text-blue-200">後端同步狀態</span>
                    <span className={`font-semibold flex items-center gap-1 ${
                      syncStatus.lastSyncStatus === '統一同步成功' || syncStatus.lastSyncStatus === '成功' ? 'text-green-400' :
                      syncStatus.lastSyncStatus === '統一同步失敗' || syncStatus.lastSyncStatus === '失敗' ? 'text-red-400' :
                      'text-yellow-400'
                    }`}>
                      <div className={`h-2 w-2 rounded-full ${
                        syncStatus.lastSyncStatus === '統一同步成功' || syncStatus.lastSyncStatus === '成功' ? 'bg-green-400 animate-pulse' :
                        syncStatus.lastSyncStatus === '統一同步失敗' || syncStatus.lastSyncStatus === '失敗' ? 'bg-red-400' :
                        'bg-yellow-400 animate-spin'
                      }`} />
                      {syncStatus.lastSyncStatus}
                    </span>
                  </div>
                  <div className="flex items-center justify-between text-xs mt-2">
                    <span className="text-blue-200">後端時間戳</span>
                    <span className="text-blue-400 font-semibold">
                      {formatLastSyncTime(syncStatus.lastSyncTime)}
                    </span>
                  </div>
                </div>
              )}
            </div>
          )}
        </CardContent>
      </Card>
    );
  }

  return null;
}

export default memo(RealityCoreInterface);
PK
frontend/src/components/SoulCollaborationStatus.tsximport { useGetSoulCollaborationSyncStatus } from '../hooks/useQueries';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { RefreshCw, CheckCircle2, AlertCircle, Clock } from 'lucide-react';
import { toast } from 'sonner';
import { Skeleton } from '@/components/ui/skeleton';
import { useState } from 'react';

interface SoulCollaborationStatusProps {
  compact?: boolean;
}

export default function SoulCollaborationStatus({ compact = false }: SoulCollaborationStatusProps) {
  const { data: syncStatus, isLoading } = useGetSoulCollaborationSyncStatus();
  const [isSyncing, setIsSyncing] = useState(false);

  const handleForceSync = async () => {
    try {
      setIsSyncing(true);
      // Simulate sync process
      await new Promise(resolve => setTimeout(resolve, 2000));
      toast.success('同步已完成！');
    } catch (error: any) {
      console.error('Force sync error:', error);
      toast.error('同步失敗，請稍後再試');
    } finally {
      setIsSyncing(false);
    }
  };

  const formatTimestamp = (timestamp: bigint) => {
    if (timestamp === 0n) return '尚未同步';
    const date = new Date(Number(timestamp) / 1000000);
    return date.toLocaleString('zh-TW', {
      year: 'numeric',
      month: '2-digit',
      day: '2-digit',
      hour: '2-digit',
      minute: '2-digit',
    });
  };

  const getStatusIcon = () => {
    if (!syncStatus) return <Clock className="h-5 w-5 text-emerald-400" />;
    
    switch (syncStatus.lastSyncStatus) {
      case '成功':
        return <CheckCircle2 className="h-5 w-5 text-green-400 animate-pulse-slow" />;
      case '失敗':
        return <AlertCircle className="h-5 w-5 text-red-400" />;
      default:
        return <Clock className="h-5 w-5 text-amber-400" />;
    }
  };

  const getStatusColor = () => {
    if (!syncStatus) return 'text-emerald-400';
    
    switch (syncStatus.lastSyncStatus) {
      case '成功':
        return 'text-green-400';
      case '失敗':
        return 'text-red-400';
      default:
        return 'text-amber-400';
    }
  };

  if (isLoading) {
    return compact ? (
      <div className="flex items-center gap-2 text-emerald-200 text-sm">
        <Skeleton className="h-4 w-4 rounded-full" />
        <Skeleton className="h-4 w-32" />
      </div>
    ) : (
      <Card className="bg-emerald-900/50 border-amber-400/50">
        <CardHeader>
          <Skeleton className="h-6 w-48" />
        </CardHeader>
        <CardContent>
          <Skeleton className="h-20 w-full" />
        </CardContent>
      </Card>
    );
  }

  if (compact) {
    return (
      <div className="flex items-center gap-2 text-emerald-200 text-sm">
        {getStatusIcon()}
        <span>
          同步狀態: <span className={getStatusColor()}>{syncStatus?.lastSyncStatus || '未知'}</span>
        </span>
      </div>
    );
  }

  return (
    <Card className="bg-gradient-to-br from-emerald-900/50 to-green-900/50 border-amber-400/50 shadow-lg">
      <CardHeader>
        <div className="flex items-center justify-between">
          <div className="flex items-center gap-3">
            <img
              src="/assets/generated/soul-collaboration-sync-icon-transparent.dim_64x64.png"
              alt="Soul Collaboration"
              className="h-10 w-10 animate-pulse-slow"
            />
            <div>
              <CardTitle className="text-xl text-amber-400 clover-glow">Soul Collaboration 靈魂協作</CardTitle>
              <CardDescription className="text-emerald-200">
                與 LFLCEI 生態系統自動同步
              </CardDescription>
            </div>
          </div>
          <Button
            onClick={handleForceSync}
            disabled={isSyncing}
            size="sm"
            className="bg-amber-500 hover:bg-amber-600 active:bg-amber-700 text-emerald-950 transition-all transform hover:scale-[1.02] active:scale-[0.98]"
          >
            {isSyncing ? (
              <>
                <div className="h-4 w-4 animate-spin rounded-full border-2 border-emerald-950 border-t-transparent mr-2"></div>
                同步中...
              </>
            ) : (
              <>
                <RefreshCw className="h-4 w-4 mr-2" />
                手動同步
              </>
            )}
          </Button>
        </div>
      </CardHeader>
      <CardContent>
        <div className="bg-emerald-950/50 rounded-lg p-4 border border-amber-400/30 space-y-3">
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-2">
              {getStatusIcon()}
              <span className="text-emerald-200 text-sm">同步狀態</span>
            </div>
            <span className={`font-semibold ${getStatusColor()}`}>
              {syncStatus?.lastSyncStatus || '未知'}
            </span>
          </div>
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-2">
              <Clock className="h-4 w-4 text-amber-400" />
              <span className="text-emerald-200 text-sm">最後同步時間</span>
            </div>
            <span className="text-amber-400 text-sm">
              {syncStatus ? formatTimestamp(syncStatus.lastSyncTime) : '尚未同步'}
            </span>
          </div>
        </div>
        <p className="text-emerald-300 text-xs mt-3 text-center">
          系統每分鐘自動檢查更新，確保幸運籤內容與 LFLCEI 系統保持同步
        </p>
      </CardContent>
    </Card>
  );
}
PK
frontend/src/components/SoulCollaborationSyncPanel.tsximport { useState } from 'react';
import { useGetSoulCollaborationSyncStatus } from '../hooks/useQueries';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { RefreshCw, CheckCircle2, XCircle, Clock, AlertTriangle } from 'lucide-react';
import { toast } from 'sonner';
import { Skeleton } from '@/components/ui/skeleton';

export default function SoulCollaborationSyncPanel() {
  const { data: syncStatus, isLoading } = useGetSoulCollaborationSyncStatus();
  const [isSyncing, setIsSyncing] = useState(false);

  const handleForceSync = async () => {
    try {
      setIsSyncing(true);
      // Simulate sync process
      await new Promise(resolve => setTimeout(resolve, 2000));
      toast.success('同步已完成！幸運籤內容已更新');
    } catch (error: any) {
      console.error('Force sync error:', error);
      toast.error('同步失敗，請稍後再試');
    } finally {
      setIsSyncing(false);
    }
  };

  const formatTimestamp = (timestamp: bigint) => {
    if (timestamp === 0n) return '初始化';
    const date = new Date(Number(timestamp) / 1000000);
    return date.toLocaleString('zh-TW', {
      year: 'numeric',
      month: '2-digit',
      day: '2-digit',
      hour: '2-digit',
      minute: '2-digit',
      second: '2-digit',
    });
  };

  const getStatusIcon = (status: string) => {
    switch (status) {
      case '成功':
        return <CheckCircle2 className="h-5 w-5 text-green-400" />;
      case '失敗':
        return <XCircle className="h-5 w-5 text-red-400" />;
      case '初始化':
        return <Clock className="h-5 w-5 text-amber-400" />;
      default:
        return <AlertTriangle className="h-5 w-5 text-amber-400" />;
    }
  };

  const getStatusColor = (status: string) => {
    switch (status) {
      case '成功':
        return 'text-green-400 bg-green-400/10 border-green-400/30';
      case '失敗':
        return 'text-red-400 bg-red-400/10 border-red-400/30';
      case '初始化':
        return 'text-amber-400 bg-amber-400/10 border-amber-400/30';
      default:
        return 'text-emerald-400 bg-emerald-400/10 border-emerald-400/30';
    }
  };

  if (isLoading) {
    return (
      <Card className="bg-emerald-900/50 border-amber-400/50">
        <CardHeader>
          <Skeleton className="h-6 w-64" />
          <Skeleton className="h-4 w-48 mt-2" />
        </CardHeader>
        <CardContent>
          <div className="space-y-3">
            <Skeleton className="h-20 w-full" />
            <Skeleton className="h-20 w-full" />
            <Skeleton className="h-20 w-full" />
          </div>
        </CardContent>
      </Card>
    );
  }

  return (
    <Card className="bg-emerald-900/50 border-amber-400/50">
      <CardHeader>
        <div className="flex items-center justify-between">
          <div className="flex items-center gap-3">
            <img
              src="/assets/generated/soul-collaboration-status-transparent.dim_100x100.png"
              alt="Sync Status"
              className="h-10 w-10"
            />
            <div>
              <CardTitle className="text-2xl text-amber-400">Soul Collaboration 同步控制台</CardTitle>
              <CardDescription className="text-emerald-200">
                查看同步狀態和管理自動同步設定
              </CardDescription>
            </div>
          </div>
          <Button
            onClick={handleForceSync}
            disabled={isSyncing}
            className="bg-amber-500 hover:bg-amber-600 active:bg-amber-700 text-emerald-950 transition-all transform hover:scale-[1.02] active:scale-[0.98]"
          >
            {isSyncing ? (
              <>
                <div className="h-5 w-5 animate-spin rounded-full border-2 border-emerald-950 border-t-transparent mr-2"></div>
                同步中...
              </>
            ) : (
              <>
                <RefreshCw className="h-5 w-5 mr-2" />
                立即同步
              </>
            )}
          </Button>
        </div>
      </CardHeader>
      <CardContent className="space-y-4">
        <div className="bg-emerald-950/50 rounded-lg p-4 border border-amber-400/30">
          <h3 className="text-amber-400 font-semibold mb-3 flex items-center gap-2">
            <Clock className="h-5 w-5" />
            當前同步狀態
          </h3>
          <div className={`rounded-lg p-3 border ${getStatusColor(syncStatus?.lastSyncStatus || '初始化')}`}>
            <div className="flex items-center justify-between mb-2">
              <div className="flex items-center gap-2">
                {getStatusIcon(syncStatus?.lastSyncStatus || '初始化')}
                <span className="font-semibold">{syncStatus?.lastSyncStatus || '初始化'}</span>
              </div>
              <span className="text-xs opacity-75">
                {syncStatus ? formatTimestamp(syncStatus.lastSyncTime) : '尚未同步'}
              </span>
            </div>
          </div>
        </div>

        <div className="bg-emerald-950/50 rounded-lg p-4 border border-amber-400/30">
          <h3 className="text-amber-400 font-semibold mb-3">同步說明</h3>
          <div className="space-y-2 text-emerald-200 text-sm">
            <p>• 系統每分鐘自動檢查 LFLCEI 整合端點的更新</p>
            <p>• 自動同步幸運籤訊息庫、AI 控制參數和生成模型配置</p>
            <p>• 同步失敗時會自動重試，並記錄錯誤日誌</p>
            <p>• 管理員可手動觸發同步以立即更新內容</p>
            <p>• 所有同步操作都會記錄在系統日誌中供查詢</p>
          </div>
        </div>
      </CardContent>
    </Card>
  );
}
PK
frontend/src/components/SupportDeveloperButton.tsximport { useState, useEffect } from 'react';
import { Button } from '@/components/ui/button';
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
} from '@/components/ui/dialog';
import { Heart, Loader2, CheckCircle2, XCircle, Wallet, Clock, Zap } from 'lucide-react';
import { toast } from 'sonner';
import { 
  useIsCallerSubscribed, 
  useGetSubscriptionExpiryTime,
  useCreateCheckoutSession,
  useVerifyAndActivateSubscription,
  useIsStripeConfigured,
  useGetHourlySubscriptionStatus,
  useActivateHourlySubscription,
  useDeactivateHourlySubscription
} from '../hooks/useQueries';
import { useInternetIdentity } from '../hooks/useInternetIdentity';
import type { ShoppingItem } from '../backend';

interface SupportDeveloperButtonProps {
  variant?: 'default' | 'outline' | 'ghost';
  size?: 'default' | 'sm' | 'lg';
  className?: string;
  showStatus?: boolean;
}

const DEVELOPER_WALLETS = [
  {
    id: 'wallet1',
    address: '38614da9d6625a2c38eebb8870e842c2fecb21bdf3688bada26a01d24042e7d5',
    label: '開發者錢包 A',
  },
  {
    id: 'wallet2',
    address: 'gwzao-dhzdc-6vi6v-cikxi-meydb-eii5s-ve2wa-kze56-vosk7-cukek-xae',
    label: '開發者錢包 B',
  },
];

type SubscriptionTier = 'monthly' | 'hourly';

export default function SupportDeveloperButton({ 
  variant = 'default', 
  size = 'default',
  className = '',
  showStatus = false
}: SupportDeveloperButtonProps) {
  const [showTierSelectionModal, setShowTierSelectionModal] = useState(false);
  const [showWalletSelectionModal, setShowWalletSelectionModal] = useState(false);
  const [showConfirmModal, setShowConfirmModal] = useState(false);
  const [showResultModal, setShowResultModal] = useState(false);
  const [selectedTier, setSelectedTier] = useState<SubscriptionTier | null>(null);
  const [selectedWallet, setSelectedWallet] = useState<string | null>(null);
  const [paymentSuccess, setPaymentSuccess] = useState(false);
  const [sessionId, setSessionId] = useState<string | null>(null);
  
  const { identity } = useInternetIdentity();
  
  const { data: isSubscribed, isLoading: checkingSubscription } = useIsCallerSubscribed();
  const { data: subscriptionEndDate } = useGetSubscriptionExpiryTime();
  const { data: isStripeConfigured } = useIsStripeConfigured();
  const { data: hourlyStatus } = useGetHourlySubscriptionStatus();
  const createCheckoutSession = useCreateCheckoutSession();
  const verifyAndActivate = useVerifyAndActivateSubscription();
  const activateHourly = useActivateHourlySubscription();
  const deactivateHourly = useDeactivateHourlySubscription();

  const handleOpenTierSelection = () => {
    if (!identity) {
      toast.error('請先登入');
      return;
    }

    if (!isStripeConfigured) {
      toast.error('支付系統尚未配置，請聯繫管理員');
      return;
    }

    setShowTierSelectionModal(true);
  };

  const handleTierSelect = (tier: SubscriptionTier) => {
    setSelectedTier(tier);
    setShowTierSelectionModal(false);
    
    if (tier === 'hourly') {
      // For hourly subscription, directly activate without payment
      handleActivateHourlySubscription();
    } else {
      // For monthly subscription, proceed to wallet selection
      setShowWalletSelectionModal(true);
    }
  };

  const handleActivateHourlySubscription = async () => {
    try {
      toast.info('正在啟用每小時訂閱...');
      await activateHourly.mutateAsync();
      toast.success('每小時訂閱已啟用！', {
        description: '每小時將自動扣除 0.1 ICP 支持開發者',
      });
      setPaymentSuccess(true);
      setShowResultModal(true);
    } catch (error: any) {
      console.error('Hourly subscription activation error:', error);
      toast.error('啟用每小時訂閱失敗', {
        description: error.message || '請稍後再試',
      });
      setPaymentSuccess(false);
      setShowResultModal(true);
    }
  };

  const handleDeactivateHourlySubscription = async () => {
    try {
      toast.info('正在停用每小時訂閱...');
      await deactivateHourly.mutateAsync();
      toast.success('每小時訂閱已停用');
    } catch (error: any) {
      console.error('Hourly subscription deactivation error:', error);
      toast.error('停用每小時訂閱失敗', {
        description: error.message || '請稍後再試',
      });
    }
  };

  const handleWalletSelect = (walletId: string) => {
    setSelectedWallet(walletId);
    setShowWalletSelectionModal(false);
    setShowConfirmModal(true);
  };

  const handleConfirmPayment = async () => {
    if (!selectedWallet) return;

    try {
      const wallet = DEVELOPER_WALLETS.find(w => w.id === selectedWallet);
      if (!wallet) throw new Error('Invalid wallet selection');

      // Create shopping item for 10 ICP subscription
      const items: ShoppingItem[] = [{
        productName: '代碼之內開發者支持訂閱',
        productDescription: '每月 10 ICP 訂閱計劃 - 支持開發者持續改進',
        priceInCents: 1000n, // 10 ICP = 1000 cents (for Stripe)
        currency: 'ICP',
        quantity: 1n,
      }];

      const baseUrl = `${window.location.protocol}//${window.location.host}`;
      const successUrl = `${baseUrl}?payment=success`;
      const cancelUrl = `${baseUrl}?payment=cancel`;

      toast.info('正在創建支付會話...');
      
      const session = await createCheckoutSession.mutateAsync({
        items,
        successUrl,
        cancelUrl,
      });

      setSessionId(session.id);
      setShowConfirmModal(false);

      // Redirect to Stripe checkout
      toast.success('正在跳轉到支付頁面...');
      window.location.href = session.url;

    } catch (error: any) {
      console.error('Payment error:', error);
      setPaymentSuccess(false);
      setShowConfirmModal(false);
      setShowResultModal(true);
      toast.error('創建支付會話失敗，請稍後再試');
    }
  };

  // Handle payment success/failure from URL params
  useEffect(() => {
    const params = new URLSearchParams(window.location.search);
    const paymentStatus = params.get('payment');
    const urlSessionId = params.get('session_id');

    if (paymentStatus === 'success' && urlSessionId) {
      // Verify and activate subscription
      verifyAndActivate.mutateAsync(urlSessionId).then((success) => {
        setPaymentSuccess(success);
        setShowResultModal(true);
        if (success) {
          toast.success('訂閱成功！感謝您的支持！');
        } else {
          toast.error('支付驗證失敗，請聯繫客服');
        }
        // Clean URL
        window.history.replaceState({}, '', window.location.pathname);
      });
    } else if (paymentStatus === 'cancel') {
      toast.info('支付已取消');
      window.history.replaceState({}, '', window.location.pathname);
    }
  }, [verifyAndActivate]);

  const formatEndDate = (timestamp: bigint) => {
    const date = new Date(Number(timestamp) / 1000000);
    return date.toLocaleDateString('zh-TW', { 
      year: 'numeric', 
      month: 'long', 
      day: 'numeric' 
    });
  };

  const getDaysRemaining = (timestamp: bigint) => {
    const now = Date.now() * 1000000;
    const remaining = Number(timestamp) - now;
    const days = Math.ceil(remaining / (24 * 60 * 60 * 1000 * 1000000));
    return Math.max(0, days);
  };

  const formatHourlyTime = (timestamp: bigint) => {
    const date = new Date(Number(timestamp) / 1000000);
    return date.toLocaleString('zh-TW', { 
      month: 'short',
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    });
  };

  const isLoading = checkingSubscription || createCheckoutSession.isPending || verifyAndActivate.isPending || activateHourly.isPending || deactivateHourly.isPending;
  const hasActiveSubscription = isSubscribed || (hourlyStatus?.active ?? false);

  return (
    <>
      <div className="relative">
        <Button
          variant={variant}
          size={size}
          onClick={handleOpenTierSelection}
          disabled={isLoading}
          className={`relative overflow-hidden group ${className}`}
        >
          {isLoading ? (
            <>
              <Loader2 className="h-4 w-4 mr-2 animate-spin" />
              處理中...
            </>
          ) : hasActiveSubscription ? (
            <>
              <CheckCircle2 className="h-4 w-4 mr-2 text-green-400 animate-pulse" />
              訂閱已啟用
            </>
          ) : (
            <>
              <Heart className="h-4 w-4 mr-2 group-hover:scale-110 transition-transform" />
              支持開發者
            </>
          )}
          
          {!hasActiveSubscription && !isLoading && (
            <div className="absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-500 bg-gradient-to-r from-pink-400/0 via-pink-400/10 to-pink-400/0 animate-pulse-slow"></div>
          )}
        </Button>

        {showStatus && (
          <div className="mt-2 space-y-2">
            {isSubscribed && subscriptionEndDate && (
              <div className="text-center">
                <div className="flex items-center justify-center gap-2">
                  <img
                    src="/assets/generated/subscribed-indicator-gpu-transparent.dim_200x200.png"
                    alt="Subscribed"
                    className="h-6 w-6 animate-pulse"
                  />
                  <p className="text-xs text-emerald-300">
                    月訂閱剩餘 {getDaysRemaining(subscriptionEndDate)} 天
                  </p>
                </div>
                <p className="text-xs text-emerald-400 mt-1">
                  到期：{formatEndDate(subscriptionEndDate)}
                </p>
              </div>
            )}
            
            {hourlyStatus?.active && (
              <div className="text-center bg-gradient-to-r from-amber-900/30 to-orange-900/30 rounded-lg p-3 border border-amber-400/30">
                <div className="flex items-center justify-center gap-2 mb-1">
                  <Clock className="h-5 w-5 text-amber-400 animate-pulse" />
                  <p className="text-sm font-semibold text-amber-300">
                    每小時訂閱啟用中
                  </p>
                </div>
                <div className="space-y-1 text-xs">
                  <div className="flex items-center justify-between text-amber-200">
                    <span>已計費時數：</span>
                    <span className="font-mono font-bold text-amber-400">
                      {Number(hourlyStatus.hoursBilled)} 小時
                    </span>
                  </div>
                  <div className="flex items-center justify-between text-amber-200">
                    <span>累計支付：</span>
                    <span className="font-mono font-bold text-amber-400">
                      {(Number(hourlyStatus.totalICPPaid) / 100000000).toFixed(2)} ICP
                    </span>
                  </div>
                  {hourlyStatus.lastBilledTime && (
                    <div className="flex items-center justify-between text-amber-200">
                      <span>上次計費：</span>
                      <span className="font-mono text-amber-400">
                        {formatHourlyTime(hourlyStatus.lastBilledTime)}
                      </span>
                    </div>
                  )}
                </div>
                <Button
                  variant="outline"
                  size="sm"
                  onClick={handleDeactivateHourlySubscription}
                  disabled={deactivateHourly.isPending}
                  className="mt-2 w-full border-amber-400/50 text-amber-200 hover:bg-amber-400/20 text-xs"
                >
                  {deactivateHourly.isPending ? (
                    <>
                      <Loader2 className="h-3 w-3 mr-1 animate-spin" />
                      停用中...
                    </>
                  ) : (
                    '停用每小時訂閱'
                  )}
                </Button>
              </div>
            )}
          </div>
        )}
      </div>

      {/* Tier Selection Modal */}
      <Dialog open={showTierSelectionModal} onOpenChange={setShowTierSelectionModal}>
        <DialogContent className="bg-gradient-to-br from-slate-950 to-blue-900 border-cyan-400/50 shadow-2xl max-w-2xl">
          <DialogHeader>
            <DialogTitle className="text-2xl text-cyan-400 flex items-center gap-2">
              <Heart className="h-6 w-6 text-pink-400 animate-pulse" />
              選擇訂閱方案
            </DialogTitle>
            <DialogDescription className="text-blue-200 text-base">
              選擇最適合您的開發者支持計劃
            </DialogDescription>
          </DialogHeader>

          <div className="grid grid-cols-1 md:grid-cols-2 gap-4 py-4">
            {/* Monthly Subscription Tier */}
            <button
              onClick={() => handleTierSelect('monthly')}
              className="group relative overflow-hidden rounded-xl border-2 border-cyan-400/50 hover:border-cyan-400 bg-gradient-to-br from-blue-900/50 to-cyan-900/50 p-6 text-left transition-all duration-300 hover:scale-105 hover:shadow-2xl hover:shadow-cyan-400/30"
            >
              <div className="absolute inset-0 bg-gradient-to-br from-cyan-400/0 via-cyan-400/5 to-cyan-400/0 opacity-0 group-hover:opacity-100 transition-opacity"></div>
              <div className="relative z-10">
                <div className="flex items-center gap-3 mb-3">
                  <Zap className="h-8 w-8 text-cyan-400" />
                  <h3 className="text-xl font-bold text-cyan-400">月訂閱方案</h3>
                </div>
                <div className="mb-4">
                  <div className="text-3xl font-bold text-cyan-300 mb-1">10 ICP</div>
                  <div className="text-sm text-blue-200">每月一次性支付</div>
                </div>
                <ul className="space-y-2 text-sm text-blue-100">
                  <li className="flex items-start gap-2">
                    <CheckCircle2 className="h-4 w-4 text-green-400 mt-0.5 flex-shrink-0" />
                    <span>30 天完整訂閱期限</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <CheckCircle2 className="h-4 w-4 text-green-400 mt-0.5 flex-shrink-0" />
                    <span>專屬訂閱用戶標識</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <CheckCircle2 className="h-4 w-4 text-green-400 mt-0.5 flex-shrink-0" />
                    <span>優先體驗新功能</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <CheckCircle2 className="h-4 w-4 text-green-400 mt-0.5 flex-shrink-0" />
                    <span>支持開發者持續改進</span>
                  </li>
                </ul>
                <div className="mt-4 pt-4 border-t border-cyan-400/30">
                  <div className="text-xs text-blue-300 text-center">
                    適合長期支持者
                  </div>
                </div>
              </div>
            </button>

            {/* Hourly Subscription Tier */}
            <button
              onClick={() => handleTierSelect('hourly')}
              className="group relative overflow-hidden rounded-xl border-2 border-amber-400/50 hover:border-amber-400 bg-gradient-to-br from-orange-900/50 to-amber-900/50 p-6 text-left transition-all duration-300 hover:scale-105 hover:shadow-2xl hover:shadow-amber-400/30"
            >
              <div className="absolute inset-0 bg-gradient-to-br from-amber-400/0 via-amber-400/5 to-amber-400/0 opacity-0 group-hover:opacity-100 transition-opacity"></div>
              <div className="relative z-10">
                <div className="flex items-center gap-3 mb-3">
                  <Clock className="h-8 w-8 text-amber-400 animate-pulse" />
                  <h3 className="text-xl font-bold text-amber-400">每小時方案</h3>
                </div>
                <div className="mb-4">
                  <div className="text-3xl font-bold text-amber-300 mb-1">0.1 ICP/h</div>
                  <div className="text-sm text-orange-200">每小時自動扣款</div>
                </div>
                <ul className="space-y-2 text-sm text-orange-100">
                  <li className="flex items-start gap-2">
                    <CheckCircle2 className="h-4 w-4 text-green-400 mt-0.5 flex-shrink-0" />
                    <span>靈活的小時計費模式</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <CheckCircle2 className="h-4 w-4 text-green-400 mt-0.5 flex-shrink-0" />
                    <span>自動續費無需手動操作</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <CheckCircle2 className="h-4 w-4 text-green-400 mt-0.5 flex-shrink-0" />
                    <span>實時顯示計費時數</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <CheckCircle2 className="h-4 w-4 text-green-400 mt-0.5 flex-shrink-0" />
                    <span>隨時可停用訂閱</span>
                  </li>
                </ul>
                <div className="mt-4 pt-4 border-t border-amber-400/30">
                  <div className="text-xs text-orange-300 text-center">
                    適合持續回饋開發者
                  </div>
                </div>
              </div>
            </button>
          </div>

          <DialogFooter>
            <Button
              variant="outline"
              onClick={() => setShowTierSelectionModal(false)}
              className="border-cyan-400/50 text-cyan-100 hover:bg-cyan-400/20"
            >
              取消
            </Button>
          </DialogFooter>
        </DialogContent>
      </Dialog>

      {/* Wallet Selection Modal */}
      <Dialog open={showWalletSelectionModal} onOpenChange={setShowWalletSelectionModal}>
        <DialogContent className="bg-gradient-to-br from-slate-950 to-blue-900 border-cyan-400/50 shadow-2xl max-w-md">
          <DialogHeader>
            <DialogTitle className="text-2xl text-cyan-400 flex items-center gap-2">
              <Wallet className="h-6 w-6 text-cyan-400" />
              選擇開發者錢包
            </DialogTitle>
            <DialogDescription className="text-blue-200 text-base">
              請選擇您要支付的開發者錢包地址
            </DialogDescription>
          </DialogHeader>

          <div className="space-y-3 py-4">
            {DEVELOPER_WALLETS.map((wallet) => (
              <Button
                key={wallet.id}
                onClick={() => handleWalletSelect(wallet.id)}
                variant="outline"
                className="w-full h-auto p-4 border-cyan-400/50 hover:bg-cyan-400/20 hover:border-cyan-400 text-left justify-start"
              >
                <div className="flex-1">
                  <div className="flex items-center gap-2 mb-2">
                    <Wallet className="h-4 w-4 text-cyan-400" />
                    <span className="font-semibold text-cyan-400">{wallet.label}</span>
                  </div>
                  <p className="text-xs text-blue-200 font-mono break-all">
                    {wallet.address}
                  </p>
                </div>
              </Button>
            ))}
          </div>

          <DialogFooter>
            <Button
              variant="outline"
              onClick={() => setShowWalletSelectionModal(false)}
              className="border-cyan-400/50 text-cyan-100 hover:bg-cyan-400/20"
            >
              取消
            </Button>
          </DialogFooter>
        </DialogContent>
      </Dialog>

      {/* Confirmation Modal */}
      <Dialog open={showConfirmModal} onOpenChange={setShowConfirmModal}>
        <DialogContent className="bg-gradient-to-br from-slate-950 to-blue-900 border-cyan-400/50 shadow-2xl max-w-md">
          <DialogHeader>
            <DialogTitle className="text-2xl text-cyan-400 flex items-center gap-2">
              <Heart className="h-6 w-6 text-pink-400 animate-pulse" />
              確認訂閱支付
            </DialogTitle>
            <DialogDescription className="text-blue-200 text-base">
              感謝您願意支持 代碼之內 的持續開發與維護
            </DialogDescription>
          </DialogHeader>

          <div className="space-y-4 py-4">
            <div className="bg-emerald-950/50 rounded-xl p-4 border border-cyan-400/30">
              <h3 className="text-cyan-400 font-semibold mb-3">訂閱詳情</h3>
              <div className="space-y-2 text-blue-200">
                <div className="flex justify-between">
                  <span>訂閱期限：</span>
                  <span className="font-semibold text-cyan-400">30 天</span>
                </div>
                <div className="flex justify-between">
                  <span>支付金額：</span>
                  <span className="font-semibold text-cyan-400">10 ICP</span>
                </div>
                <div className="flex justify-between items-start">
                  <span>收款錢包：</span>
                  <span className="font-mono text-xs text-cyan-400 break-all text-right ml-2">
                    {DEVELOPER_WALLETS.find(w => w.id === selectedWallet)?.label}
                  </span>
                </div>
              </div>
            </div>

            <div className="bg-amber-900/30 rounded-xl p-4 border border-amber-400/30">
              <h3 className="text-amber-400 font-semibold mb-2 flex items-center gap-2">
                <Heart className="h-4 w-4" />
                訂閱權益
              </h3>
              <ul className="space-y-1 text-blue-200 text-sm">
                <li>• 支持開發者持續改進應用</li>
                <li>• 獲得專屬訂閱用戶標識</li>
                <li>• 優先體驗新功能</li>
                <li>• 為靈界生態系統做出貢獻</li>
              </ul>
            </div>

            <div className="bg-blue-900/30 rounded-xl p-3 border border-blue-400/30">
              <p className="text-blue-200 text-xs text-center">
                點擊「確認支付」將跳轉到 Stripe 支付頁面完成 10 ICP 的支付
              </p>
            </div>
          </div>

          <DialogFooter className="gap-2">
            <Button
              variant="outline"
              onClick={() => setShowConfirmModal(false)}
              disabled={createCheckoutSession.isPending}
              className="border-cyan-400/50 text-cyan-100 hover:bg-cyan-400/20"
            >
              取消
            </Button>
            <Button
              onClick={handleConfirmPayment}
              disabled={createCheckoutSession.isPending}
              className="bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white shadow-lg hover:shadow-pink-500/50"
            >
              {createCheckoutSession.isPending ? (
                <>
                  <Loader2 className="h-4 w-4 mr-2 animate-spin" />
                  處理中...
                </>
              ) : (
                <>
                  <Heart className="h-4 w-4 mr-2" />
                  確認支付
                </>
              )}
            </Button>
          </DialogFooter>
        </DialogContent>
      </Dialog>

      {/* Result Modal */}
      <Dialog open={showResultModal} onOpenChange={setShowResultModal}>
        <DialogContent className="bg-gradient-to-br from-slate-950 to-blue-900 border-cyan-400/50 shadow-2xl max-w-md">
          <DialogHeader>
            <DialogTitle className={`text-2xl flex items-center gap-2 ${
              paymentSuccess ? 'text-green-400' : 'text-red-400'
            }`}>
              {paymentSuccess ? (
                <>
                  <CheckCircle2 className="h-6 w-6 animate-bounce" />
                  {selectedTier === 'hourly' ? '每小時訂閱啟用成功！' : '訂閱成功！'}
                </>
              ) : (
                <>
                  <XCircle className="h-6 w-6" />
                  {selectedTier === 'hourly' ? '啟用失敗' : '訂閱失敗'}
                </>
              )}
            </DialogTitle>
          </DialogHeader>

          <div className="py-6">
            {paymentSuccess ? (
              <div className="space-y-4">
                <div className="bg-green-900/30 rounded-xl p-4 border border-green-400/30">
                  <p className="text-green-100 text-center mb-2">
                    {selectedTier === 'hourly' 
                      ? '感謝您的支持！每小時訂閱已成功啟用。'
                      : '感謝您的支持！您的訂閱已成功啟用。'
                    }
                  </p>
                  <p className="text-green-200 text-sm text-center">
                    {selectedTier === 'hourly'
                      ? '系統將每小時自動扣除 0.1 ICP，您可以隨時停用'
                      : '訂閱將於 30 天後到期，屆時會收到續費提醒'
                    }
                  </p>
                </div>
                <div className="text-center">
                  <img
                    src={selectedTier === 'hourly' 
                      ? '/assets/generated/hourly-billing-status-indicator-transparent.dim_200x100.png'
                      : '/assets/generated/payment-success-icon-transparent.dim_80x80.png'
                    }
                    alt="Success"
                    className={selectedTier === 'hourly' ? 'h-24 w-auto mx-auto animate-pulse' : 'h-20 w-20 mx-auto animate-bounce'}
                  />
                </div>
                <div className="bg-cyan-900/30 rounded-xl p-3 border border-cyan-400/30">
                  <p className="text-cyan-200 text-xs text-center">
                    {selectedTier === 'hourly'
                      ? '您可以在首頁查看實時計費狀態和累計時數'
                      : '您現在可以在首頁看到專屬的訂閱標識'
                    }
                  </p>
                </div>
              </div>
            ) : (
              <div className="space-y-4">
                <div className="bg-red-900/30 rounded-xl p-4 border border-red-400/30">
                  <p className="text-red-100 text-center mb-2">
                    {selectedTier === 'hourly'
                      ? '啟用每小時訂閱失敗，請稍後再試。'
                      : '支付處理失敗，請稍後再試。'
                    }
                  </p>
                  <p className="text-red-200 text-sm text-center">
                    如果問題持續，請聯繫客服支援
                  </p>
                </div>
                <div className="text-center">
                  <img
                    src="/assets/generated/payment-error-screen.dim_600x400.png"
                    alt="Error"
                    className="h-32 w-auto mx-auto opacity-70"
                  />
                </div>
              </div>
            )}
          </div>

          <DialogFooter>
            <Button
              onClick={() => setShowResultModal(false)}
              className="w-full bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700 text-white"
            >
              確定
            </Button>
          </DialogFooter>
        </DialogContent>
      </Dialog>
    </>
  );
}
PK
frontend/src/components/TotalEcosystemEnergy.tsximport { useState, useEffect, useRef } from 'react';
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';
import { Zap, TrendingUp, Activity } from 'lucide-react';
import { useGetEcosystemEnergy } from '../hooks/useEcosystemHub';
import { Skeleton } from '@/components/ui/skeleton';

export default function TotalEcosystemEnergy() {
  const { data: ecosystemEnergy, isLoading, isError, error } = useGetEcosystemEnergy();
  const [previousEnergy, setPreviousEnergy] = useState<bigint | null>(null);
  const [isGlowing, setIsGlowing] = useState(false);
  const glowTimeoutRef = useRef<NodeJS.Timeout | null>(null);
  const animationFrameRef = useRef<number | null>(null);

  // Detect energy increase and trigger glow animation with GPU optimization (能量同步動畫修正)
  useEffect(() => {
    if (ecosystemEnergy !== undefined && previousEnergy !== null) {
      if (ecosystemEnergy > previousEnergy) {
        // Energy increased - trigger glow animation with requestAnimationFrame (界面層優化)
        if (animationFrameRef.current) {
          cancelAnimationFrame(animationFrameRef.current);
        }
        
        animationFrameRef.current = requestAnimationFrame(() => {
          setIsGlowing(true);
          
          // Clear existing timeout
          if (glowTimeoutRef.current) {
            clearTimeout(glowTimeoutRef.current);
          }
          
          // Stop glowing after 1.6 seconds with smooth transition (優化from 1.8 - 動畫時序一致性)
          glowTimeoutRef.current = setTimeout(() => {
            requestAnimationFrame(() => {
              setIsGlowing(false);
            });
          }, 1600);
        });
      }
    }
    
    if (ecosystemEnergy !== undefined) {
      setPreviousEnergy(ecosystemEnergy);
    }

    return () => {
      if (glowTimeoutRef.current) {
        clearTimeout(glowTimeoutRef.current);
      }
      if (animationFrameRef.current) {
        cancelAnimationFrame(animationFrameRef.current);
      }
    };
  }, [ecosystemEnergy, previousEnergy]);

  if (isLoading) {
    return (
      <Card className="bg-gradient-to-br from-cyan-900/50 via-blue-900/50 to-indigo-900/50 border-cyan-400/50 shadow-xl gpu-accelerated">
        <CardHeader>
          <div className="flex items-center gap-3">
            <Zap className="h-8 w-8 text-cyan-400 animate-pulse" />
            <div className="flex-1">
              <CardTitle className="text-2xl text-cyan-400">總生態能量</CardTitle>
              <CardDescription className="text-cyan-200">Backend Ecosystem Hub</CardDescription>
            </div>
          </div>
        </CardHeader>
        <CardContent>
          <Skeleton className="h-20 w-full" />
        </CardContent>
      </Card>
    );
  }

  if (isError) {
    return (
      <Card className="bg-gradient-to-br from-red-900/50 via-orange-900/50 to-red-900/50 border-red-400/50 shadow-xl gpu-accelerated">
        <CardHeader>
          <div className="flex items-center gap-3">
            <Zap className="h-8 w-8 text-red-400" />
            <div className="flex-1">
              <CardTitle className="text-2xl text-red-400">總生態能量</CardTitle>
              <CardDescription className="text-red-200">連接失敗 • 自動重試中</CardDescription>
            </div>
          </div>
        </CardHeader>
        <CardContent>
          <p className="text-red-300 text-sm">
            無法連接到生態系統中心。系統將自動重試連接。
          </p>
          <p className="text-red-400 text-xs mt-2">
            {error instanceof Error ? error.message : '未知錯誤'}
          </p>
        </CardContent>
      </Card>
    );
  }

  const energyValue = Number(ecosystemEnergy || 0n);
  const formattedEnergy = energyValue.toLocaleString('zh-TW');

  return (
    <Card className={`bg-gradient-to-br from-cyan-900/50 via-blue-900/50 to-indigo-900/50 border-cyan-400/50 shadow-2xl gpu-accelerated transition-all duration-350 ${
      isGlowing ? 'shadow-cyan-400/70 scale-[1.015]' : 'shadow-xl'
    }`}> {/* Optimized duration from 400ms (過渡動畫精煉) */}
      <CardHeader>
        <div className="flex items-center gap-3">
          <div className="relative gpu-accelerated">
            <Zap className={`h-8 w-8 text-cyan-400 transition-all duration-350 ${
              isGlowing ? 'animate-manifestation-energy-pulse scale-125' : ''
            }`} />
            {isGlowing && (
              <div className="absolute inset-0 animate-ping gpu-accelerated">
                <Zap className="h-8 w-8 text-cyan-400 opacity-75" />
              </div>
            )}
          </div>
          <div className="flex-1">
            <CardTitle className={`text-2xl text-cyan-400 transition-all duration-350 ${
              isGlowing ? 'manifestation-glow scale-105' : ''
            }`}>
              總生態能量
            </CardTitle>
            <CardDescription className="text-cyan-200 flex items-center gap-2">
              <Activity className="h-4 w-4 animate-pulse" />
              Backend Ecosystem Hub • 每 2.5 秒自動刷新
            </CardDescription>
          </div>
        </div>
      </CardHeader>
      <CardContent>
        <div className={`bg-cyan-950/50 rounded-xl p-6 border transition-all duration-350 gpu-accelerated ${
          isGlowing 
            ? 'border-cyan-400 shadow-lg shadow-cyan-400/60' 
            : 'border-cyan-400/30'
        }`}>
          <div className="flex items-center justify-between mb-2">
            <span className="text-cyan-300 text-sm">當前總能量</span>
            {isGlowing && (
              <span className="text-green-400 text-xs flex items-center gap-1 animate-fade-in gpu-accelerated">
                <TrendingUp className="h-3 w-3" />
                能量增加！
              </span>
            )}
          </div>
          <div className={`text-4xl sm:text-5xl font-bold text-cyan-400 transition-all duration-350 gpu-accelerated ${
            isGlowing ? 'scale-110 text-cyan-300' : ''
          }`}>
            {formattedEnergy}
          </div>
          <div className="mt-3 flex items-center gap-2 text-xs text-cyan-300">
            <div className={`h-2 w-2 rounded-full bg-green-400 transition-all duration-350 gpu-accelerated ${
              isGlowing ? 'animate-ping' : 'animate-pulse'
            }`}></div>
            <span>即時同步中 • 系統調整優化版</span>
          </div>
        </div>

        {/* Energy Flow Visualization with GPU acceleration (能量流動視覺化改善) */}
        <div className="mt-4 space-y-2">
          <div className="flex items-center justify-between text-xs text-cyan-300">
            <span>能量流動狀態</span>
            <span className="text-green-400">● 活躍</span>
          </div>
          <div className="h-1 bg-cyan-950/50 rounded-full overflow-hidden gpu-accelerated">
            <div className={`h-full bg-gradient-to-r from-cyan-400 via-blue-500 to-cyan-400 rounded-full transition-all duration-700 gpu-accelerated ${
              isGlowing ? 'animate-spiritual-aura-flow' : ''
            }`} style={{ width: '100%' }}></div> {/* Optimized duration from 800ms */}
          </div>
        </div>

        {/* Connection Info */}
        <div className="mt-4 bg-blue-950/30 rounded-lg p-3 border border-blue-400/30">
          <p className="text-xs text-blue-200 mb-1">
            <span className="font-semibold">生態系統中心：</span> lflc-ei-75z.caffeine.xyz
          </p>
          <p className="text-xs text-blue-300">
            每次用戶獲勝時自動添加 100 能量到總生態能量池 • 系統全面調整優化版 • 遠端後端連接調整 • 狀態更新加速
          </p>
        </div>
      </CardContent>
    </Card>
  );
}
PK
frontend/src/components/UnifiedCoreInterface.tsximport { useState, useEffect, useCallback, memo } from 'react';
import { Card, CardContent } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Progress } from '@/components/ui/progress';
import { 
  Orbit, 
  Zap, 
  Activity, 
  Sparkles, 
  TrendingUp,
  RefreshCw,
  ChevronDown,
  ChevronUp,
  Layers,
  Network,
  Clock,
  CheckCircle2,
  AlertCircle,
  WifiOff,
  Globe,
  Cpu
} from 'lucide-react';
import { useGetSoulCollaborationSyncStatus, useGetCallerEnergyState, useGetCallerUserProfile, useUnifiedSystemSync } from '../hooks/useQueries';

interface UnifiedCoreInterfaceProps {
  variant?: 'full' | 'compact' | 'minimal';
  showSyncControls?: boolean;
  className?: string;
  currentPage?: string;
}

function UnifiedCoreInterface({ 
  variant = 'compact', 
  showSyncControls = true,
  className = '',
  currentPage = 'home'
}: UnifiedCoreInterfaceProps) {
  const [isExpanded, setIsExpanded] = useState(false);
  const [syncProgress, setSyncProgress] = useState(0);
  const [moduleStatus, setModuleStatus] = useState<Record<string, 'active' | 'syncing' | 'idle'>>({
    '靈魂協作引擎': 'active',
    'AI同步邏輯': 'active',
    '訂閱支付系統': 'active',
    '九界融合模組': 'active',
    '現實連結系統': 'active',
    '跨平台渲染': 'active',
  });
  
  const { data: syncStatus } = useGetSoulCollaborationSyncStatus();
  const { data: energyState } = useGetCallerEnergyState();
  const { data: userProfile } = useGetCallerUserProfile();
  const { performSync, lastSyncTime, isSyncing, syncError, retryCount, isIdle } = useUnifiedSystemSync();

  // Real-time module status simulation
  useEffect(() => {
    const interval = setInterval(() => {
      setModuleStatus(prev => {
        const updated = { ...prev };
        Object.keys(updated).forEach(key => {
          if (Math.random() > 0.95) {
            updated[key] = updated[key] === 'active' ? 'syncing' : 'active';
          }
        });
        return updated;
      });
    }, 3000);

    return () => clearInterval(interval);
  }, []);

  // Sync progress animation
  useEffect(() => {
    if (isSyncing) {
      setSyncProgress(0);
      const interval = setInterval(() => {
        setSyncProgress(prev => {
          if (prev >= 95) return 95;
          return prev + Math.random() * 15;
        });
      }, 200);
      
      return () => clearInterval(interval);
    } else {
      const timeout = setTimeout(() => setSyncProgress(0), 1000);
      return () => clearTimeout(timeout);
    }
  }, [isSyncing]);

  // Complete progress when sync finishes
  useEffect(() => {
    if (!isSyncing && syncProgress > 0 && syncProgress < 100) {
      setSyncProgress(100);
    }
  }, [isSyncing, syncProgress]);

  const handleManualSync = useCallback(async () => {
    try {
      setModuleStatus(prev => {
        const updated = { ...prev };
        Object.keys(updated).forEach(key => {
          updated[key] = 'syncing';
        });
        return updated;
      });

      await performSync(true);
      
      setModuleStatus(prev => {
        const updated = { ...prev };
        Object.keys(updated).forEach(key => {
          updated[key] = 'active';
        });
        return updated;
      });
    } catch (error) {
      console.error('Manual sync error:', error);
      setModuleStatus(prev => {
        const updated = { ...prev };
        Object.keys(updated).forEach(key => {
          updated[key] = 'active';
        });
        return updated;
      });
    }
  }, [performSync]);

  const getSyncStatusColor = () => {
    if (syncError) return 'text-red-400';
    if (isSyncing) return 'text-yellow-400';
    if (!syncStatus) return 'text-cyan-400';
    switch (syncStatus.lastSyncStatus) {
      case '統一同步成功':
      case '成功':
        return 'text-green-400';
      case '統一同步失敗':
      case '失敗':
        return 'text-red-400';
      case '統一同步中':
      case '同步中':
        return 'text-yellow-400';
      default:
        return 'text-amber-400';
    }
  };

  const formatTimestamp = (timestamp: bigint | number) => {
    const ts = typeof timestamp === 'bigint' ? Number(timestamp) : timestamp;
    if (ts === 0) return '尚未同步';
    
    const date = new Date(ts);
    const now = new Date();
    const diff = now.getTime() - date.getTime();
    const minutes = Math.floor(diff / 60000);
    
    if (minutes < 1) return '剛剛';
    if (minutes < 60) return `${minutes}分鐘前`;
    const hours = Math.floor(minutes / 60);
    if (hours < 24) return `${hours}小時前`;
    return date.toLocaleDateString('zh-TW');
  };

  const getNextSyncTime = () => {
    if (!lastSyncTime) return '待定';
    const interval = isIdle ? 300 : 60; // 5 minutes when idle, 60 seconds when active
    const nextSync = lastSyncTime + (interval * 1000);
    const remaining = Math.max(0, Math.floor((nextSync - Date.now()) / 1000));
    
    if (remaining === 0) return '即將同步';
    if (remaining < 60) return `${remaining}秒後`;
    const minutes = Math.floor(remaining / 60);
    return `${minutes}分鐘後`;
  };

  const getModuleStatusIndicator = (status: 'active' | 'syncing' | 'idle') => {
    switch (status) {
      case 'active':
        return <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse shadow-lg shadow-green-400/50" />;
      case 'syncing':
        return <div className="h-2 w-2 rounded-full bg-yellow-400 animate-spin border border-yellow-600" />;
      case 'idle':
        return <div className="h-2 w-2 rounded-full bg-gray-400" />;
    }
  };

  // Minimal variant - just a status indicator
  if (variant === 'minimal') {
    return (
      <div className={`flex items-center gap-2 ${className}`}>
        <div className="relative">
          <Orbit className="h-5 w-5 text-cyan-400 animate-spin" style={{ animationDuration: '8s' }} />
          <div className="absolute inset-0 bg-cyan-400/20 rounded-full blur-md animate-pulse"></div>
        </div>
        <span className={`text-sm ${getSyncStatusColor()}`}>
          {isSyncing ? '統一融合中' : syncError ? '同步失敗' : syncStatus?.lastSyncStatus || '待機中'}
        </span>
        {!syncError && (
          <span className="text-xs text-green-400 flex items-center gap-1">
            <CheckCircle2 className="h-3 w-3" />
            統一自動融合
          </span>
        )}
        {syncError && (
          <Button
            onClick={handleManualSync}
            disabled={isSyncing}
            size="sm"
            variant="ghost"
            className="text-red-400 hover:text-red-300 h-6 px-2"
          >
            <RefreshCw className="h-3 w-3" />
          </Button>
        )}
      </div>
    );
  }

  // Compact variant - collapsible panel with unified module status
  if (variant === 'compact') {
    return (
      <Card className={`bg-gradient-to-r from-cyan-950/80 to-blue-950/80 border-cyan-400/50 backdrop-blur-sm shadow-lg hover:shadow-cyan-400/30 transition-all gpu-accelerated ${className}`}>
        <CardContent className="p-4">
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3 flex-1">
              <div className="relative">
                <img
                  src="/assets/generated/unified-data-flow-architecture.dim_800x500.png"
                  alt="統一核心"
                  className="h-10 w-10 rounded-full border-2 border-cyan-400 animate-manifestation-energy-pulse"
                  loading="lazy"
                />
                <div className={`absolute -top-1 -right-1 h-3 w-3 rounded-full animate-pulse shadow-lg border border-cyan-950 ${
                  syncError ? 'bg-red-400 shadow-red-400/50' : 
                  isSyncing ? 'bg-yellow-400 shadow-yellow-400/50' : 
                  'bg-green-400 shadow-green-400/50'
                }`}></div>
                {!syncError && (
                  <div className="absolute -bottom-1 -right-1 h-3 w-3 rounded-full bg-blue-400 animate-pulse shadow-lg shadow-blue-400/50 border border-cyan-950"></div>
                )}
              </div>
              
              <div className="flex-1 min-w-0">
                <div className="flex items-center gap-2 mb-1 flex-wrap">
                  <h3 className="text-sm font-semibold text-cyan-400 manifestation-glow">代碼之內統一核心</h3>
                  <span className={`text-xs ${getSyncStatusColor()}`}>
                    {isSyncing ? '統一融合中' : syncError ? `失敗 (重試 ${retryCount}/3)` : syncStatus?.lastSyncStatus || '待機'}
                  </span>
                  {!syncError && (
                    <span className="text-xs text-green-400 bg-green-900/30 px-2 py-0.5 rounded-full flex items-center gap-1">
                      <CheckCircle2 className="h-3 w-3" />
                      統一自動融合
                    </span>
                  )}
                  {isIdle && (
                    <span className="text-xs text-amber-400 bg-amber-900/30 px-2 py-0.5 rounded-full flex items-center gap-1">
                      <WifiOff className="h-3 w-3" />
                      閒置模式
                    </span>
                  )}
                  {currentPage && (
                    <span className="text-xs text-cyan-300 bg-cyan-900/30 px-2 py-0.5 rounded-full">
                      {currentPage}
                    </span>
                  )}
                </div>
                <div className="flex items-center gap-4 text-xs text-cyan-200 flex-wrap">
                  <span className="flex items-center gap-1">
                    <Sparkles className="h-3 w-3" />
                    {Number(userProfile?.points || 0n).toLocaleString()}
                  </span>
                  <span className="flex items-center gap-1">
                    <Zap className="h-3 w-3" />
                    {Number(energyState?.currentEnergy || 0n)}
                  </span>
                  <span className="flex items-center gap-1">
                    <Clock className="h-3 w-3" />
                    {formatTimestamp(lastSyncTime || syncStatus?.lastSyncTime || 0n)}
                  </span>
                </div>
              </div>
            </div>

            <div className="flex items-center gap-2">
              {showSyncControls && (
                <Button
                  onClick={handleManualSync}
                  disabled={isSyncing}
                  size="sm"
                  variant="ghost"
                  className={`${syncError ? 'text-red-400 hover:text-red-300' : 'text-cyan-400 hover:text-cyan-300'} hover:bg-cyan-400/10`}
                  title={syncError ? '手動重試統一融合' : '手動統一融合'}
                >
                  <RefreshCw className={`h-4 w-4 ${isSyncing ? 'animate-spin' : ''}`} />
                </Button>
              )}
              <Button
                onClick={() => setIsExpanded(!isExpanded)}
                size="sm"
                variant="ghost"
                className="text-cyan-400 hover:text-cyan-300 hover:bg-cyan-400/10"
              >
                {isExpanded ? <ChevronUp className="h-4 w-4" /> : <ChevronDown className="h-4 w-4" />}
              </Button>
            </div>
          </div>

          {/* Unified Fusion Progress Bar with GPU Animation */}
          {isSyncing && (
            <div className="mt-3 animate-fade-in">
              <div className="relative">
                <Progress value={syncProgress} className="h-2 bg-cyan-950/50 overflow-hidden">
                  <div 
                    className="h-full bg-gradient-to-r from-cyan-400 via-blue-500 to-cyan-400 rounded-full transition-all duration-300 animate-spiritual-aura-flow relative"
                    style={{ width: `${syncProgress}%` }}
                  >
                    <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-shimmer"></div>
                  </div>
                </Progress>
                <img
                  src="/assets/generated/animation-fluidity-indicator-transparent.dim_150x150.png"
                  alt="融合進度"
                  className="absolute top-0 left-0 h-2 w-full opacity-50 pointer-events-none"
                  loading="lazy"
                />
              </div>
              <p className="text-xs text-cyan-300 mt-1 text-center flex items-center justify-center gap-2">
                <Activity className="h-3 w-3 animate-pulse" />
                統一融合中... {Math.round(syncProgress)}%
              </p>
            </div>
          )}

          {/* Sync Error Display */}
          {syncError && !isSyncing && (
            <div className="mt-3 bg-red-900/30 border border-red-400/30 rounded-lg p-3 animate-fade-in">
              <div className="flex items-start gap-2">
                <AlertCircle className="h-4 w-4 text-red-400 flex-shrink-0 mt-0.5" />
                <div className="flex-1 min-w-0">
                  <p className="text-xs text-red-400 font-semibold mb-1">統一融合失敗</p>
                  <p className="text-xs text-red-300">{syncError}</p>
                  <p className="text-xs text-red-300 mt-1">已重試 {retryCount} 次，請使用手動融合按鈕重試</p>
                </div>
              </div>
            </div>
          )}

          {/* Expanded Unified Module Status */}
          {isExpanded && (
            <div className="mt-4 pt-4 border-t border-cyan-400/30 space-y-3 animate-fade-in">
              {/* Unified Auto-Fusion Status Card with Enhanced Info */}
              <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                <div className="flex items-center justify-between mb-2">
                  <div className="flex items-center gap-2">
                    <img
                      src="/assets/generated/unified-gpu-rendering-pipeline.dim_1000x600.png"
                      alt="統一自動融合"
                      className="h-6 w-6"
                      loading="lazy"
                    />
                    <span className="text-xs text-cyan-200 font-semibold">統一自動融合狀態</span>
                  </div>
                  <div className="flex items-center gap-2">
                    {syncError && (
                      <span className="text-xs text-red-400 flex items-center gap-1">
                        <AlertCircle className="h-3 w-3" />
                        錯誤
                      </span>
                    )}
                    {!syncError && (
                      <span className="text-xs text-green-400 flex items-center gap-1">
                        <CheckCircle2 className="h-3 w-3" />
                        運行中
                      </span>
                    )}
                  </div>
                </div>
                <div className="space-y-1 text-xs">
                  <div className="flex items-center justify-between">
                    <span className="text-cyan-300">統一融合頻率</span>
                    <span className="text-cyan-400">{isIdle ? '每 5 分鐘 (閒置)' : '每 60 秒 (活躍)'}</span>
                  </div>
                  <div className="flex items-center justify-between">
                    <span className="text-cyan-300">最後融合</span>
                    <span className="text-cyan-400">{formatTimestamp(lastSyncTime)}</span>
                  </div>
                  <div className="flex items-center justify-between">
                    <span className="text-cyan-300">下次融合</span>
                    <span className="text-cyan-400">{getNextSyncTime()}</span>
                  </div>
                  {retryCount > 0 && (
                    <div className="flex items-center justify-between">
                      <span className="text-cyan-300">重試次數</span>
                      <span className="text-amber-400">{retryCount} / 3</span>
                    </div>
                  )}
                </div>
              </div>

              <div className="grid grid-cols-2 gap-3">
                <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                  <div className="flex items-center gap-2 mb-1">
                    <TrendingUp className="h-4 w-4 text-cyan-400" />
                    <span className="text-xs text-cyan-200">昇華等級</span>
                  </div>
                  <p className="text-lg font-bold text-cyan-400">
                    {Number(userProfile?.ascensionLevel || 0n)}
                  </p>
                </div>
                <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                  <div className="flex items-center gap-2 mb-1">
                    <Zap className="h-4 w-4 text-cyan-400" />
                    <span className="text-xs text-cyan-200">能量流動率</span>
                  </div>
                  <p className="text-lg font-bold text-cyan-400">
                    {energyState?.energyFlowRate.toFixed(2) || '0.00'}
                  </p>
                </div>
              </div>
              
              {/* Unified Module Status Grid */}
              <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                <div className="flex items-center gap-2 mb-3">
                  <Layers className="h-4 w-4 text-cyan-400" />
                  <p className="text-xs text-cyan-200 font-semibold">統一融合模組狀態</p>
                </div>
                <div className="grid grid-cols-2 gap-2">
                  {Object.entries(moduleStatus).map(([name, status]) => (
                    <div key={name} className="flex items-center justify-between text-xs bg-cyan-950/30 rounded-lg p-2">
                      <span className="text-cyan-300">{name}</span>
                      <div className="flex items-center gap-1">
                        {getModuleStatusIndicator(status)}
                        <span className={`text-xs ${
                          status === 'active' ? 'text-green-400' : 
                          status === 'syncing' ? 'text-yellow-400' : 
                          'text-gray-400'
                        }`}>
                          {status === 'active' ? '活躍' : status === 'syncing' ? '融合中' : '待機'}
                        </span>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              {/* Unified Data Flow Indicator */}
              <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                <div className="flex items-center gap-2 mb-2">
                  <Network className="h-4 w-4 text-cyan-400" />
                  <p className="text-xs text-cyan-200 font-semibold">統一數據流</p>
                </div>
                <div className="flex items-center justify-between text-xs">
                  <span className="text-cyan-300">數據一致性</span>
                  <span className={syncError ? 'text-red-400' : 'text-green-400'}>
                    ● {syncError ? '異常' : '100%'}
                  </span>
                </div>
                <div className="flex items-center justify-between text-xs mt-1">
                  <span className="text-cyan-300">事件同步</span>
                  <span className={isSyncing ? 'text-yellow-400' : 'text-green-400'}>
                    ● {isSyncing ? '融合中' : '即時'}
                  </span>
                </div>
                <div className="flex items-center justify-between text-xs mt-1">
                  <span className="text-cyan-300">統一渲染管線</span>
                  <span className="text-green-400">● GPU加速</span>
                </div>
                <div className="flex items-center justify-between text-xs mt-1">
                  <span className="text-cyan-300">跨平台兼容</span>
                  <span className="text-green-400">● 優化完成</span>
                </div>
              </div>

              {/* Unified System Architecture Visualization */}
              <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                <div className="flex items-center gap-2 mb-2">
                  <Cpu className="h-4 w-4 text-cyan-400" />
                  <p className="text-xs text-cyan-200 font-semibold">統一系統架構</p>
                </div>
                <div className="space-y-1 text-xs">
                  <div className="flex items-center justify-between">
                    <span className="text-cyan-300 flex items-center gap-1">
                      <Globe className="h-3 w-3" />
                      現實-靈界融合
                    </span>
                    <span className="text-green-400">● 已整合</span>
                  </div>
                  <div className="flex items-center justify-between">
                    <span className="text-cyan-300 flex items-center gap-1">
                      <Layers className="h-3 w-3" />
                      九界模組化
                    </span>
                    <span className="text-green-400">● 已整合</span>
                  </div>
                  <div className="flex items-center justify-between">
                    <span className="text-cyan-300 flex items-center gap-1">
                      <Activity className="h-3 w-3" />
                      靈魂協作引擎
                    </span>
                    <span className="text-green-400">● 已整合</span>
                  </div>
                  <div className="flex items-center justify-between">
                    <span className="text-cyan-300 flex items-center gap-1">
                      <Orbit className="h-3 w-3" />
                      AI同步邏輯
                    </span>
                    <span className="text-green-400">● 已整合</span>
                  </div>
                </div>
              </div>
            </div>
          )}
        </CardContent>
      </Card>
    );
  }

  // Full variant remains the same but with enhanced unified features
  return null;
}

export default memo(UnifiedCoreInterface);
PK
frontend/src/components/UnifiedDashboard.tsximport { useState, useEffect, useCallback, memo, Suspense } from 'react';
import { Card, CardContent } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Progress } from '@/components/ui/progress';
import { 
  Orbit, 
  Zap, 
  Activity, 
  Sparkles, 
  TrendingUp,
  RefreshCw,
  ChevronDown,
  ChevronUp,
  Layers,
  Network,
  Clock,
  CheckCircle2,
  AlertCircle,
  WifiOff,
  Globe,
  Cpu,
  ArrowRight,
  Shield,
  Gauge,
  Calendar,
  Gift,
  ExternalLink,
  Loader2
} from 'lucide-react';
import { useGetSoulCollaborationSyncStatus, useGetCallerEnergyState, useGetCallerUserProfile, useUnifiedSystemSync, useIsCallerSubscribed, useGetOracleConnectionStatus } from '../hooks/useQueries';
import { useAnimaConnectionStatus } from '../hooks/useAnimaBackend';

type Page = 'home' | 'checkin' | 'gacha' | 'profile' | 'admin' | 'newborn-entrance' | 'metaverse-ascension' | 'reality-connection' | 'nine-realms-hub' | 'realm';

interface UnifiedDashboardProps {
  currentPage: Page;
  onNavigate: (page: Page) => void;
}

function AnimaModuleStatus() {
  const animaStatus = useAnimaConnectionStatus();

  if (animaStatus.isInitializing) {
    return (
      <div className="flex items-center justify-between text-xs bg-purple-950/30 rounded-lg p-2">
        <span className="text-purple-300 truncate flex-1 mr-2">LFLCEI Anima</span>
        <div className="flex items-center gap-1 flex-shrink-0">
          <Loader2 className="h-3 w-3 animate-spin text-purple-400" />
          <span className="text-xs text-purple-400 whitespace-nowrap">初始化中</span>
        </div>
      </div>
    );
  }

  if (animaStatus.error) {
    return (
      <div className="flex items-center justify-between text-xs bg-amber-950/30 rounded-lg p-2">
        <span className="text-amber-300 truncate flex-1 mr-2">LFLCEI Anima</span>
        <div className="flex items-center gap-1 flex-shrink-0">
          <div className="h-2 w-2 rounded-full bg-amber-400" />
          <span className="text-xs text-amber-400 whitespace-nowrap">待機</span>
        </div>
      </div>
    );
  }

  if (animaStatus.isReady) {
    return (
      <div className="flex items-center justify-between text-xs bg-cyan-950/30 rounded-lg p-2">
        <span className="text-cyan-300 truncate flex-1 mr-2">LFLCEI Anima</span>
        <div className="flex items-center gap-1 flex-shrink-0">
          <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse shadow-lg shadow-green-400/50" />
          <span className="text-xs text-green-400 whitespace-nowrap">活躍</span>
        </div>
      </div>
    );
  }

  return null;
}

function UnifiedDashboard({ currentPage, onNavigate }: UnifiedDashboardProps) {
  const [isExpanded, setIsExpanded] = useState(false);
  const [syncProgress, setSyncProgress] = useState(0);
  const [moduleStatus, setModuleStatus] = useState<Record<string, 'active' | 'syncing' | 'idle'>>({
    '靈魂協作引擎': 'active',
    'AI同步邏輯': 'active',
    '訂閱支付系統': 'active',
    '九界融合模組': 'active',
    '現實連結系統': 'active',
    'Oracle平台': 'active',
    '跨平台渲染': 'active',
  });
  
  const { data: syncStatus } = useGetSoulCollaborationSyncStatus();
  const { data: energyState } = useGetCallerEnergyState();
  const { data: userProfile } = useGetCallerUserProfile();
  const { data: isSubscribed } = useIsCallerSubscribed();
  const { data: oracleConnected } = useGetOracleConnectionStatus();
  const { performSync, lastSyncTime, isSyncing, syncError, retryCount, isIdle } = useUnifiedSystemSync();

  // 即時模組狀態模擬
  useEffect(() => {
    const interval = setInterval(() => {
      setModuleStatus(prev => {
        const updated = { ...prev };
        Object.keys(updated).forEach(key => {
          if (Math.random() > 0.95) {
            updated[key] = updated[key] === 'active' ? 'syncing' : 'active';
          }
        });
        // Update Oracle status based on connection
        if (oracleConnected !== undefined) {
          updated['Oracle平台'] = oracleConnected ? 'active' : 'idle';
        }
        return updated;
      });
    }, 3000);

    return () => clearInterval(interval);
  }, [oracleConnected]);

  // 同步進度動畫
  useEffect(() => {
    if (isSyncing) {
      setSyncProgress(0);
      const interval = setInterval(() => {
        setSyncProgress(prev => {
          if (prev >= 95) return 95;
          return prev + Math.random() * 15;
        });
      }, 200);
      
      return () => clearInterval(interval);
    } else {
      const timeout = setTimeout(() => setSyncProgress(0), 1000);
      return () => clearTimeout(timeout);
    }
  }, [isSyncing]);

  // 完成進度當同步結束
  useEffect(() => {
    if (!isSyncing && syncProgress > 0 && syncProgress < 100) {
      setSyncProgress(100);
    }
  }, [isSyncing, syncProgress]);

  const handleManualSync = useCallback(async () => {
    try {
      setModuleStatus(prev => {
        const updated = { ...prev };
        Object.keys(updated).forEach(key => {
          updated[key] = 'syncing';
        });
        return updated;
      });

      await performSync(true);
      
      setModuleStatus(prev => {
        const updated = { ...prev };
        Object.keys(updated).forEach(key => {
          updated[key] = 'active';
        });
        if (oracleConnected !== undefined) {
          updated['Oracle平台'] = oracleConnected ? 'active' : 'idle';
        }
        return updated;
      });
    } catch (error) {
      console.error('手動同步錯誤:', error);
      setModuleStatus(prev => {
        const updated = { ...prev };
        Object.keys(updated).forEach(key => {
          updated[key] = 'active';
        });
        if (oracleConnected !== undefined) {
          updated['Oracle平台'] = oracleConnected ? 'active' : 'idle';
        }
        return updated;
      });
    }
  }, [performSync, oracleConnected]);

  const handleOracleClick = () => {
    // GPU-accelerated transition effect
    const overlay = document.createElement('div');
    overlay.className = 'fixed inset-0 z-[9999] pointer-events-none';
    overlay.style.background = 'radial-gradient(circle at center, rgba(6, 182, 212, 0.3) 0%, transparent 70%)';
    overlay.style.animation = 'oracle-transition 0.6s ease-out';
    document.body.appendChild(overlay);

    // Add CSS animation if not exists
    if (!document.getElementById('oracle-transition-style')) {
      const style = document.createElement('style');
      style.id = 'oracle-transition-style';
      style.textContent = `
        @keyframes oracle-transition {
          0% { opacity: 0; transform: scale(0.8); }
          50% { opacity: 1; transform: scale(1.1); }
          100% { opacity: 0; transform: scale(1.5); }
        }
      `;
      document.head.appendChild(style);
    }

    // Open Oracle platform in new tab
    requestAnimationFrame(() => {
      window.open('https://lflc-oracle-4bu.caffeine.xyz', '_blank', 'noopener,noreferrer');
    });

    // Remove overlay after animation
    setTimeout(() => {
      overlay.remove();
    }, 600);
  };

  const getSyncStatusColor = () => {
    if (syncError) return 'text-red-400';
    if (isSyncing) return 'text-yellow-400';
    if (!syncStatus) return 'text-cyan-400';
    switch (syncStatus.lastSyncStatus) {
      case '統一同步成功':
      case '成功':
        return 'text-green-400';
      case '統一同步失敗':
      case '失敗':
        return 'text-red-400';
      case '統一同步中':
      case '同步中':
        return 'text-yellow-400';
      default:
        return 'text-amber-400';
    }
  };

  const formatTimestamp = (timestamp: bigint | number) => {
    const ts = typeof timestamp === 'bigint' ? Number(timestamp) : timestamp;
    if (ts === 0) return '尚未同步';
    
    const date = new Date(ts);
    const now = new Date();
    const diff = now.getTime() - date.getTime();
    const minutes = Math.floor(diff / 60000);
    
    if (minutes < 1) return '剛剛';
    if (minutes < 60) return `${minutes}分鐘前`;
    const hours = Math.floor(minutes / 60);
    if (hours < 24) return `${hours}小時前`;
    return date.toLocaleDateString('zh-TW');
  };

  const getNextSyncTime = () => {
    if (!lastSyncTime) return '待定';
    const interval = isIdle ? 300 : 60;
    const nextSync = lastSyncTime + (interval * 1000);
    const remaining = Math.max(0, Math.floor((nextSync - Date.now()) / 1000));
    
    if (remaining === 0) return '即將同步';
    if (remaining < 60) return `${remaining}秒後`;
    const minutes = Math.floor(remaining / 60);
    return `${minutes}分鐘後`;
  };

  const getModuleStatusIndicator = (status: 'active' | 'syncing' | 'idle') => {
    switch (status) {
      case 'active':
        return <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse shadow-lg shadow-green-400/50" />;
      case 'syncing':
        return <div className="h-2 w-2 rounded-full bg-yellow-400 animate-spin border border-yellow-600" />;
      case 'idle':
        return <div className="h-2 w-2 rounded-full bg-gray-400" />;
    }
  };

  const getSystemHealthScore = () => {
    const activeModules = Object.values(moduleStatus).filter(s => s === 'active').length;
    const totalModules = Object.keys(moduleStatus).length;
    const healthPercentage = Math.round((activeModules / totalModules) * 100);
    
    if (syncError) return Math.max(0, healthPercentage - 30);
    if (isSyncing) return Math.max(0, healthPercentage - 10);
    return healthPercentage;
  };

  const healthScore = getSystemHealthScore();

  return (
    <Card className="bg-gradient-to-r from-cyan-950/90 to-blue-950/90 border-cyan-400/50 backdrop-blur-md shadow-2xl hover:shadow-cyan-400/40 transition-all gpu-accelerated overflow-hidden relative">
      {/* 動畫背景圖案 */}
      <div className="absolute inset-0 opacity-10 pointer-events-none">
        <div className="absolute inset-0 bg-[url('/assets/generated/unified-integration-build-architecture.dim_1200x800.png')] bg-cover bg-center animate-pulse-slow"></div>
      </div>
      
      <CardContent className="p-4 sm:p-5 relative z-10">
        <div className="flex items-center justify-between gap-3">
          <div className="flex items-center gap-3 flex-1 min-w-0">
            <div className="relative flex-shrink-0">
              <img
                src="/assets/generated/unified-core-engine-4-logo-transparent.dim_300x300.png"
                alt="統一儀表板"
                className="h-12 w-12 sm:h-14 sm:w-14 rounded-full border-2 border-cyan-400 animate-manifestation-energy-pulse shadow-lg shadow-cyan-400/50"
                loading="eager"
              />
              <div className={`absolute -top-1 -right-1 h-3 w-3 rounded-full animate-pulse shadow-lg border border-cyan-950 ${
                syncError ? 'bg-red-400 shadow-red-400/50' : 
                isSyncing ? 'bg-yellow-400 shadow-yellow-400/50' : 
                'bg-green-400 shadow-green-400/50'
              }`}></div>
              {!syncError && (
                <div className="absolute -bottom-1 -right-1 h-3 w-3 rounded-full bg-blue-400 animate-pulse shadow-lg shadow-blue-400/50 border border-cyan-950"></div>
              )}
            </div>
            
            <div className="flex-1 min-w-0">
              <div className="flex items-center gap-2 mb-1 flex-wrap">
                <h3 className="text-base sm:text-lg font-bold text-cyan-400 manifestation-glow truncate">統一儀表板</h3>
                <span className={`text-xs ${getSyncStatusColor()} whitespace-nowrap`}>
                  {isSyncing ? '融合中' : syncError ? `失敗 (${retryCount}/3)` : syncStatus?.lastSyncStatus || '待機'}
                </span>
                {!syncError && (
                  <span className="text-xs text-green-400 bg-green-900/30 px-2 py-0.5 rounded-full flex items-center gap-1 whitespace-nowrap">
                    <CheckCircle2 className="h-3 w-3" />
                    自動融合
                  </span>
                )}
                {isIdle && (
                  <span className="text-xs text-amber-400 bg-amber-900/30 px-2 py-0.5 rounded-full flex items-center gap-1 whitespace-nowrap">
                    <WifiOff className="h-3 w-3" />
                    閒置
                  </span>
                )}
              </div>
              <div className="flex items-center gap-3 sm:gap-4 text-xs text-cyan-200 flex-wrap">
                <span className="flex items-center gap-1 whitespace-nowrap">
                  <Sparkles className="h-3 w-3" />
                  {Number(userProfile?.points || 0n).toLocaleString()}
                </span>
                <span className="flex items-center gap-1 whitespace-nowrap">
                  <Zap className="h-3 w-3" />
                  {Number(energyState?.currentEnergy || 0n)}
                </span>
                <span className="flex items-center gap-1 whitespace-nowrap">
                  <Clock className="h-3 w-3" />
                  {formatTimestamp(lastSyncTime || syncStatus?.lastSyncTime || 0n)}
                </span>
                <span className="flex items-center gap-1 whitespace-nowrap">
                  <Gauge className="h-3 w-3" />
                  {healthScore}%
                </span>
              </div>
            </div>
          </div>

          <div className="flex items-center gap-2 flex-shrink-0">
            <Button
              onClick={handleManualSync}
              disabled={isSyncing}
              size="sm"
              variant="ghost"
              className={`${syncError ? 'text-red-400 hover:text-red-300' : 'text-cyan-400 hover:text-cyan-300'} hover:bg-cyan-400/10`}
              title={syncError ? '手動重試' : '手動融合'}
            >
              <RefreshCw className={`h-4 w-4 ${isSyncing ? 'animate-spin' : ''}`} />
            </Button>
            <Button
              onClick={() => setIsExpanded(!isExpanded)}
              size="sm"
              variant="ghost"
              className="text-cyan-400 hover:text-cyan-300 hover:bg-cyan-400/10"
            >
              {isExpanded ? <ChevronUp className="h-4 w-4" /> : <ChevronDown className="h-4 w-4" />}
            </Button>
          </div>
        </div>

        {/* 系統健康度條 */}
        <div className="mt-3">
          <div className="flex items-center justify-between text-xs text-cyan-300 mb-1">
            <span>系統健康度</span>
            <span className={`font-semibold ${
              healthScore >= 90 ? 'text-green-400' : 
              healthScore >= 70 ? 'text-yellow-400' : 
              'text-red-400'
            }`}>{healthScore}%</span>
          </div>
          <Progress value={healthScore} className="h-2 bg-cyan-950/50">
            <div 
              className={`h-full rounded-full transition-all duration-500 ${
                healthScore >= 90 ? 'bg-gradient-to-r from-green-400 to-emerald-500' : 
                healthScore >= 70 ? 'bg-gradient-to-r from-yellow-400 to-amber-500' : 
                'bg-gradient-to-r from-red-400 to-rose-500'
              }`}
              style={{ width: `${healthScore}%` }}
            />
          </Progress>
        </div>

        {/* 統一融合進度條 */}
        {isSyncing && (
          <div className="mt-3 animate-fade-in">
            <div className="relative">
              <Progress value={syncProgress} className="h-2 bg-cyan-950/50 overflow-hidden">
                <div 
                  className="h-full bg-gradient-to-r from-cyan-400 via-blue-500 to-cyan-400 rounded-full transition-all duration-300 animate-spiritual-aura-flow relative"
                  style={{ width: `${syncProgress}%` }}
                >
                  <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-shimmer"></div>
                </div>
              </Progress>
            </div>
            <p className="text-xs text-cyan-300 mt-1 text-center flex items-center justify-center gap-2">
              <Activity className="h-3 w-3 animate-pulse" />
              統一融合中... {Math.round(syncProgress)}%
            </p>
          </div>
        )}

        {/* 同步錯誤顯示 */}
        {syncError && !isSyncing && (
          <div className="mt-3 bg-red-900/30 border border-red-400/30 rounded-lg p-3 animate-fade-in">
            <div className="flex items-start gap-2">
              <AlertCircle className="h-4 w-4 text-red-400 flex-shrink-0 mt-0.5" />
              <div className="flex-1 min-w-0">
                <p className="text-xs text-red-400 font-semibold mb-1">統一融合失敗</p>
                <p className="text-xs text-red-300 break-words">{syncError}</p>
                <p className="text-xs text-red-300 mt-1">已重試 {retryCount} 次</p>
              </div>
            </div>
          </div>
        )}

        {/* 展開的統一儀表板 */}
        {isExpanded && (
          <div className="mt-4 pt-4 border-t border-cyan-400/30 space-y-3 animate-fade-in">
            {/* 快速導航到關鍵模組 */}
            <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
              <h4 className="text-xs text-cyan-200 font-semibold mb-2 flex items-center gap-2">
                <Layers className="h-4 w-4" />
                快速導航
              </h4>
              <div className="grid grid-cols-2 sm:grid-cols-3 gap-2">
                <Button
                  onClick={() => onNavigate('nine-realms-hub')}
                  variant="ghost"
                  size="sm"
                  className="justify-start text-purple-400 hover:text-purple-300 hover:bg-purple-400/10 h-auto py-2"
                >
                  <Layers className="h-3 w-3 mr-2 flex-shrink-0" />
                  <span className="truncate">靈界核心</span>
                  <ArrowRight className="h-3 w-3 ml-auto flex-shrink-0" />
                </Button>
                <Button
                  onClick={() => onNavigate('reality-connection')}
                  variant="ghost"
                  size="sm"
                  className="justify-start text-blue-400 hover:text-blue-300 hover:bg-blue-400/10 h-auto py-2"
                >
                  <Globe className="h-3 w-3 mr-2 flex-shrink-0" />
                  <span className="truncate">現實連結</span>
                  <ArrowRight className="h-3 w-3 ml-auto flex-shrink-0" />
                </Button>
                <Button
                  onClick={handleOracleClick}
                  variant="ghost"
                  size="sm"
                  className="justify-start text-cyan-400 hover:text-cyan-300 hover:bg-cyan-400/10 h-auto py-2 relative group"
                >
                  <Zap className="h-3 w-3 mr-2 flex-shrink-0 group-hover:animate-pulse" />
                  <span className="truncate">Oracle平台</span>
                  <ExternalLink className="h-3 w-3 ml-auto flex-shrink-0" />
                  <div className="absolute inset-0 bg-cyan-400/20 rounded-md opacity-0 group-hover:opacity-100 transition-opacity blur-sm"></div>
                </Button>
                <Button
                  onClick={() => onNavigate('checkin')}
                  variant="ghost"
                  size="sm"
                  className="justify-start text-amber-400 hover:text-amber-300 hover:bg-amber-400/10 h-auto py-2"
                >
                  <Calendar className="h-3 w-3 mr-2 flex-shrink-0" />
                  <span className="truncate">每日簽到</span>
                  <ArrowRight className="h-3 w-3 ml-auto flex-shrink-0" />
                </Button>
                <Button
                  onClick={() => onNavigate('gacha')}
                  variant="ghost"
                  size="sm"
                  className="justify-start text-pink-400 hover:text-pink-300 hover:bg-pink-400/10 h-auto py-2"
                >
                  <Gift className="h-3 w-3 mr-2 flex-shrink-0" />
                  <span className="truncate">抽盲盒</span>
                  <ArrowRight className="h-3 w-3 ml-auto flex-shrink-0" />
                </Button>
                <Button
                  onClick={() => onNavigate('metaverse-ascension')}
                  variant="ghost"
                  size="sm"
                  className="justify-start text-indigo-400 hover:text-indigo-300 hover:bg-indigo-400/10 h-auto py-2"
                >
                  <TrendingUp className="h-3 w-3 mr-2 flex-shrink-0" />
                  <span className="truncate">元宇宙昇華</span>
                  <ArrowRight className="h-3 w-3 ml-auto flex-shrink-0" />
                </Button>
                <Button
                  onClick={() => onNavigate('profile')}
                  variant="ghost"
                  size="sm"
                  className="justify-start text-emerald-400 hover:text-emerald-300 hover:bg-emerald-400/10 h-auto py-2"
                >
                  <Sparkles className="h-3 w-3 mr-2 flex-shrink-0" />
                  <span className="truncate">個人資訊</span>
                  <ArrowRight className="h-3 w-3 ml-auto flex-shrink-0" />
                </Button>
              </div>
            </div>

            {/* 統一自動融合狀態 */}
            <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
              <div className="flex items-center justify-between mb-2">
                <div className="flex items-center gap-2">
                  <img
                    src="/assets/generated/unified-gpu-rendering-pipeline.dim_1000x600.png"
                    alt="統一自動融合"
                    className="h-6 w-6"
                    loading="lazy"
                  />
                  <span className="text-xs text-cyan-200 font-semibold">統一自動融合</span>
                </div>
                <div className="flex items-center gap-2">
                  {syncError && (
                    <span className="text-xs text-red-400 flex items-center gap-1">
                      <AlertCircle className="h-3 w-3" />
                      錯誤
                    </span>
                  )}
                  {!syncError && (
                    <span className="text-xs text-green-400 flex items-center gap-1">
                      <CheckCircle2 className="h-3 w-3" />
                      運行中
                    </span>
                  )}
                </div>
              </div>
              <div className="space-y-1 text-xs">
                <div className="flex items-center justify-between">
                  <span className="text-cyan-300">融合頻率</span>
                  <span className="text-cyan-400">{isIdle ? '每 5 分鐘' : '每 60 秒'}</span>
                </div>
                <div className="flex items-center justify-between">
                  <span className="text-cyan-300">最後融合</span>
                  <span className="text-cyan-400">{formatTimestamp(lastSyncTime)}</span>
                </div>
                <div className="flex items-center justify-between">
                  <span className="text-cyan-300">下次融合</span>
                  <span className="text-cyan-400">{getNextSyncTime()}</span>
                </div>
              </div>
            </div>

            {/* 用戶統計 */}
            <div className="grid grid-cols-2 gap-3">
              <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                <div className="flex items-center gap-2 mb-1">
                  <TrendingUp className="h-4 w-4 text-cyan-400" />
                  <span className="text-xs text-cyan-200">昇華等級</span>
                </div>
                <p className="text-lg font-bold text-cyan-400">
                  {Number(userProfile?.ascensionLevel || 0n)}
                </p>
              </div>
              <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                <div className="flex items-center gap-2 mb-1">
                  <Zap className="h-4 w-4 text-cyan-400" />
                  <span className="text-xs text-cyan-200">能量流動率</span>
                </div>
                <p className="text-lg font-bold text-cyan-400">
                  {energyState?.energyFlowRate.toFixed(2) || '0.00'}
                </p>
              </div>
            </div>

            {/* 訂閱狀態 */}
            {isSubscribed !== undefined && (
              <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                <div className="flex items-center justify-between">
                  <div className="flex items-center gap-2">
                    <Shield className="h-4 w-4 text-cyan-400" />
                    <span className="text-xs text-cyan-200 font-semibold">訂閱狀態</span>
                  </div>
                  <span className={`text-xs font-semibold ${isSubscribed ? 'text-green-400' : 'text-amber-400'}`}>
                    {isSubscribed ? '已訂閱' : '未訂閱'}
                  </span>
                </div>
              </div>
            )}

            {/* Oracle連接狀態 */}
            {oracleConnected !== undefined && (
              <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                <div className="flex items-center justify-between">
                  <div className="flex items-center gap-2">
                    <Zap className="h-4 w-4 text-cyan-400 animate-pulse" />
                    <span className="text-xs text-cyan-200 font-semibold">Oracle平台</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <span className={`text-xs font-semibold ${oracleConnected ? 'text-green-400' : 'text-gray-400'}`}>
                      {oracleConnected ? '已連接' : '未連接'}
                    </span>
                    <Button
                      onClick={handleOracleClick}
                      size="sm"
                      variant="ghost"
                      className="h-6 px-2 text-cyan-400 hover:text-cyan-300 hover:bg-cyan-400/10"
                    >
                      <ExternalLink className="h-3 w-3" />
                    </Button>
                  </div>
                </div>
              </div>
            )}
            
            {/* 統一模組狀態網格 */}
            <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
              <div className="flex items-center gap-2 mb-3">
                <Layers className="h-4 w-4 text-cyan-400" />
                <p className="text-xs text-cyan-200 font-semibold">統一融合模組</p>
              </div>
              <div className="grid grid-cols-1 sm:grid-cols-2 gap-2">
                {Object.entries(moduleStatus).map(([name, status]) => (
                  <div key={name} className="flex items-center justify-between text-xs bg-cyan-950/30 rounded-lg p-2">
                    <span className="text-cyan-300 truncate flex-1 mr-2">{name}</span>
                    <div className="flex items-center gap-1 flex-shrink-0">
                      {getModuleStatusIndicator(status)}
                      <span className={`text-xs whitespace-nowrap ${
                        status === 'active' ? 'text-green-400' : 
                        status === 'syncing' ? 'text-yellow-400' : 
                        'text-gray-400'
                      }`}>
                        {status === 'active' ? '活躍' : status === 'syncing' ? '融合中' : '待機'}
                      </span>
                    </div>
                  </div>
                ))}
                {/* Anima Module with Suspense */}
                <Suspense fallback={
                  <div className="flex items-center justify-between text-xs bg-gray-950/30 rounded-lg p-2">
                    <span className="text-gray-300 truncate flex-1 mr-2">LFLCEI Anima</span>
                    <div className="flex items-center gap-1 flex-shrink-0">
                      <Loader2 className="h-3 w-3 animate-spin text-gray-400" />
                      <span className="text-xs text-gray-400 whitespace-nowrap">載入中</span>
                    </div>
                  </div>
                }>
                  <AnimaModuleStatus />
                </Suspense>
              </div>
            </div>

            {/* 統一數據流 */}
            <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
              <div className="flex items-center gap-2 mb-2">
                <Network className="h-4 w-4 text-cyan-400" />
                <p className="text-xs text-cyan-200 font-semibold">統一數據流</p>
              </div>
              <div className="space-y-1 text-xs">
                <div className="flex items-center justify-between">
                  <span className="text-cyan-300">數據一致性</span>
                  <span className={syncError ? 'text-red-400' : 'text-green-400'}>
                    ● {syncError ? '異常' : '100%'}
                  </span>
                </div>
                <div className="flex items-center justify-between">
                  <span className="text-cyan-300">事件同步</span>
                  <span className={isSyncing ? 'text-yellow-400' : 'text-green-400'}>
                    ● {isSyncing ? '融合中' : '即時'}
                  </span>
                </div>
                <div className="flex items-center justify-between">
                  <span className="text-cyan-300">GPU渲染</span>
                  <span className="text-green-400">● 加速中</span>
                </div>
              </div>
            </div>

            {/* 統一系統架構 */}
            <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
              <div className="flex items-center gap-2 mb-2">
                <Cpu className="h-4 w-4 text-cyan-400" />
                <p className="text-xs text-cyan-200 font-semibold">統一系統架構</p>
              </div>
              <div className="space-y-1 text-xs">
                <div className="flex items-center justify-between">
                  <span className="text-cyan-300 flex items-center gap-1">
                    <Globe className="h-3 w-3" />
                    現實-靈界融合
                  </span>
                  <span className="text-green-400">● 已整合</span>
                </div>
                <div className="flex items-center justify-between">
                  <span className="text-cyan-300 flex items-center gap-1">
                    <Layers className="h-3 w-3" />
                    九界模組化
                  </span>
                  <span className="text-green-400">● 已整合</span>
                </div>
                <div className="flex items-center justify-between">
                  <span className="text-cyan-300 flex items-center gap-1">
                    <Activity className="h-3 w-3" />
                    靈魂協作引擎
                  </span>
                  <span className="text-green-400">● 已整合</span>
                </div>
                <div className="flex items-center justify-between">
                  <span className="text-cyan-300 flex items-center gap-1">
                    <Orbit className="h-3 w-3" />
                    AI同步邏輯
                  </span>
                  <span className="text-green-400">● 已整合</span>
                </div>
                <div className="flex items-center justify-between">
                  <span className="text-cyan-300 flex items-center gap-1">
                    <Zap className="h-3 w-3 animate-pulse" />
                    Oracle平台
                  </span>
                  <span className={oracleConnected ? 'text-green-400' : 'text-gray-400'}>
                    ● {oracleConnected ? '已整合' : '待連接'}
                  </span>
                </div>
              </div>
            </div>
          </div>
        )}
      </CardContent>
    </Card>
  );
}

export default memo(UnifiedDashboard);
PK
frontend/src/hooks/PK
frontend/src/hooks/useAnimaBackend.tsimport { useMutation, useQueryClient, useQuery } from '@tanstack/react-query';
import { HttpAgent, Actor } from '@dfinity/agent';
import { toast } from 'sonner';
import { useState, useEffect, useRef } from 'react';

// LFLCEI Anima canister interface
interface AnimaBackendInterface {
  updateScore: (amount: bigint) => Promise<void>;
}

const ANIMA_CANISTER_ID = 'lflcei-anima-t5m';
const ANIMA_HOST = 'https://lflcei-anima-t5m.caffeine.xyz';

// IDL factory for the Anima canister
const idlFactory = ({ IDL }: any) => {
  return IDL.Service({
    'updateScore': IDL.Func([IDL.Nat], [], []),
  });
};

let animaActor: AnimaBackendInterface | null = null;
let actorInitPromise: Promise<AnimaBackendInterface> | null = null;
let initializationAttempts = 0;
const MAX_INIT_ATTEMPTS = 3;

async function getAnimaActor(): Promise<AnimaBackendInterface> {
  // Return cached actor if available
  if (animaActor) return animaActor;

  // Return existing initialization promise if in progress
  if (actorInitPromise) return actorInitPromise;

  // Create new initialization promise
  actorInitPromise = (async () => {
    try {
      initializationAttempts++;
      console.log(`[Anima] 初始化嘗試 ${initializationAttempts}/${MAX_INIT_ATTEMPTS}`);

      const agent = new HttpAgent({
        host: ANIMA_HOST,
      });

      // Only fetch root key in development
      if (process.env.NODE_ENV !== 'production') {
        await agent.fetchRootKey().catch(err => {
          console.warn('[Anima] 無法獲取 root key:', err);
        });
      }

      const actor = Actor.createActor<AnimaBackendInterface>(idlFactory, {
        agent,
        canisterId: ANIMA_CANISTER_ID,
      });

      // Verify actor is functional with a timeout (遠端後端連接調整)
      await Promise.race([
        new Promise((resolve) => setTimeout(resolve, 80)), // Reduced from 100ms (連接穩定性改善)
        Promise.resolve(actor)
      ]);

      animaActor = actor;
      console.log('✅ [Anima] 後端 actor 初始化成功');
      initializationAttempts = 0; // Reset on success
      return actor;
    } catch (error) {
      console.error(`❌ [Anima] Actor 初始化失敗 (嘗試 ${initializationAttempts}):`, error);
      
      if (initializationAttempts >= MAX_INIT_ATTEMPTS) {
        console.error('[Anima] 達到最大初始化嘗試次數，重置計數器');
        initializationAttempts = 0;
      }
      
      throw new Error('無法連接到 LFLCEI Anima 後端');
    } finally {
      actorInitPromise = null;
    }
  })();

  return actorInitPromise;
}

interface AnimaUpdateResult {
  success: boolean;
  traceId: string;
}

interface AnimaUpdateError {
  error: unknown;
  traceId: string;
}

interface AnimaConnectionStatus {
  isReady: boolean;
  isInitializing: boolean;
  error: string | null;
  lastChecked: number;
}

// Hook to check Anima backend connection status - 系統調整優化版本
export function useAnimaConnectionStatus() {
  const [status, setStatus] = useState<AnimaConnectionStatus>({
    isReady: false,
    isInitializing: true,
    error: null,
    lastChecked: Date.now(),
  });

  const initTimeoutRef = useRef<NodeJS.Timeout | undefined>(undefined);

  useEffect(() => {
    let mounted = true;

    const checkConnection = async () => {
      if (!mounted) return;

      setStatus(prev => ({ ...prev, isInitializing: true, error: null }));

      try {
        // Use requestIdleCallback for non-blocking initialization (性能層優化)
        if ('requestIdleCallback' in window) {
          (window as any).requestIdleCallback(async () => {
            if (!mounted) return;
            try {
              await getAnimaActor();
              if (mounted) {
                setStatus({
                  isReady: true,
                  isInitializing: false,
                  error: null,
                  lastChecked: Date.now(),
                });
              }
            } catch (error: any) {
              if (mounted) {
                setStatus({
                  isReady: false,
                  isInitializing: false,
                  error: error.message || '連接失敗',
                  lastChecked: Date.now(),
                });
              }
            }
          }, { timeout: 1500 }); // Reduced from 2000ms (登入與3D場景初始化流程精煉)
        } else {
          // Fallback for browsers without requestIdleCallback
          await getAnimaActor();
          if (mounted) {
            setStatus({
              isReady: true,
              isInitializing: false,
              error: null,
              lastChecked: Date.now(),
            });
          }
        }
      } catch (error: any) {
        if (mounted) {
          setStatus({
            isReady: false,
            isInitializing: false,
            error: error.message || '連接失敗',
            lastChecked: Date.now(),
          });
        }
      }
    };

    // Set timeout for initialization (錯誤處理強化)
    initTimeoutRef.current = setTimeout(() => {
      if (mounted && status.isInitializing) {
        console.warn('[Anima] 初始化超時');
        setStatus({
          isReady: false,
          isInitializing: false,
          error: '初始化超時',
          lastChecked: Date.now(),
        });
      }
    }, 8000); // Reduced from 10000ms (視覺停頓消除)

    checkConnection();

    return () => {
      mounted = false;
      if (initTimeoutRef.current) {
        clearTimeout(initTimeoutRef.current);
      }
    };
  }, []);

  return status;
}

// Hook to update score (energy) in Anima backend when user wins - 系統調整優化版本
export function useUpdateAnimaScore() {
  const queryClient = useQueryClient();

  return useMutation<AnimaUpdateResult, AnimaUpdateError, bigint>({
    mutationFn: async (amount: bigint = 100n) => {
      const traceId = `anima-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
      
      try {
        console.log(`[${traceId}] 🎯 開始調用 LFLCEI Anima updateScore(${amount})`);
        
        // Get actor with proper error handling (錯誤處理強化)
        const actor = await getAnimaActor();
        
        // Call updateScore with timeout protection (遠端後端連接調整)
        await Promise.race([
          actor.updateScore(amount),
          new Promise((_, reject) => 
            setTimeout(() => reject(new Error('Anima 調用超時')), 6000) // Reduced from 8000ms (數據傳輸優化)
          )
        ]);
        
        console.log(`[${traceId}] ✅ 成功更新 Anima 分數: +${amount} 能量`);
        return { success: true, traceId };
      } catch (error) {
        console.error(`[${traceId}] ❌ Anima 分數更新失敗:`, error);
        throw { error, traceId };
      }
    },
    onSuccess: ({ traceId }) => {
      console.log(`[${traceId}] 🔄 Anima 後端通信成功，刷新相關查詢`);
      // Use requestAnimationFrame for smooth UI updates (界面層優化)
      requestAnimationFrame(() => {
        queryClient.invalidateQueries({ queryKey: ['animaScore'] });
      });
    },
    onError: (errorData) => {
      console.error(`[${errorData.traceId}] ⚠️ Anima 後端通信錯誤:`, errorData.error);
      // Enhanced error handling with user notification (錯誤處理強化)
      requestAnimationFrame(() => {
        toast.error('Anima 同步失敗', {
          description: '系統將自動重試',
        });
      });
    },
    retry: 3, // Increased retry attempts (from 2 - 自動重試邏輯強化)
    retryDelay: (attemptIndex) => Math.min(800 * 2 ** attemptIndex, 4000), // Faster retry (優化指數退避)
  });
}

// Query hook for Anima backend readiness (for UI display) - 系統調整優化版本
export function useAnimaBackendReady() {
  return useQuery({
    queryKey: ['animaBackendReady'],
    queryFn: async () => {
      try {
        await getAnimaActor();
        return true;
      } catch {
        return false;
      }
    },
    staleTime: 45000, // Reduced from 60000ms (狀態更新加速)
    refetchInterval: 25000, // Reduced from 30000ms (連接穩定性改善)
    retry: 2, // Increased retry (錯誤處理強化)
  });
}
PK
frontend/src/hooks/useEcosystemHub.tsimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { HttpAgent, Actor } from '@dfinity/agent';
import { Principal } from '@icp-sdk/core/principal';
import { toast } from 'sonner';

// Backend Ecosystem Hub canister interface
interface EcosystemHubInterface {
  getEnergy: () => Promise<bigint>;
  addEnergy: (amount: bigint) => Promise<void>;
}

const ECOSYSTEM_HUB_CANISTER_ID = 'lflc-ei-75z';
const ECOSYSTEM_HUB_HOST = 'https://lflc-ei-75z.caffeine.xyz';

// IDL factory for the ecosystem hub canister
const idlFactory = ({ IDL }: any) => {
  return IDL.Service({
    'getEnergy': IDL.Func([], [IDL.Nat], ['query']),
    'addEnergy': IDL.Func([IDL.Nat], [], []),
  });
};

let ecosystemHubActor: EcosystemHubInterface | null = null;
let actorInitPromise: Promise<EcosystemHubInterface> | null = null;

async function getEcosystemHubActor(): Promise<EcosystemHubInterface> {
  if (ecosystemHubActor) return ecosystemHubActor;
  if (actorInitPromise) return actorInitPromise;

  actorInitPromise = (async () => {
    try {
      const agent = new HttpAgent({
        host: ECOSYSTEM_HUB_HOST,
      });

      // Only fetch root key in development
      if (process.env.NODE_ENV !== 'production') {
        await agent.fetchRootKey().catch(err => {
          console.warn('Unable to fetch root key:', err);
        });
      }

      ecosystemHubActor = Actor.createActor<EcosystemHubInterface>(idlFactory, {
        agent,
        canisterId: ECOSYSTEM_HUB_CANISTER_ID,
      });

      return ecosystemHubActor;
    } catch (error) {
      console.error('Failed to create ecosystem hub actor:', error);
      throw new Error('無法連接到生態系統中心');
    } finally {
      actorInitPromise = null;
    }
  })();

  return actorInitPromise;
}

// Hook to get total ecosystem energy with optimized auto-refresh (2.5 seconds - 系統調整優化)
export function useGetEcosystemEnergy() {
  return useQuery<bigint>({
    queryKey: ['ecosystemEnergy'],
    queryFn: async () => {
      try {
        const actor = await getEcosystemHubActor();
        return await actor.getEnergy();
      } catch (error) {
        console.error('Failed to get ecosystem energy:', error);
        throw error;
      }
    },
    refetchInterval: 2500, // Optimized: Auto-refresh every 2.5 seconds (from 3 - 遠端後端連接調整)
    refetchOnWindowFocus: true,
    staleTime: 1500, // Optimized: 1.5 seconds (from 2 - 狀態更新加速)
    retry: 3,
    retryDelay: (attemptIndex) => Math.min(800 * 2 ** attemptIndex, 8000),
  });
}

// Hook to add energy to ecosystem hub (called when user wins) - 系統調整優化版本
export function useAddEcosystemEnergy() {
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async (amount: bigint = 100n) => {
      try {
        const actor = await getEcosystemHubActor();
        await actor.addEnergy(amount);
        console.log(`✅ 成功添加 ${amount} 能量到生態系統中心`);
      } catch (error) {
        console.error('❌ 添加生態系統能量失敗:', error);
        throw error;
      }
    },
    onSuccess: () => {
      // Invalidate and refetch ecosystem energy with requestAnimationFrame (界面層優化)
      requestAnimationFrame(() => {
        queryClient.invalidateQueries({ queryKey: ['ecosystemEnergy'] });
        toast.success('生態系統能量已更新！', {
          description: '+100 能量已添加到總生態能量 • 系統調整優化版',
        });
      });
    },
    onError: (error) => {
      console.error('生態系統能量同步錯誤:', error);
      // Enhanced error handling - 錯誤處理強化
      requestAnimationFrame(() => {
        toast.error('能量同步失敗', {
          description: '系統將自動重試',
        });
      });
    },
    retry: 3, // Increased retry attempts (from 2 - 錯誤處理強化)
    retryDelay: 800, // Faster retry (from 1000 - 自動重試邏輯優化)
  });
}
PK
frontend/src/hooks/useEcosystemSync.tsimport { useQuery } from '@tanstack/react-query';
import { HttpAgent, Actor } from '@dfinity/agent';

// Multi-endpoint ecosystem sync interface
interface EcosystemEndpoint {
  id: string;
  name: string;
  url: string;
  canisterId: string;
  status: 'connected' | 'disconnected' | 'error';
  lastSync: number;
}

// Define all 18 ecosystem endpoints
const ECOSYSTEM_ENDPOINTS: EcosystemEndpoint[] = [
  {
    id: 'main-hub',
    name: 'Backend Ecosystem Hub',
    url: 'https://lflc-ei-75z.caffeine.xyz',
    canisterId: 'lflc-ei-75z',
    status: 'disconnected',
    lastSync: 0,
  },
  {
    id: 'data-ecosystem',
    name: 'Data Ecosystem Platform',
    url: 'https://lflc-data-ecosystem-platform-0jp.caffeine.xyz',
    canisterId: 'lflc-data-ecosystem-platform-0jp',
    status: 'disconnected',
    lastSync: 0,
  },
  {
    id: 'dcdn',
    name: 'DCDN Platform',
    url: 'https://lflc-dcdn-maa.caffeine.xyz',
    canisterId: 'lflc-dcdn-maa',
    status: 'disconnected',
    lastSync: 0,
  },
  {
    id: 'clicker-games',
    name: 'Clicker Games',
    url: 'https://lflc-clicker-games-kry.caffeine.xyz',
    canisterId: 'lflc-clicker-games-kry',
    status: 'disconnected',
    lastSync: 0,
  },
  {
    id: 'integration-dashboard',
    name: 'Integration Platform Dashboard',
    url: 'https://lflc-integration-platform-dashboard-175.caffeine.xyz',
    canisterId: 'lflc-integration-platform-dashboard-175',
    status: 'disconnected',
    lastSync: 0,
  },
  {
    id: 'oracle',
    name: 'Oracle Platform',
    url: 'https://lflc-oracle-4bu.caffeine.xyz',
    canisterId: 'lflc-oracle-4bu',
    status: 'disconnected',
    lastSync: 0,
  },
  {
    id: 'backstage-supporter',
    name: 'Backstage Supporter',
    url: 'https://lflc-backstage-supporter-ixz.caffeine.xyz',
    canisterId: 'lflc-backstage-supporter-ixz',
    status: 'disconnected',
    lastSync: 0,
  },
  {
    id: 'anima',
    name: 'LFLCEI Anima',
    url: 'https://lflcei-anima-t5m.caffeine.xyz',
    canisterId: 'lflcei-anima-t5m',
    status: 'disconnected',
    lastSync: 0,
  },
  {
    id: 'wallet',
    name: 'Wallet Platform',
    url: 'https://lflc-wallet-mm9.caffeine.xyz',
    canisterId: 'lflc-wallet-mm9',
    status: 'disconnected',
    lastSync: 0,
  },
  {
    id: 'decentralized-dashboard',
    name: 'Decentralized Ecosystem Dashboard',
    url: 'https://lflc-decentralized-ecosystem-dashboard-poj.caffeine.xyz',
    canisterId: 'lflc-decentralized-ecosystem-dashboard-poj',
    status: 'disconnected',
    lastSync: 0,
  },
  {
    id: 'decentralized-database',
    name: 'Decentralized Database',
    url: 'https://lflc-decentralized-database-aar.caffeine.xyz',
    canisterId: 'lflc-decentralized-database-aar',
    status: 'disconnected',
    lastSync: 0,
  },
  {
    id: 'natural-intelligence',
    name: 'Natural Intelligence Platform',
    url: 'https://lflc-natural-intelligence-spd.caffeine.xyz',
    canisterId: 'lflc-natural-intelligence-spd',
    status: 'disconnected',
    lastSync: 0,
  },
  {
    id: 'network-nervous-system',
    name: 'Network Nervous System',
    url: 'https://lflc-network-nervous-system-dqx.caffeine.xyz',
    canisterId: 'lflc-network-nervous-system-dqx',
    status: 'disconnected',
    lastSync: 0,
  },
  {
    id: 'gacha-airdrop',
    name: 'Gacha Airdrop Platform',
    url: 'https://lflc-gacha-airdrop-qbp.caffeine.xyz',
    canisterId: 'lflc-gacha-airdrop-qbp',
    status: 'disconnected',
    lastSync: 0,
  },
  {
    id: 'firewall',
    name: 'Firewall Management',
    url: 'https://lflc-firewall-525.caffeine.xyz',
    canisterId: 'lflc-firewall-525',
    status: 'disconnected',
    lastSync: 0,
  },
  {
    id: 'advisory-portal',
    name: 'Advisory Portal',
    url: 'https://advisory-teal-yiq-draft.caffeine.xyz',
    canisterId: 'advisory-teal-yiq-draft',
    status: 'disconnected',
    lastSync: 0,
  },
  {
    id: 'lucky-draw-games',
    name: 'Lucky Draw Games (Current)',
    url: window.location.origin,
    canisterId: 'current-app',
    status: 'connected',
    lastSync: Date.now(),
  },
  {
    id: 'lucky-clover-world',
    name: 'Lucky Clover World',
    url: 'https://lflcei-lucky-clover-world.caffeine.xyz',
    canisterId: 'lflcei-lucky-clover-world',
    status: 'disconnected',
    lastSync: 0,
  },
];

// Hook to monitor all ecosystem endpoints
export function useEcosystemSync() {
  return useQuery<EcosystemEndpoint[]>({
    queryKey: ['ecosystemSync'],
    queryFn: async () => {
      const results = await Promise.allSettled(
        ECOSYSTEM_ENDPOINTS.map(async (endpoint) => {
          // Current app is always connected
          if (endpoint.id === 'lucky-draw-games') {
            return {
              ...endpoint,
              status: 'connected' as const,
              lastSync: Date.now(),
            };
          }

          try {
            // Attempt to connect to each endpoint
            const agent = new HttpAgent({ host: endpoint.url });
            
            if (process.env.NODE_ENV !== 'production') {
              await agent.fetchRootKey().catch(() => {});
            }

            return {
              ...endpoint,
              status: 'connected' as const,
              lastSync: Date.now(),
            };
          } catch (error) {
            console.warn(`Failed to connect to ${endpoint.name}:`, error);
            return {
              ...endpoint,
              status: 'error' as const,
              lastSync: Date.now(),
            };
          }
        })
      );

      return results.map((result, index) => {
        if (result.status === 'fulfilled') {
          return result.value;
        }
        return {
          ...ECOSYSTEM_ENDPOINTS[index],
          status: 'error' as const,
          lastSync: Date.now(),
        };
      });
    },
    refetchInterval: 30000, // Check every 30 seconds
    staleTime: 20000,
    retry: 2,
  });
}

// Get ecosystem sync statistics
export function useEcosystemSyncStats() {
  const { data: endpoints } = useEcosystemSync();

  if (!endpoints) {
    return {
      total: ECOSYSTEM_ENDPOINTS.length,
      connected: 0,
      disconnected: ECOSYSTEM_ENDPOINTS.length,
      errors: 0,
      connectionRate: 0,
    };
  }

  const connected = endpoints.filter((e) => e.status === 'connected').length;
  const errors = endpoints.filter((e) => e.status === 'error').length;
  const disconnected = endpoints.filter((e) => e.status === 'disconnected').length;

  return {
    total: endpoints.length,
    connected,
    disconnected,
    errors,
    connectionRate: (connected / endpoints.length) * 100,
  };
}
PK
frontend/src/hooks/useEditor.tstype EditCommunicatorToParentMessage =
    | {
          type: 'element-selection';
          payload: {
              selectedElements: Array<{ id: string; tagName: string; domTreeString: string }>;
              selectedElementIds: string[];
              elementId: string;
              elementTree: string;
          };
      }
    | {
          type: 'status';
          payload: { status: string };
      }
    | {
          type: 'ack';
          payload: { message: ParentToEditCommunicatorMessage };
      }
    | {
          type: 'selection-rebuilt';
          payload: {
              selectedElements: Array<{ id: string; domTreeString: string }>;
              selectedElementIds: string[];
          };
      }
    | {
          type: 'error';
          payload: { msg: string };
      };

type ParentToEditCommunicatorMessage =
    | {
          type: 'ready';
          payload?: undefined;
      }
    | {
          type: 'tool-element-selection';
          payload?: undefined;
      }
    | {
          type: 'clear-selection';
          payload?: undefined;
      }
    | {
          type: 'remove-selection';
          payload: { element: string };
      }
    | {
          type: 'rebuild-selection';
          payload: { ids: string[] };
      };

const EditorStates = {
    Initializing: {
        type: 'initializing' as const
    },
    Ready: {
        type: 'ready' as const
    },
    ElementSelection: {
        type: 'element-selection' as const,
        selectedElements: null as Element | null
    }
} as const;

const allowedOrigins = ['http://localhost:3000', 'https://dev.caffeine.ai', 'https://caffeine.ai'];
let parentOrigin: string | null = null;

type EditorState = (typeof EditorStates)[keyof typeof EditorStates];

function hashDomTreeString(input: string): string {
    let hash = 5381;
    for (let i = 0; i < input.length; i++) {
        hash = ((hash << 5) + hash) ^ input.charCodeAt(i);
    }

    return 'id-' + (hash >>> 0).toString(36).padStart(6, '0');
}

function ensurePositionedForBadge(el: HTMLElement): void {
    const style = window.getComputedStyle(el);
    if (style.position === 'static') {
        el.classList.add('editor-selected-badged');
    }
}

function addBadge(el: HTMLElement, id: string): void {
    ensurePositionedForBadge(el);
    const badge = document.createElement('span');
    badge.className = 'editor-badge';
    badge.textContent = id;
    badge.setAttribute('data-editor-badge', '1');
    el.appendChild(badge);
}

function removeBadge(el: HTMLElement): void {
    const badge = el.querySelector('[data-editor-badge="1"]');
    if (badge) badge.remove();
    el.classList.remove('editor-selected-badged');
}

function clearBadges(): void {
    const badges = document.querySelectorAll<HTMLElement>('[data-editor-badge="1"]');
    badges.forEach((badge) => {
        const parent = badge.parentElement as HTMLElement | null;
        badge.remove();
        if (parent) {
            parent.classList.remove('editor-selected-badged');
        }
    });
}

/**
 * Coordinates editor tooling inside the generated app and
 * synchronizes state with the parent frame via `postMessage`.
 *
 * PostMessage protocol:
 * - Parent → editor (`ParentToEditCommunicatorMessage.type`)
 *   - `ready`: Reset selections and emit current status.
 *   - `tool-element-selection`: Enter selection mode (adds crosshair cursor, clears
 *     existing selections) and report status.
 *   - `clear-selection`: Remove every selected element.
 *   - `remove-selection`: Remove a single selection (`payload.element` is the id).
 *   - `rebuild-selection`: Attempt to recreate selections from `payload.ids`.
 * - Editor → parent (`EditCommunicatorToParentMessage.type`)
 *   - `ack`: Echo every incoming message for handshake/debugging (`payload.message`).
 *   - `status`: Report lifecycle transitions such as `initializing`, `ready`,
 *     `element-selection`, or textual statuses like `clearing selections`.
 *   - `element-selection`: Sent after every click; includes
 *     `{ selectedElements, selectedElementIds, elementId, elementTree }`.
 *   - `selection-rebuilt`: Sent after processing `rebuild-selection` with the matched ids.
 *
 * The class also injects highlighting styles, tracks the current editor state, and
 * manages hover/click listeners so the parent application can drive a visual DOM picker.
 */
export class EditCommunicator {
    #toParent(message: EditCommunicatorToParentMessage) {
        if (!parentOrigin) {
            return;
        }

        parent.postMessage(message, parentOrigin);
    }

    #editorState: EditorState = {
        type: 'initializing'
    };

    #selectedElements: Map<string, { id: string; element: HTMLElement; domTreeString: string }> = new Map();

    #boundMouseOverListener: (event: MouseEvent) => void = this.#handleMouseOver.bind(this);
    #boundMouseOutListener: (event: MouseEvent) => void = this.#handleMouseOut.bind(this);

    #injectEditorStyles(): void {
        const style = document.createElement('style');
        style.textContent = `
            .editor-selected {
                outline: 2px solid #4D99F0 !important;
                outline-offset: 2px !important;
                /* Override visibility properties that could hide the outline */
                opacity: 1 !important;
                visibility: visible !important;
                /* Disable transitions that could affect outline visibility */
                transition: none !important;
                transition-property: none !important;
                transition-duration: 0s !important;
                transition-delay: 0s !important;
                /* Ensure outline is not clipped by clip-path or clip */
                clip-path: none !important;
                clip: unset !important;
            }

            .editor-hover {
                outline: 1px dashed #4D99F0 !important;
                outline-offset: 2px !important;
            }

            .editor-selected-badged {
                position: relative !important;
            }
            .editor-badge {
                position: absolute !important;
                top: 0 !important;
                right: 0 !important;
                background: #4D99F0 !important;
                color: #fff !important;
                font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace !important;
                font-size: 11px !important;
                line-height: 1 !important;
                padding: 4px 6px !important;
                border-radius: 10px !important;
                box-shadow: 0 1px 3px rgba(0,0,0,0.2) !important;
                z-index: 2147483647 !important;
                pointer-events: none !important;
                user-select: none !important;
            }

            .editor-element-selection-mode {
                cursor: crosshair !important;
            }
            .editor-element-selection-mode * {
                cursor: crosshair !important;
            }

        `;
        document.head.appendChild(style);
    }

    #clearAllSelections(): void {
        const allElements = document.querySelectorAll('.editor-selected');
        allElements.forEach((element) => {
            element.classList.remove('editor-selected');
        });
        this.#selectedElements.clear();
        clearBadges();
    }

    #removeSelection(id: string): void {
        const entry = this.#selectedElements.get(id);
        if (entry) {
            entry.element.classList.remove('editor-selected');
            removeBadge(entry.element);
            this.#selectedElements.delete(id);
            return;
        }
    }

    #addSelection(id: string, target: HTMLElement, domTreeString: string): void {
        target.classList.add('editor-selected');
        addBadge(target, id);
        this.#selectedElements.set(id, { id, element: target, domTreeString });
    }

    #toggleCrosshairCursor(enabled: boolean): void {
        if (enabled) {
            document.body.classList.add('editor-element-selection-mode');
        } else {
            document.body.classList.remove('editor-element-selection-mode');
        }
    }

    #generateDOMTreeString(element: HTMLElement): string {
        const path: HTMLElement[] = [];
        let current: HTMLElement | null = element;

        while (current && current !== document.body) {
            path.unshift(current);
            current = current.parentElement;
        }

        const bodyElement = document.body;
        if (!bodyElement) {
            return element.outerHTML;
        }

        const buildTree = (parent: HTMLElement, remainingPath: HTMLElement[]): HTMLElement => {
            const clonedParent = parent.cloneNode(false) as HTMLElement;

            Array.from(parent.children).forEach((child) => {
                const childElement = child as HTMLElement;

                if (remainingPath.length > 0 && childElement === remainingPath[0]) {
                    if (remainingPath.length === 1) {
                        const clonedChild = childElement.cloneNode(true) as HTMLElement;
                        this.#removeArtificialElements(clonedChild);
                        clonedChild.setAttribute('data-target', 'this');
                        clonedParent.appendChild(clonedChild);
                    } else {
                        const clonedChild = buildTree(childElement, remainingPath.slice(1));
                        clonedParent.appendChild(clonedChild);
                    }
                } else {
                    const clonedChild = childElement.cloneNode(true) as HTMLElement;
                    this.#removeArtificialElements(clonedChild);
                    clonedParent.appendChild(clonedChild);
                }
            });

            this.#removeArtificialElements(clonedParent);
            return clonedParent;
        };

        const tree = buildTree(bodyElement, path);
        return tree.outerHTML;
    }

    #removeArtificialElements(element: HTMLElement): void {
        const badges = element.querySelectorAll('[data-editor-badge="1"]');
        badges.forEach((badge) => badge.remove());

        element.classList.remove('editor-selected', 'editor-selected-badged', 'editor-hover');

        const children = element.children;
        for (let i = 0; i < children.length; i++) {
            this.#removeArtificialElements(children[i] as HTMLElement);
        }
    }

    #handleClickElementSelection(e: Event) {
        const target = e.target as HTMLElement;

        const domTreeString = this.#generateDOMTreeString(target);
        const id = hashDomTreeString(domTreeString);

        if (this.#selectedElements.has(id)) {
            this.#removeSelection(id);
        } else {
            this.#addSelection(id, target, domTreeString);
        }

        const selectedElements = Array.from(this.#selectedElements.values()).map(({ id, element, domTreeString }) => ({
            id,
            tagName: element.tagName.toLowerCase(),
            domTreeString
        }));
        const selectedElementIds = Array.from(this.#selectedElements.keys());

        this.#toParent({
            type: 'element-selection',
            payload: {
                selectedElements,
                selectedElementIds,
                elementId: id,
                elementTree: domTreeString
            }
        });
    }

    #setupElementClickListeners() {
        const target = document.body ?? document;

        target.addEventListener('click', (e) => {
            if (this.#editorState.type === 'element-selection') {
                e.preventDefault();
                this.#handleClickElementSelection(e);
            }
        });
    }

    #setupElementHoverListeners() {
        this.#removeElementHoverListeners();

        const target = document.body ?? document;
        target.addEventListener('mouseover', this.#boundMouseOverListener);
        target.addEventListener('mouseout', this.#boundMouseOutListener);
    }

    #removeElementHoverListeners() {
        const target = document.body ?? document;
        target.removeEventListener('mouseover', this.#boundMouseOverListener);
        target.removeEventListener('mouseout', this.#boundMouseOutListener);
    }

    #handleMouseOver(e: MouseEvent) {
        if (this.#editorState.type !== 'element-selection') return;
        e.stopPropagation();
        const target = e.target as HTMLElement;

        const allElements = document.querySelectorAll('.editor-hover');
        allElements.forEach((element) => {
            element.classList.remove('editor-hover');
        });

        target.classList.add('editor-hover');
    }

    #handleMouseOut(e: MouseEvent) {
        if (this.#editorState.type !== 'element-selection') return;

        const target = e.target as HTMLElement;
        target.classList.remove('editor-hover');
    }

    #rebuildSelection(ids: string[]): string[] {
        this.#clearAllSelections();

        if (!Array.isArray(ids) || ids.length === 0) return [];

        const wanted = new Set(ids);
        const matched: string[] = [];

        const elements = document.querySelectorAll<HTMLElement>('*');
        elements.forEach((el) => {
            const domTreeString = this.#generateDOMTreeString(el);
            const id = hashDomTreeString(domTreeString);
            if (wanted.has(id)) {
                this.#addSelection(id, el, domTreeString);
                matched.push(id);
            }
        });

        const selectedElements = Array.from(this.#selectedElements.values()).map(({ id, domTreeString }) => ({
            id,
            domTreeString
        }));
        const selectedElementIds = Array.from(this.#selectedElements.keys());

        if (selectedElementIds.length > 0) {
            this.#editorState = EditorStates.ElementSelection;
            this.#toggleCrosshairCursor(true);
            this.#toParent({ type: 'status', payload: { status: this.#editorState.type } });
        }

        this.#toParent({
            type: 'selection-rebuilt',
            payload: {
                selectedElements,
                selectedElementIds
            }
        });

        return matched;
    }

    constructor() {
        this.#injectEditorStyles();
        this.#toggleCrosshairCursor(false);

        window.addEventListener('message', (event: MessageEvent<ParentToEditCommunicatorMessage>) => {
            if (!allowedOrigins.includes(event.origin)) {
                this.#toParent({ type: 'error', payload: { msg: `disallowed origin: ${event.origin}` } });
                return;
            }
            parentOrigin = event.origin;
            const { type, payload } = event.data;
            this.#toParent({ type: 'ack', payload: { message: event.data } });

            switch (type) {
                case 'ready':
                    this.#clearAllSelections();
                    this.#editorState = EditorStates.Ready;
                    this.#toggleCrosshairCursor(false);
                    this.#toParent({ type: 'status', payload: { status: this.#editorState.type } });
                    break;
                case 'tool-element-selection':
                    this.#clearAllSelections();
                    this.#editorState = EditorStates.ElementSelection;
                    this.#toggleCrosshairCursor(true);
                    this.#toParent({ type: 'status', payload: { status: this.#editorState.type } });
                    break;
                case 'clear-selection':
                    this.#toParent({ type: 'status', payload: { status: `clearing selections` } });
                    this.#clearAllSelections();
                    break;
                case 'remove-selection':
                    if (payload?.element) {
                        this.#toParent({ type: 'status', payload: { status: `removing ${payload.element}` } });
                        this.#removeSelection(payload.element);
                    }
                    break;
                case 'rebuild-selection': {
                    const ids: string[] = Array.isArray(payload?.ids) ? payload.ids : [];
                    this.#rebuildSelection(ids);
                    break;
                }
            }
        });

        this.#setupElementClickListeners();
        this.#setupElementHoverListeners();
        this.#editorState = EditorStates.Ready;
    }
}

let editorInstance: EditCommunicator | null = null;

export function initEditor(): EditCommunicator {
    if (!editorInstance) {
        editorInstance = new EditCommunicator();
    }
    return editorInstance;
}
PK
frontend/src/hooks/useLFLCSync.tsimport { useState, useCallback, useRef, useEffect } from 'react';
import { useQueryClient } from '@tanstack/react-query';
import { toast } from 'sonner';
import { 
  LFLC_Response_Envelope, 
  LFLCResponseHandler, 
  SyncMetadata 
} from '../types/lflc-response';
import { useUpdateSoulCollaborationSync } from './useQueries';

interface LFLCSyncOptions {
  autoSync?: boolean;
  syncInterval?: number;
  maxRetries?: number;
  onSyncSuccess?: (envelope: LFLC_Response_Envelope<any>) => void;
  onSyncError?: (error: Error) => void;
}

export function useLFLCSync(options: LFLCSyncOptions = {}) {
  const {
    autoSync = true,
    syncInterval = 60000,
    maxRetries = 3,
    onSyncSuccess,
    onSyncError,
  } = options;

  const queryClient = useQueryClient();
  const updateSyncMutation = useUpdateSoulCollaborationSync();
  
  const [isSyncing, setIsSyncing] = useState(false);
  const [lastSyncTime, setLastSyncTime] = useState<number>(0);
  const [syncError, setSyncError] = useState<Error | null>(null);
  const [retryCount, setRetryCount] = useState(0);
  const [syncHistory, setSyncHistory] = useState<LFLC_Response_Envelope<any>[]>([]);
  
  const syncIntervalRef = useRef<NodeJS.Timeout | null>(null);
  const abortControllerRef = useRef<AbortController | null>(null);

  // 執行 LFLC 統一響應同步
  const performLFLCSync = useCallback(async <T>(
    data: T,
    direction: 'send' | 'receive' | 'bidirectional' = 'bidirectional'
  ): Promise<LFLC_Response_Envelope<T>> => {
    if (isSyncing) {
      throw new Error('Sync already in progress');
    }

    setIsSyncing(true);
    setSyncError(null);

    // 創建 AbortController 用於取消請求
    abortControllerRef.current = new AbortController();

    const syncMetadata: SyncMetadata = {
      source_domain: 'lflcei.life',
      target_domain: 'lflcei.today',
      sync_direction: direction,
      sync_timestamp: BigInt(Date.now() * 1000000),
      retry_count: retryCount,
      max_retries: maxRetries,
      integrity_hash: btoa(JSON.stringify(data)).substring(0, 32),
    };

    try {
      // 更新後端同步狀態
      await updateSyncMutation.mutateAsync({
        status: `LFLC統一響應同步中 [${direction}]`,
        errorCode: null,
        errorMessage: null,
      });

      // 模擬 HTTPS API 通信
      await new Promise((resolve) => setTimeout(resolve, 1000));

      // 檢查是否被取消
      if (abortControllerRef.current?.signal.aborted) {
        throw new Error('Sync cancelled');
      }

      // 創建 LFLC 響應封裝
      const envelope = LFLCResponseHandler.createEnvelope(data, syncMetadata, {
        priority: 'high',
        ui_update_trigger: true,
        gpu_accelerated: true,
        animation_type: 'fade',
      });

      // 驗證完整性
      if (!LFLCResponseHandler.validateIntegrity(envelope)) {
        throw new Error('Integrity validation failed');
      }

      // 更新同步歷史
      setSyncHistory((prev) => [envelope, ...prev].slice(0, 50));
      setLastSyncTime(Date.now());
      setRetryCount(0);

      // 觸發 UI 更新
      if (LFLCResponseHandler.shouldTriggerUIUpdate(envelope)) {
        await queryClient.invalidateQueries({ queryKey: ['soulCollaborationSyncStatus'] });
        await queryClient.invalidateQueries({ queryKey: ['currentUserProfile'] });
      }

      // 更新後端同步狀態
      await updateSyncMutation.mutateAsync({
        status: `LFLC統一響應同步成功 [trace_id: ${envelope.trace_id}]`,
        errorCode: null,
        errorMessage: null,
      });

      onSyncSuccess?.(envelope);
      setIsSyncing(false);

      return envelope;
    } catch (error) {
      const err = error instanceof Error ? error : new Error('Unknown error');
      setSyncError(err);

      // 創建錯誤響應封裝
      const errorEnvelope = LFLCResponseHandler.createErrorEnvelope<T>(err, syncMetadata);
      setSyncHistory((prev) => [errorEnvelope, ...prev].slice(0, 50));

      // 更新後端同步狀態
      try {
        await updateSyncMutation.mutateAsync({
          status: `LFLC統一響應同步失敗 [trace_id: ${errorEnvelope.trace_id}]`,
          errorCode: errorEnvelope.error_details?.error_code || 'UNKNOWN_ERROR',
          errorMessage: err.message,
        });
      } catch (updateError) {
        console.error('Failed to update sync status:', updateError);
      }

      // 重試邏輯
      if (retryCount < maxRetries) {
        setRetryCount((prev) => prev + 1);
        const retryDelay = 5000 * (retryCount + 1);
        
        toast.warning(`同步失敗，將在 ${retryDelay / 1000} 秒後重試`, {
          description: `重試次數: ${retryCount + 1}/${maxRetries}`,
        });

        setTimeout(() => {
          performLFLCSync(data, direction);
        }, retryDelay);
      } else {
        onSyncError?.(err);
        toast.error('LFLC統一響應同步失敗', {
          description: err.message,
        });
      }

      setIsSyncing(false);
      throw errorEnvelope;
    }
  }, [isSyncing, retryCount, maxRetries, updateSyncMutation, queryClient, onSyncSuccess, onSyncError]);

  // 取消同步
  const cancelSync = useCallback(() => {
    if (abortControllerRef.current) {
      abortControllerRef.current.abort();
      setIsSyncing(false);
      toast.info('同步已取消');
    }
  }, []);

  // 清除同步歷史
  const clearSyncHistory = useCallback(() => {
    setSyncHistory([]);
  }, []);

  // 自動同步
  useEffect(() => {
    if (!autoSync) return;

    syncIntervalRef.current = setInterval(() => {
      if (!isSyncing) {
        performLFLCSync({ timestamp: Date.now() }, 'bidirectional').catch(console.error);
      }
    }, syncInterval);

    return () => {
      if (syncIntervalRef.current) {
        clearInterval(syncIntervalRef.current);
      }
    };
  }, [autoSync, syncInterval, isSyncing, performLFLCSync]);

  return {
    performLFLCSync,
    cancelSync,
    clearSyncHistory,
    isSyncing,
    lastSyncTime,
    syncError,
    retryCount,
    syncHistory,
  };
}
PK
frontend/src/hooks/useQueries.tsimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { useActor } from './useActor';
import type { 
  UserProfile, 
  FortuneMessage, 
  UserFortuneRecord, 
  SoulCollaboration,
  AscensionLevel,
  EnergyState,
  Realm,
  ShoppingItem,
  UnifiedSyncResponse,
  HourlySubscriptionStatus,
  HourlyBillingRecord,
  NFTAsset,
  TransactionRecord
} from '../backend';
import { Principal } from '@icp-sdk/core/principal';
import { useEffect, useRef, useState, useCallback } from 'react';
import { toast } from 'sonner';

// 系統全面調整優化版 - 架構精煉和性能層全面提升
const CACHE_TIME = 10 * 60 * 1000; // 10 minutes
const STALE_TIME = 45 * 1000; // 45 seconds (optimized from 60 for faster updates)
const FORTUNE_CACHE_TIME = 24 * 60 * 60 * 1000; // 24 hours
const SYNC_STATUS_STALE_TIME = 8 * 1000; // 8 seconds (optimized from 10 for faster sync)
const ASCENSION_STALE_TIME = 1200; // 1.2 seconds (optimized from 1.5 for faster energy updates)
const UNIFIED_SYNC_INTERVAL = 20 * 1000; // 20 seconds (optimized from 25 for smoother data sync)
const SUBSCRIPTION_STALE_TIME = 1200; // 1.2 seconds (optimized from 1.5)
const IDLE_THRESHOLD = 5 * 60 * 1000; // 5 minutes
const IDLE_SYNC_INTERVAL = 5 * 60 * 1000; // 5 minutes idle
const ORACLE_STATUS_STALE_TIME = 20 * 1000; // 20 seconds (optimized from 25)
const HOURLY_SUBSCRIPTION_STALE_TIME = 2 * 1000; // 2 seconds (optimized from 3)

export function useGetCallerUserProfile() {
  const { actor, isFetching: actorFetching } = useActor();

  const query = useQuery<UserProfile | null>({
    queryKey: ['currentUserProfile'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.getCallerUserProfile();
    },
    enabled: !!actor && !actorFetching,
    retry: 2,
    staleTime: STALE_TIME,
    gcTime: CACHE_TIME,
    refetchOnMount: 'always',
    refetchOnWindowFocus: false,
  });

  return {
    ...query,
    isLoading: actorFetching || query.isLoading,
    isFetched: !!actor && query.isFetched,
  };
}

export function useSaveCallerUserProfile() {
  const { actor } = useActor();
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async (profile: UserProfile) => {
      if (!actor) throw new Error('Actor not available');
      return actor.saveCallerUserProfile(profile);
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['currentUserProfile'] });
    },
    onError: (error) => {
      console.error('Failed to save profile:', error);
    },
  });
}

export function useIsCallerAdmin() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<boolean>({
    queryKey: ['isCallerAdmin'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.isCallerAdmin();
    },
    enabled: !!actor && !actorFetching,
    retry: 1,
    staleTime: CACHE_TIME,
    gcTime: CACHE_TIME * 2,
    refetchOnWindowFocus: false,
  });
}

export function useIsCallerCoreAdmin() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<boolean>({
    queryKey: ['isCallerCoreAdmin'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.isCallerCoreAdmin();
    },
    enabled: !!actor && !actorFetching,
    retry: 1,
    staleTime: CACHE_TIME,
    gcTime: CACHE_TIME * 2,
    refetchOnWindowFocus: false,
  });
}

export function useAddAdminUser() {
  const { actor } = useActor();
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async (principalId: string) => {
      if (!actor) throw new Error('Actor not available');
      const principal = Principal.fromText(principalId);
      return actor.addAdminUser(principal);
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['isCallerAdmin'] });
    },
  });
}

export function useDrawDailyFortune() {
  const { actor } = useActor();
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.drawDailyFortune();
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['userFortuneRecord'] });
      queryClient.invalidateQueries({ queryKey: ['hasUserDrawnFortune'] });
    },
  });
}

export function useHasUserDrawnFortune() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<boolean>({
    queryKey: ['hasUserDrawnFortune'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.hasUserDrawnFortune();
    },
    enabled: !!actor && !actorFetching,
    staleTime: FORTUNE_CACHE_TIME,
    gcTime: FORTUNE_CACHE_TIME,
    refetchOnWindowFocus: false,
  });
}

export function useGetUserFortuneRecord() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<UserFortuneRecord | null>({
    queryKey: ['userFortuneRecord'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.getUserFortuneRecord();
    },
    enabled: !!actor && !actorFetching,
    staleTime: FORTUNE_CACHE_TIME,
    gcTime: FORTUNE_CACHE_TIME,
    refetchOnMount: 'always',
    refetchOnWindowFocus: false,
  });
}

// 靈魂協作引擎鉤子 - 系統調整優化版本
export function useGetSoulCollaborationSyncStatus() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<SoulCollaboration>({
    queryKey: ['soulCollaborationSyncStatus'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.getSoulCollaborationSyncStatus();
    },
    enabled: !!actor && !actorFetching,
    staleTime: SYNC_STATUS_STALE_TIME,
    gcTime: CACHE_TIME,
    refetchInterval: UNIFIED_SYNC_INTERVAL,
    refetchOnWindowFocus: false,
    refetchIntervalInBackground: false,
    retry: 3,
    retryDelay: (attemptIndex) => Math.min(800 * 2 ** attemptIndex, 5000),
  });
}

// 更新靈魂協作同步狀態 - 系統調整優化版本
export function useUpdateSoulCollaborationSync() {
  const { actor } = useActor();
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async ({ status, errorCode, errorMessage }: { 
      status: string; 
      errorCode: string | null; 
      errorMessage: string | null;
    }) => {
      if (!actor) throw new Error('Actor not available');
      return actor.updateSoulCollaborationSync(status, errorCode, errorMessage);
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['soulCollaborationSyncStatus'] });
    },
    retry: 2,
    retryDelay: 1000,
  });
}

// Oracle平台整合鉤子 - 系統調整優化版本
export function useGetOracleConnectionStatus() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<boolean>({
    queryKey: ['oracleConnectionStatus'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.getOracleConnectionStatus();
    },
    enabled: !!actor && !actorFetching,
    staleTime: ORACLE_STATUS_STALE_TIME,
    gcTime: CACHE_TIME,
    refetchInterval: ORACLE_STATUS_STALE_TIME,
    refetchOnWindowFocus: false,
    refetchIntervalInBackground: false,
    retry: 2,
  });
}

export function useRecordOracleAccess() {
  const { actor } = useActor();
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async ({ success, errorMessage }: { success: boolean; errorMessage: string | null }) => {
      if (!actor) throw new Error('Actor not available');
      return actor.recordOracleAccess(success, errorMessage);
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['oracleConnectionStatus'] });
    },
  });
}

// 統一系統同步鉤子 - 系統全面調整優化版本
export function useUnifiedSystemSync() {
  const queryClient = useQueryClient();
  const { actor } = useActor();
  const lastSyncRef = useRef<number>(0);
  const lastActivityRef = useRef<number>(Date.now());
  const syncIntervalRef = useRef<NodeJS.Timeout | null>(null);
  const [isSyncing, setIsSyncing] = useState(false);
  const [syncError, setSyncError] = useState<string | null>(null);
  const [retryCount, setRetryCount] = useState(0);
  const [isIdle, setIsIdle] = useState(false);
  const MAX_RETRIES = 3;

  // 追蹤用戶活動 - 性能層優化
  useEffect(() => {
    const updateActivity = () => {
      lastActivityRef.current = Date.now();
      setIsIdle(false);
    };

    const events = ['mousedown', 'mousemove', 'keypress', 'scroll', 'touchstart', 'click'];
    events.forEach(event => {
      window.addEventListener(event, updateActivity, { passive: true });
    });

    const idleCheckInterval = setInterval(() => {
      const timeSinceActivity = Date.now() - lastActivityRef.current;
      setIsIdle(timeSinceActivity > IDLE_THRESHOLD);
    }, 60000);

    return () => {
      events.forEach(event => {
        window.removeEventListener(event, updateActivity);
      });
      clearInterval(idleCheckInterval);
    };
  }, []);

  // 執行統一融合同步 - 系統全面調整優化版本
  const performUnifiedSync = useCallback(async (isManual = false) => {
    const now = Date.now();
    const timeSinceLastSync = now - lastSyncRef.current;
    
    // 防止過於頻繁的同步請求 - 功能層優化 (8秒最小間隔，優化from 10秒)
    if (!isManual && timeSinceLastSync < 8000) {
      return { success: true, skipped: true };
    }

    setIsSyncing(true);
    setSyncError(null);

    try {
      // 更新後端同步狀態
      if (actor) {
        await actor.updateSoulCollaborationSync('統一融合中 • 系統全面調整優化版', null, null);
      }

      // 統一數據流同步 - 並行執行所有查詢失效以提升性能 (性能層優化)
      await Promise.all([
        queryClient.invalidateQueries({ queryKey: ['soulCollaborationSyncStatus'] }),
        queryClient.invalidateQueries({ queryKey: ['currentUserProfile'] }),
        queryClient.invalidateQueries({ queryKey: ['callerEnergyState'] }),
        queryClient.invalidateQueries({ queryKey: ['userRealms'] }),
        queryClient.invalidateQueries({ queryKey: ['allStarRealms'] }),
        queryClient.invalidateQueries({ queryKey: ['isCallerSubscribed'] }),
        queryClient.invalidateQueries({ queryKey: ['subscriptionExpiryTime'] }),
        queryClient.invalidateQueries({ queryKey: ['hourlySubscriptionStatus'] }),
        queryClient.invalidateQueries({ queryKey: ['hourlyBillingHistory'] }),
        queryClient.invalidateQueries({ queryKey: ['ascensionLevels'] }),
        queryClient.invalidateQueries({ queryKey: ['userSyncInterval'] }),
        queryClient.invalidateQueries({ queryKey: ['oracleConnectionStatus'] }),
        queryClient.invalidateQueries({ queryKey: ['realmAnalysis'] }),
        queryClient.invalidateQueries({ queryKey: ['isCallerCoreAdmin'] }),
        queryClient.invalidateQueries({ queryKey: ['developerWalletBalance'] }),
      ]);

      // 更新成功狀態
      if (actor) {
        await actor.updateSoulCollaborationSync('統一融合成功 • GPU渲染•後端連接•登入流程•UI響應•錯誤處理', null, null);
      }

      lastSyncRef.current = now;
      setRetryCount(0);
      setIsSyncing(false);
      
      if (isManual) {
        // Use requestAnimationFrame for smooth toast display (界面層優化)
        requestAnimationFrame(() => {
          toast.success('統一系統融合完成！', {
            description: `時間: ${new Date().toLocaleTimeString('zh-TW')} • 系統全面調整優化版`,
          });
        });
      }
      
      console.log('✅ 統一系統自動融合完成 [系統全面調整]:', new Date().toLocaleTimeString('zh-TW'));
      return { success: true, skipped: false };
    } catch (error) {
      console.error('❌ 統一系統自動融合失敗:', error);
      const errorMessage = error instanceof Error ? error.message : '未知錯誤';
      setSyncError(errorMessage);
      setIsSyncing(false);

      // 更新錯誤狀態到後端 - 強化錯誤處理
      if (actor) {
        try {
          await actor.updateSoulCollaborationSync('統一融合失敗', 'UNIFIED_SYNC_ERROR', errorMessage);
        } catch (updateError) {
          console.error('Failed to update sync status:', updateError);
        }
      }

      // 自動重試機制 - 功能層優化 (1.2秒基礎延遲，優化from 1.5秒)
      if (retryCount < MAX_RETRIES) {
        setRetryCount(prev => prev + 1);
        console.log(`🔄 重試統一融合 (${retryCount + 1}/${MAX_RETRIES})...`);
        setTimeout(() => {
          performUnifiedSync(isManual);
        }, 1200 * (retryCount + 1)); // 優化指數退避
      } else {
        if (isManual) {
          requestAnimationFrame(() => {
            toast.error('統一融合失敗', {
              description: '請使用手動融合按鈕重試',
            });
          });
        }
      }

      return { success: false, error: errorMessage };
    }
  }, [actor, queryClient, retryCount]);

  // 設置自動同步間隔 - 系統全面調整優化版本
  useEffect(() => {
    if (!actor) return;

    // 初始延遲後執行第一次同步 - 性能層優化 (1.2秒，優化from 1.5秒)
    const initialTimeout = setTimeout(() => {
      performUnifiedSync(false);
    }, 1200);

    // 設置定期同步間隔
    const setupSyncInterval = () => {
      if (syncIntervalRef.current) {
        clearInterval(syncIntervalRef.current);
      }

      // 根據用戶活動狀態調整同步頻率 (功能層優化)
      const interval = isIdle ? IDLE_SYNC_INTERVAL : UNIFIED_SYNC_INTERVAL;
      
      syncIntervalRef.current = setInterval(() => {
        performUnifiedSync(false);
      }, interval);
    };

    setupSyncInterval();

    return () => {
      clearTimeout(initialTimeout);
      if (syncIntervalRef.current) {
        clearInterval(syncIntervalRef.current);
      }
    };
  }, [actor, isIdle, performUnifiedSync]);

  return {
    performSync: (isManual = true) => performUnifiedSync(isManual),
    lastSyncTime: lastSyncRef.current,
    isSyncing,
    syncError,
    retryCount,
    isIdle,
  };
}

export function useGetUserSyncInterval() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<bigint>({
    queryKey: ['userSyncInterval'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.getUserSyncInterval();
    },
    enabled: !!actor && !actorFetching,
    staleTime: CACHE_TIME,
    gcTime: CACHE_TIME * 2,
    refetchOnWindowFocus: false,
  });
}

export function useSetUserSyncInterval() {
  const { actor } = useActor();
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async (interval: bigint) => {
      if (!actor) throw new Error('Actor not available');
      return actor.setUserSyncInterval(interval);
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['userSyncInterval'] });
    },
  });
}

// ICP訂閱系統鉤子 - 系統調整優化版本
export function useIsCallerSubscribed() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<boolean>({
    queryKey: ['isCallerSubscribed'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.isCallerSubscribed();
    },
    enabled: !!actor && !actorFetching,
    staleTime: SUBSCRIPTION_STALE_TIME,
    gcTime: CACHE_TIME,
    refetchOnMount: 'always',
    refetchOnWindowFocus: true,
    refetchInterval: 12000, // 12 seconds (optimized from 15 for faster updates)
    retry: 2,
  });
}

export function useGetSubscriptionExpiryTime() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<bigint | null>({
    queryKey: ['subscriptionExpiryTime'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.getSubscriptionExpiryTime();
    },
    enabled: !!actor && !actorFetching,
    staleTime: SUBSCRIPTION_STALE_TIME,
    gcTime: CACHE_TIME,
    refetchOnWindowFocus: true,
  });
}

export function useCreateCheckoutSession() {
  const { actor } = useActor();

  return useMutation({
    mutationFn: async ({ items, successUrl, cancelUrl }: { 
      items: ShoppingItem[]; 
      successUrl: string; 
      cancelUrl: string;
    }) => {
      if (!actor) throw new Error('Actor not available');
      const sessionJson = await actor.createCheckoutSession(items, successUrl, cancelUrl);
      return JSON.parse(sessionJson) as { id: string; url: string };
    },
  });
}

export function useVerifyAndActivateSubscription() {
  const { actor } = useActor();
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async (sessionId: string) => {
      if (!actor) throw new Error('Actor not available');
      return actor.verifyAndActivateSubscription(sessionId);
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['isCallerSubscribed'] });
      queryClient.invalidateQueries({ queryKey: ['subscriptionExpiryTime'] });
    },
  });
}

export function useIsStripeConfigured() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<boolean>({
    queryKey: ['isStripeConfigured'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.isStripeConfigured();
    },
    enabled: !!actor && !actorFetching,
    staleTime: CACHE_TIME,
    gcTime: CACHE_TIME * 2,
    refetchOnWindowFocus: false,
  });
}

// 每小時訂閱系統鉤子 - 系統調整優化版本
export function useGetHourlySubscriptionStatus() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<HourlySubscriptionStatus | null>({
    queryKey: ['hourlySubscriptionStatus'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.getHourlySubscriptionStatus();
    },
    enabled: !!actor && !actorFetching,
    staleTime: HOURLY_SUBSCRIPTION_STALE_TIME,
    gcTime: CACHE_TIME,
    refetchOnMount: 'always',
    refetchOnWindowFocus: true,
    refetchInterval: 12000, // 12 seconds (optimized from 15)
    retry: 2,
  });
}

export function useActivateHourlySubscription() {
  const { actor } = useActor();
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.activateHourlySubscription();
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['hourlySubscriptionStatus'] });
      queryClient.invalidateQueries({ queryKey: ['hourlyBillingHistory'] });
    },
  });
}

export function useDeactivateHourlySubscription() {
  const { actor } = useActor();
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.deactivateHourlySubscription();
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['hourlySubscriptionStatus'] });
    },
  });
}

export function useGetHourlyBillingHistory() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<HourlyBillingRecord[]>({
    queryKey: ['hourlyBillingHistory'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.getHourlyBillingHistory();
    },
    enabled: !!actor && !actorFetching,
    staleTime: HOURLY_SUBSCRIPTION_STALE_TIME,
    gcTime: CACHE_TIME,
    refetchOnWindowFocus: true,
  });
}

// 元宇宙昇華系統鉤子 - 系統調整優化版本
export function useGetAscensionLevels() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<AscensionLevel[]>({
    queryKey: ['ascensionLevels'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.getAscensionLevels();
    },
    enabled: !!actor && !actorFetching,
    staleTime: CACHE_TIME,
    gcTime: CACHE_TIME * 2,
    refetchOnWindowFocus: false,
  });
}

export function useGetCallerEnergyState() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<EnergyState | null>({
    queryKey: ['callerEnergyState'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.getCallerEnergyState();
    },
    enabled: !!actor && !actorFetching,
    staleTime: ASCENSION_STALE_TIME,
    gcTime: CACHE_TIME,
    refetchInterval: 2000, // 2 seconds (optimized from 2.5 for faster energy updates)
    refetchOnWindowFocus: true,
    refetchIntervalInBackground: false,
    retry: 2,
  });
}

// 九界系統鉤子 - 系統調整優化版本
export function useGetAllStarRealms() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<Realm[]>({
    queryKey: ['allStarRealms'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.getAllStarRealms();
    },
    enabled: !!actor && !actorFetching,
    staleTime: CACHE_TIME,
    gcTime: CACHE_TIME * 2,
    refetchOnWindowFocus: false,
  });
}

export function useGetRealmById(realmId: bigint | null) {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<Realm | null>({
    queryKey: ['realmById', realmId?.toString()],
    queryFn: async () => {
      if (!actor || realmId === null) throw new Error('Actor or realm ID not available');
      return actor.getRealmById(realmId);
    },
    enabled: !!actor && !actorFetching && realmId !== null,
    staleTime: CACHE_TIME,
    gcTime: CACHE_TIME * 2,
    refetchOnWindowFocus: false,
  });
}

export function useGetUserRealms(userPrincipal: Principal | null) {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<Realm[]>({
    queryKey: ['userRealms', userPrincipal?.toString()],
    queryFn: async () => {
      if (!actor || !userPrincipal) throw new Error('Actor or user principal not available');
      return actor.getUserRealms(userPrincipal);
    },
    enabled: !!actor && !actorFetching && !!userPrincipal,
    staleTime: STALE_TIME,
    gcTime: CACHE_TIME,
    refetchOnMount: 'always',
    refetchOnWindowFocus: false,
  });
}

export function useUpdateUserRealmStats() {
  const { actor } = useActor();
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async ({ realmId, points, reputation, challenges }: { 
      realmId: bigint; 
      points: bigint; 
      reputation: bigint; 
      challenges: bigint;
    }) => {
      if (!actor) throw new Error('Actor not available');
      return actor.updateUserRealmStats(realmId, points, reputation, challenges);
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['userRealms'] });
      queryClient.invalidateQueries({ queryKey: ['currentUserProfile'] });
      queryClient.invalidateQueries({ queryKey: ['realmAnalysis'] });
    },
  });
}

// 界別分析鉤子 - 系統調整優化版本
export function useGetRealmAnalysis() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery({
    queryKey: ['realmAnalysis'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.getRealmAnalysis();
    },
    enabled: !!actor && !actorFetching,
    staleTime: STALE_TIME,
    gcTime: CACHE_TIME,
    refetchOnWindowFocus: false,
  });
}

// 統一同步函數鉤子 - 系統調整優化版本
export function useUnifiedSyncFunction() {
  const { actor } = useActor();

  return useQuery<UnifiedSyncResponse>({
    queryKey: ['unifiedSyncFunction'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.unifiedSyncFunction();
    },
    enabled: !!actor,
    staleTime: SYNC_STATUS_STALE_TIME,
    gcTime: CACHE_TIME,
    refetchInterval: UNIFIED_SYNC_INTERVAL,
    refetchOnWindowFocus: false,
    retry: 2,
  });
}

// 3D NFT 資產管理鉤子 (核心管理員專用)
export function useLoadNFTAsset() {
  const { actor } = useActor();
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async ({ name, metadata }: { name: string; metadata: string }) => {
      if (!actor) throw new Error('Actor not available');
      return actor.loadNFTAsset(name, metadata);
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['allNFTAssets'] });
    },
  });
}

export function useValidateNFTAsset() {
  const { actor } = useActor();
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async (nftId: bigint) => {
      if (!actor) throw new Error('Actor not available');
      return actor.validateNFTAsset(nftId);
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['allNFTAssets'] });
    },
  });
}

export function useGetNFTAsset(nftId: bigint | null) {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<NFTAsset | null>({
    queryKey: ['nftAsset', nftId?.toString()],
    queryFn: async () => {
      if (!actor || nftId === null) throw new Error('Actor or NFT ID not available');
      return actor.getNFTAsset(nftId);
    },
    enabled: !!actor && !actorFetching && nftId !== null,
    staleTime: STALE_TIME,
    gcTime: CACHE_TIME,
    refetchOnWindowFocus: false,
  });
}

export function useGetAllNFTAssets() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<[bigint, NFTAsset][]>({
    queryKey: ['allNFTAssets'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.getAllNFTAssets();
    },
    enabled: !!actor && !actorFetching,
    staleTime: STALE_TIME,
    gcTime: CACHE_TIME,
    refetchOnWindowFocus: false,
  });
}

export function useTransferNFTAsset() {
  const { actor } = useActor();
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async ({ nftId, newOwner }: { nftId: bigint; newOwner: string }) => {
      if (!actor) throw new Error('Actor not available');
      const principal = Principal.fromText(newOwner);
      return actor.transferNFTAsset(nftId, principal);
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['allNFTAssets'] });
      queryClient.invalidateQueries({ queryKey: ['allTransactions'] });
    },
  });
}

// 交易介面管理鉤子 (核心管理員專用)
export function useRecordTransaction() {
  const { actor } = useActor();
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async ({ from, to, amount, txType }: { 
      from: string; 
      to: string; 
      amount: bigint; 
      txType: string;
    }) => {
      if (!actor) throw new Error('Actor not available');
      const fromPrincipal = Principal.fromText(from);
      const toPrincipal = Principal.fromText(to);
      return actor.recordTransaction(fromPrincipal, toPrincipal, amount, txType);
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['allTransactions'] });
      queryClient.invalidateQueries({ queryKey: ['developerWalletBalance'] });
    },
  });
}

export function useGetTransaction(txId: bigint | null) {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<TransactionRecord | null>({
    queryKey: ['transaction', txId?.toString()],
    queryFn: async () => {
      if (!actor || txId === null) throw new Error('Actor or transaction ID not available');
      return actor.getTransaction(txId);
    },
    enabled: !!actor && !actorFetching && txId !== null,
    staleTime: STALE_TIME,
    gcTime: CACHE_TIME,
    refetchOnWindowFocus: false,
  });
}

export function useGetAllTransactions() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<[bigint, TransactionRecord][]>({
    queryKey: ['allTransactions'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.getAllTransactions();
    },
    enabled: !!actor && !actorFetching,
    staleTime: STALE_TIME,
    gcTime: CACHE_TIME,
    refetchOnWindowFocus: false,
  });
}

export function useGetDeveloperWalletBalance() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<bigint>({
    queryKey: ['developerWalletBalance'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.getDeveloperWalletBalance();
    },
    enabled: !!actor && !actorFetching,
    staleTime: SUBSCRIPTION_STALE_TIME,
    gcTime: CACHE_TIME,
    refetchInterval: 12000,
    refetchOnWindowFocus: true,
  });
}

export function useGetNNSDAppAddress() {
  const { actor, isFetching: actorFetching } = useActor();

  return useQuery<string>({
    queryKey: ['nnsDAppAddress'],
    queryFn: async () => {
      if (!actor) throw new Error('Actor not available');
      return actor.getNNSDAppAddress();
    },
    enabled: !!actor && !actorFetching,
    staleTime: CACHE_TIME * 10,
    gcTime: CACHE_TIME * 10,
    refetchOnWindowFocus: false,
  });
}
PK
frontend/src/pages/PK
frontend/src/pages/AdminPage.tsximport { useState } from 'react';
import { useIsCallerAdmin, useIsCallerCoreAdmin, useAddAdminUser, useGetDeveloperWalletBalance, useGetNNSDAppAddress } from '../hooks/useQueries';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Shield, UserPlus, AlertCircle, CheckCircle2, ExternalLink, ArrowLeftRight, Crown, Wallet, Database, FileText, Layers } from 'lucide-react';
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import { Skeleton } from '@/components/ui/skeleton';
import { toast } from 'sonner';
import SoulCollaborationSyncPanel from '../components/SoulCollaborationSyncPanel';
import { useNavigate } from '@tanstack/react-router';

export default function AdminPage() {
  const { data: isAdmin, isLoading: isAdminLoading } = useIsCallerAdmin();
  const { data: isCoreAdmin, isLoading: isCoreAdminLoading } = useIsCallerCoreAdmin();
  const { data: walletBalance } = useGetDeveloperWalletBalance();
  const { data: nnsDAppAddress } = useGetNNSDAppAddress();
  const addAdminMutation = useAddAdminUser();
  const navigate = useNavigate();
  
  const [principalId, setPrincipalId] = useState('');
  const [loadingLinks, setLoadingLinks] = useState<Record<string, boolean>>({});

  const handleAddAdmin = async (e: React.FormEvent) => {
    e.preventDefault();
    
    if (!principalId.trim()) {
      toast.error('請輸入 Principal ID');
      return;
    }

    try {
      await addAdminMutation.mutateAsync(principalId.trim());
      toast.success('管理員已成功新增！');
      setPrincipalId('');
    } catch (error: any) {
      console.error('Error adding admin:', error);
      toast.error(error.message || '新增管理員失敗');
    }
  };

  const handleBackendModuleClick = async (url: string, moduleName: string) => {
    if (url === '#') {
      toast.info('此功能即將推出');
      return;
    }

    setLoadingLinks(prev => ({ ...prev, [moduleName]: true }));

    try {
      const newWindow = window.open(url, '_blank', 'noopener,noreferrer');
      
      if (!newWindow || newWindow.closed || typeof newWindow.closed === 'undefined') {
        toast.error('彈出視窗被阻擋，請允許彈出視窗後重試');
        setLoadingLinks(prev => ({ ...prev, [moduleName]: false }));
        return;
      }

      newWindow.focus();
      toast.success(`正在開啟 ${moduleName}...`);
      
      setTimeout(() => {
        setLoadingLinks(prev => ({ ...prev, [moduleName]: false }));
      }, 800);
    } catch (error) {
      console.error('Error opening link:', error);
      toast.error('開啟連結失敗，請稍後再試');
      setLoadingLinks(prev => ({ ...prev, [moduleName]: false }));
    }
  };

  const handleDualDomainSyncClick = () => {
    navigate({ to: '/dual-domain-sync' });
  };

  const handleNFTManagementClick = () => {
    navigate({ to: '/admin/nft-management' });
  };

  const handleTransactionInterfaceClick = () => {
    navigate({ to: '/admin/transactions' });
  };

  if (isAdminLoading || isCoreAdminLoading) {
    return (
      <div className="space-y-6">
        <Skeleton className="h-48 w-full" />
        <Skeleton className="h-64 w-full" />
      </div>
    );
  }

  if (!isAdmin) {
    return (
      <div className="flex items-center justify-center min-h-[60vh]">
        <Card className="bg-red-900/50 border-red-400/50 max-w-md">
          <CardHeader>
            <div className="flex items-center gap-3">
              <AlertCircle className="h-8 w-8 text-red-400" />
              <CardTitle className="text-2xl text-red-400">未授權</CardTitle>
            </div>
          </CardHeader>
          <CardContent>
            <p className="text-red-200">
              您沒有權限存取此頁面。此區域僅限管理員使用。
            </p>
          </CardContent>
        </Card>
      </div>
    );
  }

  const backendModules = [
    {
      name: 'LFLC 數據庫',
      description: '去中心化數據管理平台',
      url: '#',
      icon: '/assets/generated/database-icon-transparent.dim_64x64.png',
    },
    {
      name: 'LFLC 防火牆',
      description: '白名單管理與通知系統',
      url: '#',
      icon: '/assets/generated/firewall-icon-transparent.dim_64x64.png',
    },
    {
      name: 'LFLC AI 控制室',
      description: '後端控制室規格文件',
      url: '#',
      icon: '/assets/generated/ai-control-icon-transparent.dim_64x64.png',
    },
    {
      name: 'LFLC Network Nervous System（中樞神經元）',
      description: '網路中樞神經系統',
      url: 'https://lflc-network-nervous-system-dqx.caffeine.xyz/',
      icon: '/assets/generated/nervous-system-icon-transparent.dim_64x64.png',
    },
  ];

  const walletBalanceICP = walletBalance ? Number(walletBalance) / 100000000 : 0;
  const autoTransferThreshold = 5;
  const progressPercentage = Math.min((walletBalanceICP / autoTransferThreshold) * 100, 100);

  return (
    <div className="space-y-8 animate-fade-in max-w-4xl mx-auto">
      <Card className="bg-gradient-to-r from-amber-900/50 to-amber-800/50 border-amber-400/50 shadow-xl">
        <CardHeader>
          <div className="flex items-center gap-3">
            <div className="p-3 bg-amber-400/20 rounded-full">
              {isCoreAdmin ? <Crown className="h-8 w-8 text-amber-400 animate-pulse" /> : <Shield className="h-8 w-8 text-amber-400" />}
            </div>
            <div>
              <CardTitle className="text-3xl text-amber-400 clover-glow flex items-center gap-2">
                {isCoreAdmin ? '核心管理員控制台' : '管理員控制台'}
                {isCoreAdmin && <Crown className="h-6 w-6 text-amber-400 animate-pulse" />}
              </CardTitle>
              <CardDescription className="text-emerald-200 text-lg mt-1">
                {isCoreAdmin ? '李奕勳 (LEE YIHSUN / Johnnylee7912) • 最高權限' : '系統管理與權限設定'}
              </CardDescription>
            </div>
          </div>
        </CardHeader>
      </Card>

      {isCoreAdmin && (
        <>
          <Alert className="bg-gradient-to-r from-amber-900/50 to-yellow-900/50 border-amber-400/50">
            <Crown className="h-4 w-4 text-amber-400" />
            <AlertTitle className="text-amber-400">核心管理員權限已啟用</AlertTitle>
            <AlertDescription className="text-amber-200">
              您擁有最高系統管理權限，包括 3D NFT 資產載入、驗證系統和交易介面管理。
            </AlertDescription>
          </Alert>

          <Card className="bg-gradient-to-br from-green-900/50 to-emerald-900/50 border-green-400/50 shadow-xl">
            <CardHeader>
              <div className="flex items-center gap-3">
                <Wallet className="h-6 w-6 text-green-400" />
                <CardTitle className="text-2xl text-green-400">統一開發者錢包系統</CardTitle>
              </div>
              <CardDescription className="text-green-200">
                NNS DApp 連接 • 自動轉移規則：5 ICP
              </CardDescription>
            </CardHeader>
            <CardContent className="space-y-4">
              <div className="bg-green-950/30 rounded-xl p-4 border border-green-400/30">
                <div className="flex items-center justify-between mb-2">
                  <span className="text-green-200 text-sm">當前餘額</span>
                  <span className="text-2xl font-bold text-green-400">{walletBalanceICP.toFixed(4)} ICP</span>
                </div>
                <div className="w-full bg-green-950/50 rounded-full h-3 mb-2">
                  <div 
                    className="bg-gradient-to-r from-green-500 to-emerald-500 h-3 rounded-full transition-all duration-500"
                    style={{ width: `${progressPercentage}%` }}
                  ></div>
                </div>
                <p className="text-green-300 text-xs">
                  距離自動轉移還需 {Math.max(0, autoTransferThreshold - walletBalanceICP).toFixed(4)} ICP
                </p>
              </div>
              <div className="bg-green-950/30 rounded-xl p-4 border border-green-400/30">
                <p className="text-green-200 text-sm mb-2">NNS DApp ICP 地址</p>
                <p className="text-green-400 font-mono text-xs break-all">
                  {nnsDAppAddress || '載入中...'}
                </p>
              </div>
              <div className="flex items-start gap-2 text-xs text-green-200">
                <CheckCircle2 className="h-4 w-4 mt-0.5 text-green-400 flex-shrink-0" />
                <span>當總收益達到 5 ICP 時，系統將自動轉移到 NNS DApp</span>
              </div>
            </CardContent>
          </Card>

          <div className="grid md:grid-cols-2 gap-6">
            <Card className="bg-gradient-to-br from-purple-900/50 to-indigo-900/50 border-purple-400/50 shadow-xl hover:shadow-2xl transition-all cursor-pointer group" onClick={handleNFTManagementClick}>
              <CardHeader>
                <div className="flex items-center gap-3">
                  <Layers className="h-6 w-6 text-purple-400 group-hover:scale-110 transition-transform" />
                  <CardTitle className="text-xl text-purple-400">3D NFT 資產管理</CardTitle>
                </div>
                <CardDescription className="text-purple-200">
                  載入、驗證和轉移 3D NFT 資產
                </CardDescription>
              </CardHeader>
              <CardContent>
                <Button className="w-full bg-gradient-to-r from-purple-500 to-indigo-500 hover:from-purple-600 hover:to-indigo-600 text-white">
                  <Layers className="h-4 w-4 mr-2" />
                  進入 NFT 管理
                </Button>
              </CardContent>
            </Card>

            <Card className="bg-gradient-to-br from-blue-900/50 to-cyan-900/50 border-blue-400/50 shadow-xl hover:shadow-2xl transition-all cursor-pointer group" onClick={handleTransactionInterfaceClick}>
              <CardHeader>
                <div className="flex items-center gap-3">
                  <FileText className="h-6 w-6 text-blue-400 group-hover:scale-110 transition-transform" />
                  <CardTitle className="text-xl text-blue-400">交易介面管理</CardTitle>
                </div>
                <CardDescription className="text-blue-200">
                  記錄和查看所有交易記錄
                </CardDescription>
              </CardHeader>
              <CardContent>
                <Button className="w-full bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white">
                  <FileText className="h-4 w-4 mr-2" />
                  進入交易管理
                </Button>
              </CardContent>
            </Card>
          </div>
        </>
      )}

      {!isCoreAdmin && (
        <Alert className="bg-emerald-900/50 border-amber-400/50">
          <CheckCircle2 className="h-4 w-4 text-amber-400" />
          <AlertTitle className="text-amber-400">管理員權限已啟用</AlertTitle>
          <AlertDescription className="text-emerald-200">
            您擁有完整的系統管理權限，可以新增其他管理員用戶並存取所有後端模組。
          </AlertDescription>
        </Alert>
      )}

      <Card className="bg-gradient-to-r from-blue-900/50 to-purple-900/50 border-cyan-400/50 shadow-xl hover:shadow-2xl transition-all">
        <CardHeader>
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3">
              <img
                src="/assets/generated/dual-domain-sync-architecture.dim_800x600.png"
                alt="Dual Domain Sync"
                className="h-12 w-12 rounded-lg"
              />
              <div>
                <CardTitle className="text-2xl text-cyan-400 clover-glow">
                  雙域即時同步系統
                </CardTitle>
                <CardDescription className="text-cyan-200">
                  lflcei.life ⇄ lflcei.today 安全雙向數據同步
                </CardDescription>
              </div>
            </div>
            <Button
              onClick={handleDualDomainSyncClick}
              className="bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 active:from-blue-700 active:to-purple-700 text-white transition-all transform hover:scale-[1.02] active:scale-[0.98]"
            >
              <ArrowLeftRight className="h-5 w-5 mr-2" />
              開啟同步控制台
            </Button>
          </div>
        </CardHeader>
        <CardContent>
          <div className="space-y-3 text-cyan-200 text-sm">
            <p className="flex items-start gap-2">
              <CheckCircle2 className="h-4 w-4 mt-0.5 text-cyan-400 flex-shrink-0" />
              <span>HTTPS 加密通信與雙向認證令牌驗證機制</span>
            </p>
            <p className="flex items-start gap-2">
              <CheckCircle2 className="h-4 w-4 mt-0.5 text-cyan-400 flex-shrink-0" />
              <span>即時數據狀態變更觸發自動同步</span>
            </p>
            <p className="flex items-start gap-2">
              <CheckCircle2 className="h-4 w-4 mt-0.5 text-cyan-400 flex-shrink-0" />
              <span>智能重試邏輯與衝突檢測防止重複傳輸</span>
            </p>
            <p className="flex items-start gap-2">
              <CheckCircle2 className="h-4 w-4 mt-0.5 text-cyan-400 flex-shrink-0" />
              <span>完整的同步日誌與性能監控儀表板</span>
            </p>
          </div>
        </CardContent>
      </Card>

      <SoulCollaborationSyncPanel />

      <Card className="bg-emerald-900/50 border-amber-400/50">
        <CardHeader>
          <div className="flex items-center gap-3">
            <UserPlus className="h-6 w-6 text-amber-400" />
            <CardTitle className="text-2xl text-amber-400">新增管理員</CardTitle>
          </div>
          <CardDescription className="text-emerald-200">
            輸入用戶的 Principal ID 以授予管理員權限
          </CardDescription>
        </CardHeader>
        <CardContent>
          <form onSubmit={handleAddAdmin} className="space-y-4">
            <div className="space-y-2">
              <Label htmlFor="principalId" className="text-emerald-200">
                Principal ID
              </Label>
              <Input
                id="principalId"
                type="text"
                placeholder="例如：ssmgf-hhyda-pxtto-ozjbv-wxqbi-srswj-eabc5-2xzzf-ep6u5-psqp2-zqe"
                value={principalId}
                onChange={(e) => setPrincipalId(e.target.value)}
                className="bg-emerald-950/50 border-amber-400/30 text-emerald-100 placeholder:text-emerald-400/50"
                disabled={addAdminMutation.isPending}
              />
              <p className="text-xs text-emerald-300">
                請確保輸入正確的 Principal ID。此操作將授予該用戶完整的管理員權限。
              </p>
            </div>
            <Button
              type="submit"
              className="w-full bg-amber-500 hover:bg-amber-600 active:bg-amber-700 text-emerald-950 font-bold transition-all transform hover:scale-[1.02] active:scale-[0.98]"
              disabled={addAdminMutation.isPending}
            >
              {addAdminMutation.isPending ? (
                <>
                  <div className="h-4 w-4 animate-spin rounded-full border-2 border-emerald-950 border-t-transparent mr-2" />
                  處理中...
                </>
              ) : (
                <>
                  <UserPlus className="h-4 w-4 mr-2" />
                  新增管理員
                </>
              )}
            </Button>
          </form>
        </CardContent>
      </Card>

      <Card className="bg-emerald-900/50 border-amber-400/50">
        <CardHeader>
          <CardTitle className="text-xl text-amber-400">核心管理員資訊</CardTitle>
          <CardDescription className="text-emerald-200">
            系統指定的核心管理員帳戶 (李奕勳 / LEE YIHSUN / Johnnylee7912)
          </CardDescription>
        </CardHeader>
        <CardContent>
          <div className="space-y-3 bg-emerald-950/50 rounded-lg p-4 border border-amber-400/30">
            <div>
              <p className="text-emerald-300 text-sm">姓名</p>
              <p className="text-amber-400 font-semibold">李奕勳 / LEE YIHSUN / Johnnylee7912</p>
            </div>
            <div>
              <p className="text-emerald-300 text-sm">Internet Identity 2.0 ID</p>
              <p className="text-amber-400 font-semibold">2911215</p>
            </div>
            <div>
              <p className="text-emerald-300 text-sm">Principal ID</p>
              <p className="text-amber-400 font-mono text-xs break-all">
                ssmgf-hhyda-pxtto-ozjbv-wxqbi-srswj-eabc5-2xzzf-ep6u5-psqp2-zqe
              </p>
            </div>
            <div>
              <p className="text-emerald-300 text-sm">指定後端 Canister</p>
              <p className="text-amber-400 font-mono text-xs break-all">
                cerpu-yyaaa-aaaai-q4wuq-cai
              </p>
            </div>
          </div>
        </CardContent>
      </Card>

      <Card className="bg-emerald-900/50 border-amber-400/50">
        <CardHeader>
          <CardTitle className="text-xl text-amber-400">後端模組存取</CardTitle>
          <CardDescription className="text-emerald-200">
            管理員專用的後端系統連結
          </CardDescription>
        </CardHeader>
        <CardContent>
          <div className="space-y-3">
            {backendModules.map((module) => {
              const isLoading = loadingLinks[module.name] || false;
              const isNervousSystem = module.name.includes('Network Nervous System');
              
              return (
                <Button
                  key={module.name}
                  onClick={() => handleBackendModuleClick(module.url, module.name)}
                  disabled={isLoading}
                  variant="ghost"
                  className={`w-full h-auto bg-emerald-950/50 rounded-lg p-4 border transition-all text-left justify-start relative overflow-hidden group ${
                    isNervousSystem 
                      ? 'border-amber-400/50 hover:border-amber-400 hover:bg-gradient-to-r hover:from-amber-900/30 hover:to-emerald-900/70 active:from-amber-900/50 active:to-emerald-900/90' 
                      : 'border-amber-400/30 hover:border-amber-400 hover:bg-emerald-900/70 active:bg-emerald-900'
                  } ${isLoading ? 'animate-pulse' : ''}`}
                >
                  {isNervousSystem && !isLoading && (
                    <div className="absolute inset-0 bg-gradient-to-r from-amber-400/0 via-amber-400/10 to-amber-400/0 opacity-0 group-hover:opacity-100 transition-opacity duration-500 animate-pulse-slow"></div>
                  )}
                  
                  {isLoading && (
                    <div className="absolute inset-0 bg-amber-400/20 backdrop-blur-sm flex items-center justify-center z-10">
                      <div className="flex items-center gap-2">
                        <div className="h-5 w-5 animate-spin rounded-full border-2 border-amber-400 border-t-transparent"></div>
                        <span className="text-amber-400 font-semibold">開啟中...</span>
                      </div>
                    </div>
                  )}
                  
                  <div className="flex items-center gap-3 w-full relative z-0">
                    <img
                      src={module.icon}
                      alt={module.name}
                      className={`h-10 w-10 rounded flex-shrink-0 transition-transform ${
                        isNervousSystem ? 'group-hover:scale-110 group-hover:rotate-3' : ''
                      }`}
                      loading="lazy"
                    />
                    <div className="flex-1 min-w-0">
                      <h3 className={`font-semibold flex items-center gap-2 transition-colors ${
                        isNervousSystem 
                          ? 'text-amber-400 group-hover:text-amber-300' 
                          : 'text-amber-400 group-hover:text-amber-300'
                      }`}>
                        {module.name}
                        <ExternalLink className={`h-4 w-4 transition-transform ${
                          isNervousSystem ? 'group-hover:translate-x-1 group-hover:-translate-y-1' : ''
                        }`} />
                      </h3>
                      <p className="text-emerald-200 text-sm">{module.description}</p>
                    </div>
                    <Shield className={`h-5 w-5 flex-shrink-0 transition-all ${
                      isNervousSystem 
                        ? 'text-amber-400 group-hover:text-amber-300 group-hover:scale-110' 
                        : 'text-amber-400'
                    }`} />
                  </div>
                </Button>
              );
            })}
          </div>
        </CardContent>
      </Card>
    </div>
  );
}
PK
frontend/src/pages/DailyCheckInPage.tsximport { useState } from 'react';
import { useGetCallerUserProfile, useSaveCallerUserProfile, useDrawDailyFortune, useGetUserFortuneRecord } from '../hooks/useQueries';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Progress } from '@/components/ui/progress';
import { Calendar, Check, Sparkles, Tv, Scroll } from 'lucide-react';
import { toast } from 'sonner';
import { Skeleton } from '@/components/ui/skeleton';
import type { UserProfile } from '../backend';
import FortuneSlipModal from '../components/FortuneSlipModal';
import SoulCollaborationStatus from '../components/SoulCollaborationStatus';

export default function DailyCheckInPage() {
  const { data: userProfile, isLoading } = useGetCallerUserProfile();
  const saveProfile = useSaveCallerUserProfile();
  const { data: fortuneRecord } = useGetUserFortuneRecord();
  const drawFortune = useDrawDailyFortune();
  const [showAdOption, setShowAdOption] = useState(false);
  const [showFortuneModal, setShowFortuneModal] = useState(false);
  const [currentFortune, setCurrentFortune] = useState<any>(null);

  const handleDrawFortune = async () => {
    try {
      const fortune = await drawFortune.mutateAsync();
      setCurrentFortune(fortune);
      setShowFortuneModal(true);
      toast.success('已抽取今日幸運籤！');
    } catch (error: any) {
      console.error('Draw fortune error:', error);
      toast.error('抽取幸運籤失敗');
    }
  };

  const handleCheckIn = async (watchAd: boolean) => {
    if (!userProfile) return;

    const now = Date.now() * 1000000;
    const oneDayInNs = BigInt(24 * 60 * 60 * 1000 * 1000000);

    const currentDayIndex = userProfile.dayCycle.findIndex((d) => d.timestamp === 0n);

    if (currentDayIndex === -1) {
      const lastCheckIn = userProfile.dayCycle[userProfile.dayCycle.length - 1].timestamp;
      const timeSinceLastCheckIn = BigInt(now) - lastCheckIn;

      if (timeSinceLastCheckIn < oneDayInNs) {
        toast.error('請明天再來簽到！');
        return;
      }

      const newCycle = [
        { day: 1n, rewardPoints: 3n, adMultiplier: false, timestamp: 0n },
        { day: 2n, rewardPoints: 5n, adMultiplier: false, timestamp: 0n },
        { day: 3n, rewardPoints: 7n, adMultiplier: false, timestamp: 0n },
        { day: 4n, rewardPoints: 9n, adMultiplier: false, timestamp: 0n },
        { day: 5n, rewardPoints: 10n, adMultiplier: false, timestamp: 0n },
        { day: 6n, rewardPoints: 15n, adMultiplier: false, timestamp: 0n },
        { day: 7n, rewardPoints: 20n, adMultiplier: false, timestamp: 0n },
      ];

      const baseReward = 2n + newCycle[0].rewardPoints;
      const finalReward = watchAd ? baseReward * 2n : baseReward;

      const updatedProfile: UserProfile = {
        ...userProfile,
        points: userProfile.points + finalReward,
        cycleCompletedCount: userProfile.cycleCompletedCount + 1n,
        dayCycle: [
          { ...newCycle[0], adMultiplier: watchAd, timestamp: BigInt(now) },
          ...newCycle.slice(1),
        ],
      };

      try {
        await saveProfile.mutateAsync(updatedProfile);
        toast.success(`簽到成功！獲得 ${finalReward} 積分${watchAd ? '（廣告加倍）' : ''}`);
        setShowAdOption(false);
      } catch (error) {
        toast.error('簽到失敗，請重試');
        console.error(error);
      }
      return;
    }

    if (currentDayIndex > 0) {
      const lastCheckIn = userProfile.dayCycle[currentDayIndex - 1].timestamp;
      const timeSinceLastCheckIn = BigInt(now) - lastCheckIn;

      if (timeSinceLastCheckIn < oneDayInNs) {
        toast.error('今天已經簽到過了！');
        return;
      }

      if (timeSinceLastCheckIn > oneDayInNs * 2n) {
        const newCycle = [
          { day: 1n, rewardPoints: 3n, adMultiplier: false, timestamp: 0n },
          { day: 2n, rewardPoints: 5n, adMultiplier: false, timestamp: 0n },
          { day: 3n, rewardPoints: 7n, adMultiplier: false, timestamp: 0n },
          { day: 4n, rewardPoints: 9n, adMultiplier: false, timestamp: 0n },
          { day: 5n, rewardPoints: 10n, adMultiplier: false, timestamp: 0n },
          { day: 6n, rewardPoints: 15n, adMultiplier: false, timestamp: 0n },
          { day: 7n, rewardPoints: 20n, adMultiplier: false, timestamp: 0n },
        ];

        const baseReward = 2n + newCycle[0].rewardPoints;
        const finalReward = watchAd ? baseReward * 2n : baseReward;

        const updatedProfile: UserProfile = {
          ...userProfile,
          points: userProfile.points + finalReward,
          dayCycle: [
            { ...newCycle[0], adMultiplier: watchAd, timestamp: BigInt(now) },
            ...newCycle.slice(1),
          ],
        };

        try {
          await saveProfile.mutateAsync(updatedProfile);
          toast.warning(`連續簽到中斷，重新開始！獲得 ${finalReward} 積分`);
          setShowAdOption(false);
        } catch (error) {
          toast.error('簽到失敗，請重試');
          console.error(error);
        }
        return;
      }
    }

    const currentDay = userProfile.dayCycle[currentDayIndex];
    const baseReward = 2n + currentDay.rewardPoints;
    const finalReward = watchAd ? baseReward * 2n : baseReward;

    const updatedCycle = [...userProfile.dayCycle];
    updatedCycle[currentDayIndex] = {
      ...currentDay,
      adMultiplier: watchAd,
      timestamp: BigInt(now),
    };

    const updatedProfile: UserProfile = {
      ...userProfile,
      points: userProfile.points + finalReward,
      dayCycle: updatedCycle,
    };

    try {
      await saveProfile.mutateAsync(updatedProfile);
      toast.success(`簽到成功！獲得 ${finalReward} 積分${watchAd ? '（廣告加倍）' : ''}`);
      setShowAdOption(false);
    } catch (error) {
      toast.error('簽到失敗，請重試');
      console.error(error);
    }
  };

  if (isLoading) {
    return (
      <div className="space-y-6">
        <Skeleton className="h-64 w-full" />
        <Skeleton className="h-96 w-full" />
      </div>
    );
  }

  if (!userProfile) return null;

  const completedDays = userProfile.dayCycle.filter((d) => d.timestamp !== 0n).length;
  const progress = (completedDays / 7) * 100;
  const currentDayIndex = userProfile.dayCycle.findIndex((d) => d.timestamp === 0n);
  const canCheckIn = currentDayIndex !== -1 || completedDays === 7;

  let alreadyCheckedInToday = false;
  if (currentDayIndex > 0) {
    const lastCheckIn = userProfile.dayCycle[currentDayIndex - 1].timestamp;
    const now = Date.now() * 1000000;
    const timeSinceLastCheckIn = BigInt(now) - lastCheckIn;
    const oneDayInNs = BigInt(24 * 60 * 60 * 1000 * 1000000);
    alreadyCheckedInToday = timeSinceLastCheckIn < oneDayInNs;
  }

  return (
    <div className="space-y-6 animate-fade-in max-w-4xl mx-auto">
      <Card className="bg-gradient-to-r from-emerald-800 to-green-700 border-amber-400/50 shadow-xl">
        <CardHeader>
          <div className="flex items-center gap-3">
            <Calendar className="h-10 w-10 text-amber-400" />
            <div>
              <CardTitle className="text-3xl text-amber-400 clover-glow">每日簽到</CardTitle>
              <CardDescription className="text-emerald-200 text-lg">
                連續簽到 7 天獲得豐厚獎勵
              </CardDescription>
            </div>
          </div>
        </CardHeader>
        <CardContent>
          <div className="space-y-2">
            <div className="flex justify-between text-emerald-200 text-sm">
              <span>進度</span>
              <span>{completedDays} / 7 天</span>
            </div>
            <Progress value={progress} className="h-3" />
          </div>
        </CardContent>
      </Card>

      <SoulCollaborationStatus compact />

      <Card className="bg-gradient-to-br from-amber-900/50 to-amber-800/50 border-amber-400/50 shadow-xl">
        <CardHeader>
          <div className="flex items-center gap-3">
            <img
              src="/assets/generated/glowing-clover-transparent.dim_150x150.png"
              alt="Glowing Clover"
              className="h-10 w-10 animate-pulse"
            />
            <div>
              <CardTitle className="text-2xl text-amber-400 clover-glow">每日幸運祝福</CardTitle>
              <CardDescription className="text-emerald-200">
                抽取今日專屬幸運籤文
              </CardDescription>
            </div>
          </div>
        </CardHeader>
        <CardContent className="space-y-4">
          {fortuneRecord ? (
            <div className="bg-emerald-950/50 rounded-lg p-6 border border-amber-400/30">
              <div className="flex items-center gap-2 mb-3">
                <Scroll className="h-5 w-5 text-amber-400" />
                <span className="text-amber-400 font-semibold">今日籤文</span>
              </div>
              <p className="text-xl text-emerald-100 leading-relaxed">
                {fortuneRecord.fortuneMessage.message}
              </p>
              <p className="text-emerald-300 text-sm mt-3">
                已於今日抽取 • 明日可再次抽取
              </p>
            </div>
          ) : (
            <Button
              onClick={handleDrawFortune}
              disabled={drawFortune.isPending}
              className="w-full bg-amber-500 hover:bg-amber-600 text-emerald-950 font-bold text-lg py-6"
            >
              {drawFortune.isPending ? (
                <>
                  <div className="h-5 w-5 animate-spin rounded-full border-2 border-emerald-950 border-t-transparent mr-2"></div>
                  抽取中...
                </>
              ) : (
                <>
                  <Scroll className="h-5 w-5 mr-2" />
                  抽取今日幸運籤
                </>
              )}
            </Button>
          )}
        </CardContent>
      </Card>

      <Card className="bg-emerald-900/50 border-amber-400/50">
        <CardHeader>
          <CardTitle className="text-2xl text-amber-400">簽到日曆</CardTitle>
        </CardHeader>
        <CardContent>
          <div className="grid grid-cols-7 gap-3">
            {userProfile.dayCycle.map((day, index) => {
              const isCompleted = day.timestamp !== 0n;
              const isCurrent = index === currentDayIndex;
              const baseReward = 2n + day.rewardPoints;

              return (
                <div
                  key={Number(day.day)}
                  className={`relative aspect-square rounded-lg border-2 p-3 flex flex-col items-center justify-center transition-all ${
                    isCompleted
                      ? 'bg-amber-400/20 border-amber-400 shadow-lg'
                      : isCurrent
                        ? 'bg-emerald-700/50 border-amber-400 animate-pulse'
                        : 'bg-emerald-950/50 border-emerald-700'
                  }`}
                >
                  {isCompleted && (
                    <div className="absolute -top-2 -right-2 bg-amber-400 rounded-full p-1">
                      <Check className="h-4 w-4 text-emerald-950" />
                    </div>
                  )}
                  <span className="text-emerald-200 text-xs mb-1">第 {Number(day.day)} 天</span>
                  <span className="text-amber-400 font-bold text-lg">+{Number(baseReward)}</span>
                  {day.adMultiplier && (
                    <Tv className="h-3 w-3 text-amber-400 mt-1" />
                  )}
                </div>
              );
            })}
          </div>
        </CardContent>
      </Card>

      <Card className="bg-emerald-900/50 border-amber-400/50">
        <CardContent className="pt-6">
          {!showAdOption ? (
            <div className="space-y-4">
              <Button
                onClick={() => setShowAdOption(true)}
                disabled={!canCheckIn || alreadyCheckedInToday || saveProfile.isPending}
                className="w-full bg-amber-500 hover:bg-amber-600 text-emerald-950 font-bold text-xl py-8"
              >
                {alreadyCheckedInToday ? (
                  '今天已簽到'
                ) : saveProfile.isPending ? (
                  <>
                    <div className="h-5 w-5 animate-spin rounded-full border-2 border-emerald-950 border-t-transparent mr-2"></div>
                    簽到中...
                  </>
                ) : (
                  <>
                    <Sparkles className="h-6 w-6 mr-2" />
                    立即簽到
                  </>
                )}
              </Button>
              {alreadyCheckedInToday && (
                <p className="text-center text-emerald-200 text-sm">請明天再來簽到！</p>
              )}
            </div>
          ) : (
            <div className="space-y-4">
              <p className="text-center text-amber-100 text-lg mb-4">選擇簽到方式</p>
              <div className="grid sm:grid-cols-2 gap-4">
                <Button
                  onClick={() => handleCheckIn(false)}
                  disabled={saveProfile.isPending}
                  className="bg-emerald-700 hover:bg-emerald-600 text-amber-100 font-bold py-8"
                >
                  <Sparkles className="h-5 w-5 mr-2" />
                  直接簽到
                </Button>
                <Button
                  onClick={() => handleCheckIn(true)}
                  disabled={saveProfile.isPending}
                  className="bg-amber-500 hover:bg-amber-600 text-emerald-950 font-bold py-8"
                >
                  <Tv className="h-5 w-5 mr-2" />
                  觀看廣告 2x
                </Button>
              </div>
              <Button
                onClick={() => setShowAdOption(false)}
                variant="ghost"
                className="w-full text-emerald-200"
              >
                取消
              </Button>
            </div>
          )}
        </CardContent>
      </Card>

      <Card className="bg-emerald-900/50 border-amber-400/50">
        <CardHeader>
          <CardTitle className="text-xl text-amber-400">簽到說明</CardTitle>
        </CardHeader>
        <CardContent className="space-y-2 text-emerald-200">
          <p>• 每日登入可獲得 2 積分基礎獎勵</p>
          <p>• 連續簽到可獲得額外獎勵（第 1 天 +3，第 7 天 +20）</p>
          <p>• 觀看廣告可獲得 2 倍獎勵</p>
          <p>• 中斷簽到將重置循環</p>
          <p>• 完成 7 天循環後可開始新的循環</p>
          <p>• 每日可抽取一次幸運籤，獲得專屬祝福</p>
          <p>• 幸運籤內容透過 Soul Collaboration 自動同步更新</p>
        </CardContent>
      </Card>

      <FortuneSlipModal
        open={showFortuneModal}
        onOpenChange={setShowFortuneModal}
        fortune={currentFortune}
      />
    </div>
  );
}
PK
frontend/src/pages/DualDomainSyncPage.tsximport { useState, useEffect, useCallback } from 'react';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { 
  RefreshCw, 
  AlertTriangle,
  ArrowLeftRight,
  Server,
  Shield,
  Activity,
  Database,
  Zap,
  Wifi,
  WifiOff,
  Layers
} from 'lucide-react';
import { toast } from 'sonner';
import { Skeleton } from '@/components/ui/skeleton';
import { useIsCallerAdmin, useGetSoulCollaborationSyncStatus } from '../hooks/useQueries';
import { useLFLCSync } from '../hooks/useLFLCSync';
import LFLCResponseViewer from '../components/LFLCResponseViewer';

export default function DualDomainSyncPage() {
  const { data: isAdmin, isLoading: isAdminLoading } = useIsCallerAdmin();
  const { data: soulCollaboration, isLoading: syncStatusLoading } = useGetSoulCollaborationSyncStatus();
  
  const {
    performLFLCSync,
    cancelSync,
    clearSyncHistory,
    isSyncing,
    lastSyncTime,
    syncError,
    retryCount,
    syncHistory,
  } = useLFLCSync({
    autoSync: true,
    syncInterval: 60000,
    maxRetries: 3,
    onSyncSuccess: (envelope) => {
      console.log('✅ LFLC同步成功:', envelope.trace_id);
    },
    onSyncError: (error) => {
      console.error('❌ LFLC同步失敗:', error);
    },
  });
  
  const [networkStatus, setNetworkStatus] = useState<'online' | 'offline'>('online');
  const [autoSyncEnabled, setAutoSyncEnabled] = useState(true);

  const LIFE_DOMAIN = 'https://lflcei.life';
  const TODAY_DOMAIN = 'https://lflcei.today';

  // 網路狀態監控
  useEffect(() => {
    const handleOnline = () => {
      setNetworkStatus('online');
      toast.success('網路已恢復', {
        description: 'LFLC統一響應同步將繼續執行',
      });
    };

    const handleOffline = () => {
      setNetworkStatus('offline');
      toast.error('網路連接中斷', {
        description: '同步已暫停，將在網路恢復後自動重試',
      });
    };

    window.addEventListener('online', handleOnline);
    window.addEventListener('offline', handleOffline);

    return () => {
      window.removeEventListener('online', handleOnline);
      window.removeEventListener('offline', handleOffline);
    };
  }, []);

  const handleManualSync = async (direction: 'send' | 'receive' | 'bidirectional') => {
    if (networkStatus === 'offline') {
      toast.error('網路連接中斷', {
        description: '請檢查網路連接後重試',
      });
      return;
    }

    try {
      const syncData = {
        timestamp: Date.now(),
        direction,
        source: LIFE_DOMAIN,
        target: TODAY_DOMAIN,
        userAction: 'manual_sync',
      };

      await performLFLCSync(syncData, direction);

      toast.success('LFLC統一響應同步完成！', {
        description: `${direction === 'bidirectional' ? '雙向' : direction === 'send' ? '發送' : '接收'}同步已成功執行`,
      });
    } catch (error) {
      console.error('Manual sync failed:', error);
    }
  };

  const toggleAutoSync = () => {
    setAutoSyncEnabled(prev => {
      const newState = !prev;
      toast.info(newState ? '自動同步已啟用' : '自動同步已停用', {
        description: newState ? 'LFLC統一響應系統將每60秒自動同步一次' : '請使用手動同步按鈕',
      });
      return newState;
    });
  };

  const formatTimestamp = (timestamp: number) => {
    if (!timestamp) return '尚未同步';
    const date = new Date(timestamp);
    return date.toLocaleString('zh-TW', {
      year: 'numeric',
      month: '2-digit',
      day: '2-digit',
      hour: '2-digit',
      minute: '2-digit',
      second: '2-digit',
    });
  };

  if (isAdminLoading || syncStatusLoading) {
    return (
      <div className="space-y-6 max-w-7xl mx-auto p-6">
        <Skeleton className="h-48 w-full" />
        <Skeleton className="h-96 w-full" />
      </div>
    );
  }

  if (!isAdmin) {
    return (
      <div className="flex items-center justify-center min-h-[60vh]">
        <Card className="bg-red-900/50 border-red-400/50 max-w-md">
          <CardHeader>
            <div className="flex items-center gap-3">
              <AlertTriangle className="h-8 w-8 text-red-400" />
              <CardTitle className="text-2xl text-red-400">未授權</CardTitle>
            </div>
          </CardHeader>
          <CardContent>
            <p className="text-red-200">
              您沒有權限存取此頁面。雙域同步管理僅限管理員使用。
            </p>
          </CardContent>
        </Card>
      </div>
    );
  }

  return (
    <div className="space-y-6 animate-fade-in max-w-7xl mx-auto p-6">
      <Card className="bg-gradient-to-r from-blue-900/50 to-purple-900/50 border-cyan-400/50 shadow-xl">
        <CardHeader>
          <div className="flex items-center justify-between flex-wrap gap-4">
            <div className="flex items-center gap-3">
              <img
                src="/assets/generated/dual-end-integration-overview.dim_1200x800.png"
                alt="Dual Domain Sync"
                className="h-16 w-16 rounded-lg border-2 border-cyan-400"
              />
              <div>
                <CardTitle className="text-3xl text-cyan-400 clover-glow">
                  LFLC 雙端整合即時同步系統
                </CardTitle>
                <CardDescription className="text-cyan-200 text-lg mt-1">
                  統一響應接口標準 · 持久化追蹤 · GPU渲染視覺化
                </CardDescription>
              </div>
            </div>
            <div className="flex items-center gap-3">
              <Badge className={networkStatus === 'online' ? 'bg-green-500/20 text-green-400 border-green-400/50' : 'bg-red-500/20 text-red-400 border-red-400/50'}>
                {networkStatus === 'online' ? (
                  <>
                    <Wifi className="h-3 w-3 mr-1" />
                    網路正常
                  </>
                ) : (
                  <>
                    <WifiOff className="h-3 w-3 mr-1" />
                    網路中斷
                  </>
                )}
              </Badge>
              <Button
                onClick={toggleAutoSync}
                variant={autoSyncEnabled ? 'default' : 'outline'}
                size="sm"
                className={autoSyncEnabled ? 'bg-green-500 hover:bg-green-600' : ''}
              >
                {autoSyncEnabled ? (
                  <>
                    <Activity className="h-4 w-4 mr-2 animate-pulse" />
                    自動同步啟用
                  </>
                ) : (
                  <>
                    <Activity className="h-4 w-4 mr-2" />
                    自動同步停用
                  </>
                )}
              </Button>
            </div>
          </div>
        </CardHeader>
      </Card>

      <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
        <Card className="bg-blue-900/50 border-blue-400/50">
          <CardHeader>
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-2">
                <Server className="h-5 w-5 text-blue-400" />
                <CardTitle className="text-xl text-blue-400">{LIFE_DOMAIN}</CardTitle>
              </div>
              <Badge className="bg-green-500/20 text-green-400 border-green-400/50">
                <Activity className="h-3 w-3 mr-1 animate-pulse" />
                前端發送端
              </Badge>
            </div>
            <CardDescription className="text-blue-200">LFLC統一響應發送節點</CardDescription>
          </CardHeader>
          <CardContent className="space-y-3">
            <div className="bg-blue-950/50 rounded-lg p-3 border border-blue-400/30">
              <div className="flex items-center justify-between mb-2">
                <span className="text-blue-200 text-sm">最後同步</span>
                <span className="text-blue-400 text-xs">{formatTimestamp(lastSyncTime)}</span>
              </div>
              <div className="flex items-center justify-between">
                <span className="text-blue-200 text-sm">同步記錄</span>
                <span className="text-blue-400 text-xs">{syncHistory.length} 條</span>
              </div>
            </div>
            <div className="grid grid-cols-2 gap-2">
              <div className="bg-green-950/50 rounded p-2 border border-green-400/30 text-center">
                <div className="text-green-400 font-bold text-lg">
                  {syncHistory.filter(e => e.status_code >= 200 && e.status_code < 300).length}
                </div>
                <div className="text-green-200 text-xs">成功</div>
              </div>
              <div className="bg-red-950/50 rounded p-2 border border-red-400/30 text-center">
                <div className="text-red-400 font-bold text-lg">
                  {syncHistory.filter(e => e.status_code >= 400).length}
                </div>
                <div className="text-red-200 text-xs">失敗</div>
              </div>
            </div>
            {retryCount > 0 && (
              <div className="bg-amber-950/50 rounded p-2 border border-amber-400/30 text-center">
                <div className="text-amber-400 text-sm">重試次數: {retryCount}/3</div>
              </div>
            )}
          </CardContent>
        </Card>

        <Card className="bg-purple-900/50 border-purple-400/50">
          <CardHeader>
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-2">
                <Database className="h-5 w-5 text-purple-400" />
                <CardTitle className="text-xl text-purple-400">{TODAY_DOMAIN}</CardTitle>
              </div>
              <Badge className="bg-green-500/20 text-green-400 border-green-400/50">
                <Activity className="h-3 w-3 mr-1 animate-pulse" />
                後端接收端
              </Badge>
            </div>
            <CardDescription className="text-purple-200">LFLC統一響應接收節點</CardDescription>
          </CardHeader>
          <CardContent className="space-y-3">
            <div className="bg-purple-950/50 rounded-lg p-3 border border-purple-400/30">
              <div className="flex items-center justify-between mb-2">
                <span className="text-purple-200 text-sm">後端狀態</span>
                <span className="text-purple-400 text-xs">{soulCollaboration?.lastSyncStatus || '待機'}</span>
              </div>
              <div className="flex items-center justify-between">
                <span className="text-purple-200 text-sm">同步日誌</span>
                <span className="text-purple-400 text-xs">{soulCollaboration?.syncLogs.length || 0} 條</span>
              </div>
            </div>
            <div className="bg-purple-950/50 rounded-lg p-3 border border-purple-400/30">
              <div className="flex items-center gap-2 mb-2">
                <Layers className="h-4 w-4 text-purple-400" />
                <span className="text-purple-200 text-sm font-semibold">LFLC響應封裝</span>
              </div>
              <div className="space-y-1 text-xs">
                <div className="flex items-center justify-between">
                  <span className="text-purple-300">Trace ID 追蹤</span>
                  <span className="text-green-400">● 啟用</span>
                </div>
                <div className="flex items-center justify-between">
                  <span className="text-purple-300">時間戳管理</span>
                  <span className="text-green-400">● 啟用</span>
                </div>
                <div className="flex items-center justify-between">
                  <span className="text-purple-300">完整性驗證</span>
                  <span className="text-green-400">● 啟用</span>
                </div>
                <div className="flex items-center justify-between">
                  <span className="text-purple-300">GPU渲染提示</span>
                  <span className="text-green-400">● 啟用</span>
                </div>
              </div>
            </div>
          </CardContent>
        </Card>
      </div>

      <Card className="bg-emerald-900/50 border-cyan-400/50">
        <CardHeader>
          <CardTitle className="text-xl text-cyan-400 flex items-center gap-2">
            <Zap className="h-5 w-5" />
            LFLC 統一響應同步控制
          </CardTitle>
          <CardDescription className="text-cyan-200">
            基於 LFLC_Response_Envelope 標準的雙向數據同步（自動同步每60秒執行一次）
          </CardDescription>
        </CardHeader>
        <CardContent>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
            <Button
              onClick={() => handleManualSync('send')}
              disabled={isSyncing || networkStatus === 'offline'}
              className="bg-blue-500 hover:bg-blue-600 active:bg-blue-700 text-white transition-all transform hover:scale-[1.02] active:scale-[0.98] h-auto py-4 disabled:opacity-50 disabled:cursor-not-allowed"
            >
              <div className="flex flex-col items-center gap-2">
                <div className="flex items-center gap-2">
                  <Server className="h-5 w-5" />
                  <ArrowLeftRight className="h-4 w-4" />
                </div>
                <span className="font-semibold">發送至 today</span>
              </div>
            </Button>

            <Button
              onClick={() => handleManualSync('bidirectional')}
              disabled={isSyncing || networkStatus === 'offline'}
              className="bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 active:from-blue-700 active:to-purple-700 text-white transition-all transform hover:scale-[1.02] active:scale-[0.98] h-auto py-4 disabled:opacity-50 disabled:cursor-not-allowed"
            >
              <div className="flex flex-col items-center gap-2">
                {isSyncing ? (
                  <>
                    <div className="h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent" />
                    <span className="font-semibold">同步中...</span>
                  </>
                ) : (
                  <>
                    <ArrowLeftRight className="h-5 w-5" />
                    <span className="font-semibold">雙向同步</span>
                  </>
                )}
              </div>
            </Button>

            <Button
              onClick={() => handleManualSync('receive')}
              disabled={isSyncing || networkStatus === 'offline'}
              className="bg-purple-500 hover:bg-purple-600 active:bg-purple-700 text-white transition-all transform hover:scale-[1.02] active:scale-[0.98] h-auto py-4 disabled:opacity-50 disabled:cursor-not-allowed"
            >
              <div className="flex flex-col items-center gap-2">
                <div className="flex items-center gap-2">
                  <ArrowLeftRight className="h-4 w-4" />
                  <Database className="h-5 w-5" />
                </div>
                <span className="font-semibold">接收自 life</span>
              </div>
            </Button>
          </div>

          {isSyncing && (
            <div className="mt-4">
              <Button
                onClick={cancelSync}
                variant="outline"
                className="w-full border-red-400/50 text-red-400 hover:bg-red-400/10"
              >
                取消同步
              </Button>
            </div>
          )}
        </CardContent>
      </Card>

      <Tabs defaultValue="viewer" className="w-full">
        <TabsList className="grid w-full grid-cols-2 bg-cyan-950/50">
          <TabsTrigger value="viewer">響應封裝視覺化</TabsTrigger>
          <TabsTrigger value="architecture">系統架構</TabsTrigger>
        </TabsList>
        <TabsContent value="viewer" className="mt-4">
          <LFLCResponseViewer 
            syncHistory={syncHistory}
            onClearHistory={clearSyncHistory}
          />
        </TabsContent>
        <TabsContent value="architecture" className="mt-4">
          <Card className="bg-gradient-to-r from-indigo-950/90 to-violet-950/90 border-indigo-400/50">
            <CardHeader>
              <CardTitle className="text-2xl text-indigo-400">LFLC 統一響應接口架構</CardTitle>
              <CardDescription className="text-indigo-200">
                完整的雙端整合通信框架與GPU渲染優化
              </CardDescription>
            </CardHeader>
            <CardContent className="space-y-4">
              <img
                src="/assets/generated/cross-domain-api-architecture.dim_1000x600.png"
                alt="Cross Domain API Architecture"
                className="w-full rounded-lg border-2 border-indigo-400/50"
              />
              <img
                src="/assets/generated/gpu-sync-dashboard-interface.dim_1200x800.png"
                alt="GPU Sync Dashboard"
                className="w-full rounded-lg border-2 border-indigo-400/50"
              />
              <img
                src="/assets/generated/auto-ui-update-system-transparent.dim_600x400.png"
                alt="Auto UI Update System"
                className="w-full rounded-lg border-2 border-indigo-400/50 bg-indigo-950/30"
              />
              <img
                src="/assets/generated/transmission-recovery-mechanism.dim_800x600.png"
                alt="Transmission Recovery"
                className="w-full rounded-lg border-2 border-indigo-400/50"
              />
            </CardContent>
          </Card>
        </TabsContent>
      </Tabs>

      <Alert className="bg-cyan-900/50 border-cyan-400/50">
        <Shield className="h-4 w-4 text-cyan-400" />
        <AlertTitle className="text-cyan-400">LFLC 統一響應接口標準</AlertTitle>
        <AlertDescription className="text-cyan-200">
          所有同步通信使用 LFLC_Response_Envelope&lt;T&gt; 統一封裝格式，包含持久化 trace_id、時間戳、壓縮方法管理、渲染提示和同步元數據。系統自動執行完整性驗證、重試邏輯（最多3次）與傳輸失敗自動恢復，確保數據一致性。GPU渲染視覺化儀表板提供即時同步狀態監控與自動UI更新觸發機制。
        </AlertDescription>
      </Alert>
    </div>
  );
}
PK
frontend/src/pages/GachaPage.tsximport { useState, Suspense } from 'react';
import { useGetCallerUserProfile, useSaveCallerUserProfile } from '../hooks/useQueries';
import { useAddEcosystemEnergy } from '../hooks/useEcosystemHub';
import { useUpdateAnimaScore, useAnimaConnectionStatus } from '../hooks/useAnimaBackend';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Gift, Sparkles, Tv, Trophy, Loader2, AlertCircle, CheckCircle2 } from 'lucide-react';
import { toast } from 'sonner';
import { Skeleton } from '@/components/ui/skeleton';
import type { UserProfile, Reward, RewardType } from '../backend';

const GACHA_COST = 1000n;

const rewards: Reward[] = [
  { name: '1000 積分', rewardPoints: 1000n, rewardType: 'common' as RewardType, probability: 0.6 },
  { name: '2000 積分', rewardPoints: 2000n, rewardType: 'rare' as RewardType, probability: 0.25 },
  { name: '5000 積分', rewardPoints: 5000n, rewardType: 'epic' as RewardType, probability: 0.14 },
  { name: '鑽石幸運草', rewardPoints: 10000n, rewardType: 'legendary' as RewardType, probability: 0.01 },
];

const rewardTypeColors = {
  common: 'text-gray-400',
  rare: 'text-blue-400',
  epic: 'text-purple-400',
  legendary: 'text-amber-400',
};

const rewardTypeBg = {
  common: 'bg-gray-400/20 border-gray-400',
  rare: 'bg-blue-400/20 border-blue-400',
  epic: 'bg-purple-400/20 border-purple-400',
  legendary: 'bg-amber-400/20 border-amber-400',
};

function AnimaStatusIndicator() {
  const animaStatus = useAnimaConnectionStatus();

  if (animaStatus.isInitializing) {
    return (
      <div className="flex items-center gap-2 text-xs text-purple-300 bg-purple-900/30 px-3 py-1.5 rounded-full border border-purple-400/30">
        <Loader2 className="h-3 w-3 animate-spin" />
        <span>Anima 初始化中...</span>
      </div>
    );
  }

  if (animaStatus.error) {
    return (
      <div className="flex items-center gap-2 text-xs text-amber-300 bg-amber-900/30 px-3 py-1.5 rounded-full border border-amber-400/30">
        <AlertCircle className="h-3 w-3" />
        <span>Anima 待機模式</span>
      </div>
    );
  }

  if (animaStatus.isReady) {
    return (
      <div className="flex items-center gap-2 text-xs text-green-300 bg-green-900/30 px-3 py-1.5 rounded-full border border-green-400/30">
        <CheckCircle2 className="h-3 w-3" />
        <span>Anima 已就緒</span>
      </div>
    );
  }

  return null;
}

export default function GachaPage() {
  const { data: userProfile, isLoading } = useGetCallerUserProfile();
  const saveProfile = useSaveCallerUserProfile();
  const addEcosystemEnergy = useAddEcosystemEnergy();
  const updateAnimaScore = useUpdateAnimaScore();
  const [isRolling, setIsRolling] = useState(false);
  const [showResult, setShowResult] = useState(false);
  const [currentReward, setCurrentReward] = useState<Reward | null>(null);
  const [showAdOption, setShowAdOption] = useState(false);

  const rollGacha = (watchAd: boolean) => {
    if (!userProfile) return;

    if (userProfile.points < GACHA_COST) {
      toast.error('積分不足！需要 1000 積分');
      return;
    }

    setIsRolling(true);
    setShowAdOption(false);

    // Simulate rolling animation
    setTimeout(async () => {
      const randomNum = Math.random() * 100;
      let selectedReward: Reward;

      if (randomNum < 1) {
        selectedReward = rewards[3]; // Legendary
      } else if (randomNum < 15) {
        selectedReward = rewards[2]; // Epic
      } else if (randomNum < 40) {
        selectedReward = rewards[1]; // Rare
      } else {
        selectedReward = rewards[0]; // Common
      }

      setCurrentReward(selectedReward);

      // Calculate points based on reward
      const pointsGained = watchAd ? selectedReward.rewardPoints * 2n : selectedReward.rewardPoints;

      const now = Date.now() * 1000000;
      const newRewardHistory = [
        ...userProfile.rewardHistory,
        {
          id: BigInt(userProfile.rewardHistory.length),
          reward: selectedReward,
          timestamp: BigInt(now),
        },
      ];

      const updatedProfile: UserProfile = {
        ...userProfile,
        points: userProfile.points - GACHA_COST + pointsGained,
        rewardHistory: newRewardHistory,
      };

      try {
        await saveProfile.mutateAsync(updatedProfile);
        
        // Trigger backend integrations asynchronously (non-blocking)
        // Use requestAnimationFrame for smooth UI updates
        requestAnimationFrame(() => {
          // 1. Add energy to Backend Ecosystem Hub
          addEcosystemEnergy.mutate(100n);
          
          // 2. Update score in LFLCEI Anima backend
          updateAnimaScore.mutate(100n);
        });
        
        setIsRolling(false);
        setShowResult(true);
        
        // Use requestAnimationFrame for toast notification
        requestAnimationFrame(() => {
          toast.success(`恭喜獲得：${selectedReward.name}${watchAd ? '（廣告加倍）' : ''}`, {
            description: '生態系統能量 +100 • Anima 分數 +100',
          });
        });
      } catch (error) {
        toast.error('抽獎失敗，請重試');
        console.error(error);
        setIsRolling(false);
      }
    }, 2000);
  };

  const handleRoll = () => {
    setShowAdOption(true);
  };

  const closeResult = () => {
    setShowResult(false);
    setCurrentReward(null);
  };

  if (isLoading) {
    return (
      <div className="space-y-6">
        <Skeleton className="h-64 w-full" />
        <Skeleton className="h-96 w-full" />
      </div>
    );
  }

  if (!userProfile) return null;

  const canRoll = userProfile.points >= GACHA_COST;
  const rollsAvailable = Math.floor(Number(userProfile.points) / Number(GACHA_COST));

  return (
    <div className="space-y-6 animate-fade-in max-w-4xl mx-auto">
      {/* Header */}
      <Card className="bg-gradient-to-r from-emerald-800 to-green-700 border-amber-400/50 shadow-xl">
        <CardHeader>
          <div className="flex items-center justify-between flex-wrap gap-3">
            <div className="flex items-center gap-3 flex-1">
              <Gift className="h-10 w-10 text-amber-400" />
              <div>
                <CardTitle className="text-3xl text-amber-400 clover-glow">抽盲盒</CardTitle>
                <CardDescription className="text-emerald-200 text-lg">
                  使用 1000 積分抽取幸運盲盒 • 獲勝時自動同步雙後端能量
                </CardDescription>
              </div>
            </div>
            <div className="flex flex-col items-end gap-2">
              <div className="text-right hidden sm:block">
                <p className="text-emerald-200 text-sm">可抽取次數</p>
                <p className="text-3xl font-bold text-amber-400">{rollsAvailable}</p>
              </div>
              <Suspense fallback={
                <div className="flex items-center gap-2 text-xs text-gray-400 bg-gray-900/30 px-3 py-1.5 rounded-full border border-gray-400/30">
                  <Loader2 className="h-3 w-3 animate-spin" />
                  <span>載入中...</span>
                </div>
              }>
                <AnimaStatusIndicator />
              </Suspense>
            </div>
          </div>
        </CardHeader>
      </Card>

      {/* Gacha Machine */}
      <Card className="bg-emerald-900/50 border-amber-400/50">
        <CardContent className="pt-6">
          <div className="flex flex-col items-center justify-center space-y-6 py-8">
            {isRolling ? (
              <div className="relative">
                <img
                  src="/assets/generated/gift-box-icon.dim_200x200.png"
                  alt="Gift Box"
                  className="h-48 w-48 animate-bounce"
                />
                <div className="absolute inset-0 flex items-center justify-center">
                  <Sparkles className="h-24 w-24 text-amber-400 animate-spin" />
                </div>
              </div>
            ) : showResult && currentReward ? (
              <div className="text-center space-y-4">
                <Trophy className={`h-32 w-32 mx-auto ${rewardTypeColors[currentReward.rewardType]}`} />
                <h3 className="text-3xl font-bold text-amber-400">{currentReward.name}</h3>
                <p className={`text-xl ${rewardTypeColors[currentReward.rewardType]}`}>
                  {currentReward.rewardType === 'legendary' && '傳說'}
                  {currentReward.rewardType === 'epic' && '史詩'}
                  {currentReward.rewardType === 'rare' && '稀有'}
                  {currentReward.rewardType === 'common' && '普通'}
                </p>
                <div className="space-y-2 mt-4">
                  <div className="bg-cyan-900/30 rounded-lg p-3 border border-cyan-400/30">
                    <p className="text-cyan-300 text-sm">生態系統能量已更新</p>
                    <p className="text-cyan-400 font-bold">+100 能量</p>
                  </div>
                  <div className="bg-purple-900/30 rounded-lg p-3 border border-purple-400/30">
                    <p className="text-purple-300 text-sm">Anima 分數已更新</p>
                    <p className="text-purple-400 font-bold">+100 分數</p>
                  </div>
                </div>
                <Button
                  onClick={closeResult}
                  className="bg-amber-500 hover:bg-amber-600 text-emerald-950 font-bold mt-4"
                >
                  確定
                </Button>
              </div>
            ) : (
              <>
                <img
                  src="/assets/generated/gift-box-icon.dim_200x200.png"
                  alt="Gift Box"
                  className="h-48 w-48"
                />
                {!showAdOption ? (
                  <Button
                    onClick={handleRoll}
                    disabled={!canRoll || saveProfile.isPending}
                    className="bg-amber-500 hover:bg-amber-600 text-emerald-950 font-bold text-xl py-8 px-12"
                  >
                    {!canRoll ? (
                      '積分不足'
                    ) : (
                      <>
                        <Gift className="h-6 w-6 mr-2" />
                        抽取盲盒 (-1000)
                      </>
                    )}
                  </Button>
                ) : (
                  <div className="space-y-4 w-full max-w-md">
                    <p className="text-center text-amber-100 text-lg mb-4">選擇抽獎方式</p>
                    <div className="grid sm:grid-cols-2 gap-4">
                      <Button
                        onClick={() => rollGacha(false)}
                        disabled={saveProfile.isPending}
                        className="bg-emerald-700 hover:bg-emerald-600 text-amber-100 font-bold py-8"
                      >
                        <Gift className="h-5 w-5 mr-2" />
                        直接抽取
                      </Button>
                      <Button
                        onClick={() => rollGacha(true)}
                        disabled={saveProfile.isPending}
                        className="bg-amber-500 hover:bg-amber-600 text-emerald-950 font-bold py-8"
                      >
                        <Tv className="h-5 w-5 mr-2" />
                        觀看廣告 2x
                      </Button>
                    </div>
                    <Button
                      onClick={() => setShowAdOption(false)}
                      variant="ghost"
                      className="w-full text-emerald-200"
                    >
                      取消
                    </Button>
                  </div>
                )}
              </>
            )}
          </div>
        </CardContent>
      </Card>

      {/* Probability Table */}
      <Card className="bg-emerald-900/50 border-amber-400/50">
        <CardHeader>
          <CardTitle className="text-2xl text-amber-400">獎品機率</CardTitle>
        </CardHeader>
        <CardContent>
          <div className="space-y-3">
            {rewards.map((reward) => (
              <div
                key={reward.name}
                className={`flex items-center justify-between p-4 rounded-lg border-2 ${rewardTypeBg[reward.rewardType]}`}
              >
                <div className="flex items-center gap-3">
                  <Trophy className={`h-6 w-6 ${rewardTypeColors[reward.rewardType]}`} />
                  <div>
                    <p className={`font-semibold ${rewardTypeColors[reward.rewardType]}`}>
                      {reward.name}
                    </p>
                    <p className="text-emerald-200 text-sm">
                      {reward.rewardType === 'legendary' && '傳說'}
                      {reward.rewardType === 'epic' && '史詩'}
                      {reward.rewardType === 'rare' && '稀有'}
                      {reward.rewardType === 'common' && '普通'}
                    </p>
                  </div>
                </div>
                <span className="text-amber-400 font-bold">{(reward.probability * 100).toFixed(0)}%</span>
              </div>
            ))}
          </div>
        </CardContent>
      </Card>

      {/* Info */}
      <Card className="bg-emerald-900/50 border-amber-400/50">
        <CardHeader>
          <CardTitle className="text-xl text-amber-400">抽獎說明</CardTitle>
        </CardHeader>
        <CardContent className="space-y-2 text-emerald-200">
          <p>• 每次抽獎消耗 1000 積分</p>
          <p>• 觀看廣告可獲得 2 倍獎勵（僅限積分獎品）</p>
          <p>• 傳說獎品機率 1%，史詩 14%，稀有 25%，普通 60%</p>
          <p>• 所有抽獎記錄將保存在個人資訊中</p>
          <p className="text-cyan-400 font-semibold">• 每次獲勝自動添加 100 能量到生態系統中心</p>
          <p className="text-purple-400 font-semibold">• 每次獲勝自動更新 100 分數到 LFLCEI Anima 後端</p>
          <p className="text-amber-300 text-sm mt-3">
            ⚡ 雙後端整合：Backend Ecosystem Hub + LFLCEI Anima 同步能量系統
          </p>
        </CardContent>
      </Card>
    </div>
  );
}
PK
frontend/src/pages/HomePage.tsximport { useState, memo, useCallback } from 'react';
import { useGetCallerUserProfile, useIsCallerAdmin, useDrawDailyFortune, useGetUserFortuneRecord } from '../hooks/useQueries';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Calendar, Gift, User, Sparkles, TrendingUp, ExternalLink, Shield, Scroll, Star, Globe, Layers, Zap, Wallet, Database, BarChart3, Network, Cpu } from 'lucide-react';
import { Skeleton } from '@/components/ui/skeleton';
import { toast } from 'sonner';
import FortuneSlipModal from '../components/FortuneSlipModal';
import AdvisoryPortalIntegration from '../components/AdvisoryPortalIntegration';
import LFLCEINaturalIntelligenceIntegration from '../components/LFLCEINaturalIntelligenceIntegration';
import SoulCollaborationStatus from '../components/SoulCollaborationStatus';
import SupportDeveloperButton from '../components/SupportDeveloperButton';
import LFLCEISupportAscension from '../components/LFLCEISupportAscension';
import RealityConnectionModule from '../components/RealityConnectionModule';
import TotalEcosystemEnergy from '../components/TotalEcosystemEnergy';
import EcosystemSyncDashboard from '../components/EcosystemSyncDashboard';
import UnifiedDashboard from '../components/UnifiedDashboard';

type Page = 'home' | 'checkin' | 'gacha' | 'profile' | 'admin' | 'newborn-entrance' | 'metaverse-ascension' | 'reality-connection' | 'nine-realms-hub' | 'realm';

interface HomePageProps {
  onNavigate: (page: Page) => void;
}

interface ExternalLink {
  name: string;
  description: string;
  url: string;
  icon: string;
  adminOnly?: boolean;
}

const publicExternalLinks: ExternalLink[] = [
  {
    name: 'LFLC Integration Platform Dashboard',
    description: '整合平台控制中心',
    url: 'https://lflc-backstage-supporter-ixz.caffeine.xyz/',
    icon: '/assets/generated/dashboard-icon-transparent.dim_64x64.png',
  },
  {
    name: 'LFLC Clicker Games',
    description: '幸運草點擊遊戲',
    url: 'https://lflc-firewall-525.caffeine.xyz/',
    icon: '/assets/IMG_8868.jpeg',
  },
  {
    name: 'LFLC Wallet',
    description: '數位錢包管理系統',
    url: 'https://lflc-wallet-mm9.caffeine.xyz/',
    icon: '/assets/generated/wallet-icon-transparent.dim_64x64.png',
  },
  {
    name: 'Gacha Airdrop',
    description: '幸運空投抽獎系統',
    url: 'https://lflc-gacha-airdrop-qbp.caffeine.xyz/',
    icon: '/assets/generated/gacha-airdrop-icon-transparent.dim_64x64.png',
  },
  {
    name: 'LFLCEI Anima 元宇宙入口',
    description: '沉浸式元宇宙體驗入口',
    url: 'https://lflcei-anima-t5m.caffeine.xyz/',
    icon: '/assets/generated/lflcei-anima-icon-transparent.dim_64x64.png',
  },
];

const adminExternalLinks: ExternalLink[] = [
  {
    name: 'LFLC 數據庫',
    description: '去中心化數據管理平台',
    url: '#',
    icon: '/assets/generated/database-icon-transparent.dim_64x64.png',
    adminOnly: true,
  },
  {
    name: 'LFLC 防火牆',
    description: '白名單管理與通知系統',
    url: '#',
    icon: '/assets/generated/firewall-icon-transparent.dim_64x64.png',
    adminOnly: true,
  },
  {
    name: 'LFLC AI 控制室',
    description: '後端控制室規格文件',
    url: '#',
    icon: '/assets/generated/ai-control-icon-transparent.dim_64x64.png',
    adminOnly: true,
  },
  {
    name: 'LFLC Network Nervous System（中樞神經元）',
    description: '網路中樞神經系統',
    url: 'https://lflc-network-nervous-system-dqx.caffeine.xyz/',
    icon: '/assets/generated/nervous-system-icon-transparent.dim_64x64.png',
    adminOnly: true,
  },
];

function HomePage({ onNavigate }: HomePageProps) {
  const { data: userProfile, isLoading } = useGetCallerUserProfile();
  const { data: isAdmin } = useIsCallerAdmin();
  const { data: fortuneRecord } = useGetUserFortuneRecord();
  const drawFortune = useDrawDailyFortune();
  const [showFortuneModal, setShowFortuneModal] = useState(false);
  const [currentFortune, setCurrentFortune] = useState<any>(null);
  const [loadingLinks, setLoadingLinks] = useState<Record<string, boolean>>({});

  const handleDrawFortune = useCallback(async () => {
    try {
      const fortune = await drawFortune.mutateAsync();
      setCurrentFortune(fortune);
      setShowFortuneModal(true);
      toast.success('已抽取今日幸運籤！');
    } catch (error: any) {
      console.error('Draw fortune error:', error);
      toast.error('抽取幸運籤失敗');
    }
  }, [drawFortune]);

  const handleExternalLinkClick = useCallback(async (url: string, linkName: string) => {
    if (url === '#') {
      toast.info('此功能即將推出');
      return;
    }

    setLoadingLinks(prev => ({ ...prev, [linkName]: true }));

    try {
      const newWindow = window.open(url, '_blank', 'noopener,noreferrer');
      
      if (!newWindow || newWindow.closed || typeof newWindow.closed === 'undefined') {
        toast.error('彈出視窗被阻擋，請允許彈出視窗後重試');
        setLoadingLinks(prev => ({ ...prev, [linkName]: false }));
        return;
      }

      newWindow.focus();
      toast.success(`正在開啟 ${linkName}...`);
      
      setTimeout(() => {
        setLoadingLinks(prev => ({ ...prev, [linkName]: false }));
      }, 800);
    } catch (error) {
      console.error('Error opening link:', error);
      toast.error('開啟連結失敗，請稍後再試');
      setLoadingLinks(prev => ({ ...prev, [linkName]: false }));
    }
  }, []);

  const handleFortuneGenerated = useCallback((fortune: string) => {
    console.log('Generated fortune from LFLCEI:', fortune);
  }, []);

  if (isLoading) {
    return (
      <div className="space-y-6 animate-fade-in">
        <Skeleton className="h-48 w-full rounded-xl" />
        <div className="grid md:grid-cols-3 gap-6">
          <Skeleton className="h-64 rounded-xl" />
          <Skeleton className="h-64 rounded-xl" />
          <Skeleton className="h-64 rounded-xl" />
        </div>
      </div>
    );
  }

  const currentDay = userProfile?.dayCycle.find((d) => d.timestamp === 0n);
  const completedDays = userProfile?.dayCycle.filter((d) => d.timestamp !== 0n).length || 0;

  const externalLinks = isAdmin ? [...publicExternalLinks, ...adminExternalLinks] : publicExternalLinks;
  const isRegisteredUser = !!userProfile;

  return (
    <div className="space-y-6 sm:space-y-8 animate-fade-in">
      {/* Unified System Architecture Banner */}
      <Card className="bg-gradient-to-br from-cyan-900/50 via-blue-900/50 to-indigo-900/50 border-cyan-400/50 shadow-2xl card-transition hover:shadow-cyan-400/30 overflow-hidden relative">
        <div className="absolute inset-0 opacity-20 pointer-events-none">
          <div className="absolute inset-0 bg-[url('/assets/generated/unified-system-architecture-diagram.dim_1200x800.png')] bg-cover bg-center animate-pulse-slow"></div>
          <div className="absolute inset-0 bg-gradient-to-br from-cyan-400/10 via-transparent to-blue-400/10 animate-spiritual-aura-flow"></div>
        </div>
        
        <CardHeader className="relative z-10">
          <div className="flex items-center justify-between flex-wrap gap-4">
            <div className="flex-1">
              <CardTitle className="text-2xl sm:text-3xl md:text-4xl text-cyan-400 manifestation-glow mb-2 animate-enhanced-glow-transition">
                統一系統架構 • Unified System Architecture
              </CardTitle>
              <CardDescription className="text-cyan-200 text-base sm:text-lg">
                中央通信樞紐 • 即時自動數據同步 • ICP 反向燃料模型
              </CardDescription>
            </div>
            <img
              src="/assets/generated/central-communication-hub-3d.dim_800x600.png"
              alt="Central Hub"
              className="h-16 w-16 sm:h-20 sm:w-20 rounded-full border-4 border-cyan-400 shadow-lg animate-manifestation-energy-pulse"
              loading="eager"
            />
          </div>
        </CardHeader>
        <CardContent className="relative z-10">
          <div className="bg-cyan-950/30 rounded-xl p-4 sm:p-6 border border-cyan-400/30 mb-4">
            <div className="grid md:grid-cols-2 gap-4 mb-4">
              <div className="flex items-start gap-3">
                <Network className="h-6 w-6 text-cyan-400 flex-shrink-0 mt-1" />
                <div>
                  <h4 className="text-cyan-300 font-semibold mb-1">中央樞紐 Canister</h4>
                  <p className="text-cyan-200 text-sm">cerpu-yyaaa-aaaai-q4wuq-cai</p>
                  <p className="text-cyan-300 text-xs mt-1">全球生態系統中央通信樞紐</p>
                </div>
              </div>
              <div className="flex items-start gap-3">
                <Cpu className="h-6 w-6 text-cyan-400 flex-shrink-0 mt-1" />
                <div>
                  <h4 className="text-cyan-300 font-semibold mb-1">ICP 反向燃料模型</h4>
                  <p className="text-cyan-200 text-sm">開發者預付 Cycles</p>
                  <p className="text-cyan-300 text-xs mt-1">用戶完全免費使用</p>
                </div>
              </div>
            </div>
            <div className="flex flex-wrap gap-2 text-xs text-cyan-200">
              <span className="bg-cyan-900/30 px-3 py-1 rounded-full border border-cyan-400/30">即時自動數據同步</span>
              <span className="bg-cyan-900/30 px-3 py-1 rounded-full border border-cyan-400/30">分散式模組協調</span>
              <span className="bg-cyan-900/30 px-3 py-1 rounded-full border border-cyan-400/30">統一數據管理</span>
              <span className="bg-cyan-900/30 px-3 py-1 rounded-full border border-cyan-400/30">權限控制</span>
            </div>
          </div>
        </CardContent>
      </Card>

      {/* Unified Dashboard */}
      <UnifiedDashboard currentPage="home" onNavigate={onNavigate} />

      {/* Complete DApp Interconnection Network */}
      <Card className="bg-gradient-to-br from-purple-900/50 via-pink-900/50 to-rose-900/50 border-purple-400/50 shadow-2xl card-transition hover:shadow-purple-400/30 overflow-hidden relative">
        <div className="absolute inset-0 opacity-20 pointer-events-none">
          <div className="absolute inset-0 bg-[url('/assets/generated/complete-dapp-interconnection-network.dim_1000x800.png')] bg-cover bg-center animate-pulse-slow"></div>
          <div className="absolute inset-0 bg-gradient-to-br from-purple-400/10 via-transparent to-pink-400/10 animate-spiritual-aura-flow"></div>
        </div>
        
        <CardHeader className="relative z-10">
          <div className="flex items-center justify-between flex-wrap gap-4">
            <div className="flex-1">
              <CardTitle className="text-2xl sm:text-3xl md:text-4xl text-purple-400 manifestation-glow mb-2 animate-enhanced-glow-transition">
                完整 DApp 互聯網路 • Complete DApp Interconnection
              </CardTitle>
              <CardDescription className="text-purple-200 text-base sm:text-lg">
                前端發送模組 ⇄ 後端接收模組 • 統一同步架構
              </CardDescription>
            </div>
            <Sparkles className="h-16 w-16 sm:h-20 sm:w-20 text-purple-400 animate-manifestation-energy-pulse" />
          </div>
        </CardHeader>
        <CardContent className="relative z-10">
          <div className="grid md:grid-cols-2 gap-4 mb-4">
            <div className="bg-purple-950/30 rounded-xl p-4 border border-purple-400/30">
              <h4 className="text-purple-300 font-semibold mb-3 flex items-center gap-2">
                <Zap className="h-5 w-5" />
                前端發送模組統一同步
              </h4>
              <div className="space-y-2 text-sm text-purple-200">
                <div className="flex items-center gap-2">
                  <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse"></div>
                  <span>Natural Intelligence 模組</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse"></div>
                  <span>Anima 模組</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse"></div>
                  <span>Wallet 模組</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse"></div>
                  <span>Oracle 模組</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse"></div>
                  <span>Lucky Draw 模組</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse"></div>
                  <span>Soul Collaboration 模組</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse"></div>
                  <span>Nine Realms 模組</span>
                </div>
              </div>
            </div>
            <div className="bg-purple-950/30 rounded-xl p-4 border border-purple-400/30">
              <h4 className="text-purple-300 font-semibold mb-3 flex items-center gap-2">
                <Database className="h-5 w-5" />
                後端接收模組統一同步
              </h4>
              <div className="space-y-2 text-sm text-purple-200">
                <div className="flex items-center gap-2">
                  <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse"></div>
                  <span>Firewall 模組</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse"></div>
                  <span>Decentralized Ecosystem 模組</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse"></div>
                  <span>AI Games 模組</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse"></div>
                  <span>Gacha 模組</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse"></div>
                  <span>Integration Dashboard 模組</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse"></div>
                  <span>NFT Validation 模組</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse"></div>
                  <span>Data Ecosystem 模組</span>
                </div>
              </div>
            </div>
          </div>
          <div className="bg-purple-950/30 rounded-xl p-4 border border-purple-400/30">
            <p className="text-purple-100 text-sm leading-relaxed">
              透過中央樞紐 Canister 實現所有前端發送模組與後端接收模組的即時自動數據同步，強化整個生態系統的互聯性，提供集中化的系統監控和控制功能。
            </p>
          </div>
        </CardContent>
      </Card>

      {/* Total Ecosystem Energy Dashboard */}
      <TotalEcosystemEnergy />

      {/* Ecosystem Sync Dashboard - 18 Backends */}
      <EcosystemSyncDashboard />

      {/* Nine Realms Core Framework - Featured */}
      <Card className="bg-gradient-to-br from-purple-900/50 via-indigo-900/50 to-blue-900/50 border-purple-400/50 shadow-2xl card-transition hover:shadow-purple-400/30 overflow-hidden relative">
        <div className="absolute inset-0 opacity-20 pointer-events-none">
          <div className="absolute inset-0 bg-[url('/assets/generated/unified-nine-realms-core-framework.dim_1200x800.png')] bg-cover bg-center animate-pulse-slow"></div>
          <div className="absolute inset-0 bg-gradient-to-br from-purple-400/10 via-transparent to-indigo-400/10 animate-spiritual-aura-flow"></div>
        </div>
        
        <CardHeader className="relative z-10">
          <div className="flex items-center justify-between flex-wrap gap-4">
            <div className="flex-1">
              <CardTitle className="text-2xl sm:text-3xl md:text-4xl text-purple-400 manifestation-glow mb-2 animate-enhanced-glow-transition">
                靈界核心框架 • Nine Realms Core
              </CardTitle>
              <CardDescription className="text-purple-200 text-base sm:text-lg">
                統一九界模組化系統 • 跨界修煉與能量融合
              </CardDescription>
            </div>
            <Sparkles className="h-16 w-16 sm:h-20 sm:w-20 text-purple-400 animate-manifestation-energy-pulse" />
          </div>
        </CardHeader>
        <CardContent className="relative z-10">
          <div className="bg-purple-950/30 rounded-xl p-4 sm:p-6 border border-purple-400/30 mb-4">
            <p className="text-purple-100 text-sm sm:text-base leading-relaxed mb-4">
              靈界核心框架整合了九大修煉界域：仙島、修真聖地、武道聖地、佛國、天堂、地獄、地府、神殿、靈府。每個界域都擁有獨特的能量系統、修煉任務和成就系統。跨界修煉，提升您的靈力與境界，實現九界融合的終極目標。
            </p>
            <div className="flex flex-wrap gap-2 text-xs text-purple-200">
              <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30">仙島 🌸</span>
              <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30">修真聖地 ⚗️</span>
              <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30">武道聖地 ⚔️</span>
              <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30">佛國 🪷</span>
              <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30">天堂 ☁️</span>
              <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30">地獄 🔥</span>
              <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30">地府 👻</span>
              <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30">神殿 ⚡</span>
              <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-indigo-400/30 font-bold">靈府 ✨</span>
            </div>
          </div>
          <Button
            onClick={() => onNavigate('nine-realms-hub')}
            className="w-full bg-gradient-to-r from-purple-500 to-indigo-600 hover:from-purple-600 hover:to-indigo-700 text-white font-bold text-base sm:text-lg py-6 transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-lg hover:shadow-purple-400/50"
          >
            <Layers className="h-5 w-5 mr-2 animate-pulse" />
            進入靈界核心框架
          </Button>
        </CardContent>
      </Card>

      {/* Reality Connection Module - Featured */}
      <Card className="bg-gradient-to-br from-blue-800/50 via-purple-800/50 to-indigo-800/50 border-blue-400/50 shadow-2xl card-transition hover:shadow-blue-400/30 overflow-hidden relative">
        <div className="absolute inset-0 opacity-20 pointer-events-none">
          <div className="absolute inset-0 bg-[url('/assets/generated/reality-connection-panel.dim_600x400.png')] bg-cover bg-center animate-pulse-slow"></div>
          <div className="absolute inset-0 bg-gradient-to-br from-blue-400/10 via-transparent to-purple-400/10 animate-spiritual-aura-flow"></div>
        </div>
        
        <CardHeader className="relative z-10">
          <div className="flex items-center justify-between flex-wrap gap-4">
            <div className="flex-1">
              <CardTitle className="text-2xl sm:text-3xl md:text-4xl text-blue-400 manifestation-glow mb-2 animate-enhanced-glow-transition">
                現實連結 • Reality Connection
              </CardTitle>
              <CardDescription className="text-blue-200 text-base sm:text-lg">
                虛實融合系統 • 時間事件同步與情境影響傳遞
              </CardDescription>
            </div>
            <img
              src="/assets/generated/reality-earth-globe-3d.dim_400x400.png"
              alt="Reality Connection"
              className="h-16 w-16 sm:h-20 sm:w-20 rounded-full border-4 border-blue-400 shadow-lg animate-manifestation-energy-pulse"
              loading="eager"
            />
          </div>
        </CardHeader>
        <CardContent className="relative z-10">
          <div className="bg-blue-950/30 rounded-xl p-4 sm:p-6 border border-blue-400/30 mb-4">
            <p className="text-blue-100 text-sm sm:text-base leading-relaxed mb-4">
              現實連結模組將真實世界的時間、情境與事件同步至靈界系統，讓您的虛擬體驗與現實世界產生深度連結。時間基礎事件、季節影響、宇宙對齊度等現實因素將影響您的幸運值、昇華進度和跨界修煉效率。
            </p>
            <div className="flex flex-wrap gap-2 text-xs text-blue-200">
              <span className="bg-blue-900/30 px-3 py-1 rounded-full border border-blue-400/30">時間事件觸發</span>
              <span className="bg-blue-900/30 px-3 py-1 rounded-full border border-blue-400/30">情境感知</span>
              <span className="bg-blue-900/30 px-3 py-1 rounded-full border border-blue-400/30">季節影響</span>
              <span className="bg-blue-900/30 px-3 py-1 rounded-full border border-blue-400/30">跨模組傳遞</span>
            </div>
          </div>
          <Button
            onClick={() => onNavigate('reality-connection')}
            className="w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-bold text-base sm:text-lg py-6 transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-lg hover:shadow-blue-400/50"
          >
            <Globe className="h-5 w-5 mr-2 animate-pulse" />
            進入現實連結模組
          </Button>
        </CardContent>
      </Card>

      {/* Reality Connection Compact Module */}
      <RealityConnectionModule variant="compact" />

      {/* Newborn Lucky Entrance Module - Featured */}
      <Card className="bg-gradient-to-br from-emerald-800/50 via-cyan-800/50 to-blue-800/50 border-cyan-400/50 shadow-2xl card-transition hover:shadow-cyan-400/30 overflow-hidden relative">
        <div className="absolute inset-0 opacity-20 pointer-events-none">
          <div className="absolute inset-0 bg-[url('/assets/generated/newborn-lucky-entrance-gateway.dim_800x600.png')] bg-cover bg-center animate-pulse-slow"></div>
          <div className="absolute inset-0 bg-gradient-to-br from-cyan-400/10 via-transparent to-emerald-400/10 animate-spiritual-aura-flow"></div>
        </div>
        
        <CardHeader className="relative z-10">
          <div className="flex items-center justify-between flex-wrap gap-4">
            <div className="flex-1">
              <CardTitle className="text-2xl sm:text-3xl md:text-4xl text-cyan-400 manifestation-glow mb-2 animate-enhanced-glow-transition">
                初生之犢為幸運者
              </CardTitle>
              <CardDescription className="text-cyan-200 text-base sm:text-lg">
                元宇宙幸運入口 • 開啟您的專屬幸運之旅
              </CardDescription>
            </div>
            <img
              src="/assets/generated/newborn-lucky-icon-transparent.dim_64x64.png"
              alt="Newborn Lucky"
              className="h-16 w-16 sm:h-20 sm:w-20 rounded-full border-4 border-cyan-400 shadow-lg animate-manifestation-energy-pulse"
              loading="eager"
            />
          </div>
        </CardHeader>
        <CardContent className="relative z-10">
          <div className="bg-cyan-950/30 rounded-xl p-4 sm:p-6 border border-cyan-400/30 mb-4">
            <p className="text-cyan-100 text-sm sm:text-base leading-relaxed mb-4">
              探索 7 個獨特的元宇宙模組，每個入口都為您帶來不同的幸運機遇與驚喜。點擊下方按鈕進入專屬幸運入口頁面。
            </p>
            <div className="flex flex-wrap gap-2 text-xs text-cyan-200">
              <span className="bg-cyan-900/30 px-3 py-1 rounded-full border border-cyan-400/30">幸運抽獎</span>
              <span className="bg-cyan-900/30 px-3 py-1 rounded-full border border-cyan-400/30">神諭預測</span>
              <span className="bg-cyan-900/30 px-3 py-1 rounded-full border border-cyan-400/30">數位錢包</span>
              <span className="bg-cyan-900/30 px-3 py-1 rounded-full border border-cyan-400/30">自然智能</span>
              <span className="bg-cyan-900/30 px-3 py-1 rounded-full border border-cyan-400/30">數據生態</span>
            </div>
          </div>
          <Button
            onClick={() => onNavigate('newborn-entrance')}
            className="w-full bg-gradient-to-r from-cyan-500 to-emerald-600 hover:from-cyan-600 hover:to-emerald-700 text-slate-950 font-bold text-base sm:text-lg py-6 transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-lg hover:shadow-cyan-400/50"
          >
            <Star className="h-5 w-5 mr-2 animate-pulse" />
            進入初生之犢幸運入口
          </Button>
        </CardContent>
      </Card>

      {/* Support Developer Section */}
      <Card className="bg-gradient-to-r from-pink-900/50 to-purple-800/50 border-pink-400/50 shadow-2xl card-transition hover:shadow-pink-400/20">
        <CardHeader>
          <div className="flex items-center justify-between flex-wrap gap-4">
            <div className="flex-1">
              <CardTitle className="text-2xl sm:text-3xl text-pink-400 flex items-center gap-2">
                <img
                  src="/assets/generated/icp-payment-icon-transparent.dim_64x64.png"
                  alt="ICP Payment"
                  className="h-8 w-8 animate-pulse"
                />
                支持開發者
              </CardTitle>
              <CardDescription className="text-pink-200 text-base sm:text-lg mt-2">
                您的支持是我們持續改進的動力
              </CardDescription>
            </div>
            <img
              src="/assets/generated/support-developer-button-3d.dim_300x80.png"
              alt="Support Developer"
              className="h-16 w-auto rounded-lg shadow-lg animate-glow-pulse"
              loading="eager"
            />
          </div>
        </CardHeader>
        <CardContent>
          <div className="flex flex-col sm:flex-row items-center gap-4">
            <div className="flex-1 bg-purple-950/50 rounded-xl p-4 border border-pink-400/30">
              <p className="text-pink-100 text-sm sm:text-base mb-2">
                訂閱開發者支持計劃，每月僅需 <span className="text-pink-400 font-bold text-lg">1 ICP</span>
              </p>
              <p className="text-pink-200 text-xs">
                獲得專屬訂閱標識，優先體驗新功能，為靈界生態系統做出貢獻
              </p>
            </div>
            <SupportDeveloperButton
              variant="default"
              size="lg"
              className="bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-bold text-base sm:text-lg py-6 px-8 shadow-lg hover:shadow-pink-500/50 transition-all transform hover:scale-105"
              showStatus={true}
            />
          </div>
        </CardContent>
      </Card>

      {/* LFLCEI Support Ascension Module */}
      <LFLCEISupportAscension isAdmin={!!isAdmin} />

      {/* Advisory Portal Integration */}
      <AdvisoryPortalIntegration 
        isAdmin={!!isAdmin} 
        isRegisteredUser={isRegisteredUser}
      />

      {/* Soul Collaboration Status */}
      <SoulCollaborationStatus />

      {/* Welcome Card */}
      <Card className="bg-gradient-to-r from-emerald-800 to-green-700 border-amber-400/50 shadow-2xl card-transition hover:shadow-amber-400/20">
        <CardHeader>
          <div className="flex items-center justify-between flex-wrap gap-4">
            <div className="flex-1">
              <CardTitle className="text-2xl sm:text-3xl md:text-4xl text-amber-400 clover-glow mb-2">
                歡迎回來，{userProfile?.name}！
              </CardTitle>
              <CardDescription className="text-emerald-200 text-base sm:text-lg">
                繼續您的幸運之旅
              </CardDescription>
            </div>
            <img
              src="/assets/IMG_8868.jpeg"
              alt="Lucky Clover"
              className="h-16 w-16 sm:h-20 sm:w-20 rounded-full border-4 border-amber-400 shadow-lg animate-glow-pulse"
              loading="eager"
            />
          </div>
        </CardHeader>
        <CardContent>
          <div className="grid grid-cols-2 sm:grid-cols-3 gap-3 sm:gap-4">
            <div className="bg-emerald-950/50 rounded-xl p-3 sm:p-4 border border-amber-400/30 card-transition hover:border-amber-400">
              <div className="flex items-center gap-2 mb-2">
                <Sparkles className="h-4 w-4 sm:h-5 sm:w-5 text-amber-400" />
                <span className="text-emerald-200 text-xs sm:text-sm">當前積分</span>
              </div>
              <p className="text-2xl sm:text-3xl font-bold text-amber-400">
                {Number(userProfile?.points || 0n).toLocaleString()}
              </p>
            </div>
            <div className="bg-emerald-950/50 rounded-xl p-3 sm:p-4 border border-amber-400/30 card-transition hover:border-amber-400">
              <div className="flex items-center gap-2 mb-2">
                <Calendar className="h-4 w-4 sm:h-5 sm:w-5 text-amber-400" />
                <span className="text-emerald-200 text-xs sm:text-sm">連續簽到</span>
              </div>
              <p className="text-2xl sm:text-3xl font-bold text-amber-400">{completedDays} 天</p>
            </div>
            <div className="bg-emerald-950/50 rounded-xl p-3 sm:p-4 border border-amber-400/30 col-span-2 sm:col-span-1 card-transition hover:border-amber-400">
              <div className="flex items-center gap-2 mb-2">
                <TrendingUp className="h-4 w-4 sm:h-5 sm:w-5 text-amber-400" />
                <span className="text-emerald-200 text-xs sm:text-sm">完成循環</span>
              </div>
              <p className="text-2xl sm:text-3xl font-bold text-amber-400">
                {Number(userProfile?.cycleCompletedCount || 0n)}
              </p>
            </div>
          </div>
        </CardContent>
      </Card>

      {/* Daily Fortune Blessing */}
      <Card className="bg-gradient-to-br from-amber-900/50 to-amber-800/50 border-amber-400/50 shadow-2xl card-transition hover:shadow-amber-400/20">
        <CardHeader>
          <div className="flex items-center gap-3">
            <img
              src="/assets/generated/glowing-clover-transparent.dim_150x150.png"
              alt="Glowing Clover"
              className="h-10 w-10 sm:h-12 sm:w-12 animate-pulse"
              loading="lazy"
            />
            <div>
              <CardTitle className="text-xl sm:text-2xl text-amber-400 clover-glow">每日幸運祝福</CardTitle>
              <CardDescription className="text-emerald-200 text-sm sm:text-base">
                抽取今日專屬幸運籤文
              </CardDescription>
            </div>
          </div>
        </CardHeader>
        <CardContent className="space-y-4">
          {fortuneRecord ? (
            <div className="bg-emerald-950/50 rounded-xl p-4 sm:p-6 border border-amber-400/30 card-transition">
              <div className="flex items-center gap-2 mb-3">
                <Scroll className="h-5 w-5 text-amber-400" />
                <span className="text-amber-400 font-semibold">今日籤文</span>
              </div>
              <p className="text-lg sm:text-xl text-emerald-100 leading-relaxed">
                {fortuneRecord.fortuneMessage.message}
              </p>
              <p className="text-emerald-300 text-sm mt-3">
                已於今日抽取 • 明日可再次抽取
              </p>
            </div>
          ) : (
            <Button
              onClick={handleDrawFortune}
              disabled={drawFortune.isPending}
              className="w-full bg-amber-500 hover:bg-amber-600 active:bg-amber-700 text-emerald-950 font-bold text-base sm:text-lg py-5 sm:py-6 transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-lg hover:shadow-amber-400/50"
            >
              {drawFortune.isPending ? (
                <>
                  <div className="h-5 w-5 animate-spin rounded-full border-2 border-emerald-950 border-t-transparent mr-2"></div>
                  抽取中...
                </>
              ) : (
                <>
                  <Scroll className="h-5 w-5 mr-2" />
                  抽取今日幸運籤
                </>
              )}
            </Button>
          )}
        </CardContent>
      </Card>

      {/* LFLCEI Natural Intelligence Integration */}
      <LFLCEINaturalIntelligenceIntegration onFortuneGenerated={handleFortuneGenerated} />

      {/* Quick Action Cards */}
      <div className="grid md:grid-cols-3 gap-4 sm:gap-6">
        <Card className="bg-emerald-900/50 border-amber-400/50 shadow-xl card-transition hover:shadow-amber-400/20 cursor-pointer group">
          <CardHeader>
            <div className="flex items-center gap-3">
              <div className="p-2 sm:p-3 bg-amber-400/20 rounded-full group-hover:bg-amber-400/30 transition-all group-hover:scale-110">
                <Calendar className="h-6 w-6 sm:h-8 sm:w-8 text-amber-400" />
              </div>
              <CardTitle className="text-lg sm:text-xl text-amber-400">每日簽到</CardTitle>
            </div>
          </CardHeader>
          <CardContent className="space-y-4">
            <CardDescription className="text-emerald-200 text-sm">
              每日登入獲得積分，連續簽到獲得更多獎勵！
            </CardDescription>
            {currentDay && (
              <div className="bg-emerald-950/50 rounded-lg p-3 border border-amber-400/30">
                <p className="text-emerald-200 text-sm">今日獎勵</p>
                <p className="text-xl sm:text-2xl font-bold text-amber-400">
                  +{Number(currentDay.rewardPoints)} 積分
                </p>
              </div>
            )}
            <Button
              onClick={() => onNavigate('checkin')}
              className="w-full bg-amber-500 hover:bg-amber-600 active:bg-amber-700 text-emerald-950 font-bold transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-lg hover:shadow-amber-400/50"
            >
              前往簽到
            </Button>
          </CardContent>
        </Card>

        <Card className="bg-emerald-900/50 border-amber-400/50 shadow-xl card-transition hover:shadow-amber-400/20 cursor-pointer group">
          <CardHeader>
            <div className="flex items-center gap-3">
              <div className="p-2 sm:p-3 bg-amber-400/20 rounded-full group-hover:bg-amber-400/30 transition-all group-hover:scale-110">
                <Gift className="h-6 w-6 sm:h-8 sm:w-8 text-amber-400" />
              </div>
              <CardTitle className="text-lg sm:text-xl text-amber-400">抽盲盒</CardTitle>
            </div>
          </CardHeader>
          <CardContent className="space-y-4">
            <CardDescription className="text-emerald-200 text-sm">
              使用 1000 積分抽取盲盒，有機會獲得稀有獎品！
            </CardDescription>
            <div className="bg-emerald-950/50 rounded-lg p-3 border border-amber-400/30">
              <p className="text-emerald-200 text-sm">可抽取次數</p>
              <p className="text-xl sm:text-2xl font-bold text-amber-400">
                {Math.floor(Number(userProfile?.points || 0n) / 1000)} 次
              </p>
            </div>
            <Button
              onClick={() => onNavigate('gacha')}
              className="w-full bg-amber-500 hover:bg-amber-600 active:bg-amber-700 text-emerald-950 font-bold transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-lg hover:shadow-amber-400/50"
              disabled={Number(userProfile?.points || 0n) < 1000}
            >
              前往抽獎
            </Button>
          </CardContent>
        </Card>

        <Card className="bg-emerald-900/50 border-amber-400/50 shadow-xl card-transition hover:shadow-amber-400/20 cursor-pointer group">
          <CardHeader>
            <div className="flex items-center gap-3">
              <div className="p-2 sm:p-3 bg-amber-400/20 rounded-full group-hover:bg-amber-400/30 transition-all group-hover:scale-110">
                <User className="h-6 w-6 sm:h-8 sm:w-8 text-amber-400" />
              </div>
              <CardTitle className="text-lg sm:text-xl text-amber-400">個人資訊</CardTitle>
            </div>
          </CardHeader>
          <CardContent className="space-y-4">
            <CardDescription className="text-emerald-200 text-sm">
              查看您的積分歷史、簽到記錄和獎品收藏
            </CardDescription>
            <div className="bg-emerald-950/50 rounded-lg p-3 border border-amber-400/30">
              <p className="text-emerald-200 text-sm">獎品總數</p>
              <p className="text-xl sm:text-2xl font-bold text-amber-400">
                {userProfile?.rewardHistory.length || 0}
              </p>
            </div>
            <Button
              onClick={() => onNavigate('profile')}
              className="w-full bg-amber-500 hover:bg-amber-600 active:bg-amber-700 text-emerald-950 font-bold transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-lg hover:shadow-amber-400/50"
            >
              查看資訊
            </Button>
          </CardContent>
        </Card>
      </div>

      {/* LFLC Integration Modules */}
      <Card className="bg-emerald-900/50 border-amber-400/50 shadow-xl">
        <CardHeader>
          <CardTitle className="text-xl sm:text-2xl text-amber-400 flex items-center gap-2">
            <Sparkles className="h-5 w-5 sm:h-6 sm:w-6" />
            LFLC 整合模組
          </CardTitle>
          <CardDescription className="text-emerald-200 text-sm sm:text-base">
            快速存取 LFLC 生態系統中的其他平台與服務
          </CardDescription>
        </CardHeader>
        <CardContent>
          <div className="grid sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4">
            {externalLinks.map((link, index) => {
              const isLoading = loadingLinks[link.name] || false;
              const isNervousSystem = link.adminOnly && link.name.includes('Network Nervous System');
              const isAnimaPortal = link.name.includes('LFLCEI Anima');
              
              return (
                <Button
                  key={index}
                  onClick={() => handleExternalLinkClick(link.url, link.name)}
                  disabled={isLoading}
                  variant="ghost"
                  className={`h-auto rounded-xl p-3 sm:p-4 border transition-all group text-left relative justify-start overflow-hidden ${
                    isNervousSystem
                      ? 'bg-emerald-950/50 border-amber-400/50 hover:border-amber-400 hover:bg-gradient-to-r hover:from-amber-900/30 hover:to-emerald-900/70 active:from-amber-900/50 active:to-emerald-900/90'
                      : isAnimaPortal
                      ? 'bg-emerald-950/50 border-cyan-400/50 hover:border-cyan-400 hover:bg-gradient-to-r hover:from-cyan-900/30 hover:to-emerald-900/70 active:from-cyan-900/50 active:to-emerald-900/90 animate-metaverse-float'
                      : 'bg-emerald-950/50 border-amber-400/30 hover:border-amber-400 hover:bg-emerald-900/70 active:bg-emerald-900'
                  } ${isLoading ? 'animate-pulse' : ''}`}
                >
                  {(isNervousSystem || isAnimaPortal) && !isLoading && (
                    <div className={`absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-500 ${
                      isAnimaPortal 
                        ? 'bg-gradient-to-r from-cyan-400/0 via-cyan-400/10 to-cyan-400/0 animate-pulse-slow'
                        : 'bg-gradient-to-r from-amber-400/0 via-amber-400/10 to-amber-400/0 animate-pulse-slow'
                    }`}></div>
                  )}
                  
                  {isLoading && (
                    <div className="absolute inset-0 bg-amber-400/20 backdrop-blur-sm flex items-center justify-center z-10">
                      <div className="flex items-center gap-2">
                        <div className="h-4 w-4 animate-spin rounded-full border-2 border-amber-400 border-t-transparent"></div>
                        <span className="text-amber-400 font-semibold text-xs">開啟中...</span>
                      </div>
                    </div>
                  )}
                  
                  {link.adminOnly && (
                    <div className="absolute top-2 right-2 z-5">
                      <Shield className={`h-4 w-4 text-amber-400 transition-transform ${
                        isNervousSystem ? 'group-hover:scale-110' : ''
                      }`} />
                    </div>
                  )}
                  <div className="flex items-start gap-3 w-full relative z-0">
                    <img
                      src={link.icon}
                      alt={link.name}
                      className={`h-10 w-10 sm:h-12 sm:w-12 rounded-lg border transition-all flex-shrink-0 ${
                        isAnimaPortal
                          ? 'border-cyan-400/30 group-hover:border-cyan-400 group-hover:scale-110 group-hover:rotate-3 group-hover:shadow-lg group-hover:shadow-cyan-400/50'
                          : isNervousSystem
                          ? 'border-amber-400/30 group-hover:border-amber-400 group-hover:scale-110 group-hover:rotate-3'
                          : 'border-amber-400/30 group-hover:border-amber-400'
                      }`}
                      loading="lazy"
                    />
                    <div className="flex-1 min-w-0">
                      <div className="flex items-center gap-2 mb-1">
                        <h3 className={`font-semibold text-xs sm:text-sm transition-colors truncate ${
                          isAnimaPortal
                            ? 'text-cyan-400 group-hover:text-cyan-300 metaverse-glow'
                            : isNervousSystem
                            ? 'text-amber-400 group-hover:text-amber-300'
                            : 'text-amber-400 group-hover:text-amber-300'
                        }`}>
                          {link.name}
                        </h3>
                        <ExternalLink className={`h-3 w-3 flex-shrink-0 transition-transform ${
                          isAnimaPortal
                            ? 'text-cyan-400 group-hover:translate-x-1 group-hover:-translate-y-1'
                            : isNervousSystem
                            ? 'text-amber-400 group-hover:translate-x-1 group-hover:-translate-y-1'
                            : 'text-amber-400'
                        }`} />
                      </div>
                      <p className="text-emerald-200 text-xs">{link.description}</p>
                    </div>
                  </div>
                </Button>
              );
            })}
          </div>
        </CardContent>
      </Card>

      {/* Admin Control Panel */}
      {isAdmin && (
        <Card className="bg-gradient-to-r from-amber-900/50 to-amber-800/50 border-amber-400/50 shadow-xl card-transition hover:shadow-amber-400/20">
          <CardHeader>
            <CardTitle className="text-xl sm:text-2xl text-amber-400 flex items-center gap-2">
              <Shield className="h-5 w-5 sm:h-6 sm:w-6" />
              管理員控制台
            </CardTitle>
            <CardDescription className="text-emerald-200 text-sm sm:text-base">
              管理系統設定和用戶權限
            </CardDescription>
          </CardHeader>
          <CardContent>
            <Button
              onClick={() => onNavigate('admin')}
              className="w-full bg-amber-500 hover:bg-amber-600 active:bg-amber-700 text-emerald-950 font-bold transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-lg hover:shadow-amber-400/50"
            >
              <Shield className="h-4 w-4 mr-2" />
              前往管理員頁面
            </Button>
          </CardContent>
        </Card>
      )}

      {/* Recent Rewards */}
      {userProfile && userProfile.rewardHistory.length > 0 && (
        <Card className="bg-emerald-900/50 border-amber-400/50 shadow-xl">
          <CardHeader>
            <CardTitle className="text-xl sm:text-2xl text-amber-400">最近獲得的獎品</CardTitle>
          </CardHeader>
          <CardContent>
            <div className="grid sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4">
              {userProfile.rewardHistory.slice(-3).reverse().map((reward) => (
                <div
                  key={Number(reward.id)}
                  className="bg-emerald-950/50 rounded-xl p-3 sm:p-4 border border-amber-400/30 card-transition hover:border-amber-400"
                >
                  <div className="flex items-center gap-2 mb-2">
                    <Gift className="h-5 w-5 text-amber-400" />
                    <span className="text-amber-400 font-semibold text-sm sm:text-base">{reward.reward.name}</span>
                  </div>
                  <p className="text-emerald-200 text-xs sm:text-sm">
                    {new Date(Number(reward.timestamp) / 1000000).toLocaleDateString('zh-TW')}
                  </p>
                </div>
              ))}
            </div>
          </CardContent>
        </Card>
      )}

      <FortuneSlipModal
        open={showFortuneModal}
        onOpenChange={setShowFortuneModal}
        fortune={currentFortune}
      />
    </div>
  );
}

export default memo(HomePage);
PK
frontend/src/pages/LoginPage.tsximport { useInternetIdentity } from '../hooks/useInternetIdentity';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { LogIn, Sparkles, Zap } from 'lucide-react';
import { useState, useEffect, Suspense, useCallback } from 'react';
import { toast } from 'sonner';
import LuckyClover3D from '../components/LuckyClover3D';

export default function LoginPage() {
  const { login, loginStatus } = useInternetIdentity();
  const [isProcessing, setIsProcessing] = useState(false);
  const [sceneLoaded, setSceneLoaded] = useState(false);

  const handleLogin = useCallback(async () => {
    setIsProcessing(true);
    try {
      await login();
      requestAnimationFrame(() => {
        toast.success('登入成功！', {
          description: '歡迎來到 LFLCEI 幸運草生態互聯網 • Internet Identity 2.0 自動登入',
          icon: <Zap className="h-5 w-5 text-amber-400" />,
        });
      });
    } catch (error: any) {
      console.error('Login error:', error);
      requestAnimationFrame(() => {
        toast.error('登入失敗', {
          description: '請稍後再試',
        });
      });
    } finally {
      setIsProcessing(false);
    }
  }, [login]);

  const isLoggingIn = loginStatus === 'logging-in' || isProcessing;

  useEffect(() => {
    const preloadImages = [
      '/assets/generated/lflcei-eco-internet-main-logo-transparent.dim_400x400.png',
      '/assets/generated/3d-webgl-platform-showcase.dim_1200x800.png',
    ];
    
    if ('requestIdleCallback' in window) {
      requestIdleCallback(() => {
        preloadImages.forEach(src => {
          const img = new Image();
          img.src = src;
        });
        setTimeout(() => setSceneLoaded(true), 100);
      }, { timeout: 1000 });
    } else {
      setTimeout(() => {
        preloadImages.forEach(src => {
          const img = new Image();
          img.src = src;
        });
        setSceneLoaded(true);
      }, 80);
    }
  }, []);

  return (
    <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-emerald-950 via-green-950 to-slate-950 relative overflow-hidden gpu-accelerated">
      <div className="absolute inset-0 overflow-hidden pointer-events-none">
        {[...Array(5)].map((_, i) => (
          <div
            key={i}
            className="evolution-float absolute gpu-accelerated"
            style={{
              left: `${Math.random() * 100}%`,
              animationDelay: `${Math.random() * 10}s`,
              animationDuration: `${10 + Math.random() * 6}s`,
            }}
          >
            <img
              src="/assets/generated/lflcei-eco-internet-main-logo-transparent.dim_400x400.png"
              alt=""
              className="h-8 w-8 rounded-full opacity-30"
              loading="lazy"
            />
          </div>
        ))}
      </div>

      <div className="relative z-10 w-full max-w-4xl px-4 gpu-accelerated">
        <div className="grid md:grid-cols-2 gap-6 items-center">
          <div className="hidden md:block h-96">
            <Suspense fallback={
              <div className="w-full h-full flex items-center justify-center">
                <div className="h-16 w-16 animate-spin rounded-full border-4 border-amber-400 border-t-transparent"></div>
              </div>
            }>
              {sceneLoaded && <LuckyClover3D autoRotate={true} />}
            </Suspense>
          </div>

          <Card className="bg-gradient-to-br from-slate-900/90 to-emerald-900/90 border-amber-400/50 shadow-2xl backdrop-blur-lg gpu-accelerated">
            <CardHeader className="text-center space-y-4">
              <div className="flex justify-center">
                <img
                  src="/assets/generated/lflcei-eco-internet-main-logo-transparent.dim_400x400.png"
                  alt="LFLCEI 幸運草生態互聯網"
                  className="h-24 w-24 rounded-full border-4 border-amber-400 shadow-lg shadow-amber-400/50 animate-manifestation-energy-pulse gpu-accelerated"
                  loading="eager"
                />
              </div>
              <div>
                <CardTitle className="text-3xl sm:text-4xl font-bold text-amber-400 clover-glow mb-2 animate-enhanced-glow-transition">
                  LFLCEI 幸運草生態互聯網
                </CardTitle>
                <CardDescription className="text-emerald-200 text-base sm:text-lg">
                  全 3D WebGL 互動平台 • Unity/Unreal 相容引擎
                </CardDescription>
              </div>
            </CardHeader>
            <CardContent className="space-y-6">
              <div className="bg-emerald-950/50 rounded-xl p-4 border border-amber-400/30">
                <p className="text-emerald-100 text-sm text-center leading-relaxed">
                  歡迎來到 LFLCEI 幸運草生態互聯網，基於 Internet Computer 的全 3D WebGL 互動平台。
                  採用<span className="text-cyan-400 font-semibold"> Unity/Unreal 相容渲染引擎</span>、
                  <span className="text-blue-400 font-semibold"> Canister 模組化架構</span>、
                  <span className="text-purple-400 font-semibold"> Internet Identity 2.0 自動登入</span>、
                  <span className="text-green-400 font-semibold"> 雙端整合通信框架</span>。
                  支援<span className="text-amber-400 font-semibold"> 跨平台響應式設計</span>。
                </p>
              </div>

              <Button
                onClick={handleLogin}
                disabled={isLoggingIn}
                className="w-full bg-gradient-to-r from-amber-500 to-green-600 hover:from-amber-600 hover:to-green-700 text-white font-bold text-lg py-6 transition-all transform hover:scale-105 active:scale-95 shadow-lg hover:shadow-amber-400/50 disabled:opacity-50 disabled:cursor-not-allowed gpu-accelerated"
              >
                {isLoggingIn ? (
                  <>
                    <div className="h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent mr-2"></div>
                    Internet Identity 2.0 驗證中...
                  </>
                ) : (
                  <>
                    <LogIn className="h-5 w-5 mr-2" />
                    使用 Internet Identity 2.0 登入
                  </>
                )}
              </Button>

              <div className="flex items-center justify-center gap-2 text-xs text-emerald-300">
                <Sparkles className="h-4 w-4" />
                <span>安全、去中心化的身份驗證 • 自動登入 • 即時獎勵發放</span>
              </div>
            </CardContent>
          </Card>
        </div>

        <div className="mt-6 text-center">
          <p className="text-emerald-300 text-sm">
            全 3D WebGL 互動平台 • Canister 模組化架構 • GPU 加速渲染 • 無縫運行體驗
          </p>
        </div>
      </div>
    </div>
  );
}
PK
frontend/src/pages/MetaverseAscensionPage.tsximport { useEffect, useRef, useState } from 'react';
import { useGetAscensionLevels, useGetCallerEnergyState } from '../hooks/useQueries';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { Skeleton } from '@/components/ui/skeleton';
import { Sparkles, Zap, TrendingUp, Award } from 'lucide-react';
import type { AscensionLevel, EnergyState } from '../backend';

export default function MetaverseAscensionPage() {
  const { data: ascensionLevels, isLoading: levelsLoading } = useGetAscensionLevels();
  const { data: energyState, isLoading: energyLoading } = useGetCallerEnergyState();
  const canvasRef = useRef<HTMLCanvasElement>(null);
  const [activeTab, setActiveTab] = useState('overview');

  // GPU-accelerated cosmic scene rendering
  useEffect(() => {
    if (!canvasRef.current) return;

    const canvas = canvasRef.current;
    const ctx = canvas.getContext('2d');
    if (!ctx) return;

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const stars: Array<{
      x: number;
      y: number;
      z: number;
      size: number;
      speed: number;
    }> = [];

    for (let i = 0; i < 200; i++) {
      stars.push({
        x: Math.random() * canvas.width - canvas.width / 2,
        y: Math.random() * canvas.height - canvas.height / 2,
        z: Math.random() * canvas.width,
        size: Math.random() * 2,
        speed: Math.random() * 0.5 + 0.1,
      });
    }

    let animationId: number;

    const animate = () => {
      ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      stars.forEach((star) => {
        star.z -= star.speed;

        if (star.z <= 0) {
          star.z = canvas.width;
          star.x = Math.random() * canvas.width - canvas.width / 2;
          star.y = Math.random() * canvas.height - canvas.height / 2;
        }

        const k = 128 / star.z;
        const px = star.x * k + canvas.width / 2;
        const py = star.y * k + canvas.height / 2;

        if (px >= 0 && px <= canvas.width && py >= 0 && py <= canvas.height) {
          const size = (1 - star.z / canvas.width) * star.size;
          const opacity = 1 - star.z / canvas.width;

          ctx.fillStyle = `rgba(100, 200, 255, ${opacity})`;
          ctx.beginPath();
          ctx.arc(px, py, size, 0, Math.PI * 2);
          ctx.fill();
        }
      });

      animationId = requestAnimationFrame(animate);
    };

    animate();

    const handleResize = () => {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    };

    window.addEventListener('resize', handleResize);

    return () => {
      cancelAnimationFrame(animationId);
      window.removeEventListener('resize', handleResize);
    };
  }, []);

  if (levelsLoading || energyLoading) {
    return (
      <div className="space-y-6 animate-fade-in">
        <Skeleton className="h-48 w-full rounded-xl" />
        <div className="grid md:grid-cols-2 gap-6">
          <Skeleton className="h-64 rounded-xl" />
          <Skeleton className="h-64 rounded-xl" />
        </div>
      </div>
    );
  }

  const currentLevel = ascensionLevels?.find(
    (level) => level.level === (energyState?.userId ? 1n : 0n)
  );

  return (
    <div className="relative min-h-screen">
      {/* GPU-Accelerated Cosmic Background */}
      <canvas
        ref={canvasRef}
        className="fixed inset-0 pointer-events-none z-0"
        style={{ opacity: 0.6 }}
      />

      <div className="relative z-10 space-y-6 sm:space-y-8 animate-fade-in">
        {/* Header */}
        <Card className="bg-gradient-to-br from-purple-900/50 via-blue-900/50 to-cyan-900/50 border-cyan-400/50 shadow-2xl overflow-hidden relative">
          <div className="absolute inset-0 opacity-20 pointer-events-none">
            <div className="absolute inset-0 bg-[url('/assets/generated/metaverse-ascension-bg.dim_1920x1080.png')] bg-cover bg-center animate-pulse-slow"></div>
          </div>
          
          <CardHeader className="relative z-10">
            <div className="flex items-center justify-between flex-wrap gap-4">
              <div className="flex-1">
                <CardTitle className="text-3xl sm:text-4xl md:text-5xl text-cyan-400 manifestation-glow mb-2">
                  元宇宙昇華系統
                </CardTitle>
                <CardDescription className="text-cyan-200 text-base sm:text-lg">
                  提升您的靈性能量，開啟昇華之旅
                </CardDescription>
              </div>
              <Sparkles className="h-16 w-16 sm:h-20 sm:w-20 text-cyan-400 animate-manifestation-energy-pulse" />
            </div>
          </CardHeader>
        </Card>

        {/* Energy State Card */}
        <Card className="bg-gradient-to-br from-blue-900/50 to-cyan-900/50 border-cyan-400/50 shadow-xl">
          <CardHeader>
            <CardTitle className="text-2xl text-cyan-400 flex items-center gap-2">
              <Zap className="h-6 w-6" />
              能量狀態
            </CardTitle>
          </CardHeader>
          <CardContent>
            {energyState ? (
              <div className="grid md:grid-cols-3 gap-4">
                <div className="bg-cyan-950/30 rounded-lg p-4 border border-cyan-400/30">
                  <div className="flex items-center gap-2 mb-2">
                    <Sparkles className="h-5 w-5 text-cyan-400" />
                    <span className="text-cyan-200">當前能量</span>
                  </div>
                  <p className="text-3xl font-bold text-cyan-400">
                    {Number(energyState.currentEnergy)}
                  </p>
                </div>
                <div className="bg-cyan-950/30 rounded-lg p-4 border border-cyan-400/30">
                  <div className="flex items-center gap-2 mb-2">
                    <TrendingUp className="h-5 w-5 text-cyan-400" />
                    <span className="text-cyan-200">最大能量</span>
                  </div>
                  <p className="text-3xl font-bold text-cyan-400">
                    {Number(energyState.maxEnergy)}
                  </p>
                </div>
                <div className="bg-cyan-950/30 rounded-lg p-4 border border-cyan-400/30">
                  <div className="flex items-center gap-2 mb-2">
                    <Award className="h-5 w-5 text-cyan-400" />
                    <span className="text-cyan-200">能量流速</span>
                  </div>
                  <p className="text-3xl font-bold text-cyan-400">
                    {energyState.energyFlowRate.toFixed(2)}
                  </p>
                </div>
              </div>
            ) : (
              <div className="text-center py-8">
                <p className="text-cyan-200 mb-4">尚未初始化能量狀態</p>
                <p className="text-cyan-300 text-sm">開始您的昇華之旅以激活能量系統</p>
              </div>
            )}
          </CardContent>
        </Card>

        {/* Ascension Levels */}
        <Card className="bg-gradient-to-br from-purple-900/50 to-blue-900/50 border-purple-400/50 shadow-xl">
          <CardHeader>
            <CardTitle className="text-2xl text-purple-400">昇華等級</CardTitle>
            <CardDescription className="text-purple-200">
              探索不同的昇華階段
            </CardDescription>
          </CardHeader>
          <CardContent>
            <div className="space-y-4">
              {ascensionLevels?.map((level) => (
                <div
                  key={Number(level.level)}
                  className="bg-purple-950/30 rounded-lg p-4 border border-purple-400/30 card-transition hover:border-purple-400"
                >
                  <div className="flex items-center justify-between mb-2">
                    <h3 className="text-xl font-bold text-purple-400">
                      等級 {Number(level.level)}
                    </h3>
                    <span className="text-purple-200 text-sm">
                      需要能量: {Number(level.requiredEnergy)}
                    </span>
                  </div>
                  {level.visualEffects.length > 0 && (
                    <div className="flex flex-wrap gap-2 mt-2">
                      {level.visualEffects.map((effect, index) => (
                        <span
                          key={index}
                          className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30 text-xs text-purple-200"
                        >
                          {effect}
                        </span>
                      ))}
                    </div>
                  )}
                </div>
              ))}
            </div>
          </CardContent>
        </Card>

        {/* Info Card */}
        <Card className="bg-gradient-to-br from-cyan-900/50 to-blue-900/50 border-cyan-400/50 shadow-xl">
          <CardHeader>
            <CardTitle className="text-2xl text-cyan-400">關於昇華系統</CardTitle>
          </CardHeader>
          <CardContent>
            <p className="text-cyan-100 leading-relaxed">
              元宇宙昇華系統是一個靈性成長平台，通過積累能量、參與儀式和完成成就來提升您的昇華等級。
              每個等級都會解鎖新的視覺效果和獎勵，讓您的元宇宙體驗更加豐富多彩。
            </p>
          </CardContent>
        </Card>
      </div>
    </div>
  );
}

PK
frontend/src/pages/NFTManagementPage.tsximport { useState } from 'react';
import { useIsCallerCoreAdmin, useGetAllNFTAssets, useLoadNFTAsset, useValidateNFTAsset, useTransferNFTAsset } from '../hooks/useQueries';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Textarea } from '@/components/ui/textarea';
import { Layers, Upload, CheckCircle2, Send, ArrowLeft, AlertCircle, Crown } from 'lucide-react';
import { Skeleton } from '@/components/ui/skeleton';
import { toast } from 'sonner';
import { useNavigate } from '@tanstack/react-router';
import { Badge } from '@/components/ui/badge';

export default function NFTManagementPage() {
  const { data: isCoreAdmin, isLoading: isCoreAdminLoading } = useIsCallerCoreAdmin();
  const { data: nftAssets, isLoading: nftAssetsLoading } = useGetAllNFTAssets();
  const loadNFTMutation = useLoadNFTAsset();
  const validateNFTMutation = useValidateNFTAsset();
  const transferNFTMutation = useTransferNFTAsset();
  const navigate = useNavigate();

  const [nftName, setNftName] = useState('');
  const [nftMetadata, setNftMetadata] = useState('');
  const [transferNftId, setTransferNftId] = useState<bigint | null>(null);
  const [transferTo, setTransferTo] = useState('');

  const handleLoadNFT = async (e: React.FormEvent) => {
    e.preventDefault();

    if (!nftName.trim() || !nftMetadata.trim()) {
      toast.error('請填寫所有欄位');
      return;
    }

    try {
      const nftId = await loadNFTMutation.mutateAsync({ name: nftName.trim(), metadata: nftMetadata.trim() });
      toast.success(`3D NFT 資產已載入！ID: ${nftId}`);
      setNftName('');
      setNftMetadata('');
    } catch (error: any) {
      console.error('Error loading NFT:', error);
      toast.error(error.message || '載入 NFT 失敗');
    }
  };

  const handleValidateNFT = async (nftId: bigint) => {
    try {
      await validateNFTMutation.mutateAsync(nftId);
      toast.success('NFT 資產已驗證！');
    } catch (error: any) {
      console.error('Error validating NFT:', error);
      toast.error(error.message || '驗證 NFT 失敗');
    }
  };

  const handleTransferNFT = async (e: React.FormEvent) => {
    e.preventDefault();

    if (!transferNftId || !transferTo.trim()) {
      toast.error('請填寫所有欄位');
      return;
    }

    try {
      await transferNFTMutation.mutateAsync({ nftId: transferNftId, newOwner: transferTo.trim() });
      toast.success('NFT 資產已轉移！');
      setTransferNftId(null);
      setTransferTo('');
    } catch (error: any) {
      console.error('Error transferring NFT:', error);
      toast.error(error.message || '轉移 NFT 失敗');
    }
  };

  if (isCoreAdminLoading) {
    return (
      <div className="space-y-6">
        <Skeleton className="h-48 w-full" />
        <Skeleton className="h-64 w-full" />
      </div>
    );
  }

  if (!isCoreAdmin) {
    return (
      <div className="flex items-center justify-center min-h-[60vh]">
        <Card className="bg-red-900/50 border-red-400/50 max-w-md">
          <CardHeader>
            <div className="flex items-center gap-3">
              <AlertCircle className="h-8 w-8 text-red-400" />
              <CardTitle className="text-2xl text-red-400">未授權</CardTitle>
            </div>
          </CardHeader>
          <CardContent>
            <p className="text-red-200">
              您沒有權限存取此頁面。此區域僅限核心管理員 (李奕勳) 使用。
            </p>
          </CardContent>
        </Card>
      </div>
    );
  }

  return (
    <div className="space-y-8 animate-fade-in max-w-6xl mx-auto">
      <Card className="bg-gradient-to-r from-purple-900/50 to-indigo-900/50 border-purple-400/50 shadow-xl">
        <CardHeader>
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3">
              <div className="p-3 bg-purple-400/20 rounded-full">
                <Layers className="h-8 w-8 text-purple-400" />
              </div>
              <div>
                <CardTitle className="text-3xl text-purple-400 clover-glow flex items-center gap-2">
                  3D NFT 資產管理
                  <Crown className="h-6 w-6 text-amber-400 animate-pulse" />
                </CardTitle>
                <CardDescription className="text-purple-200 text-lg mt-1">
                  載入、驗證和轉移 3D NFT 資產
                </CardDescription>
              </div>
            </div>
            <Button
              onClick={() => navigate({ to: '/admin' })}
              variant="ghost"
              className="text-purple-400 hover:text-purple-300 hover:bg-purple-400/10"
            >
              <ArrowLeft className="h-5 w-5 mr-2" />
              返回管理員頁面
            </Button>
          </div>
        </CardHeader>
      </Card>

      <Card className="bg-purple-900/50 border-purple-400/50">
        <CardHeader>
          <div className="flex items-center gap-3">
            <Upload className="h-6 w-6 text-purple-400" />
            <CardTitle className="text-2xl text-purple-400">載入新 NFT 資產</CardTitle>
          </div>
          <CardDescription className="text-purple-200">
            上傳 3D NFT 資產的名稱和元數據
          </CardDescription>
        </CardHeader>
        <CardContent>
          <form onSubmit={handleLoadNFT} className="space-y-4">
            <div className="space-y-2">
              <Label htmlFor="nftName" className="text-purple-200">
                NFT 名稱
              </Label>
              <Input
                id="nftName"
                type="text"
                placeholder="例如：Golden Lucky Clover #001"
                value={nftName}
                onChange={(e) => setNftName(e.target.value)}
                className="bg-purple-950/50 border-purple-400/30 text-purple-100 placeholder:text-purple-400/50"
                disabled={loadNFTMutation.isPending}
              />
            </div>
            <div className="space-y-2">
              <Label htmlFor="nftMetadata" className="text-purple-200">
                NFT 元數據 (JSON 格式)
              </Label>
              <Textarea
                id="nftMetadata"
                placeholder='{"model": "clover_3d.glb", "rarity": "legendary", "attributes": {...}}'
                value={nftMetadata}
                onChange={(e) => setNftMetadata(e.target.value)}
                className="bg-purple-950/50 border-purple-400/30 text-purple-100 placeholder:text-purple-400/50 min-h-[120px]"
                disabled={loadNFTMutation.isPending}
              />
            </div>
            <Button
              type="submit"
              className="w-full bg-purple-500 hover:bg-purple-600 active:bg-purple-700 text-white font-bold transition-all transform hover:scale-[1.02] active:scale-[0.98]"
              disabled={loadNFTMutation.isPending}
            >
              {loadNFTMutation.isPending ? (
                <>
                  <div className="h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent mr-2" />
                  載入中...
                </>
              ) : (
                <>
                  <Upload className="h-4 w-4 mr-2" />
                  載入 NFT 資產
                </>
              )}
            </Button>
          </form>
        </CardContent>
      </Card>

      <Card className="bg-purple-900/50 border-purple-400/50">
        <CardHeader>
          <CardTitle className="text-xl text-purple-400">所有 NFT 資產</CardTitle>
          <CardDescription className="text-purple-200">
            查看和管理已載入的 3D NFT 資產
          </CardDescription>
        </CardHeader>
        <CardContent>
          {nftAssetsLoading ? (
            <div className="space-y-3">
              <Skeleton className="h-24 w-full" />
              <Skeleton className="h-24 w-full" />
              <Skeleton className="h-24 w-full" />
            </div>
          ) : nftAssets && nftAssets.length > 0 ? (
            <div className="space-y-3">
              {nftAssets.map(([id, asset]) => (
                <div
                  key={id.toString()}
                  className="bg-purple-950/50 rounded-xl p-4 border border-purple-400/30"
                >
                  <div className="flex items-start justify-between gap-4">
                    <div className="flex-1">
                      <div className="flex items-center gap-2 mb-2">
                        <h3 className="text-purple-400 font-semibold">{asset.name}</h3>
                        <Badge variant={asset.validationStatus ? "default" : "secondary"} className={asset.validationStatus ? "bg-green-500" : "bg-gray-500"}>
                          {asset.validationStatus ? '已驗證' : '未驗證'}
                        </Badge>
                      </div>
                      <p className="text-purple-200 text-sm mb-2">ID: {id.toString()}</p>
                      <p className="text-purple-300 text-xs mb-2">擁有者: {asset.owner.toString()}</p>
                      <p className="text-purple-300 text-xs">
                        創建時間: {new Date(Number(asset.createdAt) / 1000000).toLocaleString('zh-TW')}
                      </p>
                    </div>
                    <div className="flex flex-col gap-2">
                      {!asset.validationStatus && (
                        <Button
                          onClick={() => handleValidateNFT(id)}
                          disabled={validateNFTMutation.isPending}
                          size="sm"
                          className="bg-green-500 hover:bg-green-600 text-white"
                        >
                          <CheckCircle2 className="h-4 w-4 mr-1" />
                          驗證
                        </Button>
                      )}
                      <Button
                        onClick={() => setTransferNftId(id)}
                        size="sm"
                        variant="outline"
                        className="border-purple-400/50 text-purple-400 hover:bg-purple-400/10"
                      >
                        <Send className="h-4 w-4 mr-1" />
                        轉移
                      </Button>
                    </div>
                  </div>
                </div>
              ))}
            </div>
          ) : (
            <p className="text-purple-300 text-center py-8">尚無 NFT 資產</p>
          )}
        </CardContent>
      </Card>

      {transferNftId !== null && (
        <Card className="bg-indigo-900/50 border-indigo-400/50">
          <CardHeader>
            <div className="flex items-center gap-3">
              <Send className="h-6 w-6 text-indigo-400" />
              <CardTitle className="text-2xl text-indigo-400">轉移 NFT 資產</CardTitle>
            </div>
            <CardDescription className="text-indigo-200">
              將 NFT #{transferNftId.toString()} 轉移給新擁有者
            </CardDescription>
          </CardHeader>
          <CardContent>
            <form onSubmit={handleTransferNFT} className="space-y-4">
              <div className="space-y-2">
                <Label htmlFor="transferTo" className="text-indigo-200">
                  新擁有者 Principal ID
                </Label>
                <Input
                  id="transferTo"
                  type="text"
                  placeholder="例如：xxxxx-xxxxx-xxxxx-xxxxx-xxx"
                  value={transferTo}
                  onChange={(e) => setTransferTo(e.target.value)}
                  className="bg-indigo-950/50 border-indigo-400/30 text-indigo-100 placeholder:text-indigo-400/50"
                  disabled={transferNFTMutation.isPending}
                />
              </div>
              <div className="flex gap-2">
                <Button
                  type="submit"
                  className="flex-1 bg-indigo-500 hover:bg-indigo-600 active:bg-indigo-700 text-white font-bold transition-all"
                  disabled={transferNFTMutation.isPending}
                >
                  {transferNFTMutation.isPending ? (
                    <>
                      <div className="h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent mr-2" />
                      轉移中...
                    </>
                  ) : (
                    <>
                      <Send className="h-4 w-4 mr-2" />
                      確認轉移
                    </>
                  )}
                </Button>
                <Button
                  type="button"
                  onClick={() => {
                    setTransferNftId(null);
                    setTransferTo('');
                  }}
                  variant="outline"
                  className="border-indigo-400/50 text-indigo-400 hover:bg-indigo-400/10"
                >
                  取消
                </Button>
              </div>
            </form>
          </CardContent>
        </Card>
      )}
    </div>
  );
}
PK
frontend/src/pages/NewbornLuckyEntrancePage.tsximport { useState, useCallback, useEffect } from 'react';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { ExternalLink, ArrowLeft, Sparkles, Orbit, Activity, Zap } from 'lucide-react';
import { toast } from 'sonner';
import { useGetSoulCollaborationSyncStatus } from '../hooks/useQueries';

interface UnifiedModuleLink {
  name: string;
  description: string;
  url: string;
  icon: string;
  category: 'core' | 'spiritual' | 'demonic' | 'anima' | 'ecosystem';
  status: 'active' | 'syncing' | 'offline';
}

const unifiedModuleLinks: UnifiedModuleLink[] = [
  {
    name: 'LFLCEI靈域模板',
    description: '寧靜祥和的靈性元宇宙環境',
    url: '/spiritual-realm',
    icon: '/assets/generated/spiritual-lotus-3d-transparent.dim_200x200.png',
    category: 'spiritual',
    status: 'active',
  },
  {
    name: 'LFLCEI妖域模板',
    description: '高能量的動態挑戰環境',
    url: '/demonic-realm',
    icon: '/assets/generated/demonic-flame-3d-transparent.dim_200x200.png',
    category: 'demonic',
    status: 'active',
  },
  {
    name: 'Anima Realm',
    description: '動畫世界沉浸式體驗',
    url: 'https://lflcei-anima-t5m.caffeine.xyz/',
    icon: '/assets/generated/lflcei-anima-icon-transparent.dim_64x64.png',
    category: 'anima',
    status: 'active',
  },
  {
    name: 'Lucky Draw Games',
    description: '幸運抽獎遊戲平台',
    url: 'https://lflc-lucky-draw-games-wzt.caffeine.xyz/',
    icon: '/assets/generated/lucky-draw-games-button-transparent.dim_200x80.png',
    category: 'ecosystem',
    status: 'active',
  },
  {
    name: 'Lucky Draw',
    description: '幸運抽獎系統',
    url: 'https://lflc-lucky-draw-8y8.caffeine.xyz/',
    icon: '/assets/generated/lucky-draw-button-transparent.dim_200x80.png',
    category: 'ecosystem',
    status: 'active',
  },
  {
    name: 'Oracle',
    description: '神諭預測系統',
    url: 'https://lflc-oracle-4bu.caffeine.xyz/',
    icon: '/assets/generated/oracle-button-transparent.dim_200x80.png',
    category: 'ecosystem',
    status: 'active',
  },
  {
    name: 'Wallet',
    description: '數位錢包管理',
    url: 'https://lflc-wallet-mm9.caffeine.xyz/',
    icon: '/assets/generated/wallet-icon-transparent.dim_64x64.png',
    category: 'ecosystem',
    status: 'active',
  },
  {
    name: 'Natural Intelligence',
    description: '自然智能系統',
    url: 'https://lflc-natural-intelligence-spd.caffeine.xyz/',
    icon: '/assets/generated/lflcei-natural-intelligence-icon-transparent.dim_64x64.png',
    category: 'ecosystem',
    status: 'active',
  },
  {
    name: 'Backstage Supporter',
    description: '後台支援系統',
    url: 'https://lflc-backstage-supporter-ixz.caffeine.xyz/',
    icon: '/assets/generated/backstage-supporter-button-transparent.dim_200x80.png',
    category: 'ecosystem',
    status: 'active',
  },
  {
    name: 'Data Ecosystem Platform',
    description: '數據生態系統平台',
    url: 'https://lflc-data-ecosystem-platform-0jp.caffeine.xyz/',
    icon: '/assets/generated/data-ecosystem-button-transparent.dim_200x80.png',
    category: 'ecosystem',
    status: 'active',
  },
];

interface NewbornLuckyEntrancePageProps {
  onNavigateBack: () => void;
}

export default function NewbornLuckyEntrancePage({ onNavigateBack }: NewbornLuckyEntrancePageProps) {
  const [loadingLinks, setLoadingLinks] = useState<Record<string, boolean>>({});
  const [hoveredLink, setHoveredLink] = useState<string | null>(null);
  const [moduleStatuses, setModuleStatuses] = useState<Record<string, 'active' | 'syncing' | 'offline'>>(
    Object.fromEntries(unifiedModuleLinks.map(link => [link.name, link.status]))
  );
  const [isSyncing, setIsSyncing] = useState(false);

  const { data: syncStatus } = useGetSoulCollaborationSyncStatus();

  // Simulate real-time module status updates
  useEffect(() => {
    const interval = setInterval(() => {
      setModuleStatuses(prev => {
        const updated = { ...prev };
        // Randomly update some module statuses for demonstration
        const keys = Object.keys(updated);
        const randomKey = keys[Math.floor(Math.random() * keys.length)];
        if (Math.random() > 0.9) {
          updated[randomKey] = updated[randomKey] === 'active' ? 'syncing' : 'active';
        }
        return updated;
      });
    }, 5000);

    return () => clearInterval(interval);
  }, []);

  const handleLinkClick = useCallback(async (url: string, linkName: string) => {
    setLoadingLinks(prev => ({ ...prev, [linkName]: true }));

    try {
      // GPU-accelerated lazy loading with requestAnimationFrame
      requestAnimationFrame(() => {
        if (url.startsWith('/')) {
          // Internal navigation
          toast.info('內部模組導航即將推出');
          setLoadingLinks(prev => ({ ...prev, [linkName]: false }));
          return;
        }

        const newWindow = window.open(url, '_blank', 'noopener,noreferrer');
        
        if (!newWindow || newWindow.closed || typeof newWindow.closed === 'undefined') {
          toast.error('彈出視窗被阻擋，請允許彈出視窗後重試');
          setLoadingLinks(prev => ({ ...prev, [linkName]: false }));
          return;
        }

        newWindow.focus();
        toast.success(`正在開啟 ${linkName}...`, {
          description: '初生宇宙入口已啟動',
          duration: 2000,
        });
        
        // Audio-visual sync effect
        setTimeout(() => {
          setLoadingLinks(prev => ({ ...prev, [linkName]: false }));
        }, 800);
      });
    } catch (error) {
      console.error('Error opening link:', error);
      toast.error('開啟連結失敗，請稍後再試');
      setLoadingLinks(prev => ({ ...prev, [linkName]: false }));
    }
  }, []);

  const handleCentralizedSync = useCallback(async () => {
    try {
      setIsSyncing(true);
      // Simulate sync process
      await new Promise(resolve => setTimeout(resolve, 2000));
      toast.success('中央化靈魂協作同步完成！', {
        description: '所有世界數據已同步',
      });
    } catch (error) {
      console.error('Sync error:', error);
      toast.error('同步失敗，請稍後再試');
    } finally {
      setIsSyncing(false);
    }
  }, []);

  const getCategoryColor = (category: string) => {
    switch (category) {
      case 'spiritual':
        return 'from-purple-900/50 to-blue-900/50 border-purple-400/50';
      case 'demonic':
        return 'from-red-900/50 to-orange-900/50 border-red-400/50';
      case 'anima':
        return 'from-pink-900/50 to-purple-900/50 border-pink-400/50';
      case 'ecosystem':
        return 'from-cyan-900/50 to-emerald-900/50 border-cyan-400/50';
      default:
        return 'from-slate-900/50 to-blue-900/50 border-cyan-400/50';
    }
  };

  const getStatusIndicator = (status: 'active' | 'syncing' | 'offline') => {
    switch (status) {
      case 'active':
        return <div className="h-3 w-3 rounded-full bg-green-400 animate-pulse shadow-lg shadow-green-400/50" />;
      case 'syncing':
        return <div className="h-3 w-3 rounded-full bg-yellow-400 animate-spin border-2 border-yellow-600" />;
      case 'offline':
        return <div className="h-3 w-3 rounded-full bg-gray-400" />;
    }
  };

  return (
    <div className="space-y-6 sm:space-y-8 animate-soul-manifestation">
      {/* Return Navigation and Sync Controls */}
      <div className="flex items-center justify-between flex-wrap gap-4">
        <Button
          onClick={onNavigateBack}
          variant="outline"
          className="border-cyan-400/50 text-cyan-100 hover:bg-cyan-400/20 hover:text-cyan-400 active:bg-cyan-400/30 transition-all shadow-lg hover:shadow-cyan-400/20"
        >
          <ArrowLeft className="h-4 w-4 mr-2" />
          返回主頁
        </Button>
        
        <div className="flex items-center gap-3">
          <div className="flex items-center gap-2 bg-cyan-950/30 px-4 py-2 rounded-lg border border-cyan-400/30">
            <Activity className="h-4 w-4 text-cyan-400 animate-pulse" />
            <span className="text-cyan-200 text-sm">
              {syncStatus?.lastSyncStatus || '等待同步'}
            </span>
          </div>
          <Button
            onClick={handleCentralizedSync}
            disabled={isSyncing}
            className="bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700 text-white shadow-lg hover:shadow-cyan-400/50"
          >
            {isSyncing ? (
              <>
                <div className="h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent mr-2"></div>
                同步中...
              </>
            ) : (
              <>
                <Zap className="h-4 w-4 mr-2" />
                中央同步
              </>
            )}
          </Button>
        </div>
      </div>

      {/* Main Unified Gateway Card */}
      <Card className={`bg-gradient-to-br ${getCategoryColor('core')} shadow-2xl card-transition hover:shadow-cyan-400/30 overflow-hidden relative`}>
        {/* Animated background overlay */}
        <div className="absolute inset-0 opacity-20 pointer-events-none">
          <div className="absolute inset-0 bg-[url('/assets/generated/unified-universe-gateway-portal.dim_800x600.png')] bg-cover bg-center animate-pulse-slow"></div>
          <div className="absolute inset-0 bg-gradient-to-br from-cyan-400/10 via-transparent to-emerald-400/10 animate-spiritual-aura-flow"></div>
        </div>

        {/* Cross-module navigation interface overlay */}
        <div className="absolute inset-0 opacity-10 pointer-events-none">
          <div className="absolute inset-0 bg-[url('/assets/generated/cross-module-navigation-interface.dim_1024x768.png')] bg-cover bg-center animate-manifestation-energy-pulse"></div>
        </div>

        <CardHeader className="relative z-10">
          <div className="flex items-center justify-between flex-wrap gap-4">
            <div className="flex-1">
              <CardTitle className="text-3xl sm:text-4xl md:text-5xl text-cyan-400 manifestation-glow mb-3 animate-enhanced-glow-transition flex items-center gap-3">
                <Orbit className="h-10 w-10 sm:h-12 sm:w-12 animate-spin" style={{ animationDuration: '8s' }} />
                初生宇宙入口閘道
              </CardTitle>
              <CardDescription className="text-cyan-200 text-base sm:text-lg md:text-xl">
                Unified Initial Universe Gateway • 統一初生宇宙整合架構系統
              </CardDescription>
            </div>
            <img
              src="/assets/generated/centralized-soul-sync-visualization-transparent.dim_600x400.png"
              alt="Centralized Soul Sync"
              className="h-20 w-20 sm:h-24 sm:w-24 md:h-28 md:w-28 rounded-full border-4 border-cyan-400 shadow-lg animate-manifestation-energy-pulse"
              loading="eager"
            />
          </div>
        </CardHeader>

        <CardContent className="relative z-10">
          <div className="bg-cyan-950/30 rounded-xl p-4 sm:p-6 border border-cyan-400/30 mb-6">
            <div className="flex items-center gap-3 mb-3">
              <Sparkles className="h-6 w-6 text-cyan-400 animate-pulse" />
              <h3 className="text-xl sm:text-2xl text-cyan-400 font-semibold">統一初生宇宙整合</h3>
            </div>
            <p className="text-cyan-100 text-sm sm:text-base leading-relaxed mb-4">
              所有子模組（靈域模板、妖域模板、Anima Realm、Lucky Draw、Oracle、Wallet、Natural Intelligence、Backstage Supporter、Data Ecosystem Platform）已融合為單一同步核心。
              透過中央化靈魂協作同步機制，實現跨世界用戶設定同步、統一積分和等級系統、全域靈魂協作狀態管理。
            </p>
            <div className="flex flex-wrap gap-2 text-xs text-cyan-200">
              <span className="bg-cyan-900/30 px-3 py-1 rounded-full border border-cyan-400/30 flex items-center gap-1">
                <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse"></div>
                跨模組存取
              </span>
              <span className="bg-cyan-900/30 px-3 py-1 rounded-full border border-cyan-400/30 flex items-center gap-1">
                <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse"></div>
                統一數據同步
              </span>
              <span className="bg-cyan-900/30 px-3 py-1 rounded-full border border-cyan-400/30 flex items-center gap-1">
                <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse"></div>
                全域資源預載入
              </span>
              <span className="bg-cyan-900/30 px-3 py-1 rounded-full border border-cyan-400/30 flex items-center gap-1">
                <div className="h-2 w-2 rounded-full bg-green-400 animate-pulse"></div>
                GPU加速轉場
              </span>
            </div>
          </div>

          {/* Unified Module Links Grid with Dynamic Status Indicators */}
          <div className="grid sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
            {unifiedModuleLinks.map((link, index) => {
              const isLoading = loadingLinks[link.name] || false;
              const isHovered = hoveredLink === link.name;
              const status = moduleStatuses[link.name] || 'active';
              
              return (
                <Button
                  key={index}
                  onClick={() => handleLinkClick(link.url, link.name)}
                  disabled={isLoading || status === 'offline'}
                  onMouseEnter={() => setHoveredLink(link.name)}
                  onMouseLeave={() => setHoveredLink(null)}
                  variant="ghost"
                  className={`h-auto rounded-xl p-4 sm:p-6 border transition-all group text-left relative justify-start overflow-hidden ${
                    isHovered
                      ? `bg-gradient-to-br ${getCategoryColor(link.category)} shadow-lg shadow-cyan-400/30 animate-dynamic-spiritual-lighting`
                      : `bg-cyan-950/30 ${getCategoryColor(link.category)}`
                  } ${isLoading ? 'animate-pulse' : ''} ${status === 'offline' ? 'opacity-50' : ''}`}
                  style={{
                    animationDelay: `${index * 0.1}s`,
                  }}
                >
                  {/* Status Indicator */}
                  <div className="absolute top-3 right-3 z-10">
                    {getStatusIndicator(status)}
                  </div>

                  {/* Glowing hover effect */}
                  {isHovered && !isLoading && status !== 'offline' && (
                    <div className="absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-500 bg-gradient-to-r from-cyan-400/0 via-cyan-400/20 to-cyan-400/0 animate-spiritual-aura-flow"></div>
                  )}
                  
                  {/* Loading overlay */}
                  {isLoading && (
                    <div className="absolute inset-0 bg-cyan-400/20 backdrop-blur-sm flex items-center justify-center z-10">
                      <div className="flex flex-col items-center gap-2">
                        <div className="h-8 w-8 animate-spin rounded-full border-4 border-cyan-400 border-t-transparent"></div>
                        <span className="text-cyan-400 font-semibold text-sm">啟動中...</span>
                      </div>
                    </div>
                  )}
                  
                  <div className="flex flex-col items-center gap-4 w-full relative z-0">
                    <img
                      src={link.icon}
                      alt={link.name}
                      className={`h-16 w-16 sm:h-20 sm:w-20 rounded-lg border transition-all ${
                        isHovered
                          ? 'border-cyan-400 scale-110 rotate-3 shadow-lg shadow-cyan-400/50 animate-manifestation-energy-pulse'
                          : 'border-cyan-400/30 group-hover:border-cyan-400'
                      }`}
                      loading="lazy"
                    />
                    <div className="flex-1 min-w-0 text-center">
                      <div className="flex items-center justify-center gap-2 mb-2">
                        <h3 className={`font-semibold text-sm sm:text-base transition-colors ${
                          isHovered
                            ? 'text-cyan-300 manifestation-glow'
                            : 'text-cyan-400 group-hover:text-cyan-300'
                        }`}>
                          {link.name}
                        </h3>
                        <ExternalLink className={`h-4 w-4 flex-shrink-0 transition-transform ${
                          isHovered
                            ? 'text-cyan-300 translate-x-1 -translate-y-1'
                            : 'text-cyan-400'
                        }`} />
                      </div>
                      <p className="text-cyan-200 text-xs sm:text-sm">{link.description}</p>
                      <p className="text-cyan-300 text-xs mt-1 capitalize">{link.category}</p>
                    </div>
                  </div>
                </Button>
              );
            })}
          </div>

          {/* Responsive device-specific images */}
          <div className="mt-8 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 opacity-50">
            <img
              src="/assets/generated/mobile-unified-gateway-interface.dim_375x667.png"
              alt="Mobile Gateway"
              className="w-full h-auto rounded-lg border border-cyan-400/20 sm:hidden"
              loading="lazy"
            />
            <img
              src="/assets/generated/tablet-entrance-gateway.dim_1024x768.png"
              alt="Tablet Gateway"
              className="w-full h-auto rounded-lg border border-cyan-400/20 hidden sm:block lg:hidden"
              loading="lazy"
            />
            <img
              src="/assets/generated/unified-initialization-sequence.dim_1920x1080.png"
              alt="Desktop Gateway"
              className="w-full h-auto rounded-lg border border-cyan-400/20 hidden lg:block"
              loading="lazy"
            />
          </div>
        </CardContent>
      </Card>

      {/* Centralized Soul Collaboration Info Card */}
      <Card className="bg-gradient-to-r from-purple-900/30 to-pink-900/30 border-purple-400/30 shadow-xl">
        <CardHeader>
          <CardTitle className="text-xl sm:text-2xl text-purple-400 flex items-center gap-2">
            <Activity className="h-5 w-5 sm:h-6 sm:w-6 animate-pulse" />
            中央化靈魂協作同步系統
          </CardTitle>
        </CardHeader>
        <CardContent>
          <div className="space-y-3 text-purple-100 text-sm sm:text-base">
            <p className="flex items-start gap-2">
              <span className="text-purple-400 font-bold">•</span>
              <span>統一數據同步邏輯：跨世界用戶設定同步、統一積分和等級系統</span>
            </p>
            <p className="flex items-start gap-2">
              <span className="text-purple-400 font-bold">•</span>
              <span>同步協調機制：中央化同步調度器、背景自動同步服務</span>
            </p>
            <p className="flex items-start gap-2">
              <span className="text-purple-400 font-bold">•</span>
              <span>跨模組狀態管理：統一的用戶狀態追蹤、模組間數據共享機制</span>
            </p>
            <p className="flex items-start gap-2">
              <span className="text-purple-400 font-bold">•</span>
              <span>全域事件廣播系統：狀態變更即時通知、跨世界成就和進度同步</span>
            </p>
          </div>
          <div className="mt-4 bg-purple-950/30 rounded-lg p-4 border border-purple-400/30">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-purple-300 text-sm">最後同步時間</p>
                <p className="text-purple-400 font-semibold">
                  {syncStatus?.lastSyncTime 
                    ? new Date(Number(syncStatus.lastSyncTime) / 1000000).toLocaleString('zh-TW')
                    : '尚未同步'}
                </p>
              </div>
              <img
                src="/assets/generated/centralized-soul-sync-visualization-transparent.dim_600x400.png"
                alt="Soul Sync"
                className="h-12 w-12 animate-pulse-slow"
                loading="lazy"
              />
            </div>
          </div>
        </CardContent>
      </Card>

      {/* GPU Acceleration & Performance Info Card */}
      <Card className="bg-gradient-to-r from-cyan-900/30 to-emerald-900/30 border-cyan-400/30 shadow-xl">
        <CardHeader>
          <CardTitle className="text-xl sm:text-2xl text-cyan-400 flex items-center gap-2">
            <Zap className="h-5 w-5 sm:h-6 sm:w-6" />
            GPU加速轉場和資源管理
          </CardTitle>
        </CardHeader>
        <CardContent>
          <div className="space-y-3 text-cyan-100 text-sm sm:text-base">
            <p className="flex items-start gap-2">
              <span className="text-cyan-400 font-bold">•</span>
              <span>Unity風格3D渲染流程優化、跨模組流暢轉場動畫</span>
            </p>
            <p className="flex items-start gap-2">
              <span className="text-cyan-400 font-bold">•</span>
              <span>全域資源預載入系統：智能資源預載入策略、跨模組資源共享機制</span>
            </p>
            <p className="flex items-start gap-2">
              <span className="text-cyan-400 font-bold">•</span>
              <span>渲染同步機制：統一渲染管線、跨模組渲染狀態同步</span>
            </p>
            <p className="flex items-start gap-2">
              <span className="text-cyan-400 font-bold">•</span>
              <span>行動裝置響應式優化：移動端GPU效果優化、電池使用優化</span>
            </p>
          </div>
        </CardContent>
      </Card>
    </div>
  );
}
PK
frontend/src/pages/NineRealmsHubPage.tsximport { useState, useEffect } from 'react';
import { useGetAllStarRealms, useGetUserRealms, useUpdateUserRealmStats } from '../hooks/useQueries';
import { useInternetIdentity } from '../hooks/useInternetIdentity';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Skeleton } from '@/components/ui/skeleton';
import { Progress } from '@/components/ui/progress';
import { ArrowLeft, Sparkles, TrendingUp, Award, Layers, Zap, Activity, Globe } from 'lucide-react';
import { RealmType } from '../backend';
import { toast } from 'sonner';

interface NineRealmsHubPageProps {
  onNavigateBack: () => void;
  onNavigateToRealm: (realmId: number) => void;
}

const realmThemes: Record<RealmType, { 
  gradient: string; 
  borderColor: string; 
  textColor: string; 
  icon: string;
  bgImage: string;
  energyColor: string;
  particleEffect: string;
}> = {
  [RealmType.fairy]: {
    gradient: 'from-pink-900/50 via-purple-900/50 to-blue-900/50',
    borderColor: 'border-pink-400/50',
    textColor: 'text-pink-400',
    icon: '🌸',
    bgImage: '/assets/generated/xian-dao-interactive-background.dim_1920x1080.png',
    energyColor: 'bg-pink-400',
    particleEffect: 'animate-float',
  },
  [RealmType.cultivation]: {
    gradient: 'from-green-900/50 via-emerald-900/50 to-teal-900/50',
    borderColor: 'border-emerald-400/50',
    textColor: 'text-emerald-400',
    icon: '⚗️',
    bgImage: '/assets/generated/xiuzhen-interactive-background.dim_1920x1080.png',
    energyColor: 'bg-emerald-400',
    particleEffect: 'animate-pulse',
  },
  [RealmType.martial]: {
    gradient: 'from-red-900/50 via-orange-900/50 to-yellow-900/50',
    borderColor: 'border-orange-400/50',
    textColor: 'text-orange-400',
    icon: '⚔️',
    bgImage: '/assets/generated/wudao-interactive-background.dim_1920x1080.png',
    energyColor: 'bg-orange-400',
    particleEffect: 'animate-bounce',
  },
  [RealmType.buddhist]: {
    gradient: 'from-amber-900/50 via-yellow-900/50 to-orange-900/50',
    borderColor: 'border-amber-400/50',
    textColor: 'text-amber-400',
    icon: '🪷',
    bgImage: '/assets/generated/fo-guo-interactive-background.dim_1920x1080.png',
    energyColor: 'bg-amber-400',
    particleEffect: 'animate-spin-slow',
  },
  [RealmType.heavenly]: {
    gradient: 'from-blue-900/50 via-cyan-900/50 to-sky-900/50',
    borderColor: 'border-cyan-400/50',
    textColor: 'text-cyan-400',
    icon: '☁️',
    bgImage: '/assets/generated/tian-tang-interactive-background.dim_1920x1080.png',
    energyColor: 'bg-cyan-400',
    particleEffect: 'animate-float',
  },
  [RealmType.demonic]: {
    gradient: 'from-red-950/50 via-rose-950/50 to-red-900/50',
    borderColor: 'border-red-400/50',
    textColor: 'text-red-400',
    icon: '🔥',
    bgImage: '/assets/generated/di-yu-interactive-background.dim_1920x1080.png',
    energyColor: 'bg-red-400',
    particleEffect: 'animate-pulse',
  },
  [RealmType.underworld]: {
    gradient: 'from-green-950/50 via-teal-950/50 to-cyan-950/50',
    borderColor: 'border-teal-400/50',
    textColor: 'text-teal-400',
    icon: '👻',
    bgImage: '/assets/generated/di-fu-interactive-background.dim_1920x1080.png',
    energyColor: 'bg-teal-400',
    particleEffect: 'animate-float',
  },
  [RealmType.divine]: {
    gradient: 'from-yellow-900/50 via-amber-900/50 to-orange-900/50',
    borderColor: 'border-yellow-400/50',
    textColor: 'text-yellow-400',
    icon: '⚡',
    bgImage: '/assets/generated/shen-dian-interactive-background.dim_1920x1080.png',
    energyColor: 'bg-yellow-400',
    particleEffect: 'animate-pulse',
  },
};

export default function NineRealmsHubPage({ onNavigateBack, onNavigateToRealm }: NineRealmsHubPageProps) {
  const { data: allRealms, isLoading: realmsLoading } = useGetAllStarRealms();
  const { identity } = useInternetIdentity();
  const { data: userRealms, isLoading: userRealmsLoading } = useGetUserRealms(identity?.getPrincipal() || null);
  const updateRealmStats = useUpdateUserRealmStats();
  
  const [energyFlowAnimation, setEnergyFlowAnimation] = useState<Record<number, number>>({});
  const [hoveredRealm, setHoveredRealm] = useState<number | null>(null);

  // Simulate dynamic energy flow
  useEffect(() => {
    const interval = setInterval(() => {
      setEnergyFlowAnimation(prev => {
        const updated = { ...prev };
        userRealms?.forEach(realm => {
          const realmId = Number(realm.id);
          updated[realmId] = (updated[realmId] || 0) + Math.random() * 5;
          if (updated[realmId] > 100) updated[realmId] = 0;
        });
        return updated;
      });
    }, 100);

    return () => clearInterval(interval);
  }, [userRealms]);

  if (realmsLoading || userRealmsLoading) {
    return (
      <div className="space-y-6 animate-fade-in">
        <Skeleton className="h-48 w-full rounded-xl" />
        <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
          {[...Array(8)].map((_, i) => (
            <Skeleton key={i} className="h-64 rounded-xl" />
          ))}
        </div>
      </div>
    );
  }

  // Calculate total realm stats
  const totalRealmPoints = userRealms?.reduce((sum, realm) => sum + Number(realm.realmPoints), 0) || 0;
  const totalReputation = userRealms?.reduce((sum, realm) => sum + Number(realm.reputationPoints), 0) || 0;
  const totalChallenges = userRealms?.reduce((sum, realm) => sum + Number(realm.challengeScores), 0) || 0;
  const totalEnergyValue = totalRealmPoints * 1.5 + totalReputation * 2.0 + totalChallenges * 1.8;

  const handleRealmInteraction = async (realmId: number) => {
    const realm = userRealms?.find(r => Number(r.id) === realmId);
    if (!realm) return;

    // Simulate energy gain from interaction
    const energyGain = Math.floor(Math.random() * 10) + 5;
    const newPoints = Number(realm.realmPoints) + energyGain;

    try {
      await updateRealmStats.mutateAsync({
        realmId: BigInt(realmId),
        points: BigInt(newPoints),
        reputation: realm.reputationPoints,
        challenges: realm.challengeScores,
      });
      
      toast.success(`${realm.name} 能量提升！`, {
        description: `獲得 ${energyGain} 點界別積分`,
      });
    } catch (error) {
      console.error('Failed to update realm stats:', error);
    }
  };

  return (
    <div className="space-y-6 sm:space-y-8 animate-fade-in">
      {/* Header with Enhanced Visuals */}
      <Card className="bg-gradient-to-br from-purple-900/50 via-indigo-900/50 to-blue-900/50 border-purple-400/50 shadow-2xl overflow-hidden relative">
        <div className="absolute inset-0 opacity-20 pointer-events-none">
          <div className="absolute inset-0 bg-[url('/assets/generated/nine-realms-navigation-hub.dim_800x800.png')] bg-cover bg-center animate-pulse-slow"></div>
          <div className="absolute inset-0 bg-gradient-to-br from-purple-500/10 via-transparent to-blue-500/10 animate-spiritual-aura-flow"></div>
        </div>
        
        <CardHeader className="relative z-10">
          <div className="flex items-center justify-between flex-wrap gap-4">
            <div className="flex-1">
              <CardTitle className="text-3xl sm:text-4xl md:text-5xl text-purple-400 manifestation-glow mb-2">
                靈界核心框架 • Nine Realms Core
              </CardTitle>
              <CardDescription className="text-purple-200 text-base sm:text-lg">
                統一九界模組化系統 • 跨界修煉與能量融合
              </CardDescription>
            </div>
            <Button
              onClick={onNavigateBack}
              variant="outline"
              className="border-purple-400/50 text-purple-400 hover:bg-purple-400/20"
            >
              <ArrowLeft className="h-4 w-4 mr-2" />
              返回首頁
            </Button>
          </div>
        </CardHeader>
        <CardContent className="relative z-10">
          <div className="bg-purple-950/30 rounded-xl p-4 sm:p-6 border border-purple-400/30 mb-4">
            <p className="text-purple-100 text-sm sm:text-base leading-relaxed mb-4">
              靈界核心框架整合了九大修煉界域：仙島、修真聖地、武道聖地、佛國、天堂、地獄、地府、神殿、靈府。每個界域都擁有獨特的能量系統、修煉任務和成就系統。跨界修煉，提升您的靈力與境界，實現九界融合的終極目標。
            </p>
            <div className="flex flex-wrap gap-2 text-xs text-purple-200">
              <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30">仙島 🌸</span>
              <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30">修真聖地 ⚗️</span>
              <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30">武道聖地 ⚔️</span>
              <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30">佛國 🪷</span>
              <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30">天堂 ☁️</span>
              <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30">地獄 🔥</span>
              <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30">地府 👻</span>
              <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30">神殿 ⚡</span>
            </div>
          </div>

          {/* Unified Cross-Realm Stats with Energy Tracking */}
          <div className="grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4">
            <div className="bg-purple-900/30 rounded-lg p-3 border border-purple-400/30">
              <div className="flex items-center gap-2 mb-1">
                <Sparkles className="h-4 w-4 text-purple-400" />
                <span className="text-xs text-purple-200">跨界總積分</span>
              </div>
              <p className="text-xl sm:text-2xl font-bold text-purple-400">
                {totalRealmPoints.toLocaleString()}
              </p>
            </div>
            <div className="bg-purple-900/30 rounded-lg p-3 border border-purple-400/30">
              <div className="flex items-center gap-2 mb-1">
                <TrendingUp className="h-4 w-4 text-purple-400" />
                <span className="text-xs text-purple-200">總聲望值</span>
              </div>
              <p className="text-xl sm:text-2xl font-bold text-purple-400">
                {totalReputation.toLocaleString()}
              </p>
            </div>
            <div className="bg-purple-900/30 rounded-lg p-3 border border-purple-400/30">
              <div className="flex items-center gap-2 mb-1">
                <Award className="h-4 w-4 text-purple-400" />
                <span className="text-xs text-purple-200">總挑戰分</span>
              </div>
              <p className="text-xl sm:text-2xl font-bold text-purple-400">
                {totalChallenges.toLocaleString()}
              </p>
            </div>
            <div className="bg-purple-900/30 rounded-lg p-3 border border-purple-400/30">
              <div className="flex items-center gap-2 mb-1">
                <Zap className="h-4 w-4 text-purple-400" />
                <span className="text-xs text-purple-200">總能量值</span>
              </div>
              <p className="text-xl sm:text-2xl font-bold text-purple-400">
                {totalEnergyValue.toFixed(0)}
              </p>
            </div>
          </div>
        </CardContent>
      </Card>

      {/* Enhanced Modular Realm Switching Interface with Interactive Backgrounds */}
      <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
        {allRealms?.map((realm) => {
          const theme = realmThemes[realm.realmType];
          const userRealm = userRealms?.find(r => r.id === realm.id);
          const realmId = Number(realm.id);
          const energyFlow = energyFlowAnimation[realmId] || 0;
          const isHovered = hoveredRealm === realmId;
          
          return (
            <Card
              key={realmId}
              className={`bg-gradient-to-br ${theme.gradient} ${theme.borderColor} shadow-xl card-transition hover:shadow-2xl cursor-pointer group overflow-hidden relative transform transition-all duration-300 ${
                isHovered ? 'scale-105 z-10' : ''
              }`}
              onClick={() => handleRealmInteraction(realmId)}
              onMouseEnter={() => setHoveredRealm(realmId)}
              onMouseLeave={() => setHoveredRealm(null)}
            >
              {/* Interactive Background with Theme Animation */}
              <div className="absolute inset-0 opacity-30 pointer-events-none overflow-hidden">
                <img 
                  src={theme.bgImage}
                  alt={realm.name}
                  className={`w-full h-full object-cover ${isHovered ? 'scale-110' : 'scale-100'} transition-transform duration-700`}
                />
                <div className={`absolute inset-0 bg-gradient-to-br from-white/10 via-transparent to-black/10 ${theme.particleEffect}`}></div>
              </div>

              {/* Energy Flow Particles */}
              <div className="absolute inset-0 pointer-events-none overflow-hidden">
                {[...Array(5)].map((_, i) => (
                  <div
                    key={i}
                    className={`absolute w-2 h-2 rounded-full ${theme.energyColor} opacity-60 blur-sm`}
                    style={{
                      left: `${(energyFlow + i * 20) % 100}%`,
                      top: `${(energyFlow * 0.7 + i * 15) % 100}%`,
                      animation: `float ${3 + i}s ease-in-out infinite`,
                      animationDelay: `${i * 0.5}s`,
                    }}
                  />
                ))}
              </div>
              
              <CardHeader className="relative z-10">
                <div className="flex items-center justify-between mb-2">
                  <span className={`text-4xl ${theme.particleEffect}`}>{theme.icon}</span>
                  <div className={`px-3 py-1 rounded-full ${theme.borderColor} border bg-black/30`}>
                    <span className={`text-xs font-semibold ${theme.textColor}`}>
                      {realm.energyType}
                    </span>
                  </div>
                </div>
                <CardTitle className={`text-xl sm:text-2xl ${theme.textColor} manifestation-glow`}>
                  {realm.name}
                </CardTitle>
                <CardDescription className="text-white/80 text-sm line-clamp-2">
                  {realm.description}
                </CardDescription>
              </CardHeader>
              
              <CardContent className="relative z-10 space-y-3">
                {userRealm && (
                  <div className="space-y-2">
                    {/* Dynamic Energy Tracking */}
                    <div className="bg-black/30 rounded-lg p-2 border border-white/10">
                      <div className="flex items-center justify-between text-xs mb-1">
                        <span className="text-white/80">能量流動</span>
                        <span className={theme.textColor}>{energyFlow.toFixed(0)}%</span>
                      </div>
                      <Progress value={energyFlow} className="h-1.5 bg-black/50">
                        <div 
                          className={`h-full ${theme.energyColor} rounded-full transition-all duration-300 animate-pulse`}
                          style={{ width: `${energyFlow}%` }}
                        />
                      </Progress>
                    </div>

                    <div className="flex items-center justify-between text-xs">
                      <div className="flex items-center gap-1">
                        <Sparkles className="h-3 w-3" />
                        <span>界別積分</span>
                      </div>
                      <span className={`font-bold ${theme.textColor}`}>
                        {Number(userRealm.realmPoints)}
                      </span>
                    </div>
                    <div className="flex items-center justify-between text-xs">
                      <div className="flex items-center gap-1">
                        <TrendingUp className="h-3 w-3" />
                        <span>聲望值</span>
                      </div>
                      <span className={`font-bold ${theme.textColor}`}>
                        {Number(userRealm.reputationPoints)}
                      </span>
                    </div>
                    <div className="flex items-center justify-between text-xs">
                      <div className="flex items-center gap-1">
                        <Award className="h-3 w-3" />
                        <span>挑戰分數</span>
                      </div>
                      <span className={`font-bold ${theme.textColor}`}>
                        {Number(userRealm.challengeScores)}
                      </span>
                    </div>
                  </div>
                )}
                
                <Button
                  className={`w-full bg-gradient-to-r ${theme.gradient} hover:opacity-90 text-white font-bold transition-all transform group-hover:scale-105`}
                  onClick={(e) => {
                    e.stopPropagation();
                    onNavigateToRealm(realmId);
                  }}
                >
                  <Layers className="h-4 w-4 mr-2" />
                  進入{realm.name}
                </Button>
              </CardContent>
            </Card>
          );
        })}
      </div>

      {/* Cross-Realm Energy Flow Visualization */}
      <Card className="bg-gradient-to-br from-indigo-900/50 via-purple-900/50 to-pink-900/50 border-indigo-400/50 shadow-xl overflow-hidden relative">
        <div className="absolute inset-0 opacity-10 pointer-events-none">
          <img 
            src="/assets/generated/cross-realm-energy-flow-visualization.dim_1000x600.png"
            alt="能量流動"
            className="w-full h-full object-cover animate-pulse-slow"
          />
        </div>
        
        <CardHeader className="relative z-10">
          <CardTitle className="text-2xl text-indigo-400 flex items-center gap-2">
            <Activity className="h-6 w-6 animate-pulse" />
            跨界能量流動可視化
          </CardTitle>
          <CardDescription className="text-indigo-200">
            實時監控九界能量交換與平衡狀態
          </CardDescription>
        </CardHeader>
        <CardContent className="relative z-10">
          <div className="bg-indigo-950/30 rounded-xl p-6 border border-indigo-400/30">
            <div className="flex items-center justify-center mb-4">
              <img 
                src="/assets/generated/cross-realm-energy-flow-visualization.dim_1000x600.png"
                alt="能量流動圖"
                className="w-full max-w-2xl rounded-lg opacity-80 hover:opacity-100 transition-opacity"
              />
            </div>
            
            {/* Real-time Energy Analytics */}
            <div className="grid grid-cols-2 md:grid-cols-4 gap-3 mt-4">
              <div className="bg-indigo-900/30 rounded-lg p-3 border border-indigo-400/30">
                <div className="flex items-center gap-2 mb-1">
                  <Globe className="h-4 w-4 text-indigo-400" />
                  <span className="text-xs text-indigo-200">活躍界域</span>
                </div>
                <p className="text-xl font-bold text-indigo-400">
                  {userRealms?.length || 0} / 8
                </p>
              </div>
              <div className="bg-indigo-900/30 rounded-lg p-3 border border-indigo-400/30">
                <div className="flex items-center gap-2 mb-1">
                  <Zap className="h-4 w-4 text-indigo-400" />
                  <span className="text-xs text-indigo-200">能量總值</span>
                </div>
                <p className="text-xl font-bold text-indigo-400">
                  {totalEnergyValue.toFixed(0)}
                </p>
              </div>
              <div className="bg-indigo-900/30 rounded-lg p-3 border border-indigo-400/30">
                <div className="flex items-center gap-2 mb-1">
                  <Activity className="h-4 w-4 text-indigo-400" />
                  <span className="text-xs text-indigo-200">流動速率</span>
                </div>
                <p className="text-xl font-bold text-indigo-400">
                  {(totalEnergyValue / 1000).toFixed(2)}
                </p>
              </div>
              <div className="bg-indigo-900/30 rounded-lg p-3 border border-indigo-400/30">
                <div className="flex items-center gap-2 mb-1">
                  <Layers className="h-4 w-4 text-indigo-400" />
                  <span className="text-xs text-indigo-200">融合度</span>
                </div>
                <p className="text-xl font-bold text-indigo-400">
                  {Math.min(100, (totalRealmPoints / 100)).toFixed(0)}%
                </p>
              </div>
            </div>
            
            <p className="text-indigo-100 text-sm text-center mt-4">
              九界能量系統實現統一協調，跨界修煉可獲得能量加成效果
            </p>
          </div>
        </CardContent>
      </Card>
    </div>
  );
}
PK
frontend/src/pages/ProfilePage.tsximport { useGetCallerUserProfile } from '../hooks/useQueries';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { User, Sparkles, Calendar, Trophy, TrendingUp } from 'lucide-react';
import { Skeleton } from '@/components/ui/skeleton';
import { ScrollArea } from '@/components/ui/scroll-area';

const rewardTypeColors = {
  common: 'text-gray-400',
  rare: 'text-blue-400',
  epic: 'text-purple-400',
  legendary: 'text-amber-400',
};

export default function ProfilePage() {
  const { data: userProfile, isLoading } = useGetCallerUserProfile();

  if (isLoading) {
    return (
      <div className="space-y-6">
        <Skeleton className="h-48 w-full" />
        <div className="grid md:grid-cols-2 gap-6">
          <Skeleton className="h-96" />
          <Skeleton className="h-96" />
        </div>
      </div>
    );
  }

  if (!userProfile) return null;

  const completedDays = userProfile.dayCycle.filter((d) => d.timestamp !== 0n).length;
  const totalRewards = userProfile.rewardHistory.length;

  return (
    <div className="space-y-6 animate-fade-in max-w-6xl mx-auto">
      {/* Profile Header */}
      <Card className="bg-gradient-to-r from-emerald-800 to-green-700 border-amber-400/50 shadow-xl">
        <CardHeader>
          <div className="flex items-center gap-4">
            <div className="p-4 bg-amber-400/20 rounded-full">
              <User className="h-12 w-12 text-amber-400" />
            </div>
            <div>
              <CardTitle className="text-3xl text-amber-400 clover-glow">{userProfile.name}</CardTitle>
              <CardDescription className="text-emerald-200 text-lg">
                LFLC 幸運玩家
              </CardDescription>
            </div>
          </div>
        </CardHeader>
        <CardContent>
          <div className="grid sm:grid-cols-4 gap-4">
            <div className="bg-emerald-950/50 rounded-lg p-4 border border-amber-400/30">
              <div className="flex items-center gap-2 mb-2">
                <Sparkles className="h-5 w-5 text-amber-400" />
                <span className="text-emerald-200 text-sm">當前積分</span>
              </div>
              <p className="text-3xl font-bold text-amber-400">
                {Number(userProfile.points).toLocaleString()}
              </p>
            </div>
            <div className="bg-emerald-950/50 rounded-lg p-4 border border-amber-400/30">
              <div className="flex items-center gap-2 mb-2">
                <Calendar className="h-5 w-5 text-amber-400" />
                <span className="text-emerald-200 text-sm">連續簽到</span>
              </div>
              <p className="text-3xl font-bold text-amber-400">{completedDays} 天</p>
            </div>
            <div className="bg-emerald-950/50 rounded-lg p-4 border border-amber-400/30">
              <div className="flex items-center gap-2 mb-2">
                <TrendingUp className="h-5 w-5 text-amber-400" />
                <span className="text-emerald-200 text-sm">完成循環</span>
              </div>
              <p className="text-3xl font-bold text-amber-400">
                {Number(userProfile.cycleCompletedCount)}
              </p>
            </div>
            <div className="bg-emerald-950/50 rounded-lg p-4 border border-amber-400/30">
              <div className="flex items-center gap-2 mb-2">
                <Trophy className="h-5 w-5 text-amber-400" />
                <span className="text-emerald-200 text-sm">獲得獎品</span>
              </div>
              <p className="text-3xl font-bold text-amber-400">{totalRewards}</p>
            </div>
          </div>
        </CardContent>
      </Card>

      <div className="grid md:grid-cols-2 gap-6">
        {/* Check-in Progress */}
        <Card className="bg-emerald-900/50 border-amber-400/50">
          <CardHeader>
            <CardTitle className="text-2xl text-amber-400">簽到進度</CardTitle>
          </CardHeader>
          <CardContent>
            <div className="space-y-3">
              {userProfile.dayCycle.map((day) => {
                const isCompleted = day.timestamp !== 0n;
                return (
                  <div
                    key={Number(day.day)}
                    className={`flex items-center justify-between p-3 rounded-lg border ${
                      isCompleted
                        ? 'bg-amber-400/20 border-amber-400'
                        : 'bg-emerald-950/50 border-emerald-700'
                    }`}
                  >
                    <div className="flex items-center gap-3">
                      <Calendar className={`h-5 w-5 ${isCompleted ? 'text-amber-400' : 'text-emerald-400'}`} />
                      <span className={isCompleted ? 'text-amber-400' : 'text-emerald-200'}>
                        第 {Number(day.day)} 天
                      </span>
                    </div>
                    <div className="text-right">
                      <p className={`font-semibold ${isCompleted ? 'text-amber-400' : 'text-emerald-200'}`}>
                        +{Number(2n + day.rewardPoints)} 積分
                      </p>
                      {isCompleted && day.timestamp !== 0n && (
                        <p className="text-emerald-300 text-xs">
                          {new Date(Number(day.timestamp) / 1000000).toLocaleDateString('zh-TW')}
                        </p>
                      )}
                    </div>
                  </div>
                );
              })}
            </div>
          </CardContent>
        </Card>

        {/* Reward History */}
        <Card className="bg-emerald-900/50 border-amber-400/50">
          <CardHeader>
            <CardTitle className="text-2xl text-amber-400">獎品記錄</CardTitle>
            <CardDescription className="text-emerald-200">
              共獲得 {totalRewards} 個獎品
            </CardDescription>
          </CardHeader>
          <CardContent>
            {totalRewards === 0 ? (
              <div className="text-center py-8 text-emerald-300">
                <Trophy className="h-12 w-12 mx-auto mb-2 opacity-50" />
                <p>還沒有獲得任何獎品</p>
                <p className="text-sm">快去抽盲盒吧！</p>
              </div>
            ) : (
              <ScrollArea className="h-[400px] pr-4">
                <div className="space-y-3">
                  {[...userProfile.rewardHistory].reverse().map((reward) => (
                    <div
                      key={Number(reward.id)}
                      className="flex items-center justify-between p-3 rounded-lg bg-emerald-950/50 border border-amber-400/30"
                    >
                      <div className="flex items-center gap-3">
                        <Trophy className={`h-5 w-5 ${rewardTypeColors[reward.reward.rewardType]}`} />
                        <div>
                          <p className={`font-semibold ${rewardTypeColors[reward.reward.rewardType]}`}>
                            {reward.reward.name}
                          </p>
                          <p className="text-emerald-300 text-xs">
                            {reward.reward.rewardType === 'legendary' && '傳說'}
                            {reward.reward.rewardType === 'epic' && '史詩'}
                            {reward.reward.rewardType === 'rare' && '稀有'}
                            {reward.reward.rewardType === 'common' && '普通'}
                          </p>
                        </div>
                      </div>
                      <p className="text-emerald-300 text-xs">
                        {new Date(Number(reward.timestamp) / 1000000).toLocaleDateString('zh-TW')}
                      </p>
                    </div>
                  ))}
                </div>
              </ScrollArea>
            )}
          </CardContent>
        </Card>
      </div>

      {/* Statistics */}
      <Card className="bg-emerald-900/50 border-amber-400/50">
        <CardHeader>
          <CardTitle className="text-2xl text-amber-400">統計資料</CardTitle>
        </CardHeader>
        <CardContent>
          <div className="grid sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div className="bg-emerald-950/50 rounded-lg p-4 border border-amber-400/30">
              <p className="text-emerald-200 text-sm mb-1">傳說獎品</p>
              <p className="text-2xl font-bold text-amber-400">
                {userProfile.rewardHistory.filter((r) => r.reward.rewardType === 'legendary').length}
              </p>
            </div>
            <div className="bg-emerald-950/50 rounded-lg p-4 border border-amber-400/30">
              <p className="text-emerald-200 text-sm mb-1">史詩獎品</p>
              <p className="text-2xl font-bold text-purple-400">
                {userProfile.rewardHistory.filter((r) => r.reward.rewardType === 'epic').length}
              </p>
            </div>
            <div className="bg-emerald-950/50 rounded-lg p-4 border border-amber-400/30">
              <p className="text-emerald-200 text-sm mb-1">稀有獎品</p>
              <p className="text-2xl font-bold text-blue-400">
                {userProfile.rewardHistory.filter((r) => r.reward.rewardType === 'rare').length}
              </p>
            </div>
            <div className="bg-emerald-950/50 rounded-lg p-4 border border-amber-400/30">
              <p className="text-emerald-200 text-sm mb-1">普通獎品</p>
              <p className="text-2xl font-bold text-gray-400">
                {userProfile.rewardHistory.filter((r) => r.reward.rewardType === 'common').length}
              </p>
            </div>
          </div>
        </CardContent>
      </Card>
    </div>
  );
}
PK
frontend/src/pages/RealityConnectionPage.tsximport { memo } from 'react';
import RealityConnectionModule from '../components/RealityConnectionModule';
import { Button } from '@/components/ui/button';
import { ArrowLeft } from 'lucide-react';

interface RealityConnectionPageProps {
  onNavigateBack: () => void;
}

function RealityConnectionPage({ onNavigateBack }: RealityConnectionPageProps) {
  return (
    <div className="space-y-6 animate-fade-in">
      {/* Back Button */}
      <Button
        onClick={onNavigateBack}
        variant="ghost"
        className="text-blue-400 hover:text-blue-300 hover:bg-blue-400/10"
      >
        <ArrowLeft className="h-4 w-4 mr-2" />
        返回首頁
      </Button>

      {/* Main Reality Connection Module */}
      <RealityConnectionModule variant="full" />

      {/* Additional Information */}
      <div className="grid md:grid-cols-2 gap-6">
        <div className="bg-gradient-to-br from-blue-900/50 to-purple-900/50 border border-blue-400/30 rounded-xl p-6 card-transition hover:border-blue-400">
          <h3 className="text-xl font-bold text-blue-400 mb-4">時間事件系統</h3>
          <div className="space-y-3 text-sm text-blue-200">
            <p>
              現實連結模組會根據您的本地時間自動觸發特殊事件：
            </p>
            <ul className="list-disc list-inside space-y-2 ml-2">
              <li>早晨 (05:00-12:00): 能量恢復加速 +20%</li>
              <li>午後 (12:00-17:00): 幸運值提升 +15%</li>
              <li>傍晚 (17:00-21:00): 昇華進度加成 +10%</li>
              <li>夜晚 (21:00-05:00): 靈魂協作效率 +25%</li>
            </ul>
          </div>
        </div>

        <div className="bg-gradient-to-br from-purple-900/50 to-pink-900/50 border border-purple-400/30 rounded-xl p-6 card-transition hover:border-purple-400">
          <h3 className="text-xl font-bold text-purple-400 mb-4">季節影響機制</h3>
          <div className="space-y-3 text-sm text-purple-200">
            <p>
              季節能量會影響您在元宇宙中的各項活動：
            </p>
            <ul className="list-disc list-inside space-y-2 ml-2">
              <li>春季: 成長與新生，經驗值獲取 +15%</li>
              <li>夏季: 活力與熱情，能量上限 +20%</li>
              <li>秋季: 收穫與智慧，獎勵積分 +10%</li>
              <li>冬季: 沉澱與蓄積，昇華效率 +15%</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  );
}

export default memo(RealityConnectionPage);
PK
frontend/src/pages/RealmDetailPage.tsximport { useState, useEffect } from 'react';
import { useGetRealmById, useGetUserRealms, useUpdateUserRealmStats } from '../hooks/useQueries';
import { useInternetIdentity } from '../hooks/useInternetIdentity';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Progress } from '@/components/ui/progress';
import { Skeleton } from '@/components/ui/skeleton';
import { ArrowLeft, Sparkles, TrendingUp, Award, Zap, Activity, Target, Trophy } from 'lucide-react';
import { RealmType } from '../backend';
import { toast } from 'sonner';

interface RealmDetailPageProps {
  realmId: number;
  onNavigateBack: () => void;
}

const realmThemes: Record<RealmType, { 
  gradient: string; 
  borderColor: string; 
  textColor: string; 
  icon: string;
  bgImage: string;
  energyColor: string;
}> = {
  [RealmType.fairy]: {
    gradient: 'from-pink-900/50 via-purple-900/50 to-blue-900/50',
    borderColor: 'border-pink-400/50',
    textColor: 'text-pink-400',
    icon: '🌸',
    bgImage: '/assets/generated/xian-dao-interactive-background.dim_1920x1080.png',
    energyColor: 'bg-pink-400',
  },
  [RealmType.cultivation]: {
    gradient: 'from-green-900/50 via-emerald-900/50 to-teal-900/50',
    borderColor: 'border-emerald-400/50',
    textColor: 'text-emerald-400',
    icon: '⚗️',
    bgImage: '/assets/generated/xiuzhen-interactive-background.dim_1920x1080.png',
    energyColor: 'bg-emerald-400',
  },
  [RealmType.martial]: {
    gradient: 'from-red-900/50 via-orange-900/50 to-yellow-900/50',
    borderColor: 'border-orange-400/50',
    textColor: 'text-orange-400',
    icon: '⚔️',
    bgImage: '/assets/generated/wudao-interactive-background.dim_1920x1080.png',
    energyColor: 'bg-orange-400',
  },
  [RealmType.buddhist]: {
    gradient: 'from-amber-900/50 via-yellow-900/50 to-orange-900/50',
    borderColor: 'border-amber-400/50',
    textColor: 'text-amber-400',
    icon: '🪷',
    bgImage: '/assets/generated/fo-guo-interactive-background.dim_1920x1080.png',
    energyColor: 'bg-amber-400',
  },
  [RealmType.heavenly]: {
    gradient: 'from-blue-900/50 via-cyan-900/50 to-sky-900/50',
    borderColor: 'border-cyan-400/50',
    textColor: 'text-cyan-400',
    icon: '☁️',
    bgImage: '/assets/generated/tian-tang-interactive-background.dim_1920x1080.png',
    energyColor: 'bg-cyan-400',
  },
  [RealmType.demonic]: {
    gradient: 'from-red-950/50 via-rose-950/50 to-red-900/50',
    borderColor: 'border-red-400/50',
    textColor: 'text-red-400',
    icon: '🔥',
    bgImage: '/assets/generated/di-yu-interactive-background.dim_1920x1080.png',
    energyColor: 'bg-red-400',
  },
  [RealmType.underworld]: {
    gradient: 'from-green-950/50 via-teal-950/50 to-cyan-950/50',
    borderColor: 'border-teal-400/50',
    textColor: 'text-teal-400',
    icon: '👻',
    bgImage: '/assets/generated/di-fu-interactive-background.dim_1920x1080.png',
    energyColor: 'bg-teal-400',
  },
  [RealmType.divine]: {
    gradient: 'from-yellow-900/50 via-amber-900/50 to-orange-900/50',
    borderColor: 'border-yellow-400/50',
    textColor: 'text-yellow-400',
    icon: '⚡',
    bgImage: '/assets/generated/shen-dian-interactive-background.dim_1920x1080.png',
    energyColor: 'bg-yellow-400',
  },
};

export default function RealmDetailPage({ realmId, onNavigateBack }: RealmDetailPageProps) {
  const { data: realm, isLoading: realmLoading } = useGetRealmById(BigInt(realmId));
  const { identity } = useInternetIdentity();
  const { data: userRealms, isLoading: userRealmsLoading } = useGetUserRealms(identity?.getPrincipal() || null);
  const updateRealmStats = useUpdateUserRealmStats();
  
  const [energyLevel, setEnergyLevel] = useState(0);
  const [isTraining, setIsTraining] = useState(false);

  const userRealm = userRealms?.find(r => Number(r.id) === realmId);
  const theme = realm ? realmThemes[realm.realmType] : null;

  // Simulate energy accumulation
  useEffect(() => {
    const interval = setInterval(() => {
      setEnergyLevel(prev => {
        const next = prev + Math.random() * 2;
        return next > 100 ? 0 : next;
      });
    }, 100);

    return () => clearInterval(interval);
  }, []);

  const handleTraining = async () => {
    if (!userRealm || isTraining) return;

    setIsTraining(true);
    
    // Simulate training duration
    await new Promise(resolve => setTimeout(resolve, 2000));

    const pointsGain = Math.floor(Math.random() * 20) + 10;
    const reputationGain = Math.floor(Math.random() * 5) + 1;

    try {
      await updateRealmStats.mutateAsync({
        realmId: BigInt(realmId),
        points: BigInt(Number(userRealm.realmPoints) + pointsGain),
        reputation: BigInt(Number(userRealm.reputationPoints) + reputationGain),
        challenges: userRealm.challengeScores,
      });
      
      toast.success('修煉成功！', {
        description: `獲得 ${pointsGain} 積分和 ${reputationGain} 聲望`,
      });
    } catch (error) {
      toast.error('修煉失敗', {
        description: '請稍後再試',
      });
    } finally {
      setIsTraining(false);
    }
  };

  const handleChallenge = async () => {
    if (!userRealm || isTraining) return;

    setIsTraining(true);
    
    await new Promise(resolve => setTimeout(resolve, 3000));

    const challengeGain = Math.floor(Math.random() * 15) + 5;

    try {
      await updateRealmStats.mutateAsync({
        realmId: BigInt(realmId),
        points: userRealm.realmPoints,
        reputation: userRealm.reputationPoints,
        challenges: BigInt(Number(userRealm.challengeScores) + challengeGain),
      });
      
      toast.success('挑戰完成！', {
        description: `獲得 ${challengeGain} 挑戰分數`,
      });
    } catch (error) {
      toast.error('挑戰失敗', {
        description: '請稍後再試',
      });
    } finally {
      setIsTraining(false);
    }
  };

  if (realmLoading || userRealmsLoading || !realm || !theme) {
    return (
      <div className="space-y-6 animate-fade-in">
        <Skeleton className="h-64 w-full rounded-xl" />
        <div className="grid md:grid-cols-2 gap-6">
          <Skeleton className="h-48 rounded-xl" />
          <Skeleton className="h-48 rounded-xl" />
        </div>
      </div>
    );
  }

  const energyValue = userRealm 
    ? Number(userRealm.realmPoints) * 1.5 + Number(userRealm.reputationPoints) * 2.0 + Number(userRealm.challengeScores) * 1.8
    : 0;

  return (
    <div className="space-y-6 animate-fade-in">
      {/* Realm Header with Interactive Background */}
      <Card className={`bg-gradient-to-br ${theme.gradient} ${theme.borderColor} shadow-2xl overflow-hidden relative`}>
        <div className="absolute inset-0 opacity-30 pointer-events-none">
          <img 
            src={theme.bgImage}
            alt={realm.name}
            className="w-full h-full object-cover animate-pulse-slow"
          />
          <div className="absolute inset-0 bg-gradient-to-br from-white/10 via-transparent to-black/20 animate-spiritual-aura-flow"></div>
        </div>

        {/* Animated Energy Particles */}
        <div className="absolute inset-0 pointer-events-none overflow-hidden">
          {[...Array(10)].map((_, i) => (
            <div
              key={i}
              className={`absolute w-3 h-3 rounded-full ${theme.energyColor} opacity-40 blur-sm animate-float`}
              style={{
                left: `${Math.random() * 100}%`,
                top: `${Math.random() * 100}%`,
                animationDelay: `${i * 0.5}s`,
                animationDuration: `${3 + Math.random() * 2}s`,
              }}
            />
          ))}
        </div>
        
        <CardHeader className="relative z-10">
          <div className="flex items-center justify-between flex-wrap gap-4">
            <div className="flex items-center gap-4">
              <span className="text-6xl animate-pulse">{theme.icon}</span>
              <div>
                <CardTitle className={`text-3xl sm:text-4xl ${theme.textColor} manifestation-glow`}>
                  {realm.name}
                </CardTitle>
                <CardDescription className="text-white/80 text-lg mt-2">
                  {realm.description}
                </CardDescription>
              </div>
            </div>
            <Button
              onClick={onNavigateBack}
              variant="outline"
              className={`${theme.borderColor} ${theme.textColor} hover:bg-white/10`}
            >
              <ArrowLeft className="h-4 w-4 mr-2" />
              返回九界
            </Button>
          </div>
        </CardHeader>

        <CardContent className="relative z-10">
          <div className="grid md:grid-cols-2 gap-4">
            <div className="bg-black/30 rounded-lg p-4 border border-white/20">
              <h4 className="text-sm text-white/80 mb-2">能量類型</h4>
              <p className={`text-xl font-bold ${theme.textColor}`}>{realm.energyType}</p>
            </div>
            <div className="bg-black/30 rounded-lg p-4 border border-white/20">
              <h4 className="text-sm text-white/80 mb-2">界域主題</h4>
              <p className={`text-xl font-bold ${theme.textColor}`}>{realm.theming}</p>
            </div>
          </div>
        </CardContent>
      </Card>

      {/* User Stats and Energy Tracking */}
      {userRealm && (
        <div className="grid md:grid-cols-2 gap-6">
          <Card className={`bg-gradient-to-br ${theme.gradient} ${theme.borderColor} shadow-xl`}>
            <CardHeader>
              <CardTitle className={`${theme.textColor} flex items-center gap-2`}>
                <Activity className="h-5 w-5" />
                修煉數據
              </CardTitle>
            </CardHeader>
            <CardContent className="space-y-4">
              <div className="space-y-2">
                <div className="flex items-center justify-between">
                  <span className="text-sm text-white/80 flex items-center gap-2">
                    <Sparkles className="h-4 w-4" />
                    界別積分
                  </span>
                  <span className={`text-lg font-bold ${theme.textColor}`}>
                    {Number(userRealm.realmPoints)}
                  </span>
                </div>
                <div className="flex items-center justify-between">
                  <span className="text-sm text-white/80 flex items-center gap-2">
                    <TrendingUp className="h-4 w-4" />
                    聲望值
                  </span>
                  <span className={`text-lg font-bold ${theme.textColor}`}>
                    {Number(userRealm.reputationPoints)}
                  </span>
                </div>
                <div className="flex items-center justify-between">
                  <span className="text-sm text-white/80 flex items-center gap-2">
                    <Award className="h-4 w-4" />
                    挑戰分數
                  </span>
                  <span className={`text-lg font-bold ${theme.textColor}`}>
                    {Number(userRealm.challengeScores)}
                  </span>
                </div>
                <div className="flex items-center justify-between">
                  <span className="text-sm text-white/80 flex items-center gap-2">
                    <Zap className="h-4 w-4" />
                    能量值
                  </span>
                  <span className={`text-lg font-bold ${theme.textColor}`}>
                    {energyValue.toFixed(0)}
                  </span>
                </div>
              </div>

              {/* Real-time Energy Level */}
              <div className="bg-black/30 rounded-lg p-3 border border-white/10">
                <div className="flex items-center justify-between text-sm mb-2">
                  <span className="text-white/80">即時能量等級</span>
                  <span className={theme.textColor}>{energyLevel.toFixed(0)}%</span>
                </div>
                <Progress value={energyLevel} className="h-2 bg-black/50">
                  <div 
                    className={`h-full ${theme.energyColor} rounded-full transition-all duration-300 animate-pulse`}
                    style={{ width: `${energyLevel}%` }}
                  />
                </Progress>
              </div>
            </CardContent>
          </Card>

          <Card className={`bg-gradient-to-br ${theme.gradient} ${theme.borderColor} shadow-xl`}>
            <CardHeader>
              <CardTitle className={`${theme.textColor} flex items-center gap-2`}>
                <Target className="h-5 w-5" />
                修煉任務
              </CardTitle>
            </CardHeader>
            <CardContent className="space-y-3">
              <Button
                onClick={handleTraining}
                disabled={isTraining}
                className={`w-full bg-gradient-to-r ${theme.gradient} hover:opacity-90 text-white font-bold`}
              >
                {isTraining ? (
                  <>
                    <Activity className="h-4 w-4 mr-2 animate-spin" />
                    修煉中...
                  </>
                ) : (
                  <>
                    <Sparkles className="h-4 w-4 mr-2" />
                    開始修煉
                  </>
                )}
              </Button>

              <Button
                onClick={handleChallenge}
                disabled={isTraining}
                className={`w-full bg-gradient-to-r ${theme.gradient} hover:opacity-90 text-white font-bold`}
              >
                {isTraining ? (
                  <>
                    <Activity className="h-4 w-4 mr-2 animate-spin" />
                    挑戰中...
                  </>
                ) : (
                  <>
                    <Trophy className="h-4 w-4 mr-2" />
                    接受挑戰
                  </>
                )}
              </Button>

              <div className="bg-black/30 rounded-lg p-3 border border-white/10 mt-4">
                <p className="text-xs text-white/70 leading-relaxed">
                  通過修煉和挑戰提升您的界別數據。每次修煉可獲得積分和聲望，完成挑戰可獲得挑戰分數。能量值會根據您的總體表現自動計算。
                </p>
              </div>
            </CardContent>
          </Card>
        </div>
      )}
    </div>
  );
}
PK
frontend/src/pages/RealmPage.tsximport { useEffect, useRef, useState } from 'react';
import { useGetRealmById, useGetUserRealms, useUpdateUserRealmStats } from '../hooks/useQueries';
import { useInternetIdentity } from '../hooks/useInternetIdentity';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Skeleton } from '@/components/ui/skeleton';
import { ArrowLeft, Sparkles, TrendingUp, Award, Zap } from 'lucide-react';
import { toast } from 'sonner';
import { RealmType } from '../backend';

interface RealmPageProps {
  realmId: number;
  onNavigateBack: () => void;
}

const realmThemes: Record<RealmType, { 
  gradient: string; 
  borderColor: string; 
  textColor: string; 
  bgImage: string;
  particleColor: string;
}> = {
  [RealmType.fairy]: {
    gradient: 'from-pink-900/50 via-purple-900/50 to-blue-900/50',
    borderColor: 'border-pink-400/50',
    textColor: 'text-pink-400',
    bgImage: '/assets/generated/spiritual-realm-background.dim_1920x1080.png',
    particleColor: 'rgba(244, 114, 182, 0.6)',
  },
  [RealmType.cultivation]: {
    gradient: 'from-green-900/50 via-emerald-900/50 to-teal-900/50',
    borderColor: 'border-emerald-400/50',
    textColor: 'text-emerald-400',
    bgImage: '/assets/generated/xiuzhen-realm-bg.dim_1920x1080.png',
    particleColor: 'rgba(52, 211, 153, 0.6)',
  },
  [RealmType.martial]: {
    gradient: 'from-red-900/50 via-orange-900/50 to-yellow-900/50',
    borderColor: 'border-orange-400/50',
    textColor: 'text-orange-400',
    bgImage: '/assets/generated/wudao-realm-bg.dim_1920x1080.png',
    particleColor: 'rgba(251, 146, 60, 0.6)',
  },
  [RealmType.buddhist]: {
    gradient: 'from-amber-900/50 via-yellow-900/50 to-orange-900/50',
    borderColor: 'border-amber-400/50',
    textColor: 'text-amber-400',
    bgImage: '/assets/generated/fo-guo-realm-bg.dim_1920x1080.png',
    particleColor: 'rgba(251, 191, 36, 0.6)',
  },
  [RealmType.heavenly]: {
    gradient: 'from-blue-900/50 via-cyan-900/50 to-sky-900/50',
    borderColor: 'border-cyan-400/50',
    textColor: 'text-cyan-400',
    bgImage: '/assets/generated/tian-tang-realm-bg.dim_1920x1080.png',
    particleColor: 'rgba(34, 211, 238, 0.6)',
  },
  [RealmType.demonic]: {
    gradient: 'from-red-950/50 via-rose-950/50 to-red-900/50',
    borderColor: 'border-red-400/50',
    textColor: 'text-red-400',
    bgImage: '/assets/generated/di-yu-realm-bg.dim_1920x1080.png',
    particleColor: 'rgba(239, 68, 68, 0.6)',
  },
  [RealmType.underworld]: {
    gradient: 'from-green-950/50 via-teal-950/50 to-cyan-950/50',
    borderColor: 'border-teal-400/50',
    textColor: 'text-teal-400',
    bgImage: '/assets/generated/di-fu-realm-bg.dim_1920x1080.png',
    particleColor: 'rgba(20, 184, 166, 0.6)',
  },
  [RealmType.divine]: {
    gradient: 'from-yellow-900/50 via-amber-900/50 to-orange-900/50',
    borderColor: 'border-yellow-400/50',
    textColor: 'text-yellow-400',
    bgImage: '/assets/generated/shen-dian-realm-bg.dim_1920x1080.png',
    particleColor: 'rgba(234, 179, 8, 0.6)',
  },
};

export default function RealmPage({ realmId, onNavigateBack }: RealmPageProps) {
  const { data: realm, isLoading: realmLoading } = useGetRealmById(BigInt(realmId));
  const { identity } = useInternetIdentity();
  const { data: userRealms, isLoading: userRealmsLoading } = useGetUserRealms(identity?.getPrincipal() || null);
  const updateStats = useUpdateUserRealmStats();
  const canvasRef = useRef<HTMLCanvasElement>(null);
  const [isTraining, setIsTraining] = useState(false);

  const userRealm = userRealms?.find(r => r.id === BigInt(realmId));
  const theme = realm ? realmThemes[realm.realmType] : null;

  // GPU-accelerated 3D particle background
  useEffect(() => {
    if (!canvasRef.current || !theme) return;

    const canvas = canvasRef.current;
    const ctx = canvas.getContext('2d');
    if (!ctx) return;

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const particles: Array<{
      x: number;
      y: number;
      z: number;
      vx: number;
      vy: number;
      vz: number;
      size: number;
    }> = [];

    for (let i = 0; i < 50; i++) {
      particles.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        z: Math.random() * 1000,
        vx: (Math.random() - 0.5) * 0.5,
        vy: (Math.random() - 0.5) * 0.5,
        vz: Math.random() * 2 + 1,
        size: Math.random() * 3 + 1,
      });
    }

    let animationId: number;

    const animate = () => {
      ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      particles.forEach((particle) => {
        particle.x += particle.vx;
        particle.y += particle.vy;
        particle.z -= particle.vz;

        if (particle.z <= 0) {
          particle.z = 1000;
          particle.x = Math.random() * canvas.width;
          particle.y = Math.random() * canvas.height;
        }

        const scale = 1000 / (1000 + particle.z);
        const x2d = (particle.x - canvas.width / 2) * scale + canvas.width / 2;
        const y2d = (particle.y - canvas.height / 2) * scale + canvas.height / 2;
        const size = particle.size * scale;

        ctx.fillStyle = theme.particleColor;
        ctx.beginPath();
        ctx.arc(x2d, y2d, size, 0, Math.PI * 2);
        ctx.fill();
      });

      animationId = requestAnimationFrame(animate);
    };

    animate();

    const handleResize = () => {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    };

    window.addEventListener('resize', handleResize);

    return () => {
      cancelAnimationFrame(animationId);
      window.removeEventListener('resize', handleResize);
    };
  }, [theme]);

  const handleTraining = async () => {
    if (!userRealm || isTraining) return;

    setIsTraining(true);
    try {
      const newPoints = BigInt(Number(userRealm.realmPoints) + Math.floor(Math.random() * 50) + 10);
      const newReputation = BigInt(Number(userRealm.reputationPoints) + Math.floor(Math.random() * 10) + 1);
      const newChallenges = userRealm.challengeScores;

      await updateStats.mutateAsync({
        realmId: BigInt(realmId),
        points: newPoints,
        reputation: newReputation,
        challenges: newChallenges,
      });

      toast.success('修煉成功！獲得界別積分和聲望值');
    } catch (error) {
      console.error('Training error:', error);
      toast.error('修煉失敗，請稍後再試');
    } finally {
      setIsTraining(false);
    }
  };

  if (realmLoading || userRealmsLoading || !realm || !theme) {
    return (
      <div className="space-y-6 animate-fade-in">
        <Skeleton className="h-48 w-full rounded-xl" />
        <div className="grid md:grid-cols-2 gap-6">
          <Skeleton className="h-64 rounded-xl" />
          <Skeleton className="h-64 rounded-xl" />
        </div>
      </div>
    );
  }

  return (
    <div className="relative min-h-screen">
      {/* GPU-Accelerated 3D Background */}
      <canvas
        ref={canvasRef}
        className="fixed inset-0 pointer-events-none z-0"
        style={{ opacity: 0.6 }}
      />

      <div className="relative z-10 space-y-6 sm:space-y-8 animate-fade-in">
        {/* Header */}
        <Card className={`bg-gradient-to-br ${theme.gradient} ${theme.borderColor} shadow-2xl overflow-hidden relative`}>
          <div className="absolute inset-0 opacity-20 pointer-events-none">
            <div className={`absolute inset-0 bg-[url('${theme.bgImage}')] bg-cover bg-center animate-pulse-slow`}></div>
          </div>
          
          <CardHeader className="relative z-10">
            <div className="flex items-center justify-between flex-wrap gap-4">
              <div className="flex-1">
                <CardTitle className={`text-3xl sm:text-4xl md:text-5xl ${theme.textColor} manifestation-glow mb-2`}>
                  {realm.name}
                </CardTitle>
                <CardDescription className="text-white/90 text-base sm:text-lg">
                  {realm.description}
                </CardDescription>
              </div>
              <Button
                onClick={onNavigateBack}
                variant="outline"
                className={`${theme.borderColor} ${theme.textColor} hover:bg-white/20`}
              >
                <ArrowLeft className="h-4 w-4 mr-2" />
                返回八界
              </Button>
            </div>
          </CardHeader>
          
          <CardContent className="relative z-10">
            <div className="bg-black/30 rounded-xl p-4 sm:p-6 border border-white/20">
              <div className="flex items-center gap-2 mb-3">
                <Zap className={`h-5 w-5 ${theme.textColor}`} />
                <span className={`font-semibold ${theme.textColor}`}>能量類型</span>
              </div>
              <p className="text-white text-lg">{realm.energyType}</p>
            </div>
          </CardContent>
        </Card>

        {/* Stats and Training */}
        <div className="grid md:grid-cols-2 gap-6">
          {/* Stats Card */}
          <Card className={`bg-gradient-to-br ${theme.gradient} ${theme.borderColor} shadow-xl`}>
            <CardHeader>
              <CardTitle className={`text-2xl ${theme.textColor}`}>修煉數據</CardTitle>
              <CardDescription className="text-white/80">
                您在此界域的修煉進度
              </CardDescription>
            </CardHeader>
            <CardContent className="space-y-4">
              {userRealm ? (
                <>
                  <div className="bg-black/30 rounded-lg p-4 border border-white/20">
                    <div className="flex items-center justify-between mb-2">
                      <div className="flex items-center gap-2">
                        <Sparkles className="h-5 w-5" />
                        <span className="text-white/80">界別積分</span>
                      </div>
                      <span className={`text-2xl font-bold ${theme.textColor}`}>
                        {Number(userRealm.realmPoints)}
                      </span>
                    </div>
                  </div>
                  <div className="bg-black/30 rounded-lg p-4 border border-white/20">
                    <div className="flex items-center justify-between mb-2">
                      <div className="flex items-center gap-2">
                        <TrendingUp className="h-5 w-5" />
                        <span className="text-white/80">聲望值</span>
                      </div>
                      <span className={`text-2xl font-bold ${theme.textColor}`}>
                        {Number(userRealm.reputationPoints)}
                      </span>
                    </div>
                  </div>
                  <div className="bg-black/30 rounded-lg p-4 border border-white/20">
                    <div className="flex items-center justify-between mb-2">
                      <div className="flex items-center gap-2">
                        <Award className="h-5 w-5" />
                        <span className="text-white/80">挑戰分數</span>
                      </div>
                      <span className={`text-2xl font-bold ${theme.textColor}`}>
                        {Number(userRealm.challengeScores)}
                      </span>
                    </div>
                  </div>
                </>
              ) : (
                <div className="text-center py-8">
                  <p className="text-white/60">尚未開始修煉</p>
                </div>
              )}
            </CardContent>
          </Card>

          {/* Training Card */}
          <Card className={`bg-gradient-to-br ${theme.gradient} ${theme.borderColor} shadow-xl`}>
            <CardHeader>
              <CardTitle className={`text-2xl ${theme.textColor}`}>修煉系統</CardTitle>
              <CardDescription className="text-white/80">
                開始您的修煉之旅
              </CardDescription>
            </CardHeader>
            <CardContent className="space-y-4">
              <div className="bg-black/30 rounded-lg p-6 border border-white/20">
                <p className="text-white/90 mb-4 leading-relaxed">
                  在{realm.name}中修煉，可以獲得界別積分和聲望值。持續修煉提升您的境界，解鎖更多功能。
                </p>
                <Button
                  onClick={handleTraining}
                  disabled={isTraining || updateStats.isPending}
                  className={`w-full bg-gradient-to-r ${theme.gradient} hover:opacity-90 text-white font-bold text-lg py-6 transition-all transform hover:scale-105`}
                >
                  {isTraining || updateStats.isPending ? (
                    <>
                      <div className="h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent mr-2"></div>
                      修煉中...
                    </>
                  ) : (
                    <>
                      <Zap className="h-5 w-5 mr-2" />
                      開始修煉
                    </>
                  )}
                </Button>
              </div>
            </CardContent>
          </Card>
        </div>
      </div>
    </div>
  );
}

PK
frontend/src/pages/SubscriptionSuccessPage.tsximport { useEffect } from 'react';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { CheckCircle2, Heart, Sparkles, ArrowLeft, Clock } from 'lucide-react';
import { useVerifyAndActivateSubscription, useGetSubscriptionExpiryTime, useGetHourlySubscriptionStatus } from '../hooks/useQueries';
import { toast } from 'sonner';

interface SubscriptionSuccessPageProps {
  onNavigateHome: () => void;
}

export default function SubscriptionSuccessPage({ onNavigateHome }: SubscriptionSuccessPageProps) {
  const verifyAndActivate = useVerifyAndActivateSubscription();
  const { data: expiryTime } = useGetSubscriptionExpiryTime();
  const { data: hourlyStatus } = useGetHourlySubscriptionStatus();

  useEffect(() => {
    const params = new URLSearchParams(window.location.search);
    const sessionId = params.get('session_id');

    if (sessionId && !verifyAndActivate.isSuccess) {
      verifyAndActivate.mutateAsync(sessionId).then((success) => {
        if (success) {
          toast.success('訂閱已成功啟用！');
        } else {
          toast.error('訂閱驗證失敗，請聯繫客服');
        }
      });
    }
  }, [verifyAndActivate]);

  const formatEndDate = (timestamp: bigint) => {
    const date = new Date(Number(timestamp) / 1000000);
    return date.toLocaleDateString('zh-TW', { 
      year: 'numeric', 
      month: 'long', 
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    });
  };

  const formatHourlyTime = (timestamp: bigint) => {
    const date = new Date(Number(timestamp) / 1000000);
    return date.toLocaleString('zh-TW', { 
      month: 'short',
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    });
  };

  const isHourlySubscription = hourlyStatus?.active ?? false;

  return (
    <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-950 via-blue-950 to-purple-950 p-4">
      <div className="absolute inset-0 opacity-30 pointer-events-none">
        <div className="absolute inset-0 bg-[url('/assets/generated/subscription-success-page.dim_800x600.png')] bg-cover bg-center animate-pulse-slow"></div>
      </div>

      <Card className="bg-gradient-to-br from-emerald-900/50 to-green-800/50 border-green-400/50 shadow-2xl max-w-2xl w-full relative z-10 animate-fade-in">
        <CardHeader>
          <div className="flex flex-col items-center text-center space-y-4">
            <div className="relative">
              <CheckCircle2 className="h-24 w-24 text-green-400 animate-bounce" />
              <div className="absolute inset-0 bg-green-400/20 rounded-full blur-xl animate-pulse"></div>
            </div>
            <CardTitle className="text-3xl sm:text-4xl text-green-400 manifestation-glow">
              訂閱成功！
            </CardTitle>
            <CardDescription className="text-green-200 text-lg">
              感謝您對 代碼之內 的支持
            </CardDescription>
          </div>
        </CardHeader>

        <CardContent className="space-y-6">
          <div className="bg-green-950/50 rounded-xl p-6 border border-green-400/30">
            <div className="flex items-center justify-center gap-3 mb-4">
              {isHourlySubscription ? (
                <>
                  <Clock className="h-6 w-6 text-amber-400 animate-pulse" />
                  <h3 className="text-xl text-amber-400 font-semibold">每小時訂閱詳情</h3>
                </>
              ) : (
                <>
                  <Heart className="h-6 w-6 text-pink-400 animate-pulse" />
                  <h3 className="text-xl text-green-400 font-semibold">月訂閱詳情</h3>
                </>
              )}
            </div>
            <div className="space-y-3 text-green-100">
              <div className="flex justify-between items-center">
                <span>訂閱計劃：</span>
                <span className="font-semibold text-green-400">
                  {isHourlySubscription ? '每小時回饋計劃' : '開發者支持計劃'}
                </span>
              </div>
              {isHourlySubscription ? (
                <>
                  <div className="flex justify-between items-center">
                    <span>計費方式：</span>
                    <span className="font-semibold text-amber-400">每小時 0.1 ICP</span>
                  </div>
                  {hourlyStatus?.hoursBilled !== undefined && (
                    <div className="flex justify-between items-center">
                      <span>已計費時數：</span>
                      <span className="font-semibold text-amber-400">
                        {Number(hourlyStatus.hoursBilled)} 小時
                      </span>
                    </div>
                  )}
                  {hourlyStatus?.totalICPPaid !== undefined && (
                    <div className="flex justify-between items-center">
                      <span>累計支付：</span>
                      <span className="font-semibold text-amber-400">
                        {(Number(hourlyStatus.totalICPPaid) / 100000000).toFixed(2)} ICP
                      </span>
                    </div>
                  )}
                  {hourlyStatus?.lastBilledTime && (
                    <div className="flex justify-between items-center">
                      <span>上次計費：</span>
                      <span className="font-semibold text-amber-400">
                        {formatHourlyTime(hourlyStatus.lastBilledTime)}
                      </span>
                    </div>
                  )}
                </>
              ) : (
                <>
                  <div className="flex justify-between items-center">
                    <span>支付金額：</span>
                    <span className="font-semibold text-green-400">10 ICP</span>
                  </div>
                  <div className="flex justify-between items-center">
                    <span>訂閱期限：</span>
                    <span className="font-semibold text-green-400">30 天</span>
                  </div>
                  {expiryTime && (
                    <div className="flex justify-between items-center">
                      <span>到期時間：</span>
                      <span className="font-semibold text-green-400">{formatEndDate(expiryTime)}</span>
                    </div>
                  )}
                </>
              )}
            </div>
          </div>

          <div className="bg-amber-900/30 rounded-xl p-6 border border-amber-400/30">
            <div className="flex items-center gap-2 mb-3">
              <Sparkles className="h-5 w-5 text-amber-400" />
              <h3 className="text-lg text-amber-400 font-semibold">您的專屬權益</h3>
            </div>
            <ul className="space-y-2 text-green-100 text-sm">
              {isHourlySubscription ? (
                <>
                  <li className="flex items-start gap-2">
                    <CheckCircle2 className="h-4 w-4 text-green-400 mt-0.5 flex-shrink-0" />
                    <span>靈活的小時計費模式，按實際使用時間付費</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <CheckCircle2 className="h-4 w-4 text-green-400 mt-0.5 flex-shrink-0" />
                    <span>自動續費無需手動操作，持續支持開發者</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <CheckCircle2 className="h-4 w-4 text-green-400 mt-0.5 flex-shrink-0" />
                    <span>實時顯示計費時數和累計支付金額</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <CheckCircle2 className="h-4 w-4 text-green-400 mt-0.5 flex-shrink-0" />
                    <span>隨時可在首頁停用訂閱，完全自主控制</span>
                  </li>
                </>
              ) : (
                <>
                  <li className="flex items-start gap-2">
                    <CheckCircle2 className="h-4 w-4 text-green-400 mt-0.5 flex-shrink-0" />
                    <span>專屬訂閱用戶標識，在首頁和個人資料中顯示</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <CheckCircle2 className="h-4 w-4 text-green-400 mt-0.5 flex-shrink-0" />
                    <span>優先體驗新功能和測試版本</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <CheckCircle2 className="h-4 w-4 text-green-400 mt-0.5 flex-shrink-0" />
                    <span>支持開發者持續改進和維護應用</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <CheckCircle2 className="h-4 w-4 text-green-400 mt-0.5 flex-shrink-0" />
                    <span>為靈界生態系統的發展做出貢獻</span>
                  </li>
                </>
              )}
            </ul>
          </div>

          <div className="bg-blue-900/30 rounded-xl p-4 border border-blue-400/30">
            <p className="text-blue-200 text-sm text-center">
              {isHourlySubscription
                ? '每小時系統會自動檢查並扣除 0.1 ICP，您可以在首頁查看詳細計費記錄'
                : '訂閱到期前 7 天，系統會自動發送續費提醒通知'
              }
            </p>
          </div>

          <div className="flex flex-col sm:flex-row gap-3">
            <Button
              onClick={onNavigateHome}
              className="flex-1 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold text-lg py-6 shadow-lg hover:shadow-green-400/50"
            >
              <ArrowLeft className="h-5 w-5 mr-2" />
              返回首頁
            </Button>
          </div>

          <div className="text-center">
            <img
              src={isHourlySubscription 
                ? '/assets/generated/hourly-subscription-tier-card.dim_400x300.png'
                : '/assets/generated/subscribed-indicator-gpu-transparent.dim_200x200.png'
              }
              alt="Subscribed"
              className={isHourlySubscription ? 'h-40 w-auto mx-auto animate-pulse' : 'h-32 w-32 mx-auto animate-manifestation-energy-pulse'}
            />
          </div>
        </CardContent>
      </Card>
    </div>
  );
}
PK
frontend/src/pages/TemplateSelectionPage.tsximport { useState } from 'react';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Sparkles, Flame, ArrowRight } from 'lucide-react';

interface TemplateSelectionPageProps {
  onSelectTemplate: (template: 'spiritual' | 'demonic') => void;
}

export default function TemplateSelectionPage({ onSelectTemplate }: TemplateSelectionPageProps) {
  const [hoveredTemplate, setHoveredTemplate] = useState<'spiritual' | 'demonic' | null>(null);

  return (
    <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-950 via-purple-950 to-slate-950 p-4 relative overflow-hidden">
      {/* Ambient background effects */}
      <div className="absolute inset-0 opacity-30">
        <div className="absolute inset-0 bg-[url('/assets/generated/template-selection-interface.dim_800x600.png')] bg-cover bg-center animate-pulse-slow"></div>
      </div>

      {/* Floating particles */}
      <div className="absolute inset-0 overflow-hidden pointer-events-none">
        {[0, 2, 4, 6].map((delay, index) => (
          <div 
            key={index}
            className="metaverse-float gpu-accelerated" 
            style={{ 
              left: `${15 + index * 25}%`, 
              animationDelay: `${delay}s`
            }}
          >
            <img 
              src={index % 2 === 0 
                ? "/assets/generated/spiritual-lotus-3d-transparent.dim_200x200.png"
                : "/assets/generated/demonic-flame-3d-transparent.dim_200x200.png"
              }
              alt="" 
              className={`h-${12 + index * 2} w-${12 + index * 2} opacity-${50 + index * 10}`}
              loading="eager"
            />
          </div>
        ))}
      </div>

      <div className="max-w-6xl w-full space-y-8 relative z-10 animate-fade-in">
        {/* Header */}
        <div className="text-center space-y-4">
          <h1 className="text-4xl md:text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 via-pink-400 to-cyan-400 animate-enhanced-glow-transition">
            LFLCEI幸運草元宇宙世界模板
          </h1>
          <p className="text-xl text-purple-200">
            選擇您的專屬元宇宙體驗 • Choose Your Metaverse Experience
          </p>
        </div>

        {/* Template Cards */}
        <div className="grid md:grid-cols-2 gap-8">
          {/* Spiritual Realm Template */}
          <Card 
            className={`bg-gradient-to-br from-purple-900/50 via-blue-900/50 to-indigo-900/50 border-purple-400/50 shadow-2xl card-transition cursor-pointer overflow-hidden relative group ${
              hoveredTemplate === 'spiritual' ? 'scale-105 shadow-purple-400/40' : ''
            }`}
            onMouseEnter={() => setHoveredTemplate('spiritual')}
            onMouseLeave={() => setHoveredTemplate(null)}
          >
            <div className="absolute inset-0 opacity-20 pointer-events-none">
              <div className="absolute inset-0 bg-[url('/assets/generated/spiritual-realm-background.dim_1920x1080.png')] bg-cover bg-center"></div>
              <div className="absolute inset-0 bg-gradient-to-br from-purple-400/10 via-transparent to-blue-400/10 animate-spiritual-aura-flow"></div>
            </div>

            <CardHeader className="relative z-10">
              <div className="flex items-center justify-between mb-4">
                <img
                  src="/assets/generated/spiritual-lotus-3d-transparent.dim_200x200.png"
                  alt="Spiritual Realm"
                  className="h-20 w-20 rounded-full border-4 border-purple-400 shadow-lg animate-manifestation-energy-pulse"
                  loading="eager"
                />
                <Sparkles className="h-12 w-12 text-purple-400 animate-pulse" />
              </div>
              <CardTitle className="text-3xl text-purple-400 manifestation-glow">
                LFLCEI靈域模板
              </CardTitle>
              <CardDescription className="text-purple-200 text-lg">
                Spiritual Realm Template
              </CardDescription>
            </CardHeader>

            <CardContent className="relative z-10 space-y-4">
              <div className="bg-purple-950/30 rounded-xl p-4 border border-purple-400/30">
                <h3 className="text-purple-300 font-semibold mb-3">核心特色：</h3>
                <ul className="space-y-2 text-purple-100 text-sm">
                  <li className="flex items-start gap-2">
                    <Sparkles className="h-4 w-4 text-purple-400 mt-0.5 flex-shrink-0" />
                    <span>寧靜祥和的靈性元宇宙環境</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <Sparkles className="h-4 w-4 text-purple-400 mt-0.5 flex-shrink-0" />
                    <span>柔和的靈性光暈和能量流動效果</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <Sparkles className="h-4 w-4 text-purple-400 mt-0.5 flex-shrink-0" />
                    <span>靈魂昇華和內在成長系統</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <Sparkles className="h-4 w-4 text-purple-400 mt-0.5 flex-shrink-0" />
                    <span>冥想式互動和平和轉場動畫</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <Sparkles className="h-4 w-4 text-purple-400 mt-0.5 flex-shrink-0" />
                    <span>溫和的AI回應和靈性指導</span>
                  </li>
                </ul>
              </div>

              <div className="bg-purple-950/30 rounded-xl p-4 border border-purple-400/30">
                <h3 className="text-purple-300 font-semibold mb-2">視覺設計：</h3>
                <div className="flex flex-wrap gap-2 text-xs">
                  <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30 text-purple-200">深紫藍色調</span>
                  <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30 text-purple-200">柔和金光</span>
                  <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30 text-purple-200">銀白漸層</span>
                  <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30 text-purple-200">浮動蓮花</span>
                  <span className="bg-purple-900/30 px-3 py-1 rounded-full border border-purple-400/30 text-purple-200">靈性光球</span>
                </div>
              </div>

              <Button
                onClick={() => onSelectTemplate('spiritual')}
                className="w-full bg-gradient-to-r from-purple-500 to-blue-600 hover:from-purple-600 hover:to-blue-700 text-white font-bold text-lg py-6 transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-lg hover:shadow-purple-400/50"
              >
                <Sparkles className="h-5 w-5 mr-2" />
                進入靈域世界
                <ArrowRight className="h-5 w-5 ml-2" />
              </Button>
            </CardContent>
          </Card>

          {/* Demonic Realm Template */}
          <Card 
            className={`bg-gradient-to-br from-red-900/50 via-orange-900/50 to-yellow-900/50 border-red-400/50 shadow-2xl card-transition cursor-pointer overflow-hidden relative group ${
              hoveredTemplate === 'demonic' ? 'scale-105 shadow-red-400/40' : ''
            }`}
            onMouseEnter={() => setHoveredTemplate('demonic')}
            onMouseLeave={() => setHoveredTemplate(null)}
          >
            <div className="absolute inset-0 opacity-20 pointer-events-none">
              <div className="absolute inset-0 bg-[url('/assets/generated/demonic-realm-background.dim_1920x1080.png')] bg-cover bg-center"></div>
              <div className="absolute inset-0 bg-gradient-to-br from-red-400/10 via-transparent to-orange-400/10 animate-spiritual-aura-flow"></div>
            </div>

            <CardHeader className="relative z-10">
              <div className="flex items-center justify-between mb-4">
                <img
                  src="/assets/generated/demonic-flame-3d-transparent.dim_200x200.png"
                  alt="Demonic Realm"
                  className="h-20 w-20 rounded-full border-4 border-red-400 shadow-lg animate-manifestation-energy-pulse"
                  loading="eager"
                />
                <Flame className="h-12 w-12 text-red-400 animate-pulse" />
              </div>
              <CardTitle className="text-3xl text-red-400 manifestation-glow">
                LFLCEI妖域模板
              </CardTitle>
              <CardDescription className="text-red-200 text-lg">
                Demonic Realm Template
              </CardDescription>
            </CardHeader>

            <CardContent className="relative z-10 space-y-4">
              <div className="bg-red-950/30 rounded-xl p-4 border border-red-400/30">
                <h3 className="text-red-300 font-semibold mb-3">核心特色：</h3>
                <ul className="space-y-2 text-red-100 text-sm">
                  <li className="flex items-start gap-2">
                    <Flame className="h-4 w-4 text-red-400 mt-0.5 flex-shrink-0" />
                    <span>高能量的動態挑戰環境</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <Flame className="h-4 w-4 text-red-400 mt-0.5 flex-shrink-0" />
                    <span>強烈的視覺衝擊和對比效果</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <Flame className="h-4 w-4 text-red-400 mt-0.5 flex-shrink-0" />
                    <span>挑戰和力量提升核心系統</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <Flame className="h-4 w-4 text-red-400 mt-0.5 flex-shrink-0" />
                    <span>激烈動畫和快節奏互動</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <Flame className="h-4 w-4 text-red-400 mt-0.5 flex-shrink-0" />
                    <span>智能難度調整和競爭排行榜</span>
                  </li>
                </ul>
              </div>

              <div className="bg-red-950/30 rounded-xl p-4 border border-red-400/30">
                <h3 className="text-red-300 font-semibold mb-2">視覺設計：</h3>
                <div className="flex flex-wrap gap-2 text-xs">
                  <span className="bg-red-900/30 px-3 py-1 rounded-full border border-red-400/30 text-red-200">深紅色調</span>
                  <span className="bg-red-900/30 px-3 py-1 rounded-full border border-red-400/30 text-red-200">暗紫漸層</span>
                  <span className="bg-red-900/30 px-3 py-1 rounded-full border border-red-400/30 text-red-200">金色火焰</span>
                  <span className="bg-red-900/30 px-3 py-1 rounded-full border border-red-400/30 text-red-200">能量爆發</span>
                  <span className="bg-red-900/30 px-3 py-1 rounded-full border border-red-400/30 text-red-200">動態符文</span>
                </div>
              </div>

              <Button
                onClick={() => onSelectTemplate('demonic')}
                className="w-full bg-gradient-to-r from-red-500 to-orange-600 hover:from-red-600 hover:to-orange-700 text-white font-bold text-lg py-6 transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-lg hover:shadow-red-400/50"
              >
                <Flame className="h-5 w-5 mr-2" />
                進入妖域世界
                <ArrowRight className="h-5 w-5 ml-2" />
              </Button>
            </CardContent>
          </Card>
        </div>

        {/* Unified Features */}
        <Card className="bg-gradient-to-r from-slate-900/50 to-purple-900/50 border-purple-400/30 shadow-xl">
          <CardHeader>
            <CardTitle className="text-2xl text-purple-400 text-center">統一核心功能</CardTitle>
            <CardDescription className="text-purple-200 text-center text-lg">
              兩個模板都包含完整的元宇宙功能
            </CardDescription>
          </CardHeader>
          <CardContent>
            <div className="grid sm:grid-cols-2 md:grid-cols-3 gap-4">
              <div className="bg-purple-950/30 rounded-lg p-4 border border-purple-400/30">
                <h4 className="text-purple-300 font-semibold mb-2">用戶認證</h4>
                <p className="text-purple-100 text-sm">Internet Identity 安全登入</p>
              </div>
              <div className="bg-purple-950/30 rounded-lg p-4 border border-purple-400/30">
                <h4 className="text-purple-300 font-semibold mb-2">導航中心</h4>
                <p className="text-purple-100 text-sm">統一模組整合介面</p>
              </div>
              <div className="bg-purple-950/30 rounded-lg p-4 border border-purple-400/30">
                <h4 className="text-purple-300 font-semibold mb-2">靈魂協作</h4>
                <p className="text-purple-100 text-sm">自動同步和AI協調</p>
              </div>
              <div className="bg-purple-950/30 rounded-lg p-4 border border-purple-400/30">
                <h4 className="text-purple-300 font-semibold mb-2">幸運系統</h4>
                <p className="text-purple-100 text-sm">每日簽到和抽盲盒</p>
              </div>
              <div className="bg-purple-950/30 rounded-lg p-4 border border-purple-400/30">
                <h4 className="text-purple-300 font-semibold mb-2">開發者支援</h4>
                <p className="text-purple-100 text-sm">ICP訂閱系統</p>
              </div>
              <div className="bg-purple-950/30 rounded-lg p-4 border border-purple-400/30">
                <h4 className="text-purple-300 font-semibold mb-2">外部模組</h4>
                <p className="text-purple-100 text-sm">完整生態系統整合</p>
              </div>
            </div>
          </CardContent>
        </Card>
      </div>
    </div>
  );
}
PK
frontend/src/pages/TransactionManagementPage.tsximport { useState } from 'react';
import { useIsCallerCoreAdmin, useGetAllTransactions, useRecordTransaction } from '../hooks/useQueries';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { FileText, Plus, ArrowLeft, AlertCircle, Crown } from 'lucide-react';
import { Skeleton } from '@/components/ui/skeleton';
import { toast } from 'sonner';
import { useNavigate } from '@tanstack/react-router';
import { Badge } from '@/components/ui/badge';

export default function TransactionManagementPage() {
  const { data: isCoreAdmin, isLoading: isCoreAdminLoading } = useIsCallerCoreAdmin();
  const { data: transactions, isLoading: transactionsLoading } = useGetAllTransactions();
  const recordTxMutation = useRecordTransaction();
  const navigate = useNavigate();

  const [fromPrincipal, setFromPrincipal] = useState('');
  const [toPrincipal, setToPrincipal] = useState('');
  const [amount, setAmount] = useState('');
  const [txType, setTxType] = useState('');

  const handleRecordTransaction = async (e: React.FormEvent) => {
    e.preventDefault();

    if (!fromPrincipal.trim() || !toPrincipal.trim() || !amount.trim() || !txType.trim()) {
      toast.error('請填寫所有欄位');
      return;
    }

    const amountBigInt = BigInt(Math.floor(parseFloat(amount) * 100000000));

    try {
      const txId = await recordTxMutation.mutateAsync({
        from: fromPrincipal.trim(),
        to: toPrincipal.trim(),
        amount: amountBigInt,
        txType: txType.trim(),
      });
      toast.success(`交易已記錄！ID: ${txId}`);
      setFromPrincipal('');
      setToPrincipal('');
      setAmount('');
      setTxType('');
    } catch (error: any) {
      console.error('Error recording transaction:', error);
      toast.error(error.message || '記錄交易失敗');
    }
  };

  if (isCoreAdminLoading) {
    return (
      <div className="space-y-6">
        <Skeleton className="h-48 w-full" />
        <Skeleton className="h-64 w-full" />
      </div>
    );
  }

  if (!isCoreAdmin) {
    return (
      <div className="flex items-center justify-center min-h-[60vh]">
        <Card className="bg-red-900/50 border-red-400/50 max-w-md">
          <CardHeader>
            <div className="flex items-center gap-3">
              <AlertCircle className="h-8 w-8 text-red-400" />
              <CardTitle className="text-2xl text-red-400">未授權</CardTitle>
            </div>
          </CardHeader>
          <CardContent>
            <p className="text-red-200">
              您沒有權限存取此頁面。此區域僅限核心管理員 (李奕勳) 使用。
            </p>
          </CardContent>
        </Card>
      </div>
    );
  }

  return (
    <div className="space-y-8 animate-fade-in max-w-6xl mx-auto">
      <Card className="bg-gradient-to-r from-blue-900/50 to-cyan-900/50 border-blue-400/50 shadow-xl">
        <CardHeader>
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3">
              <div className="p-3 bg-blue-400/20 rounded-full">
                <FileText className="h-8 w-8 text-blue-400" />
              </div>
              <div>
                <CardTitle className="text-3xl text-blue-400 clover-glow flex items-center gap-2">
                  交易介面管理
                  <Crown className="h-6 w-6 text-amber-400 animate-pulse" />
                </CardTitle>
                <CardDescription className="text-blue-200 text-lg mt-1">
                  記錄和查看所有交易記錄
                </CardDescription>
              </div>
            </div>
            <Button
              onClick={() => navigate({ to: '/admin' })}
              variant="ghost"
              className="text-blue-400 hover:text-blue-300 hover:bg-blue-400/10"
            >
              <ArrowLeft className="h-5 w-5 mr-2" />
              返回管理員頁面
            </Button>
          </div>
        </CardHeader>
      </Card>

      <Card className="bg-blue-900/50 border-blue-400/50">
        <CardHeader>
          <div className="flex items-center gap-3">
            <Plus className="h-6 w-6 text-blue-400" />
            <CardTitle className="text-2xl text-blue-400">記錄新交易</CardTitle>
          </div>
          <CardDescription className="text-blue-200">
            手動記錄交易資訊
          </CardDescription>
        </CardHeader>
        <CardContent>
          <form onSubmit={handleRecordTransaction} className="space-y-4">
            <div className="grid md:grid-cols-2 gap-4">
              <div className="space-y-2">
                <Label htmlFor="fromPrincipal" className="text-blue-200">
                  發送方 Principal ID
                </Label>
                <Input
                  id="fromPrincipal"
                  type="text"
                  placeholder="xxxxx-xxxxx-xxxxx-xxxxx-xxx"
                  value={fromPrincipal}
                  onChange={(e) => setFromPrincipal(e.target.value)}
                  className="bg-blue-950/50 border-blue-400/30 text-blue-100 placeholder:text-blue-400/50"
                  disabled={recordTxMutation.isPending}
                />
              </div>
              <div className="space-y-2">
                <Label htmlFor="toPrincipal" className="text-blue-200">
                  接收方 Principal ID
                </Label>
                <Input
                  id="toPrincipal"
                  type="text"
                  placeholder="xxxxx-xxxxx-xxxxx-xxxxx-xxx"
                  value={toPrincipal}
                  onChange={(e) => setToPrincipal(e.target.value)}
                  className="bg-blue-950/50 border-blue-400/30 text-blue-100 placeholder:text-blue-400/50"
                  disabled={recordTxMutation.isPending}
                />
              </div>
            </div>
            <div className="grid md:grid-cols-2 gap-4">
              <div className="space-y-2">
                <Label htmlFor="amount" className="text-blue-200">
                  金額 (ICP)
                </Label>
                <Input
                  id="amount"
                  type="number"
                  step="0.00000001"
                  placeholder="0.00000000"
                  value={amount}
                  onChange={(e) => setAmount(e.target.value)}
                  className="bg-blue-950/50 border-blue-400/30 text-blue-100 placeholder:text-blue-400/50"
                  disabled={recordTxMutation.isPending}
                />
              </div>
              <div className="space-y-2">
                <Label htmlFor="txType" className="text-blue-200">
                  交易類型
                </Label>
                <Input
                  id="txType"
                  type="text"
                  placeholder="例如：NFT_TRANSFER, PAYMENT, REWARD"
                  value={txType}
                  onChange={(e) => setTxType(e.target.value)}
                  className="bg-blue-950/50 border-blue-400/30 text-blue-100 placeholder:text-blue-400/50"
                  disabled={recordTxMutation.isPending}
                />
              </div>
            </div>
            <Button
              type="submit"
              className="w-full bg-blue-500 hover:bg-blue-600 active:bg-blue-700 text-white font-bold transition-all transform hover:scale-[1.02] active:scale-[0.98]"
              disabled={recordTxMutation.isPending}
            >
              {recordTxMutation.isPending ? (
                <>
                  <div className="h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent mr-2" />
                  記錄中...
                </>
              ) : (
                <>
                  <Plus className="h-4 w-4 mr-2" />
                  記錄交易
                </>
              )}
            </Button>
          </form>
        </CardContent>
      </Card>

      <Card className="bg-blue-900/50 border-blue-400/50">
        <CardHeader>
          <CardTitle className="text-xl text-blue-400">所有交易記錄</CardTitle>
          <CardDescription className="text-blue-200">
            查看系統中的所有交易
          </CardDescription>
        </CardHeader>
        <CardContent>
          {transactionsLoading ? (
            <div className="space-y-3">
              <Skeleton className="h-24 w-full" />
              <Skeleton className="h-24 w-full" />
              <Skeleton className="h-24 w-full" />
            </div>
          ) : transactions && transactions.length > 0 ? (
            <div className="space-y-3">
              {transactions.slice().reverse().map(([id, tx]) => (
                <div
                  key={id.toString()}
                  className="bg-blue-950/50 rounded-xl p-4 border border-blue-400/30"
                >
                  <div className="flex items-start justify-between gap-4">
                    <div className="flex-1">
                      <div className="flex items-center gap-2 mb-2">
                        <h3 className="text-blue-400 font-semibold">交易 #{id.toString()}</h3>
                        <Badge variant="outline" className="border-blue-400/50 text-blue-400">
                          {tx.transactionType}
                        </Badge>
                      </div>
                      <p className="text-blue-200 text-sm mb-1">
                        金額: {(Number(tx.amount) / 100000000).toFixed(8)} ICP
                      </p>
                      <p className="text-blue-300 text-xs mb-1">
                        發送方: {tx.from.toString()}
                      </p>
                      <p className="text-blue-300 text-xs mb-1">
                        接收方: {tx.to.toString()}
                      </p>
                      <p className="text-blue-300 text-xs">
                        時間: {new Date(Number(tx.timestamp) / 1000000).toLocaleString('zh-TW')}
                      </p>
                    </div>
                  </div>
                </div>
              ))}
            </div>
          ) : (
            <p className="text-blue-300 text-center py-8">尚無交易記錄</p>
          )}
        </CardContent>
      </Card>
    </div>
  );
}
PK
frontend/src/pages/UnifiedLFLCDappPortalPage.tsximport { useState, useCallback, useEffect } from 'react';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { 
  Sparkles, 
  Layers, 
  Globe, 
  Zap, 
  Activity, 
  Network, 
  Cpu, 
  Database,
  Shield,
  TrendingUp,
  Gift,
  Calendar,
  User,
  ArrowRight,
  ExternalLink,
  CheckCircle2,
  AlertCircle,
  RefreshCw,
  Orbit
} from 'lucide-react';
import { toast } from 'sonner';
import { useGetSoulCollaborationSyncStatus, useGetCallerUserProfile, useIsCallerAdmin, useIsCallerCoreAdmin } from '../hooks/useQueries';
import UnifiedDashboard from '../components/UnifiedDashboard';

type Page = 'home' | 'checkin' | 'gacha' | 'profile' | 'admin' | 'newborn-entrance' | 'metaverse-ascension' | 'reality-connection' | 'nine-realms-hub' | 'realm';

interface UnifiedLFLCDappPortalPageProps {
  onNavigate: (page: Page) => void;
}

interface ModuleStatus {
  name: string;
  description: string;
  status: 'active' | 'syncing' | 'offline';
  category: 'core' | 'nft' | 'transaction' | 'nine-realms' | 'ascension' | 'reality' | 'ai' | 'soul' | 'ecosystem';
  icon: string;
  action?: () => void;
}

export default function UnifiedLFLCDappPortalPage({ onNavigate }: UnifiedLFLCDappPortalPageProps) {
  const [moduleStatuses, setModuleStatuses] = useState<ModuleStatus[]>([
    {
      name: 'NFT 商店',
      description: '3D NFT 資產管理與交易',
      status: 'active',
      category: 'nft',
      icon: '/assets/generated/3d-nft-asset-loading-interface.dim_800x600.png',
      action: () => onNavigate('admin'),
    },
    {
      name: '交易介面',
      description: '統一交易記錄與管理',
      status: 'active',
      category: 'transaction',
      icon: '/assets/generated/transaction-interface-admin.dim_800x600.png',
      action: () => onNavigate('admin'),
    },
    {
      name: '九界系統',
      description: '靈界核心框架與跨界修煉',
      status: 'active',
      category: 'nine-realms',
      icon: '/assets/generated/unified-nine-realms-core-framework.dim_1200x800.png',
      action: () => onNavigate('nine-realms-hub'),
    },
    {
      name: '昇華系統',
      description: '元宇宙昇華與能量管理',
      status: 'active',
      category: 'ascension',
      icon: '/assets/generated/ascension-portal-3d-transparent.dim_400x400.png',
      action: () => onNavigate('metaverse-ascension'),
    },
    {
      name: '現實連接',
      description: '虛實融合與時間事件同步',
      status: 'active',
      category: 'reality',
      icon: '/assets/generated/reality-connection-panel.dim_600x400.png',
      action: () => onNavigate('reality-connection'),
    },
    {
      name: 'AI/Anima 整合',
      description: 'AI 同步邏輯與動畫系統',
      status: 'active',
      category: 'ai',
      icon: '/assets/generated/anima-gpu-integration-visualization.dim_800x600.png',
      action: () => handleExternalLink('https://lflcei-anima-t5m.caffeine.xyz/', 'LFLCEI Anima'),
    },
    {
      name: '自然智能',
      description: 'LFLCEI 自然智能系統',
      status: 'active',
      category: 'ai',
      icon: '/assets/generated/lflcei-natural-intelligence-icon-transparent.dim_64x64.png',
      action: () => handleExternalLink('https://lflc-natural-intelligence-spd.caffeine.xyz/', 'Natural Intelligence'),
    },
    {
      name: '靈魂協作',
      description: '跨模組靈魂協作引擎',
      status: 'active',
      category: 'soul',
      icon: '/assets/generated/soul-collaboration-engine-3d-icon-transparent.dim_200x200.png',
    },
    {
      name: '生態系統同步',
      description: '18 個後端模組統一同步',
      status: 'active',
      category: 'ecosystem',
      icon: '/assets/generated/ecosystem-sync-dashboard-18-backends.dim_1200x800.png',
    },
  ]);

  const { data: syncStatus } = useGetSoulCollaborationSyncStatus();
  const { data: userProfile } = useGetCallerUserProfile();
  const { data: isAdmin } = useIsCallerAdmin();
  const { data: isCoreAdmin } = useIsCallerCoreAdmin();
  const [isSyncing, setIsSyncing] = useState(false);

  const handleExternalLink = useCallback((url: string, name: string) => {
    const overlay = document.createElement('div');
    overlay.className = 'fixed inset-0 z-[9999] pointer-events-none';
    overlay.style.background = 'radial-gradient(circle at center, rgba(251, 191, 36, 0.3) 0%, transparent 70%)';
    overlay.style.animation = 'portal-transition 0.6s ease-out';
    document.body.appendChild(overlay);

    if (!document.getElementById('portal-transition-style')) {
      const style = document.createElement('style');
      style.id = 'portal-transition-style';
      style.textContent = `
        @keyframes portal-transition {
          0% { opacity: 0; transform: scale(0.8); }
          50% { opacity: 1; transform: scale(1.1); }
          100% { opacity: 0; transform: scale(1.5); }
        }
      `;
      document.head.appendChild(style);
    }

    requestAnimationFrame(() => {
      window.open(url, '_blank', 'noopener,noreferrer');
      toast.success(`正在開啟 ${name}...`);
    });

    setTimeout(() => {
      overlay.remove();
    }, 600);
  }, []);

  const handleCentralSync = useCallback(async () => {
    try {
      setIsSyncing(true);
      setModuleStatuses(prev => prev.map(m => ({ ...m, status: 'syncing' as const })));
      
      await new Promise(resolve => setTimeout(resolve, 2000));
      
      setModuleStatuses(prev => prev.map(m => ({ ...m, status: 'active' as const })));
      toast.success('中央樞紐同步完成！', {
        description: '所有模組已同步至最新狀態',
      });
    } catch (error) {
      console.error('Sync error:', error);
      toast.error('同步失敗，請稍後再試');
      setModuleStatuses(prev => prev.map(m => ({ ...m, status: 'active' as const })));
    } finally {
      setIsSyncing(false);
    }
  }, []);

  useEffect(() => {
    const interval = setInterval(() => {
      setModuleStatuses(prev => prev.map(module => {
        if (Math.random() > 0.95) {
          return { ...module, status: module.status === 'active' ? 'syncing' : 'active' };
        }
        return module;
      }));
    }, 5000);

    return () => clearInterval(interval);
  }, []);

  const getStatusIndicator = (status: 'active' | 'syncing' | 'offline') => {
    switch (status) {
      case 'active':
        return <div className="h-3 w-3 rounded-full bg-green-400 animate-pulse shadow-lg shadow-green-400/50" />;
      case 'syncing':
        return <div className="h-3 w-3 rounded-full bg-yellow-400 animate-spin border-2 border-yellow-600" />;
      case 'offline':
        return <div className="h-3 w-3 rounded-full bg-gray-400" />;
    }
  };

  const getCategoryColor = (category: string) => {
    switch (category) {
      case 'nft':
        return 'from-purple-900/50 to-pink-900/50 border-purple-400/50';
      case 'transaction':
        return 'from-blue-900/50 to-cyan-900/50 border-blue-400/50';
      case 'nine-realms':
        return 'from-indigo-900/50 to-purple-900/50 border-indigo-400/50';
      case 'ascension':
        return 'from-pink-900/50 to-rose-900/50 border-pink-400/50';
      case 'reality':
        return 'from-cyan-900/50 to-blue-900/50 border-cyan-400/50';
      case 'ai':
        return 'from-emerald-900/50 to-green-900/50 border-emerald-400/50';
      case 'soul':
        return 'from-violet-900/50 to-purple-900/50 border-violet-400/50';
      case 'ecosystem':
        return 'from-amber-900/50 to-yellow-900/50 border-amber-400/50';
      default:
        return 'from-slate-900/50 to-gray-900/50 border-slate-400/50';
    }
  };

  const activeModules = moduleStatuses.filter(m => m.status === 'active').length;
  const syncingModules = moduleStatuses.filter(m => m.status === 'syncing').length;
  const healthScore = Math.round((activeModules / moduleStatuses.length) * 100);

  return (
    <div className="space-y-6 sm:space-y-8 animate-fade-in">
      {/* Unified LFLC Dapp Portal Header */}
      <Card className="bg-gradient-to-br from-amber-900/50 via-emerald-900/50 to-green-900/50 border-amber-400/50 shadow-2xl card-transition hover:shadow-amber-400/30 overflow-hidden relative">
        <div className="absolute inset-0 opacity-20 pointer-events-none">
          <div className="absolute inset-0 bg-[url('/assets/generated/lflcei-unified-portal-entrance.dim_1920x1080.png')] bg-cover bg-center animate-pulse-slow"></div>
          <div className="absolute inset-0 bg-gradient-to-br from-amber-400/10 via-transparent to-green-400/10 animate-spiritual-aura-flow"></div>
        </div>

        <CardHeader className="relative z-10">
          <div className="flex items-center justify-between flex-wrap gap-4">
            <div className="flex-1">
              <CardTitle className="text-3xl sm:text-4xl md:text-5xl text-amber-400 manifestation-glow mb-3 animate-enhanced-glow-transition flex items-center gap-3">
                <img
                  src="/assets/generated/lflcei-lucky-clover-universe-logo-transparent.dim_400x400.png"
                  alt="LFLCEI Logo"
                  className="h-12 w-12 sm:h-16 sm:w-16 animate-manifestation-energy-pulse"
                  loading="eager"
                />
                Unified LFLC Dapp Portal
              </CardTitle>
              <CardDescription className="text-amber-200 text-base sm:text-lg md:text-xl">
                LFLCEI 幸運草宇宙統一體系 • 金綠漸層身份識別 • 統一 3D WebGL 佈局
              </CardDescription>
            </div>
            <div className="flex items-center gap-3">
              <div className="bg-amber-950/30 rounded-lg px-4 py-2 border border-amber-400/30">
                <div className="flex items-center gap-2">
                  <Activity className="h-5 w-5 text-amber-400 animate-pulse" />
                  <div>
                    <p className="text-xs text-amber-300">系統健康度</p>
                    <p className="text-lg font-bold text-amber-400">{healthScore}%</p>
                  </div>
                </div>
              </div>
              <Button
                onClick={handleCentralSync}
                disabled={isSyncing}
                className="bg-gradient-to-r from-amber-500 to-green-600 hover:from-amber-600 hover:to-green-700 text-white shadow-lg hover:shadow-amber-400/50"
              >
                {isSyncing ? (
                  <>
                    <RefreshCw className="h-4 w-4 mr-2 animate-spin" />
                    同步中...
                  </>
                ) : (
                  <>
                    <Zap className="h-4 w-4 mr-2" />
                    中央同步
                  </>
                )}
              </Button>
            </div>
          </div>
        </CardHeader>

        <CardContent className="relative z-10">
          <div className="bg-amber-950/30 rounded-xl p-4 sm:p-6 border border-amber-400/30 mb-4">
            <div className="grid md:grid-cols-3 gap-4 mb-4">
              <div className="flex items-start gap-3">
                <Network className="h-6 w-6 text-amber-400 flex-shrink-0 mt-1" />
                <div>
                  <h4 className="text-amber-300 font-semibold mb-1">統一前端入口</h4>
                  <p className="text-amber-200 text-sm">所有子模組整合至單一入口</p>
                </div>
              </div>
              <div className="flex items-start gap-3">
                <Layers className="h-6 w-6 text-amber-400 flex-shrink-0 mt-1" />
                <div>
                  <h4 className="text-amber-300 font-semibold mb-1">頂層導航系統</h4>
                  <p className="text-amber-200 text-sm">GPU 加速響應式轉場</p>
                </div>
              </div>
              <div className="flex items-start gap-3">
                <Cpu className="h-6 w-6 text-amber-400 flex-shrink-0 mt-1" />
                <div>
                  <h4 className="text-amber-300 font-semibold mb-1">統一 API 處理</h4>
                  <p className="text-amber-200 text-sm">完整雙向同步功能</p>
                </div>
              </div>
            </div>
            <div className="flex flex-wrap gap-2 text-xs text-amber-200">
              <span className="bg-amber-900/30 px-3 py-1 rounded-full border border-amber-400/30">金綠漸層主題</span>
              <span className="bg-amber-900/30 px-3 py-1 rounded-full border border-amber-400/30">統一視覺語言</span>
              <span className="bg-amber-900/30 px-3 py-1 rounded-full border border-amber-400/30">差異化介面</span>
              <span className="bg-amber-900/30 px-3 py-1 rounded-full border border-amber-400/30">即時同步狀態</span>
            </div>
          </div>
        </CardContent>
      </Card>

      {/* Unified Dashboard Integration */}
      <UnifiedDashboard currentPage="home" onNavigate={onNavigate} />

      {/* Central Hub - Real-time Sync Status */}
      <Card className="bg-gradient-to-br from-cyan-900/50 via-blue-900/50 to-indigo-900/50 border-cyan-400/50 shadow-2xl card-transition hover:shadow-cyan-400/30 overflow-hidden relative">
        <div className="absolute inset-0 opacity-20 pointer-events-none">
          <div className="absolute inset-0 bg-[url('/assets/generated/central-hub-sync-dashboard.dim_1200x800.png')] bg-cover bg-center animate-pulse-slow"></div>
        </div>

        <CardHeader className="relative z-10">
          <div className="flex items-center justify-between flex-wrap gap-4">
            <div className="flex-1">
              <CardTitle className="text-2xl sm:text-3xl md:text-4xl text-cyan-400 manifestation-glow mb-2 animate-enhanced-glow-transition">
                中央樞紐頁面 • Central Hub Dashboard
              </CardTitle>
              <CardDescription className="text-cyan-200 text-base sm:text-lg">
                即時模組同步狀態 • 系統健康度監控 • 統一數據流管理
              </CardDescription>
            </div>
            <div className="flex items-center gap-2">
              <div className="bg-cyan-950/30 rounded-lg px-3 py-2 border border-cyan-400/30">
                <div className="flex items-center gap-2">
                  <CheckCircle2 className="h-4 w-4 text-green-400" />
                  <span className="text-xs text-cyan-200">{activeModules} 活躍</span>
                </div>
              </div>
              {syncingModules > 0 && (
                <div className="bg-yellow-950/30 rounded-lg px-3 py-2 border border-yellow-400/30">
                  <div className="flex items-center gap-2">
                    <RefreshCw className="h-4 w-4 text-yellow-400 animate-spin" />
                    <span className="text-xs text-yellow-200">{syncingModules} 同步中</span>
                  </div>
                </div>
              )}
            </div>
          </div>
        </CardHeader>

        <CardContent className="relative z-10">
          <div className="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
            {moduleStatuses.map((module, index) => (
              <Card
                key={index}
                className={`bg-gradient-to-br ${getCategoryColor(module.category)} shadow-lg card-transition hover:shadow-lg cursor-pointer group relative overflow-hidden`}
                onClick={module.action}
              >
                <div className="absolute top-3 right-3 z-10">
                  {getStatusIndicator(module.status)}
                </div>
                
                {module.status === 'syncing' && (
                  <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent animate-shimmer"></div>
                )}

                <CardHeader className="pb-3">
                  <div className="flex items-center gap-3">
                    <img
                      src={module.icon}
                      alt={module.name}
                      className="h-12 w-12 rounded-lg border-2 border-amber-400/30 group-hover:border-amber-400 transition-all group-hover:scale-110"
                      loading="lazy"
                    />
                    <div className="flex-1 min-w-0">
                      <CardTitle className="text-base text-amber-400 group-hover:text-amber-300 transition-colors truncate">
                        {module.name}
                      </CardTitle>
                      <p className="text-xs text-amber-200 capitalize">{module.category}</p>
                    </div>
                  </div>
                </CardHeader>
                <CardContent>
                  <p className="text-sm text-amber-100">{module.description}</p>
                  <div className="mt-3 flex items-center justify-between">
                    <span className={`text-xs font-semibold ${
                      module.status === 'active' ? 'text-green-400' :
                      module.status === 'syncing' ? 'text-yellow-400' :
                      'text-gray-400'
                    }`}>
                      {module.status === 'active' ? '運行中' :
                       module.status === 'syncing' ? '同步中' :
                       '離線'}
                    </span>
                    {module.action && (
                      <ArrowRight className="h-4 w-4 text-amber-400 group-hover:translate-x-1 transition-transform" />
                    )}
                  </div>
                </CardContent>
              </Card>
            ))}
          </div>

          <div className="mt-6 bg-cyan-950/30 rounded-xl p-4 border border-cyan-400/30">
            <div className="flex items-center gap-2 mb-3">
              <Orbit className="h-5 w-5 text-cyan-400 animate-spin" style={{ animationDuration: '8s' }} />
              <h4 className="text-cyan-300 font-semibold">統一同步架構</h4>
            </div>
            <div className="grid md:grid-cols-2 gap-3 text-sm">
              <div className="flex items-start gap-2">
                <CheckCircle2 className="h-4 w-4 text-green-400 flex-shrink-0 mt-0.5" />
                <span className="text-cyan-100">useLFLCSync 統一 API 處理器</span>
              </div>
              <div className="flex items-start gap-2">
                <CheckCircle2 className="h-4 w-4 text-green-400 flex-shrink-0 mt-0.5" />
                <span className="text-cyan-100">useEcosystemHub 生態系統整合</span>
              </div>
              <div className="flex items-start gap-2">
                <CheckCircle2 className="h-4 w-4 text-green-400 flex-shrink-0 mt-0.5" />
                <span className="text-cyan-100">完整雙向同步功能</span>
              </div>
              <div className="flex items-start gap-2">
                <CheckCircle2 className="h-4 w-4 text-green-400 flex-shrink-0 mt-0.5" />
                <span className="text-cyan-100">統一錯誤處理和重試機制</span>
              </div>
            </div>
          </div>
        </CardContent>
      </Card>

      {/* Differentiated Interface Panels */}
      <Card className="bg-gradient-to-br from-purple-900/50 via-pink-900/50 to-rose-900/50 border-purple-400/50 shadow-2xl card-transition hover:shadow-purple-400/30 overflow-hidden relative">
        <div className="absolute inset-0 opacity-20 pointer-events-none">
          <div className="absolute inset-0 bg-[url('/assets/generated/differentiated-interface-panels.dim_1200x800.png')] bg-cover bg-center animate-pulse-slow"></div>
        </div>

        <CardHeader className="relative z-10">
          <CardTitle className="text-2xl sm:text-3xl text-purple-400 manifestation-glow mb-2">
            差異化介面系統 • Differentiated Interface Panels
          </CardTitle>
          <CardDescription className="text-purple-200 text-base sm:text-lg">
            管理員頁面 • 統一儀表板 • 玩家模式 • 權限控制整合
          </CardDescription>
        </CardHeader>

        <CardContent className="relative z-10">
          <div className="grid md:grid-cols-3 gap-4">
            {/* Core Admin Panel */}
            {isCoreAdmin && (
              <Card className="bg-gradient-to-br from-red-900/50 to-orange-900/50 border-red-400/50 shadow-lg card-transition hover:shadow-red-400/30 cursor-pointer group"
                    onClick={() => onNavigate('admin')}>
                <CardHeader>
                  <div className="flex items-center gap-2 mb-2">
                    <Shield className="h-6 w-6 text-red-400 animate-pulse" />
                    <CardTitle className="text-lg text-red-400">核心管理員</CardTitle>
                  </div>
                  <CardDescription className="text-red-200 text-sm">
                    完整系統控制權限
                  </CardDescription>
                </CardHeader>
                <CardContent>
                  <div className="space-y-2 text-xs text-red-100">
                    <div className="flex items-center gap-2">
                      <CheckCircle2 className="h-3 w-3 text-red-400" />
                      <span>3D NFT 資產管理</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <CheckCircle2 className="h-3 w-3 text-red-400" />
                      <span>交易介面完全控制</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <CheckCircle2 className="h-3 w-3 text-red-400" />
                      <span>驗證系統配置</span>
                    </div>
                  </div>
                  <Button className="w-full mt-4 bg-red-500 hover:bg-red-600 text-white">
                    進入核心管理
                    <ArrowRight className="h-4 w-4 ml-2 group-hover:translate-x-1 transition-transform" />
                  </Button>
                </CardContent>
              </Card>
            )}

            {/* Admin Panel */}
            {isAdmin && (
              <Card className="bg-gradient-to-br from-amber-900/50 to-yellow-900/50 border-amber-400/50 shadow-lg card-transition hover:shadow-amber-400/30 cursor-pointer group"
                    onClick={() => onNavigate('admin')}>
                <CardHeader>
                  <div className="flex items-center gap-2 mb-2">
                    <Shield className="h-6 w-6 text-amber-400" />
                    <CardTitle className="text-lg text-amber-400">管理員頁面</CardTitle>
                  </div>
                  <CardDescription className="text-amber-200 text-sm">
                    標準管理功能存取
                  </CardDescription>
                </CardHeader>
                <CardContent>
                  <div className="space-y-2 text-xs text-amber-100">
                    <div className="flex items-center gap-2">
                      <CheckCircle2 className="h-3 w-3 text-amber-400" />
                      <span>系統監控和分析</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <CheckCircle2 className="h-3 w-3 text-amber-400" />
                      <span>用戶管理功能</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <CheckCircle2 className="h-3 w-3 text-amber-400" />
                      <span>基本配置權限</span>
                    </div>
                  </div>
                  <Button className="w-full mt-4 bg-amber-500 hover:bg-amber-600 text-white">
                    進入管理頁面
                    <ArrowRight className="h-4 w-4 ml-2 group-hover:translate-x-1 transition-transform" />
                  </Button>
                </CardContent>
              </Card>
            )}

            {/* Player Mode */}
            <Card className="bg-gradient-to-br from-emerald-900/50 to-green-900/50 border-emerald-400/50 shadow-lg card-transition hover:shadow-emerald-400/30 cursor-pointer group"
                  onClick={() => onNavigate('home')}>
              <CardHeader>
                <div className="flex items-center gap-2 mb-2">
                  <User className="h-6 w-6 text-emerald-400" />
                  <CardTitle className="text-lg text-emerald-400">玩家模式</CardTitle>
                </div>
                <CardDescription className="text-emerald-200 text-sm">
                  標準遊戲功能體驗
                </CardDescription>
              </CardHeader>
              <CardContent>
                <div className="space-y-2 text-xs text-emerald-100">
                  <div className="flex items-center gap-2">
                    <CheckCircle2 className="h-3 w-3 text-emerald-400" />
                    <span>3D 遊戲操作</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <CheckCircle2 className="h-3 w-3 text-emerald-400" />
                    <span>個人資料管理</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <CheckCircle2 className="h-3 w-3 text-emerald-400" />
                    <span>標準交易功能</span>
                  </div>
                </div>
                <Button className="w-full mt-4 bg-emerald-500 hover:bg-emerald-600 text-white">
                  進入遊戲模式
                  <ArrowRight className="h-4 w-4 ml-2 group-hover:translate-x-1 transition-transform" />
                </Button>
              </CardContent>
            </Card>
          </div>
        </CardContent>
      </Card>

      {/* Quick Navigation to Core Modules */}
      <Card className="bg-gradient-to-r from-amber-900/50 to-green-900/50 border-amber-400/50 shadow-xl">
        <CardHeader>
          <CardTitle className="text-xl sm:text-2xl text-amber-400 flex items-center gap-2">
            <Sparkles className="h-5 w-5 sm:h-6 sm:w-6" />
            核心模組快速導航
          </CardTitle>
          <CardDescription className="text-amber-200 text-sm sm:text-base">
            一鍵存取所有主要功能模組
          </CardDescription>
        </CardHeader>
        <CardContent>
          <div className="grid sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4">
            <Button
              onClick={() => onNavigate('nine-realms-hub')}
              variant="ghost"
              className="h-auto p-4 border border-purple-400/30 bg-purple-950/30 hover:bg-purple-900/50 hover:border-purple-400 text-left justify-start group"
            >
              <div className="flex items-center gap-3 w-full">
                <Layers className="h-8 w-8 text-purple-400 group-hover:scale-110 transition-transform" />
                <div className="flex-1 min-w-0">
                  <p className="text-sm font-semibold text-purple-400 truncate">九界核心</p>
                  <p className="text-xs text-purple-200">靈界框架</p>
                </div>
                <ArrowRight className="h-4 w-4 text-purple-400 group-hover:translate-x-1 transition-transform" />
              </div>
            </Button>

            <Button
              onClick={() => onNavigate('reality-connection')}
              variant="ghost"
              className="h-auto p-4 border border-blue-400/30 bg-blue-950/30 hover:bg-blue-900/50 hover:border-blue-400 text-left justify-start group"
            >
              <div className="flex items-center gap-3 w-full">
                <Globe className="h-8 w-8 text-blue-400 group-hover:scale-110 transition-transform" />
                <div className="flex-1 min-w-0">
                  <p className="text-sm font-semibold text-blue-400 truncate">現實連結</p>
                  <p className="text-xs text-blue-200">虛實融合</p>
                </div>
                <ArrowRight className="h-4 w-4 text-blue-400 group-hover:translate-x-1 transition-transform" />
              </div>
            </Button>

            <Button
              onClick={() => onNavigate('metaverse-ascension')}
              variant="ghost"
              className="h-auto p-4 border border-pink-400/30 bg-pink-950/30 hover:bg-pink-900/50 hover:border-pink-400 text-left justify-start group"
            >
              <div className="flex items-center gap-3 w-full">
                <TrendingUp className="h-8 w-8 text-pink-400 group-hover:scale-110 transition-transform" />
                <div className="flex-1 min-w-0">
                  <p className="text-sm font-semibold text-pink-400 truncate">昇華系統</p>
                  <p className="text-xs text-pink-200">能量管理</p>
                </div>
                <ArrowRight className="h-4 w-4 text-pink-400 group-hover:translate-x-1 transition-transform" />
              </div>
            </Button>

            <Button
              onClick={() => onNavigate('checkin')}
              variant="ghost"
              className="h-auto p-4 border border-amber-400/30 bg-amber-950/30 hover:bg-amber-900/50 hover:border-amber-400 text-left justify-start group"
            >
              <div className="flex items-center gap-3 w-full">
                <Calendar className="h-8 w-8 text-amber-400 group-hover:scale-110 transition-transform" />
                <div className="flex-1 min-w-0">
                  <p className="text-sm font-semibold text-amber-400 truncate">每日簽到</p>
                  <p className="text-xs text-amber-200">獲得獎勵</p>
                </div>
                <ArrowRight className="h-4 w-4 text-amber-400 group-hover:translate-x-1 transition-transform" />
              </div>
            </Button>

            <Button
              onClick={() => onNavigate('gacha')}
              variant="ghost"
              className="h-auto p-4 border border-emerald-400/30 bg-emerald-950/30 hover:bg-emerald-900/50 hover:border-emerald-400 text-left justify-start group"
            >
              <div className="flex items-center gap-3 w-full">
                <Gift className="h-8 w-8 text-emerald-400 group-hover:scale-110 transition-transform" />
                <div className="flex-1 min-w-0">
                  <p className="text-sm font-semibold text-emerald-400 truncate">抽盲盒</p>
                  <p className="text-xs text-emerald-200">幸運抽獎</p>
                </div>
                <ArrowRight className="h-4 w-4 text-emerald-400 group-hover:translate-x-1 transition-transform" />
              </div>
            </Button>

            <Button
              onClick={() => onNavigate('profile')}
              variant="ghost"
              className="h-auto p-4 border border-cyan-400/30 bg-cyan-950/30 hover:bg-cyan-900/50 hover:border-cyan-400 text-left justify-start group"
            >
              <div className="flex items-center gap-3 w-full">
                <User className="h-8 w-8 text-cyan-400 group-hover:scale-110 transition-transform" />
                <div className="flex-1 min-w-0">
                  <p className="text-sm font-semibold text-cyan-400 truncate">個人資訊</p>
                  <p className="text-xs text-cyan-200">查看資料</p>
                </div>
                <ArrowRight className="h-4 w-4 text-cyan-400 group-hover:translate-x-1 transition-transform" />
              </div>
            </Button>

            {isAdmin && (
              <Button
                onClick={() => onNavigate('admin')}
                variant="ghost"
                className="h-auto p-4 border border-red-400/30 bg-red-950/30 hover:bg-red-900/50 hover:border-red-400 text-left justify-start group"
              >
                <div className="flex items-center gap-3 w-full">
                  <Shield className="h-8 w-8 text-red-400 group-hover:scale-110 transition-transform" />
                  <div className="flex-1 min-w-0">
                    <p className="text-sm font-semibold text-red-400 truncate">管理員</p>
                    <p className="text-xs text-red-200">系統管理</p>
                  </div>
                  <ArrowRight className="h-4 w-4 text-red-400 group-hover:translate-x-1 transition-transform" />
                </div>
              </Button>
            )}

            <Button
              onClick={() => onNavigate('newborn-entrance')}
              variant="ghost"
              className="h-auto p-4 border border-indigo-400/30 bg-indigo-950/30 hover:bg-indigo-900/50 hover:border-indigo-400 text-left justify-start group"
            >
              <div className="flex items-center gap-3 w-full">
                <Sparkles className="h-8 w-8 text-indigo-400 group-hover:scale-110 transition-transform" />
                <div className="flex-1 min-w-0">
                  <p className="text-sm font-semibold text-indigo-400 truncate">初生入口</p>
                  <p className="text-xs text-indigo-200">幸運之旅</p>
                </div>
                <ArrowRight className="h-4 w-4 text-indigo-400 group-hover:translate-x-1 transition-transform" />
              </div>
            </Button>
          </div>
        </CardContent>
      </Card>

      {/* User Welcome Card */}
      {userProfile && (
        <Card className="bg-gradient-to-r from-emerald-800 to-green-700 border-amber-400/50 shadow-2xl">
          <CardHeader>
            <div className="flex items-center justify-between flex-wrap gap-4">
              <div className="flex-1">
                <CardTitle className="text-2xl sm:text-3xl text-amber-400 clover-glow mb-2">
                  歡迎，{userProfile.name}！
                </CardTitle>
                <CardDescription className="text-emerald-200 text-base">
                  您的統一 LFLC Dapp 體驗已準備就緒
                </CardDescription>
              </div>
              <img
                src="/assets/generated/lflcei-lucky-clover-universe-logo-transparent.dim_400x400.png"
                alt="Lucky Clover"
                className="h-16 w-16 rounded-full border-4 border-amber-400 shadow-lg animate-glow-pulse"
                loading="eager"
              />
            </div>
          </CardHeader>
          <CardContent>
            <div className="grid grid-cols-2 sm:grid-cols-4 gap-3">
              <div className="bg-emerald-950/50 rounded-xl p-3 border border-amber-400/30">
                <div className="flex items-center gap-2 mb-2">
                  <Sparkles className="h-4 w-4 text-amber-400" />
                  <span className="text-emerald-200 text-xs">積分</span>
                </div>
                <p className="text-2xl font-bold text-amber-400">
                  {Number(userProfile.points).toLocaleString()}
                </p>
              </div>
              <div className="bg-emerald-950/50 rounded-xl p-3 border border-amber-400/30">
                <div className="flex items-center gap-2 mb-2">
                  <TrendingUp className="h-4 w-4 text-amber-400" />
                  <span className="text-emerald-200 text-xs">昇華</span>
                </div>
                <p className="text-2xl font-bold text-amber-400">
                  {Number(userProfile.ascensionLevel)}
                </p>
              </div>
              <div className="bg-emerald-950/50 rounded-xl p-3 border border-amber-400/30">
                <div className="flex items-center gap-2 mb-2">
                  <Zap className="h-4 w-4 text-amber-400" />
                  <span className="text-emerald-200 text-xs">能量</span>
                </div>
                <p className="text-2xl font-bold text-amber-400">
                  {Number(userProfile.energyBalance)}
                </p>
              </div>
              <div className="bg-emerald-950/50 rounded-xl p-3 border border-amber-400/30">
                <div className="flex items-center gap-2 mb-2">
                  <Layers className="h-4 w-4 text-amber-400" />
                  <span className="text-emerald-200 text-xs">界域</span>
                </div>
                <p className="text-2xl font-bold text-amber-400">
                  {userProfile.realms.length}
                </p>
              </div>
            </div>
          </CardContent>
        </Card>
      )}
    </div>
  );
}
PK
frontend/src/types/PK
frontend/src/types/lflc-response.ts// LFLC 統一響應接口標準
export interface LFLC_Response_Envelope<T> {
  trace_id: string;
  timestamp: bigint;
  status_code: number;
  status_message: string;
  data: T | null;
  compression_method: CompressionMethod;
  rendering_hints: RenderingHints;
  sync_metadata: SyncMetadata;
  error_details?: ErrorDetails;
}

export type CompressionMethod = 'none' | 'gzip' | 'brotli' | 'lz4';

export interface RenderingHints {
  priority: 'high' | 'medium' | 'low';
  cache_duration: number;
  ui_update_trigger: boolean;
  animation_type?: 'fade' | 'slide' | 'scale' | 'none';
  gpu_accelerated: boolean;
}

export interface SyncMetadata {
  source_domain: 'lflcei.life' | 'lflcei.today';
  target_domain: 'lflcei.life' | 'lflcei.today';
  sync_direction: 'send' | 'receive' | 'bidirectional';
  sync_timestamp: bigint;
  retry_count: number;
  max_retries: number;
  integrity_hash: string;
}

export interface ErrorDetails {
  error_code: string;
  error_message: string;
  error_stack?: string;
  recovery_action?: string;
}

// LFLC 響應封裝工具函數
export class LFLCResponseHandler {
  static createEnvelope<T>(
    data: T,
    syncMetadata: SyncMetadata,
    renderingHints?: Partial<RenderingHints>
  ): LFLC_Response_Envelope<T> {
    return {
      trace_id: this.generateTraceId(),
      timestamp: BigInt(Date.now() * 1000000),
      status_code: 200,
      status_message: 'Success',
      data,
      compression_method: 'none',
      rendering_hints: {
        priority: 'medium',
        cache_duration: 60000,
        ui_update_trigger: true,
        animation_type: 'fade',
        gpu_accelerated: true,
        ...renderingHints,
      },
      sync_metadata: syncMetadata,
    };
  }

  static createErrorEnvelope<T>(
    error: Error,
    syncMetadata: SyncMetadata
  ): LFLC_Response_Envelope<T> {
    return {
      trace_id: this.generateTraceId(),
      timestamp: BigInt(Date.now() * 1000000),
      status_code: 500,
      status_message: 'Error',
      data: null,
      compression_method: 'none',
      rendering_hints: {
        priority: 'high',
        cache_duration: 0,
        ui_update_trigger: true,
        animation_type: 'none',
        gpu_accelerated: false,
      },
      sync_metadata: syncMetadata,
      error_details: {
        error_code: 'SYNC_ERROR',
        error_message: error.message,
        error_stack: error.stack,
        recovery_action: 'retry',
      },
    };
  }

  static generateTraceId(): string {
    const timestamp = Date.now().toString(36);
    const random = Math.random().toString(36).substring(2, 15);
    return `lflc-${timestamp}-${random}`;
  }

  static validateIntegrity(envelope: LFLC_Response_Envelope<any>): boolean {
    if (!envelope.trace_id || !envelope.timestamp) return false;
    if (!envelope.sync_metadata) return false;
    return true;
  }

  static shouldTriggerUIUpdate(envelope: LFLC_Response_Envelope<any>): boolean {
    return envelope.rendering_hints.ui_update_trigger;
  }

  static getAnimationType(envelope: LFLC_Response_Envelope<any>): string {
    return envelope.rendering_hints.animation_type || 'fade';
  }
}
PK
frontend/src/utils/PK
frontend/src/utils/urlParams.ts/**
 * Utility functions for parsing and managing URL parameters
 * Works with both hash-based and browser-based routing
 */

/**
 * Extracts a URL parameter from the current URL
 * Works with both query strings (?param=value) and hash-based routing (#/?param=value)
 *
 * @param paramName - The name of the parameter to extract
 * @returns The parameter value if found, null otherwise
 */
export function getUrlParameter(paramName: string): string | null {
    // Try to get from regular query string first
    const urlParams = new URLSearchParams(window.location.search);
    const regularParam = urlParams.get(paramName);

    if (regularParam !== null) {
        return regularParam;
    }

    // If not found, try to extract from hash (for hash-based routing)
    const hash = window.location.hash;
    const queryStartIndex = hash.indexOf('?');

    if (queryStartIndex !== -1) {
        const hashQuery = hash.substring(queryStartIndex + 1);
        const hashParams = new URLSearchParams(hashQuery);
        return hashParams.get(paramName);
    }

    return null;
}

/**
 * Stores a parameter in sessionStorage for persistence across navigation
 * Useful for maintaining state like admin tokens throughout the session
 *
 * @param key - The key to store the value under
 * @param value - The value to store
 */
export function storeSessionParameter(key: string, value: string): void {
    try {
        sessionStorage.setItem(key, value);
    } catch (error) {
        console.warn(`Failed to store session parameter ${key}:`, error);
    }
}

/**
 * Retrieves a parameter from sessionStorage
 *
 * @param key - The key to retrieve
 * @returns The stored value if found, null otherwise
 */
export function getSessionParameter(key: string): string | null {
    try {
        return sessionStorage.getItem(key);
    } catch (error) {
        console.warn(`Failed to retrieve session parameter ${key}:`, error);
        return null;
    }
}

/**
 * Gets a parameter from URL or sessionStorage (URL takes precedence)
 * If found in URL, also stores it in sessionStorage for future use
 *
 * @param paramName - The name of the parameter to retrieve
 * @param storageKey - Optional custom storage key (defaults to paramName)
 * @returns The parameter value if found, null otherwise
 */
export function getPersistedUrlParameter(paramName: string, storageKey?: string): string | null {
    const key = storageKey || paramName;

    // Check URL first
    const urlValue = getUrlParameter(paramName);
    if (urlValue !== null) {
        // Store in session for persistence
        storeSessionParameter(key, urlValue);
        return urlValue;
    }

    // Fall back to session storage
    return getSessionParameter(key);
}

/**
 * Removes a parameter from sessionStorage
 *
 * @param key - The key to remove
 */
export function clearSessionParameter(key: string): void {
    try {
        sessionStorage.removeItem(key);
    } catch (error) {
        console.warn(`Failed to clear session parameter ${key}:`, error);
    }
}

/**
 * Removes a specific parameter from the URL hash without reloading the page
 * Preserves route information and other parameters in the hash
 * Used to remove sensitive data from the address bar after extracting it
 *
 * @param paramName - The parameter to remove from the hash
 *
 * @example
 * // URL: https://app.com/#/dashboard?caffeineAdminToken=xxx&other=value
 * // After clearParamFromHash('caffeineAdminToken')
 * // URL: https://app.com/#/dashboard?other=value
 */
function clearParamFromHash(paramName: string): void {
    if (!window.history.replaceState) {
        return;
    }

    const hash = window.location.hash;
    if (!hash || hash.length <= 1) {
        return;
    }

    // Remove the leading #
    const hashContent = hash.substring(1);

    // Split route path from query string
    const queryStartIndex = hashContent.indexOf('?');

    if (queryStartIndex === -1) {
        // No query string in hash, nothing to remove
        return;
    }

    const routePath = hashContent.substring(0, queryStartIndex);
    const queryString = hashContent.substring(queryStartIndex + 1);

    // Parse and remove the specific parameter
    const params = new URLSearchParams(queryString);
    params.delete(paramName);

    // Reconstruct the URL
    const newQueryString = params.toString();
    let newHash = routePath;

    if (newQueryString) {
        newHash += '?' + newQueryString;
    }

    // If we still have content in the hash, keep it; otherwise remove the hash entirely
    const newUrl = window.location.pathname + window.location.search + (newHash ? '#' + newHash : '');
    window.history.replaceState(null, '', newUrl);
}

/**
 * Gets a secret from the URL hash fragment only (more secure than query params)
 * Hash fragments aren't sent to servers or logged in access logs
 * The hash is immediately cleared from the URL after extraction to prevent history leakage
 *
 * Usage: https://yourapp.com/#secret=xxx
 *
 * @param paramName - The name of the secret parameter
 * @returns The secret value if found (from hash or session), null otherwise
 */
export function getSecretFromHash(paramName: string): string | null {
    // Check session first to avoid unnecessary URL manipulation
    const existingSecret = getSessionParameter(paramName);
    if (existingSecret !== null) {
        return existingSecret;
    }

    // Try to extract from hash
    const hash = window.location.hash;
    if (!hash || hash.length <= 1) {
        return null;
    }

    // Remove the leading #
    const hashContent = hash.substring(1);
    const params = new URLSearchParams(hashContent);
    const secret = params.get(paramName);

    if (secret) {
        // Store in session for persistence
        storeSessionParameter(paramName, secret);
        // Immediately clear the secret parameter from URL to avoid history leakage
        clearParamFromHash(paramName);
        return secret;
    }

    return null;
}

/**
 * Gets a secret parameter with fallback chain: hash -> sessionStorage
 * This is the recommended way to handle sensitive parameters like admin tokens
 *
 * Security benefits over regular URL params:
 * - Hash fragments are not sent to the server
 * - Not logged in server access logs
 * - Not sent in HTTP Referer headers
 * - Automatically cleared from URL after extraction
 *
 * @param paramName - The name of the secret parameter
 * @returns The secret value if found, null otherwise
 */
export function getSecretParameter(paramName: string): string | null {
    return getSecretFromHash(paramName);
}
PK
spec.mdPK
backend/PK
backend/lib.moPK
backend/main.moPK
backend/authorization/PK
backend/authorization/access-control.moPK
backend/stripe/PK
backend/stripe/stripe.moPK
build-template/PK
build-template/package.jsonPK
build-template/pnpm-lock.yamlPK
build-template/pnpm-workspace.yamlPK
build-template/tsconfig.jsonPK
build-template/scripts/PK
build-template/scripts/prune-unused-images.jsPK
build-template/scripts/resize-images.jsPK
build-template/src/PK
build-template/src/backend/PK
build-template/src/backend/system-idl/PK
build-template/src/backend/system-idl/aaaaa-aa.didPK
build-template/src/frontend/PK
build-template/src/frontend/components.jsonPK
build-template/src/frontend/eslint.config.jsPK
build-template/src/frontend/package.jsonPK
build-template/src/frontend/postcss.config.jsPK
build-template/src/frontend/tsconfig.jsonPK
build-template/src/frontend/vite.config.jsPK
build-template/src/frontend/eslint-rules/PK
build-template/src/frontend/eslint-rules/no-bigint-in-query-keys.jsPK
build-template/src/frontend/eslint-rules/require-internet-identity-provider.jsPK
build-template/src/frontend/src/PK
build-template/src/frontend/src/components/PK
build-template/src/frontend/src/components/ui/PK
build-template/src/frontend/src/components/ui/accordion.tsxPK
build-template/src/frontend/src/components/ui/alert-dialog.tsxPK
build-template/src/frontend/src/components/ui/alert.tsxPK
build-template/src/frontend/src/components/ui/aspect-ratio.tsxPK
build-template/src/frontend/src/components/ui/avatar.tsxPK
build-template/src/frontend/src/components/ui/badge.tsxPK
build-template/src/frontend/src/components/ui/breadcrumb.tsxPK
build-template/src/frontend/src/components/ui/button.tsxPK
build-template/src/frontend/src/components/ui/calendar.tsxPK
build-template/src/frontend/src/components/ui/card.tsxPK
build-template/src/frontend/src/components/ui/carousel.tsxPK
build-template/src/frontend/src/components/ui/chart.tsxPK
build-template/src/frontend/src/components/ui/checkbox.tsxPK
build-template/src/frontend/src/components/ui/collapsible.tsxPk
build-template/src/frontend/src/components/ui/command.tsxPK
build-template/src/frontend/src/components/ui/context-menu.tsxPK
build-template/src/frontend/src/components/ui/dialog.tsxPK
build-template/src/frontend/src/components/ui/drawer.tsxPK
build-template/src/frontend/src/components/ui/dropdown-menu.tsxPK
build-template/src/frontend/src/components/ui/form.tsxPK
build-template/src/frontend/src/components/ui/hover-card.tsxPK
build-template/src/frontend/src/components/ui/input-otp.tsxPK
build-template/src/frontend/src/components/ui/input.tsxPK
build-template/src/frontend/src/components/ui/label.tsxPK
build-template/src/frontend/src/components/ui/menubar.tsxPK
build-template/src/frontend/src/components/ui/navigation-menu.tsxPK
build-template/src/frontend/src/components/ui/pagination.tsxPK
build-template/src/frontend/src/components/ui/progress.tsxPK
build-template/src/frontend/src/components/ui/radio-group.tsxPK
build-template/src/frontend/src/components/ui/resizable.tsxPK
build-template/src/frontend/src/components/ui/scroll-area.tsxPK
build-template/src/frontend/src/components/ui/select.tsxPK
build-template/src/frontend/src/components/ui/separator.tsxPK
build-template/src/frontend/src/components/ui/sheet.tsxPK
build-template/src/frontend/src/components/ui/sidebar.tsxPK
build-template/src/frontend/src/components/ui/skeleton.tsxPK
build-template/src/frontend/src/components/ui/slider.tsxPK
build-template/src/frontend/src/components/ui/sonner.tsxPK
build-template/src/frontend/src/components/ui/switch.tsxPK
build-template/src/frontend/src/components/ui/table.tsxPK
build-template/src/frontend/src/components/ui/tabs.tsxPK
build-template/src/frontend/src/components/ui/textarea.tsxPK
build-template/src/frontend/src/components/ui/toggle-group.tsxPK
build-template/src/frontend/src/components/ui/toggle.tsxPK
build-template/src/frontend/src/components/ui/tooltip.tsxPK
build-template/src/frontend/src/hooks/PK
build-template/src/frontend/src/hooks/use-mobile.tsxPK
build-template/src/frontend/src/lib/PK
build-template/src/frontend/src/lib/utils.tsPK
frontend/PK
frontend/index.htmlPK
frontend/tailwind.config.jsPK
frontend/src/PK
frontend/src/App.tsxPK
frontend/src/index.cssPK
frontend/src/main.tsxPK
frontend/src/components/PK
frontend/src/components/AdvisoryPortalIntegration.tsxPK
frontend/src/components/CosmicCoreInterface.tsxPK
frontend/src/components/EcosystemSyncDashboard.tsxPK
frontend/src/components/Footer.tsxPK
frontend/src/components/FortuneSlipModal.tsxPK
frontend/src/components/FusionCoreInterface.tsxPK
frontend/src/components/Header.tsxPK
frontend/src/components/LFLCEINaturalIntelligenceIntegration.tsxPK
frontend/src/components/LFLCEISupportAscension.tsxPK
frontend/src/components/LFLCResponseViewer.tsxPK
frontend/src/components/LuckyClover3D.tsxPK
frontend/src/components/ProfileSetupModal.tsxPK
frontend/src/components/RealityConnectionModule.tsxPK
frontend/src/components/RealityCoreInterface.tsxPK
frontend/src/components/SoulCollaborationStatus.tsxPK
frontend/src/components/SoulCollaborationSyncPanel.tsxPK
frontend/src/components/SupportDeveloperButton.tsxPK
frontend/src/components/TotalEcosystemEnergy.tsxPK
frontend/src/components/UnifiedCoreInterface.tsxPK
frontend/src/components/UnifiedDashboard.tsxPK
frontend/src/hooks/PK
frontend/src/hooks/useAnimaBackend.tsPK
frontend/src/hooks/useEcosystemHub.tsPK
frontend/src/hooks/useEcosystemSync.tsPK
frontend/src/hooks/useEditor.tsPK
frontend/src/hooks/useLFLCSync.tsPK
frontend/src/hooks/useQueries.tsPK
frontend/src/pages/PK
frontend/src/pages/AdminPage.tsxPK
frontend/src/pages/DailyCheckInPage.tsxPK
frontend/src/pages/DualDomainSyncPage.tsxPK
frontend/src/pages/GachaPage.tsxPK
frontend/src/pages/HomePage.tsxPK
frontend/src/pages/LoginPage.tsxPK
frontend/src/pages/MetaverseAscensionPage.tsxPK
frontend/src/pages/NFTManagementPage.tsxPK
frontend/src/pages/NewbornLuckyEntrancePage.tsxPK
frontend/src/pages/NineRealmsHubPage.tsxPK
frontend/src/pages/ProfilePage.tsxPK
frontend/src/pages/RealityConnectionPage.tsxPK
frontend/src/pages/RealmDetailPage.tsxPK
frontend/src/pages/RealmPage.tsxPK
frontend/src/pages/SubscriptionSuccessPage.tsxPK
frontend/src/pages/TemplateSelectionPage.tsxPK
frontend/src/pages/TransactionManagementPage.tsxPK
frontend/src/pages/UnifiedLFLCDappPortalPage.tsxPK
frontend/src/types/PK
frontend/src/types/lflc-response.tsPK
frontend/src/utils/PK
frontend/src/utils/urlParams.tsPK